[[ref.webui.systems.autoinst]]
= Autoinstallation
ifdef::env-github,backend-html5,backend-docbook5[]
//Admonitions
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
:linkattrs:
// SUSE ENTITIES FOR GITHUB
// System Architecture
:zseries: z Systems
:ppc: POWER
:ppc64le: ppc64le
:ipf : Itanium
:x86: x86
:x86_64: x86_64
// Rhel Entities
:rhel: Red Hat Enterprise Linux
:rhela: RHEL
:rhnminrelease6: Red Hat Enterprise Linux Server 6
:rhnminrelease7: Red Hat Enterprise Linux Server 7
// SUSE Manager Entities
:productname:
:susemgr: SUSE Manager
:susemgrproxy: SUSE Manager Proxy
:productnumber: 3.2
:saltversion: 2018.3.0
:webui: WebUI
// SUSE Product Entities
:sles-version: 12
:sp-version: SP3
:jeos: JeOS
:scc: SUSE Customer Center
:sls: SUSE Linux Enterprise Server
:sle: SUSE Linux Enterprise
:slsa: SLES
:suse: SUSE
:ay: AutoYaST
:kickstart: Kickstart
endif::[]
// Asciidoctor Front Matter
:doctype: book
:sectlinks:
:toc: left
:icons: font
:experimental:
:sourcedir: .
:imagesdir: images

.Autoinstallation Types: {ay} and Kickstart
[NOTE]
====
In the following section, {ay} and {ay} features apply for {sle} client systems only.
For {rhela} systems, use Kickstart and Kickstart features.
====

{ay} and Kickstart configuration files allow administrators to create an environment for automating otherwise time-consuming system installations, such as multiple servers or workstations. {ay} files have to be uploaded to be managed with {productname}.
Kickstart files can be created, modified, and managed within the {productname} Web interface.

{productname} also features the Cobbler installation server.
For more information on Cobbler, see
ifndef::env-github,backend-html5[]
<<advanced.topics.cobbler>>.
endif::[]
ifdef::env-github,backend-html5[]
<<advanced_topics_cobbler.adoc#advanced.topics.cobbler, Cobbler>>.
endif::[]

{productname} provides an interface for developing Kickstart and {ay} profiles that can be used to install {rhel} or {sle} on either new or already-registered systems automatically according to certain specifications.

.Autoinstallation Overview

image::systems_kickstart_overview.png[scaledwidth=444]


This overview page displays the status of automated installations (Kickstart and {ay}) on your client systems: the types and number of profiles you have created and the progress of systems that are scheduled to be installed using Kickstart or {ay}.
In the upper right area is the menu:Autoinstallation Actions[] section, which contains a series of links to management actions for your Kickstart or {ay}  profiles.
Before explaining the various automated installation options on this page, the next two sections provide an introduction to {ay}  (<<ref.webui.systems.autoinst.ay_intro>>) and Kickstart (<<ref.webui.systems.autoinst.kick_intro>>).




[[ref.webui.systems.autoinst.ay_intro]]
== Introduction to {ay}
ifdef::showremarks[]
#

    2011-01-19 - ke: do we want to enhance this intro?
    2011-01-24: it can stay as is for the moment. #
endif::showremarks[]


Using {ay}, a system administrator can create a single file containing the answers to all the questions that would normally be asked during a typical installation of a {sle} system.

{ay} files can be kept on a single server system and read by individual computers during the installation.
This way the same {ay} file is used to install {sle} on multiple machines.

The [ref]_SUSE Linux Enterprise Server AutoYaST Guide_ at (https://www.suse.com/documentation/sles-15/) will contain an in-depth discussion of "`Automated Installation`" using {ay}.




[[s4-system-ay-intro-explain]]
=== {ay} Explained


When a machine is to receive a network-based {ay} installation, the following events must occur in this order:

. After being connected to the network and turned on, the machine's PXE logic broadcasts its MAC address and requests to be discovered.
. If no static IP address is used, the DHCP server recognizes the discovery request and offers network information needed for the new machine to boot. This includes an IP address, the default gateway to be used, the netmask of the network, the IP address of the TFTP or HTTP server holding the bootloader program, and the full path and file name to that program (relative to the server's root).
. The machine applies the networking information and initiates a session with the server to request the bootloader program.
. The bootloader searches for its configuration file on the server from which it was loaded. This file dictates which Kernel and Kernel options, such as the initial RAM disk (initrd) image, should be executed on the booting machine. Assuming the bootloader program is SYSLINUX, this file is located in the [path]``pxelinux.cfg`` directory on the server and named the hexadecimal equivalent of the new machine's IP address. For example, a bootloader configuration file for {sls} should contain:
+

----
port 0
prompt 0
timeout 1
default autoyast
label autoyast
  kernel vmlinuz
  append autoyast=http://`my_susemanager_server`/`path`\
    install=http://`my_susemanager_server`/`repo_tree`
----
. The machine accepts and uncompresses the initrd and kernel, boots the kernel, fetches the instsys from the install server and initiates the {ay} installation with the options supplied in the bootloader configuration file, including the server containing the {ay} configuration file.
. The new machine is installed based on the parameters established within the {ay} configuration file.


[[s4-system-ay-intro-prereq]]
=== {ay} Prerequisites


Some preparation is required for your infrastructure to handle {ay} installations.
For instance, before creating {ay} profiles, you may consider:
ifdef::showremarks[]
#
     2011-01-21 - ke: Does it make sense to mention this?
     2011-01-24: Recommended by ug, there is now an item on HTTP and SM.
     #
endif::showremarks[]


* A DHCP server is not required for {ay}, but it can make things easier. If you are using static IP addresses, you should select static IP while developing your {ay} profile.
* Host the {ay} distribution trees via HTTP, properly provided by {productname}.
* If conducting a so-called bare-metal {ay} installation, provide the following settings:
** Configure DHCP to assign the required networking parameters and the bootloader program location.
** In the bootloader configuration file, specify the kernel and appropriate kernel options to be used.


[[s4-system-ay-iso]]
=== Building Bootable {ay} ISOs
ifdef::showremarks[]
#

      2011-01-24 - ke: good enough? #
endif::showremarks[]

ifdef::showremarks[]
#

     2011-02-09 - kkaempf: Does this work this way on SLE? #
endif::showremarks[]

ifdef::showremarks[]
#

     2011-02-09 - ke: Yes, it does.  Confirmed by ug.  See
     http://www.suse.de/~ug/AutoYaST_FAQ.html#bD #
endif::showremarks[]

ifdef::showremarks[]
#

     2015-08-11 - ke: http://doccomments.provo.novell.com/comments/28738
     wants us to recommend cobbler.  Changing accordingly. #
endif::showremarks[]


While you can schedule a registered system to be installed by {ay} with a new operating system and package profile, you can also automatically install a system that is not registered with {productname}, or does not yet have an operating system installed.
One common method of doing this is to create a bootable CD-ROM that is inserted into the target system.
When the system is rebooted or switched on, it boots from the CD-ROM, loads the {ay} configuration from your {productname}, and proceeds to install {sls} according to the {ay} profile you have created.

To use the CD-ROM, boot the system and type `autoyast` at the prompt (assuming you left the label for the {ay}  boot as ``autoyast``). When you press kbd:[Enter], the {ay}  installation begins.

For more information about image creation, refer to KIWI at http://doc.opensuse.org/projects/kiwi/doc/.




[[s4-system-ay-pxe]]
=== Integrating {ay} with PXE


ifdef::showremarks[]
#
      2011-01-19 - ke: reality check required
     #
endif::showremarks[]

ifdef::showremarks[]
#
      2011-01-24 - ke: I added note on uploading with Web UI
     #
endif::showremarks[]

In addition to CD-ROM-based installations, {ay} installation through a Pre-Boot Execution Environment (PXE) is supported.
This is less error-prone than CDs, enables {ay} installation from bare metal, and integrates with existing PXE/DHCP environments.

To use this method, make sure your systems have network interface cards (NIC) that support PXE, install and configure a PXE server, ensure DHCP is running, and place the installation repository on an HTTP server for deployment.
Finally upload the {ay} profile via the Web interface to the {productname} server.
Once the {ay} profile has been created, use the URL from the menu:Autoinstallation Overview[] page, as for CD-ROM-based installations.

To obtain specific instructions for conducting PXE {ay} installation, refer to the _Using PXE Boot_ section of the [ref]_SUSE Linux Enterprise Deployment Guide_.

Starting with <<ref.webui.systems.autoinst.profiles>>, {ay} options available from menu:Systems[Kickstart] are described.




[[ref.webui.systems.autoinst.kick_intro]]
== Introduction to Kickstart
ifdef::showremarks[]
#

    2011-01-19 - ke: do we want to keep this intro and the following sections?

    => joe: yes, it is important. #
endif::showremarks[]


Using Kickstart, a system administrator can create a single file containing the answers to all the questions that would normally be asked during a typical installation of {rhel}.

Kickstart files can be kept on a single server and read by individual computers during the installation.
This method allows you to use one Kickstart file to install {rhel} on multiple machines.

The [ref]_Red Hat Enterprise Linux System Administration Guide_ contains an in-depth description of Kickstart (https://access.redhat.com/documentation/en/red-hat-enterprise-linux/).

[[s4-system-ks-intro-explain]]
=== Kickstart Explained


When a machine is to receive a network-based {kickstart}, the following events must occur in this order:

. After being connected to the network and turned on, the machine's PXE logic broadcasts its MAC address and requests to be discovered.
. If no static IP address is used, the DHCP server recognizes the discovery request and offers network information needed for the new machine to boot. This information includes an IP address, the default gateway to be used, the netmask of the network, the IP address of the TFTP or HTTP server holding the bootloader program, and the full path and file name of that program (relative to the server's root).
. The machine applies the networking information and initiates a session with the server to request the bootloader program.
. The bootloader searches for its configuration file on the server from which it was loaded. This file dictates which kernel and kernel options, such as the initial RAM disk (initrd) image, should be executed on the booting machine. Assuming the bootloader program is SYSLINUX, this file is located in the [path]``pxelinux.cfg`` directory on the server and named the hexadecimal equivalent of the new machine's IP address. For example, a bootloader configuration file for Red Hat Enterprise Linux AS 2.1 should contain:
+

----
port 0
prompt 0
timeout 1
default My_Label
label My_Label
      kernel vmlinuz
      append ks=http://`my_susemanager_server`/`path`\
          initrd=initrd.img network apic
----
. The machine accepts and uncompresses the init image and kernel, boots the kernel, and initiates a Kickstart installation with the options supplied in the bootloader configuration file, including the server containing the Kickstart configuration file.
. This {kickstart} configuration file in turn directs the machine to the location of the installation files.
. The new machine is built based on the parameters established within the Kickstart configuration file.




[[s4-system-ks-intro-prereq]]
=== Kickstart Prerequisites


Some preparation is required for your infrastructure to handle {kickstart}s.
For instance, before creating Kickstart profiles, you may consider:

* A DHCP server is not required for kickstarting, but it can make things easier. If you are using static IP addresses, select static IP while developing your Kickstart profile.
* An FTP server can be used instead of hosting the Kickstart distribution trees via HTTP.
* If conducting a bare metal {kickstart}, you should configure DHCP to assign required networking parameters and the bootloader program location. Also, specify within the bootloader configuration file the kernel to be used and appropriate kernel options.




[[s4-system-ks-iso]]
=== Building Bootable Kickstart ISOs


While you can schedule a registered system to be kickstarted to a new operating system and package profile, you can also {kickstart} a system that is not registered with {productname} or does not yet have an operating system installed.
One common method of doing this is to create a bootable CD-ROM that is inserted into the target system.
When the system is rebooted, it boots from the CD-ROM, loads the {kickstart} configuration from your {productname}, and proceeds to install {rhel} according to the Kickstart profile you have created.

To do this, copy the contents of [path]``/isolinux`` from the first CD-ROM of the target distribution.
Then edit the [path]``isolinux.cfg`` file to default to 'ks'. Change the 'ks' section to the following template:

----
label ks
kernel vmlinuz
  append text ks=`url`initrd=initrd.img lang= devfs=nomount \
    ramdisk_size=16438`ksdevice`
----


IP address-based {kickstart} URLs will look like this:

----
http://`my.manager.server`/kickstart/ks/mode/ip_range
----


The {kickstart} distribution defined via the IP range should match the distribution from which you are building, or errors will occur. [replaceable]``ksdevice`` is optional, but looks like:

----
ksdevice=eth0
----


It is possible to change the distribution for a Kickstart profile within a family, such as Red Hat Enterprise Linux AS 4 to Red Hat Enterprise Linux ES 4, by specifying the new distribution label.
Note that you cannot move between versions (4 to 5) or between updates (U1 to U2).

Next, customize [path]``isolinux.cfg`` further for your needs by adding multiple Kickstart options, different boot messages, shorter timeout periods, etc.

Next, create the ISO as described in the _Making an Installation Boot CD-ROM_ section of the [ref]_Red Hat Enterprise Linux Installation Guide_.
Alternatively, issue the command:

----
mkisofs -o file.iso -b isolinux.bin -c boot.cat -no-emul-boot \
  -boot-load-size 4 -boot-info-table -R -J -v -T isolinux/
----


Note that [path]``isolinux/`` is the relative path to the directory containing the modified isolinux files copied from the distribution CD, while [path]``file.iso`` is the output ISO file, which is placed into the current directory.

Burn the ISO to CD-ROM and insert the disc.
Boot the system and type "ks" at the prompt (assuming you left the label for the Kickstart boot as 'ks'). When you press kbd:[Enter], Kickstart starts running.




[[s4-system-ks-pxe]]
=== Integrating Kickstart with PXE

In addition to CD-ROM-based installs, Kickstart supports a Pre-Boot Execution Environment (PXE). This is less error-prone than CDs, enables kickstarting from bare metal, and integrates with existing PXE/DHCP environments.

To use this method, make sure your systems have network interface cards (NIC) that support PXE.
Install and configure a PXE server and ensure DHCP is running.
Then place the appropriate files on an HTTP server for deployment.
Once the {kickstart} profile has been created, use the URL from the menu:Kickstart Details[] page, as for CD-ROM-based installs.

To obtain specific instructions for conducting PXE {kickstart}s, refer to the _PXE Network Installations_ chapter of the [ref]_Red Hat Enterprise Linux 4 System Administration    Guide_.

[NOTE]
====
Running the Network Booting Tool, as described in the Red Hat Enterprise Linux 4: System Administration Guide, select "HTTP" as the protocol and include the domain name of the {productname} in the Server field if you intend to use it to distribute the installation files.
====


The following sections describe the autoinstallation options available from the menu:Systems[Autoinstallation] page.




[[ref.webui.systems.autoinst.profiles]]
== Autoinstallation > Profiles (Kickstart and {ay})


This page lists all profiles for your organization, shows whether these profiles are active, and specifies the distribution tree with which each profile is associated.


image::systems_kickstart_overview.png[scaledwidth=444]


You can either create a Kickstart profile by clicking the [guimenu]``Create Kickstart Profile`` link, upload or paste the contents of a new profile clicking the [guimenu]``Upload Kickstart/Autoyast File``, or edit an existing Kickstart profile by clicking the name of the profile.
Note, you can only update {ay} profiles using the upload button.
You can also view {ay} profiles in the edit box or change the virtualization type using the selection list.




[[ref.webui.systems.autoinst.profiles.create]]
=== Create a Kickstart Profile


Click on the [guimenu]``Create Kickstart Profile`` link from the menu:Main Menu[Systems > Autoinstallation] page to start the wizard that populates the base values needed for a Kickstart profile.


image::create_profile_wizard.png[scaledwidth=444]


.Procedure: Creating a Kickstart Profile
. On the first line, enter a Kickstart profile label. This label cannot contain spaces, so use dashes (``-``) or underscores (``\_``) as separators.
. Select a [guimenu]``Base Channel`` for this profile, which consists of packages based on a specific architecture and Red Hat Enterprise Linux release.
+
.Creating Base Channel
NOTE: Base channels are only available if a suitable distribution is created first.
For creating distributions, see <<ref.webui.systems.autoinst.distribution>>.
+

. Select an [guimenu]``Kickstartable Tree`` for this profile. The [guimenu]``Kickstartable Tree`` drop-down menu is only populated if one or more distributions have been created for the selected base channel (see <<ref.webui.systems.autoinst.distribution>>).
. Instead of selecting a specific tree, you can also check the box [guimenu]``Always use the newest Tree for this base channel``. This setting lets {productname} automatically pick the latest tree that is associated with the specified base channels. If you add new trees later, {productname} will always keep the most recently created or modified.
. Select the [guimenu]``Virtualization Type`` from the drop-down menu.
+
NOTE: If you do not intend to use the Kickstart profile to create virtual guest systems, you can leave the drop-down at the default [guimenu]``None`` choice.
+

. On the second page, select (or enter) the location of the Kickstart tree.
. On the third page, select a root password for the system.


Depending on your base channel, your newly created Kickstart profile might be subscribed to a channel that is missing required packages.
For {kickstart} to work properly, the following packages should be present in its base channel: [package]``pyOpenSSL``, [package]``rhnlib``, [package]``libxml2-python``, and [package]``spacewalk-koan`` and associated packages.

To resolve this issue:

* Make sure that the Tools software channel for the Kickstart profile's base channel is available to your organization. If it is not, you must request entitlements for the Tools software channel from the {productname} administrator.
* Make sure that the Tools software channel for this Kickstart profile's base channel is available to your {productname} as a child channel.
* Make sure that [package]``rhn-kickstart`` and associated packages corresponding to this {kickstart} are available in the Tools child channel.


The final stage of the wizard presents the menu:Autoinstallation Details[Details] tab.
On this tab and the other subtabs, nearly every option for the new Kickstart profile can be customized.

Once created, you can access the Kickstart profile by downloading it from the [guimenu]``Autoinstallation Details`` page by clicking the [guimenu]``Autoinstallation File`` subtab and clicking the [guimenu]``Download Autoinstallation File`` link.

If the Kickstart file is _not_ managed by {productname}, you can access it via the following URL:

----
http://`my.manager.server`/ks/dist/ks-rhel-`ARCH`-`VARIANT`-`VERSION`
----


In the above example, [replaceable]``ARCH`` is the architecture of the Kickstart file, [replaceable]``VARIANT`` is either `client` or ``server``, and [replaceable]``VERSION`` is the release of {rhel} associated with the Kickstart file.

The following sections describe the options available on each subtab.

[[s4-system-ks-details-details]]
==== Autoinstallation Details  >  Details

image::details-ks-3.png[scaledwidth=444]

On the menu:Autoinstallation Details[Details] page, you have the following options:

* Change the profile [guimenu]``Label``.
* Change the operating system by clicking [guimenu]``(Change)``.
* Change the [guimenu]``Virtualization Type``.
+
NOTE: Changing the [guimenu]``Virtualization Type`` may require changes to the Kickstart profile bootloader and partition options, potentially overwriting user customizations.
Consult the [guimenu]``Partitioning`` tab to verify any new or changed settings.
+

* Change the amount of [guimenu]``Virtual Memory`` (in Megabytes of RAM) allocated to virtual guests autoinstalled with this profile.
* Change the number of [guimenu]``Virtual CPUs`` for each virtual guest.
* Change the [guimenu]``Virtual Storage Path`` from the default in [path]``/var/lib/xen/`` .
* Change the amount of [guimenu]``Virtual Disk Space`` (in GB) allotted to each virtual guest.
* Change the [guimenu]``Virtual Bridge`` for networking of the virtual guest.
* Deactivate the profile so that it cannot be used to schedule a {kickstart} by removing the [guimenu]``Active`` check mark.
* Check whether to enable logging for custom [option]``%post`` scripts to the [path]``/root/ks-post.log`` file.
* Decide whether to enable logging for custom [option]``%pre`` scripts to the [path]``/root/ks-pre.log`` file.
* Choose whether to preserve the [path]``ks.cfg`` file and all `%include` fragments to the [path]``/root/`` directory of all systems autoinstalled with this profile.
* Select whether this profile is the default for all of your organization's {kickstart}s by checking or unchecking the box.
* Add any [guimenu]``Kernel Options`` in the corresponding text box.
* Add any [guimenu]``Post Kernel Options`` in the corresponding text box.
* Enter comments that are useful to you in distinguishing this profile from others.




[[s4-system-ks-details-options]]
==== Autoinstallation Details >  Operating System

On this page, you can make the following changes to the operating system that the Kickstart profile installs:

Change the base channel::
Select from the available base channels. {productname} administrators see a list of all base channels that are currently synced to the {productname}.

Child Channels::
Subscribe to available child channels of the base channel, such as the Tools channel.

Available Trees::
Use the drop-down menu to choose from available trees associated with the base channel.

Always use the newest Tree for this base channel.::
Instead of selecting a specific tree, you can also check the box menu:Always use the newest Tree for this base channel.[]
This setting lets {productname} automatically pick the latest tree that is associated with the specified base channels.
If you add new trees later, {productname} will always keep the most recently created or modified.

Software URL (File Location)::
The exact location from which the Kickstart tree is mounted.
This value is determined when the profile is created.
You can view it on this page but you cannot change it.




[[s4-sm-system-kick-details-variables]]
==== Autoinstallation Details >  Variables

Autoinstallation variables can substitute values in Kickstart and {ay} profiles.
To define a variable, create a name-value pair ([replaceable]``name/value``) in the text box.

For example, if you want to autoinstall a system that joins the network of a specified organization (for example the Engineering department), you can create a profile variable to set the IP address and the gateway server address to a variable that any system using that profile will use.
Add the following line to the [guimenu]``Variables`` text box.

----
IPADDR=192.168.0.28
GATEWAY=192.168.0.1
----


Now you can use the name of the variable in the profile instead of a specific value.
For example, the [option]``network`` part of a Kickstart file looks like the following:

----
network --bootproto=static --device=eth0 --onboot=on --ip=$IPADDR \
  --gateway=$GATEWAY
----


The [option]``$IPADDR`` will be resolved to ``192.168.0.28``, and the [option]``$GATEWAY`` to `192.168.0.1`

[NOTE]
====
There is a hierarchy when creating and using variables in Kickstart files.
System Kickstart variables take precedence over [guimenu]``Profile`` variables, which in turn take precedence over [guimenu]``Distribution`` variables.
Understanding this hierarchy can alleviate confusion when using variables in {kickstart}s.
====


Using variables are just one part of the larger Cobbler infrastructure for creating templates that can be shared between multiple profiles and systems.
For more information about Cobbler and templates, refer to
ifndef::env-github,backend-html5[]
<<advanced.topics.cobbler>>.
endif::[]
ifdef::env-github,backend-html5[]
<<advanced_topics_cobbler.adoc#advanced.topics.cobbler, Cobbler>>.
endif::[]




[[s4-sm-system-kick-details-advanced]]
==== Autoinstallation Details >  Advanced Options


From this page, you can toggle several installation options on and off by checking and unchecking the boxes to the left of the option.
For most installations, the default options are correct.
Refer to Red Hat Enterprise Linux documentation for details.

[[s4-sm-system-kick-details-defprofile]]
==== Assigning Default Profiles to an Organization


You can specify an Organization Default Profile by clicking menu:Autoinstallation[Profiles > profile name > Details], then checking the [guimenu]``Organization Default Profile`` box and finally clicking [guimenu]``Update``.




[[s4-sm-system-kick-details-iprange]]
==== Assigning IP Ranges to Profiles


You can associate an IP range to an autoinstallation profile by clicking on menu:Autoinstallation[Profiles > profile name > Bare Metal Autoinstallation], adding an IPv4 range and finally clicking menu:Add IP Range[].




[[s4-sm-system-kick-details-packages]]
==== Autoinstallation Details >  Bare Metal Autoinstallation


This subtab provides the information necessary to Kickstart systems that are not currently registered with {productname}.
Using the on-screen instructions, you may either autoinstall systems using boot media (CD-ROM) or by IP address.




[[s4-sm-system-kick-details-pre]]
==== menu:System Details[Details]

Displays subtabs that are available from the [guimenu]``System Details`` tab.

On the menu:System Details[Details] page, you have the following options:

* Select between DHCP and static IP, depending on your network.
* Choose the level of SELinux that is configured on kickstarted systems.
* Enable configuration management or remote command execution on kickstarted systems.
* Change the root password associated with this profile.

image::details-ks-4.png[scaledwidth=444]



[[s4-sm-system-kick-details-post]]
==== System Details >  Locale


Change the timezone for kickstarted systems.

[[s4-system-ks-sysd-partition]]
==== System Details >  Partitioning


From this subtab, indicate the partitions that you wish to create during installation.
For example:

----
partition /boot --fstype=ext3 --size=200
partition swap --size=2000
partition pv.01 --size=1000 --grow
volgroup myvg pv.01 logvol / --vgname=myvg --name=rootvol --size=1000 --grow
----

[[s4-system-ks-sysd-file-pres]]
==== System Details >  File Preservation


If you have previously created a file preservation list, include this list as part of the {kickstart}.
This will protect the listed files from being over-written during the installation process.
Refer to <<ref.webui.systems.autoinst.preserve>> for information on how to create a file preservation list.




[[s4-system-ks-sysd-gpg-ssl]]
==== System Details >  GPG & SSL

From this subtab, select the GPG keys and/or SSL certificates to be exported to the kickstarted system during the %post section of the {kickstart}.
For {productname} customers, this list includes the SSL Certificate used during the installation of {productname}.

[NOTE]
====
Any GPG key you wish to export to the kickstarted system must be in ASCII rather than binary format.
====




[[s4-system-ks-sysd-trouble]]
==== System Details >  Troubleshooting


From this subtab, change information that may help with troubleshooting hardware problems:

Bootloader::
For some headless systems, it is better to select the non-graphic LILO bootloader.

Kernel Parameters::
Enter kernel parameters here that may help to narrow down the source of hardware issues.





[[s4-system-ks-soft-pkg-group]]
==== Software >  Package Groups

image::details-ks-5.png[scaledwidth=444]

The image above shows subtabs that are available from the [guimenu]``Software`` tab.

Enter the package groups, such as [systemitem]``@office`` or [systemitem]``@admin-tools`` you would like to install on the kickstarted system in the large text box.
If you would like to know what package groups are available, and what packages they contain, refer to the [path]``RedHat/base/`` file of your Kickstart tree.




[[s4-system-ks-soft-pkg-profile]]
==== Software >  Package Profiles


If you have previously created a Package Profile from one of your registered systems, you can use that profile as a template for the files to be installed on a kickstarted system.
Refer to
ifndef::env-github,backend-html5[]
<<s4-sm-system-details-packages>>
endif::[]
ifdef::env-github,backend-html5[]
<<reference-webui-systems.adoc#s4-sm-system-details-packages, Package Profiles>>
endif::[]
for more information about package profiles.




[[s4-system-ks-act-keys]]
==== Activation Keys

.Activation Keys

image::details-ks-6.png[scaledwidth=444]


The [guimenu]``Activation Keys`` tab allows you to select Activation Keys to include as part of the Kickstart profile.
These keys, which must be created before the Kickstart profile, will be used when re-registering kickstarted systems.




[[s4-system-ks-scripts]]
==== Scripts

.Scripts

image::details-ks-7.png[scaledwidth=444]


The [guimenu]``Scripts`` tab is where [option]``%pre`` and [option]``%post`` scripts are created.
This page lists any scripts that have already been created for this Kickstart profile.
To create a Kickstart script, perform the following procedure:


. Click the [guimenu]``add new kickstart script`` link in the upper right corner.
. Enter the path to the scripting language used to create the script, such as ``/usr/bin/perl``.
. Enter the full script in the large text box.
. Indicate whether this script is to be executed in the [option]``%pre`` or [option]``%post`` section of the Kickstart process.
. Indicate whether this script is to run outside of the chroot environment. Refer to the [ref]_Post-installation Script_ section of the [ref]_Red Hat Enterprise Linux System Administration Guide_ for further explanation of the [option]``nochroot`` option.


[NOTE]
====
{productname} supports the inclusion of separate files within the Partition Details section of the Kickstart profile.
For instance, you may dynamically generate a partition file based on the machine type and number of disks at {kickstart} time.
This file can be created via [option]``%pre`` script and placed on the system, such as [path]``/tmp/part-include``.
Then you can call for that file by entering the following line in the Partition Details field of the menu:System Details[Partitioning] tab:

----
%include /tmp/part-include
----
====




[[s4-system-ks-ks-file]]
==== Autoinstallation File

.Autoinstallation File

image::details-ks-8.png[scaledwidth=444]


The [guimenu]``Autoinstallation File`` tab allows you to view or download the profile that has been generated from the options chosen in the previous tabs.

[[ref.webui.systems.autoinst.profiles.upload]]
=== Upload Kickstart/{ay} File


Click the [guimenu]``Upload Kickstart/Autoyast File`` link from the menu:Systems[Autoinstallation] page to upload an externally prepared {ay} or Kickstart profile.


. In the first line, enter a profile [guimenu]``Label`` for the automated installation. This label[] drop-down menu is only populated if one or more distributions have been created for the selected base channel (see <<ref.webui.systems.autoinst.distribution>>).
. Instead of selecting a specific tree, you can also check the box [guimenu]``Always use the newest Tree`` for this base channel. This setting lets {productname} automatically pick the latest tree that is associated with the specified base channels. If you add new trees later, {productname} will always keep the most recently created or modified.
. Select the [guimenu]``Virtualization Type`` from the drop-down menu. For more information about virtualization, refer to
ifndef::env-github,backend-html5[]
<<advanced.topics.virtualization>>.
endif::[]
ifdef::env-github,backend-html5[]
<<advanced_topics_virtualization.adoc#advanced.topics.virtualization, Virtualization>>.
endif::[]
+
NOTE: If you do not intend to use the autoinstall profile to create virtual guest systems, you can leave the drop-down set to the default choice [guimenu]``KVM Virtualized Guest``.
+

. Finally, either provide the file contents with cut-and-paste or update the file from the local storage medium:
** Paste it into the [guimenu]``File Contents`` box and click [guimenu]``Create``, or
** enter the file name in the [guimenu]``File to Upload`` field and click btn:[Upload File].


Once done, four subtabs are available:

* [guimenu]``Details``
* [guimenu]``Bare Metal``
* [guimenu]``Variables``
* [guimenu]``Autoinstallable File``




[[ref.webui.systems.autoinst.bare_metal]]
== Autoinstallation >  Bare Metal


Lists the IP addresses that have been associated with the profiles created by your organization.
Click either the range or the profile name to access different tabs of the [guimenu]``Autoinstallation Details`` page.




[[ref.webui.systems.autoinst.keys]]
== Autoinstallation >  GPG and SSL Keys


Lists keys and certificates available for inclusion in {kickstart} profiles and provides a means to create new ones.
This is especially important for customers of {productname} or the Proxy Server because systems kickstarted by them must have the server key imported into {productname} and associated with the relevant {kickstart} profiles.
Import it by creating a new key here and then make the profile association in the [guimenu]``GPG and SSL keys`` subtab of the [guimenu]``Autoinstallation Details`` page.

To create a key or certificate, click the [guimenu]``Create Stored Key/Cert`` link in the upper-right corner of the page.
Enter a description, select the type, upload the file, and click the btn:[Update Key] button.
A unique description is required.

[IMPORTANT]
====
The GPG key you upload to {productname} must be in ASCII format.
Using a GPG key in binary format causes anaconda, and therefore the {kickstart} process, to fail.
====



[[ref.webui.systems.autoinst.distribution]]
== Autoinstallation >  Distributions


The [guimenu]``Distributions`` page enables you to find and create custom installation trees that may be used for automated installations.

[NOTE]
====
The [guimenu]``Distributions`` page does not display distributions already provided.
They can be found within the [guimenu]``Distribution`` drop-down menu of the [guimenu]``Autoinstallation Details`` page.

Before creating a distribution, you must make an installation data available, as described in the [ref]_SUSE Linux Enterprise Deployment Guide_ (https://www.suse.com/documentation/sles-12/singlehtml/book_sle_deployment/book_sle_deployment.html) or, respectively, the _Kickstart Installations_ chapter of the [ref]_Red Hat Enterprise Linux System Administration Guide_.
This tree must be located in a local directory on the {productname} server.
====

.Procedure: Creating a Distribution for Autoinstallation
. To create a distribution, on the [guimenu]``Autoinstallable Distributions`` page click [guimenu]``Create Distribution`` in the upper right corner.
. On the [guimenu]``Create Autoinstallable Distribution`` page, provide the following data:
+
** Enter a label (without spaces) in the [guimenu]``Distribution Label`` field, such as `my-orgs-sles-12-sp2` or ``my-orgs-rhel-as-7``.
** In the menu:Tree Path[] field, paste the path to the base of the installation tree.
** Select the matching distribution from the [guimenu]``Base Channel`` and [guimenu]``Installer Generation`` drop-down menus, such as `SUSE Linux` for {sle}, or `Red Hat Enterprise Linux 7` for {rhel} 7 client systems.
. When finished, click the btn:[Create Autoinstallable Distribution] button.





[[s4-sm-system-kick-dist-variables]]
=== Autoinstallation >  Distributions  >  Variables


Autoinstallation variables can be used to substitute values into Kickstart and {ay} profiles.
To define a variable, create a name-value pair ([replaceable]``name/value``) in the text box.

For example, if you want to autoinstall a system that joins the network of a specified organization (for example the Engineering department) you can create a profile variable to set the IP address and the gateway server address to a variable that any system using that profile will use.
Add the following line to the [guimenu]``Variables`` text box.

----
IPADDR=192.168.0.28
GATEWAY=192.168.0.1
----


To use the distribution variable, use the name of the variable in the profile to substitute the value.
For example, the [option]``network`` part of a {kickstart} file looks like the following:

----
network --bootproto=static --device=eth0 --onboot=on --ip=$IPADDR \
  --gateway=$GATEWAY
----


The [option]``$IPADDR`` will be resolved to ``192.168.0.28``, and the [option]``$GATEWAY`` to ``192.168.0.1``.

[NOTE]
====
There is a hierarchy when creating and using variables in Kickstart files.
System Kickstart variables take precedence over Profile variables, which in turn take precedence over Distribution variables.
Understanding this hierarchy can alleviate confusion when using variables in {kickstart}s.
====


In {ay} profiles you can use such variables as well.

Using variables are just one part of the larger Cobbler infrastructure for creating templates that can be shared between multiple profiles and systems.
For more information about Cobbler and templates, refer to
ifndef::env-github,backend-html5[]
<<advanced.topics.cobbler>>.
endif::[]
ifdef::env-github,backend-html5[]
<<advanced_topics_cobbler.adoc#advanced.topics.cobbler, Cobbler>>.
endif::[]




[[ref.webui.systems.autoinst.preserve]]
== Autoinstallation >  File Preservation


Collects lists of files to be protected and re-deployed on systems during {kickstart}.
For instance, if you have many custom configuration files located on a system to be kickstarted, enter them here as a list and associate that list with the Kickstart profile to be used.

To use this feature, click the [guimenu]``Create File Preservation List`` link at the top.
Enter a suitable label and all files and directories to be preserved.
Enter absolute paths to all files and directories.
Then click btn:[Create List].

[IMPORTANT]
====
Although file preservation is useful, it does have limitations.
Each list is limited to a total size of 1 MB.
Special devices like [path]``/dev/hda1`` and [path]``/dev/sda1`` are not supported.
Only file and directory names may be entered.
No regular expression wildcards can be used.
====


When finished, you may include the file preservation list in the Kickstart profile to be used on systems containing those files.
Refer to <<ref.webui.systems.autoinst.profiles.create>> for precise steps.





[[ref.webui.systems.autoinst.snippet]]
== Autoinstallation >  Autoinstallation Snippets


Use snippets to store common blocks of code that can be shared across multiple Kickstart or {ay} profiles in {productname}.

[[s4-sm-system-kick-snippet-default]]
=== Autoinstallation  >  Autoinstallation Snippets  >  Default Snippets


Default snippets coming with {productname} are not editable.
You can use a snippet, if you add the [guimenu]``Snippet Macro`` statement such as `$SNIPPET('spacewalk/sles_register_script')` to your autoinstallation profile.
This is an {ay} profile example:

----
<init-scripts config:type="list">
  $SNIPPET('spacewalk/sles_register_script')
</init-scripts>
----


When you create a snippet with the [guimenu]``Create Snippet`` link, all profiles including that snippet will be updated accordingly.




[[s4-sm-system-kick-snippet-custom]]
=== Autoinstallation >  Autoinstallation Snippets  >  Custom Snippets


This is the tab with custom snippets.
Click a name of a snippet to view, edit, or delete it.

[[s4-sm-system-kick-snippet-all]]
=== Autoinstallation >  Autoinstallation Snippets  >  All Snippets

q
The [guimenu]``All Snippets`` tab lists default and custom snippets together.

ifdef::backend-docbook[]
[index]
== Index
// Generated automatically by the DocBook toolchain.
endif::backend-docbook[]
