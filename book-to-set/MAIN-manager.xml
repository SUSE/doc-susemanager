<?xml version="1.0" encoding="UTF-8"?>
<?asciidoc-toc?>
<?asciidoc-numbered?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xl="http://www.w3.org/1999/xlink" version="5.0" xml:lang="en">
<info>
<title>SUSE Manager Documentation</title>
<date>2019-11-04</date>
</info>
<part xml:id="book.suma.getting-started">
<title>Getting Started</title>
<chapter xml:id="quickstart.chapt.overview.requirements">
<title>Introduction</title>
<simpara>This Getting Started Guide provides guidance on setting up SUSE Manager server with KVM.
You will learn the fundamentals of managing both traditional and Salt clients.</simpara>
<simpara>This guide is intended for system administrators.</simpara>
<note>
<title>SUSE Manager Version Information</title>
<simpara>In this manual if not other specified, SUSE Manager version 3.2 is assumed and this version is required if a feature is discussed.
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy were originally released as a SLES 12 SP3 extension.
With the next maintenance update (December 2018),
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy will be based on SLES 12 SP4 and support SLE 12 SP4 clients officially.
In the following sections and chapters, it is highly recommended to use SLE 12 SP4 instead of SP3.
Whenever features of the SUSE Manager 3.2 host operating system are documented and not other specified version 12 SP4 is assumed.</simpara>
</note>
<section xml:id="quickstart.sect.introduction">
<title>Introduction to SUSE Manager</title>
<simpara>SUSE Manager is a solution for organizations that require absolute control over maintenance and package deployment on their servers.
It lets you manage large sets of Linux systems and keep them up to date, with automated software management, asset management, and system provisioning.
SUSE Manager allows you to maintain a high level of security while effectively managing system life-cycle requirements.</simpara>
<simpara>SUSE Manager uses <emphasis>Salt</emphasis> to provide event-driven configuration and management control.
The Salt-master orchestrates thousands of Salt-minions (SUSE Manager Clients) using remote execution.</simpara>
<simpara>SUSE Manager is fully compatible with Red Hat Satellite Server and offers seamless management of both SUSE Linux Enterprise and Red Hat Enterprise Linux client systems.</simpara>
<simpara>SUSE Manager can be integrated with your network infrastructure in multiple ways.
This book will guide you through an initial proof-of-concept setup, using these steps:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Install an operating system (either JeOS or SLES) for use with SUSE Manager</simpara>
</listitem>
<listitem>
<simpara>Install SUSE Manager Server</simpara>
</listitem>
<listitem>
<simpara>Register SUSE Manager with SUSE Customer Center</simpara>
</listitem>
<listitem>
<simpara>Perform initial setup of your SUSE Manager Server</simpara>
</listitem>
<listitem>
<simpara>Register a traditional client</simpara>
</listitem>
<listitem>
<simpara>Register a Salt minion</simpara>
</listitem>
</orderedlist>
<simpara>The book also contains a section about getting started with Salt.</simpara>
</section>
<section xml:id="quickstart.sect.prereq">
<title>Prerequisites for Installation</title>
<simpara>Before you begin your installation, ensure you have fulfilled these prerequisites:</simpara>
<itemizedlist>
<listitem>
<simpara>Current SUSE Customer Center organization credentials</simpara>
</listitem>
<listitem>
<simpara>Access to installation media for your chosen operating system</simpara>
</listitem>
<listitem>
<simpara>Your environment meets the hardware and networking requirements</simpara>
</listitem>
<listitem>
<simpara>You understand the supported client operating systems</simpara>
</listitem>
</itemizedlist>
<simpara>This section contains more information on each of these prerequisites.</simpara>
<note>
<simpara>SUSE Manager 3.2 is based on SLES 12 SP4 as the host operating system.</simpara>
</note>
<section xml:id="quickstart.sect.prereq.scc">
<title>Obtaining your SUSE Customer Center Credentials</title>
<simpara>You will need to create an account with SUSE Customer Center before you install SUSE Linux Enterprise Server and SUSE Manager.
To obtain your SUSE Customer Center credentials:</simpara>
<orderedlist xml:id="creating.scc.account.mgr" numeration="arabic">
<title>Procedure: Obtaining Your SCC Organization Credentials</title>
<listitem>
<simpara>Open a browser and direct it to <link xl:href="https://scc.suse.com/login">https://scc.suse.com/login</link>.</simpara>
</listitem>
<listitem>
<simpara>If you have not done so, create an account now.</simpara>
</listitem>
<listitem>
<simpara>Log in to your new SCC account.</simpara>
</listitem>
<listitem>
<simpara>Under the <guibutton>Management tools</guibutton> widget select <guibutton>Manage Users</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Organization Credentials</guibutton> tab.</simpara>
</listitem>
<listitem>
<simpara>Record your login information for use during SUSE Manager setup.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="quickstart.sect.prereq.installmedia">
<title>Obtaining Installation Media</title>
<simpara>This book describes installation methods for both JeOS and SUSE Linux Enterprise Server.
The JeOS image provides the quickest installation and setup, and is suitable for a test or proof of concept installation.
Alternatively, SUSE Linux Enterprise Server provides a more robust installation, which requires a larger initial download.
Choose your preferred operating system based on the type of environment you want to install, and the amount of bandwidth and time you have available.</simpara>
<simpara>You can find installation images for JeOS and SLES in your SUSE Customer Center account.
Log in, then navigate to the URL for your chosen operating system:</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://www.suse.com/products/server/jeos/">JeOS - Media Download</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://www.suse.com/products/server/download/">SUSE Linux Enterprise Server - Media Download</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="quickstart.sect.prereq.hardware">
<title>Hardware Requirements</title>
<simpara>This table outlines hardware and software requirements on x86_64 and IBM Power PC architecture.
For installation on z Systems, see:</simpara>
<itemizedlist>
<listitem>
<simpara><xref linkend="art.suma.install.zsystems"/></simpara>
</listitem>
</itemizedlist>
<table frame="all" rowsep="1" colsep="1">
<title>Hardware Requirements for x86_64 Architecture</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Recommended</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>CPU</simpara></entry>
<entry align="left" valign="top"><simpara>Multi-core 64-bit CPU</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>RAM:</simpara></entry>
<entry align="left" valign="top"><simpara><emphasis>Test Server</emphasis> Minimum 8&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><emphasis>Base Installation</emphasis> Minimum 16&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><emphasis>Production Server</emphasis> Minimum 32&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Disk Space:</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/</literal> <emphasis>(root) The default JeOS root partition size of 24 GB is sufficient for this guide</emphasis></simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/lib/pgsql</literal> Minimum 50&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/spacewalk</literal> Minimum 50&#160;GB per SUSE product and 250&#160;GB per Red Hat product</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>Hardware Requirements for IBM POWER8 or POWER9 Architecture</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Recommended</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>CPU</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 4 dedicated cores</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>RAM:</simpara></entry>
<entry align="left" valign="top"><simpara><emphasis>Test Server</emphasis> Minimum 8&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><emphasis>Base Installation</emphasis> Minimum 16&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><emphasis>Production Server</emphasis> Minimum 32&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Disk Space:</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/</literal> Minimum 100&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/lib/pgsql</literal> Minimum 50&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/spacewalk</literal> Minimum 50&#160;GB per SUSE product and 250&#160;GB per Red Hat product</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="quickstart.sect.prereq.network">
<title>Network Requirements</title>
<simpara>This section details the networking and port requirements for SUSE Manager.</simpara>
<variablelist>
<varlistentry>
<term>Fully Qualified Domain Name (FQDN)</term>
<listitem>
<simpara>The SUSE Manager server must resolve its FQDN correctly or cookies will not work properly on the WebUI.
For more information about configuring the hostname and DNS, see <link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_basicnet_yast.html#sec_basicnet_yast_change_host">SUSE Linux Enterprise Server Documentation - Configuring Host Name and DNS</link></simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Hostname and IP Address</term>
<listitem>
<simpara>To ensure that the SUSE Manager domain name can be resolved by its clients, both server and client machines must be connected to a working DNS server.
For more information about setting up a DNS server, see <link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_dns.html">SUSE Linux Enterprise Server Documentation - The Domain Name System</link></simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Using a Proxy When Installing from SUSE Linux Enterprise Media</term>
<listitem>
<simpara>If you are on an internal network and do not have access to SUSE Customer Center, you can set up and use a proxy during installation.
For more information about configuring a proxy for access to SUSE Customer Center during a SUSE Linux Enterprise installation, see <link xl:href="https://www.suse.com/documentation/sled-12/singlehtml/book_sle_deployment/book_sle_deployment.html#sec.i.yast2.start.parameters.proxy">SUSE Linux Enterprise Server Documentation -  Using a Proxy During Installation</link></simpara>
</listitem>
</varlistentry>
</variablelist>
<important>
<title>Naming Your Server</title>
<simpara>The hostname of SUSE Manager must not contain uppercase letters as this may cause <emphasis>jabberd</emphasis> to fail.
Choose the hostname of your SUSE Manager server carefully.
Although changing the server name is possible, it is a complex process and unsupported.</simpara>
</important>
<simpara>In a production environment, SUSE Manager server and its clients should always use a firewall.
This table gives an overview of required ports, to be used when you are setting up your firewall rules.</simpara>
<table xml:id="tab.install.ports.server1" frame="all" rowsep="1" colsep="1">
<title>Required Server Ports</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Port</entry>
<entry align="left" valign="top">Protocol</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>22</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>SSH</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>67</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>DHCP</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>69</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>TFTP, used to support PXE services</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>80</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>HTTP, used in some bootstrap cases</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>123</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>NTP time service</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>443</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>HTTPS, used for Web UI, client, Proxy server, and API traffic</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>4505</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>Salt, used by the Salt-master to accept communication requests from minions</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>4506</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>Salt, used by the Salt-master to accept communication requests from minions</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>5222</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>XMPP client, used for communications with the <literal role="systemitem">osad</literal> daemon on traditional client systems</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>5269</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>XMPP server, used for pushing actions to SUSE Manager Proxy</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>For more information on disconnected setup and port configuration, see:</simpara>
<itemizedlist>
<listitem>
<simpara><xref linkend="disconnect-setup"/></simpara>
</listitem>
<listitem>
<simpara><xref linkend="advanced.topics.app.ports.server"/></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="quickstart.sect.prereq.clientos">
<title>Supported Client Systems</title>
<simpara>Supported operating systems for traditional and Salt clients are listed in this table.</simpara>
<table xml:id="mgr.supported.clients" frame="all" rowsep="1" colsep="1">
<title>Supported Client Systems</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="25*"/>
<colspec colname="col_2" colwidth="25*"/>
<colspec colname="col_3" colwidth="25*"/>
<colspec colname="col_4" colwidth="25*"/>
<thead>
<row>
<entry align="left" valign="top">Operating Systems</entry>
<entry align="left" valign="top">Architecture</entry>
<entry align="left" valign="top">Traditional Clients</entry>
<entry align="left" valign="top">Salt Clients</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>SUSE Linux Enterprise 11 SP4</simpara></entry>
<entry align="left" valign="top"><simpara>x86, x86_64, Itanium, IBM POWER, z Systems</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SUSE Linux Enterprise 12 SP3, 12 SP4</simpara></entry>
<entry align="left" valign="top"><simpara>x86_64, IBM POWER (IBM Power PC), z Systems, ARM</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SUSE Linux Enterprise 15</simpara></entry>
<entry align="left" valign="top"><simpara>x86_64, IBM POWER (IBM Power PC), z Systems, ARM</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis>Latest minor release Red Hat Enterprise Linux Server 6</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>x86, x86_64</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis>Latest minor release Red Hat Enterprise Linux Server 7</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>x86_64</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Open Enterprise Server 2015, 2015 SP1, 2018</simpara></entry>
<entry align="left" valign="top"><simpara>x86_64</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<note>
<title>Supported Versions and SP Levels</title>
<simpara>Client operating system versions and SP levels must be under general support (normal or LTSS) to be supported with SUSE Manager.
For details on supported product versions, see <link xl:href="https://www.suse.com/lifecycle">https://www.suse.com/lifecycle</link>.</simpara>
</note>
</section>
</section>
</chapter>
<chapter xml:id="sles.installation.within.kvm.jeos">
<title>JeOS Installation</title>
<section xml:id="quickstart.sect.kvm.settings">
<title>Virtual Machine Manager (virt-manager) Settings</title>
<simpara>This chapter provides the required (KVM) settings for installation of SUSE Linux Enterprise Just Enough Operating System (JeOS) 12 as the base for SUSE Manager.
A kernel virtual machine (KVM) combined with Virtual Machine Manager (<emphasis>virt-manager</emphasis>) will be used as a sandbox for your first installation.</simpara>
<tip>
<title>SUSEVirtualization Guide</title>
<simpara>For more information on virtualization, see: <link xl:href="https://www.suse.com/documentation/sles-12/singlehtml/book_virt/book_virt.html">SUSE Linux Enterprise Virtualization Guide</link></simpara>
</tip>
<simpara>Enter the following settings when creating a new virtual machine using <emphasis role="strong">virt-manager</emphasis>.
In the following table replace <emphasis>version</emphasis> with the actual product version string.</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top" namest="col_1" nameend="col_2">KVM Settings</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Installation Method</simpara></entry>
<entry align="left" valign="top"><simpara>Import Existing Disk Image</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>OS:</simpara></entry>
<entry align="left" valign="top"><simpara>Linux</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Version:</simpara></entry>
<entry align="left" valign="top"><simpara>SLES&lt;VERSION&gt;-JeOS-for-kvm-and-xen.x86_64-GM.qcow2</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Memory:</simpara></entry>
<entry align="left" valign="top"><simpara>4096 MB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>CPU&#8217;s:</simpara></entry>
<entry align="left" valign="top"><simpara>2</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Storage Format:</simpara></entry>
<entry align="left" valign="top"><simpara><emphasis>.qcow2</emphasis> 24 GB (Default) JeOS Root Partition</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Virtual Disks:</simpara></entry>
<entry align="left" valign="top"></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 2</simpara></entry>
<entry align="left" valign="top"><simpara>101 GB for <literal role="path">/var/spacewalk</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 3</simpara></entry>
<entry align="left" valign="top"><simpara>50 GB for <literal role="path">/var/lib/pgsql</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 4</simpara></entry>
<entry align="left" valign="top"><simpara>4 GB for swap</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Name:</simpara></entry>
<entry align="left" valign="top"><simpara>test-setup</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Network</simpara></entry>
<entry align="left" valign="top"><simpara>Bridge <emphasis>br0</emphasis></simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<tip>
<title>SUSE Virtualization Guide</title>
<simpara>For more information on virtualization, see: <link xl:href="https://www.suse.com/documentation/sles-12/singlehtml/book_virt/book_virt.html">SUSE Linux Enterprise Virtualization Guide</link></simpara>
</tip>
</section>
<section xml:id="jeos.kvm.settings">
<title>JeOS KVM Settings</title>
<simpara>Create three additional virtual disks required for the SUSE Manager storage partitions.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Creating the Required Partitions with KVM</title>
<listitem>
<simpara>Create a new virtual machine using the downloaded JeOS KVM image and select <guimenu>Import existing disk image</guimenu> .</simpara>
</listitem>
<listitem>
<simpara>Configure RAM and number of CPUs (At least 4 GB RAM and 2 CPUs).</simpara>
</listitem>
<listitem>
<simpara>Name your KVM machine and select the <guimenu>Customize configuration before install</guimenu> check box.</simpara>
</listitem>
<listitem>
<simpara>Select the <guibutton>Add Hardware</guibutton> button and create three new virtual disks with the following specifications.
These disks will be partitioned and mounted in <xref linkend="proc.jeos.susemgr.prep"/>.</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">VirtIO Storage Disks</entry>
<entry align="left" valign="top">Name</entry>
<entry align="left" valign="top">Sizing</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 2</simpara></entry>
<entry align="left" valign="top"><simpara>spacewalk</simpara></entry>
<entry align="left" valign="top"><simpara>101&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 3</simpara></entry>
<entry align="left" valign="top"><simpara>pgsql</simpara></entry>
<entry align="left" valign="top"><simpara>50&#160;GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 4</simpara></entry>
<entry align="left" valign="top"><simpara>swap</simpara></entry>
<entry align="left" valign="top"><simpara>4&#160;GB</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</listitem>
<listitem>
<simpara>Click <guimenu>Begin Installation</guimenu> and your new VM will boot from the JeOS image.</simpara>
</listitem>
</orderedlist>
<simpara>Proceed through the basic JeOS installation prompts until you reach the command line.</simpara>
<tip>
<title>Root Password</title>
<simpara>During the basic installation prompts you are asked to enter the root password.
Select a strong password and then in the next message box <guibutton>Confirm root Password</guibutton>.</simpara>
</tip>
</section>
<section xml:id="jeos.susemgr.prep">
<title>Preparing JeOS for SUSE Manager</title>
<orderedlist xml:id="proc.jeos.susemgr.prep" numeration="arabic">
<title>Procedure: Preparing JeOS for SUSE Manager Installation</title>
<listitem>
<simpara>Register with SCC:</simpara>
<screen>SUSEConnect -e`EMAIL_ADDRESS`-r`SUSE_MANAGER_CODE`</screen>
</listitem>
<listitem>
<simpara>Add SUSE Manager repositories:</simpara>
<screen>SUSEConnect -p SUSE-Manager-Server/&lt;productnumber&gt;/x86_64 -r`SUSE_MANAGER_CODE`</screen>
</listitem>
<listitem>
<simpara>Install <phrase role="package">yast2-storage</phrase> with all required dependencies (approx. 40 packages, 30 MB when installed).
This basic administration package is required for preparing storage partitions:</simpara>
<screen>zypper in -t package yast2-storage</screen>
</listitem>
<listitem>
<simpara>Partition and mount the virtual disks at the following locations using YaST Partitioner (<literal role="command">yast2 disk</literal>).</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="4">
<colspec colname="col_1" colwidth="25*"/>
<colspec colname="col_2" colwidth="25*"/>
<colspec colname="col_3" colwidth="25*"/>
<colspec colname="col_4" colwidth="25*"/>
<thead>
<row>
<entry align="left" valign="top">VirtIO Storage Disks</entry>
<entry align="left" valign="top">Name</entry>
<entry align="left" valign="top">Storage Size</entry>
<entry align="left" valign="top">File System Type</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 2</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/spacewalk</literal></simpara></entry>
<entry align="left" valign="top"><simpara>101&#160;GB</simpara></entry>
<entry align="left" valign="top"><simpara>XFS</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 3</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/lib/pgsql</literal></simpara></entry>
<entry align="left" valign="top"><simpara>50&#160;GB</simpara></entry>
<entry align="left" valign="top"><simpara>XFS</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>VirtIO Disk 4</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">swap</literal></simpara></entry>
<entry align="left" valign="top"><simpara>4&#160;GB</simpara></entry>
<entry align="left" valign="top"><simpara>swap</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</listitem>
<listitem>
<simpara>SLES by default uses the BTRFS file system.
A mount point is created automatically for <literal role="path">/var/lib/pgsql/</literal> (even when not installed).
This must be removed or commented out from the <literal role="path">/etc/fstab</literal> entries.
As root, edit <literal role="path">/etc/fstab</literal> and comment out or remove the line:</simpara>
<screen>/var/lib/pgsql btrfs subvol=@/var/lib/pgsql 0 0</screen>
<warning>
<title>Remove <literal role="command">pgsql</literal> from the fstab Configuration File</title>
<simpara>If you do not remove this line from fstab the first time you shut down the server you will lose your database.
This occurs because you will have duplicate entries in the fstab file. <emphasis>Updated tools shipped with recent SPs will no longer require human intervention.</emphasis></simpara>
</warning>
</listitem>
<listitem>
<simpara>Exit the partitioner and install the SUSE Manager pattern:</simpara>
<screen>zypper in -t pattern suma_server</screen>
</listitem>
</orderedlist>
<simpara>For proceeding with SUSE Manager setup, see <link xl:href="quickstart3_chap_sumasetup_with_yast.xml#suma.setup.with.yast">SUSE Manager Setup</link>.</simpara>
</section>
</chapter>
<chapter xml:id="quickstart3.chap.suma.installation.sles">
<title>SUSE Linux Enterprise Server Installation</title>
<simpara>This chapter provides the required KVM settings for installation of SUSE Linux Enterprise Server media as the base for SUSE Manager.
A kernel virtual machine KVM combined with Virtual Machine Manager (<literal role="command">virt-manager</literal>) will be used as a sandbox for this installation.</simpara>
<section xml:id="_sles_kvm_requirements">
<title>SLES KVM Requirements</title>
<simpara>Enter the following settings when creating a new virtual machine using <literal role="command">virt-manager</literal> (replace <literal role="replaceable">version</literal> with the actual version string):</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">KVM Settings for SLES</entry>
<entry align="left" valign="top">Installation Method:</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Local install media (ISO image or CDROM)</simpara></entry>
<entry align="left" valign="top"><simpara>OS:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Linux</simpara></entry>
<entry align="left" valign="top"><simpara>Version:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>SLE-[replaceable]</literal>version<literal>-Server-x86_64-GM-DVD1.iso</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Memory:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>4096&#160;MB</simpara></entry>
<entry align="left" valign="top"><simpara>CPUs:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>2</simpara></entry>
<entry align="left" valign="top"><simpara>Storage Format:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>ISO 3&#160;GB</simpara></entry>
<entry align="left" valign="top"><simpara>Disk Space:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>234&#160;GB split between 4&#160;GB swap and 130&#160;GB mounted at <literal role="path">/var/spacewalk/</literal></simpara></entry>
<entry align="left" valign="top"></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>(Virtual Disk 1) and 50&#160;GB mounted at <literal role="path">/var/lib/pgsql</literal></simpara></entry>
<entry align="left" valign="top"></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>(Virtual Disk 2).  The rest for the root partition (100&#160;GB+).</simpara></entry>
<entry align="left" valign="top"><simpara>Name:</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>example-server</simpara></entry>
<entry align="left" valign="top"><simpara>Network</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<section xml:id="sles.installation.within.kvm.media">
<title>SLES KVM Settings</title>
<simpara>This section provides guidance on installation of SUSE Manager
utilizing the full installation media with KVM and <literal role="command">virt-manager</literal>.
This section assumes you have previously setup an account with SCC and downloaded the SLES full installation media.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Preparing for SLES Installation</title>
<listitem>
<simpara>In <literal role="command">virt-manager</literal> select <menuchoice><guimenu>File</guimenu> <guimenuitem>New Virtual Machine</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Select <guibutton>Local install media (ISO image or CDROM)</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Ensure <guibutton>Use ISO Image</guibutton> is selected then click <guibutton>Browse</guibutton> and locate the full SLES image you downloaded from your SCC account.</simpara>
</listitem>
<listitem>
<simpara>Configure your machine with at least 4096 MB RAM and a minimum of 2 CPUs.</simpara>
</listitem>
<listitem>
<simpara>Create a storage device with a minimum of 234 GB storage space for the installation.
During the partitioning setup of the SLES installation this disk should be partitioned into the following disks:</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="1">
<colspec colname="col_1" colwidth="100*"/>
<thead>
<row>
<entry align="left" valign="top">Disk Space Requirements</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>4&#160;GB Swap space</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>130&#160;GB XFS partition (or dedicated virtual disk) for <literal role="path">/var/spacewalk/</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>50&#160;GB XFS partition (or dedicated virtual disk) for <literal role="path">/var/lib/pgsql/</literal></simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</listitem>
<listitem>
<simpara>The remaining storage space will be used by the operating system for the root partition.
Select <guibutton>Finish</guibutton> to begin the installation.</simpara>
</listitem>
</orderedlist>
<simpara>Installation of SUSE Linux Enterprise Server will begin.
For more information on completing an installation of SUSE Linux Enterprise Server, see: <link xl:href="https://www.suse.com/documentation/sles-12/book_quickstarts/data/sec_sle_installquick.html">SUSE Linux Enterprise Installation Quickstart</link>.</simpara>
</section>
</section>
<section xml:id="quickstart3.sec.suma.installation.sles.sumaext">
<title>Selecting the SUSE Manager Extension</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>During the SUSE Linux Enterprise Server installation you will be presented with the <guibutton>Extension and Module Selection</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Select the SUSE Manager Extension and then click the <guibutton>Next</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>Complete the SUSE Linux Enterprise Server installation.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="manager-extension.png" width="80%"/>
</imageobject>
<textobject><phrase>manager extension</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</chapter>
<chapter xml:id="suma.setup.with.yast">
<title>SUSE Manager Setup</title>
<section xml:id="suma.setup.with.yast.setup">
<title>Topics</title>
<simpara>This section covers SUSE Manager setup.
You will perform the following procedures:</simpara>
<itemizedlist>
<listitem>
<simpara>Start SUSE Manager setup via YaST or command line</simpara>
</listitem>
<listitem>
<simpara>Create the main administration account with the SUSE Manager Web UI</simpara>
</listitem>
<listitem>
<simpara>Name your base organization and add login credentials</simpara>
</listitem>
<listitem>
<simpara>Sync the SUSE Linux Enterprise product channel from SUSE Customer Center</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="suma-setup-with-yast-sumasetup">
<title>SUSE Manager Setup</title>
<warning>
<title>Third Party Software</title>
<simpara>SUSE Manager is an extension of SUSE Linux Enterprise Server and compatible with the software shipped with SUSE Linux Enterprise Server.</simpara>
<simpara>SUSE Manager is a complex system, and therefore installing third party is not allowed. Installing monitoring software provided by a third party vendor is allowed only if you do not exchange basic libraries such as SSL, cryptographic software, and similar tools.
In case of emergency, SUSE reserves the right to ask to remove any third party software (and associated configuration changes) and then to reproduce the problem on a clean system.</simpara>
</warning>
<simpara>This section will guide you through SUSE Manager setup procedures.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: SUSE Manager Setup</title>
<listitem>
<simpara>Login to the SUSE Manager server desktop and perform one of the following actions to begin setup:</simpara>
<itemizedlist>
<listitem>
<simpara>Select <menuchoice><guimenu>Applications</guimenu> <guisubmenu>System Tools</guisubmenu> <guisubmenu>YaST</guisubmenu> <guimenuitem>SUSE Manager Setup</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Open a terminal as root and type <literal role="command">yast2 susemanager_setup</literal> to begin setup.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>From the introduction screen select <menuchoice><guimenu>SUSE Manager Setup</guimenu> <guimenuitem>Setup SUSE Manager from scratch</guimenuitem></menuchoice>. Then click <guibutton>Next</guibutton> to continue.</simpara>
</listitem>
<listitem>
<simpara>Enter the email address that should receive status notifications about SUSE Manager.
The number of emails sent from SUSE Manager can be extensive, therefore notifications via email may be disabled from the Web UI after setup. Then click <guibutton>Next</guibutton> to continue.</simpara>
</listitem>
<listitem>
<simpara>Enter your certificate information and a password. The password should be stored in a secure location.</simpara>
<important>
<title>Certificate Password</title>
<simpara><emphasis>Without this password it will not be possible to set up a SUSE Manager Proxy Server.</emphasis></simpara>
</important>
</listitem>
<listitem>
<simpara>Click <guibutton>Next</guibutton> to continue.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="quickstart-mgr-setup4.png" width="80%"/>
</imageobject>
<textobject><phrase>quickstart mgr setup4</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>SUSE Manager Setup</guimenu> <guimenuitem>Database Settings</guimenuitem></menuchoice> screen, enter a database user and password.
This password should be stored in a secure location.
Then click <guibutton>Next</guibutton> to continue.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="quickstart-mgr-setup5.png" width="80%"/>
</imageobject>
<textobject><phrase>quickstart mgr setup5</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Enter your SUSE Customer Center <literal role="systemitem">Organization Credentials</literal>.
Open <link xl:href="https://scc.suse.com/login">https://scc.suse.com/login</link> to register or access to your organization credentials.</simpara>
<note>
<title><guibutton>Skip</guibutton></title>
<simpara>If you are using SUSE Enterprise products, SUSE Manager requires that you connect to SUSE Customer Center for software, updates and patches.
You will not be able to synchronize or provide Enterprise channels to your clients without this information.</simpara>
<simpara>However if you would like to work with open source software channels and repositories then click the <guibutton>Skip</guibutton> button to continue.
You can setup your SUSE Customer Center credentials or configure inter-server sync at a later time.</simpara>
</note>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="quickstart-mgr-setup9.png" width="80%"/>
</imageobject>
<textobject><phrase>quickstart mgr setup9</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Click <guibutton>Next</guibutton> to continue.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Yes</guibutton> to run setup when prompted.</simpara>
</listitem>
<listitem>
<simpara>Once setup has completed, click <guibutton>Next</guibutton> to continue.
You will see the address of the SUSE Manager Web UI.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Finish</guibutton> to complete SUSE Manager setup.</simpara>
</listitem>
</orderedlist>
<simpara>In the next section you will create the administrator&#8217;s account and synchronize with SUSE Customer Center.</simpara>
<section xml:id="suma.setup.with.yast.admin">
<title>Creating the Main Administration Account</title>
<simpara>This section will walk you through creating your organizations main administration account for SUSE Manager.</simpara>
<warning>
<title>Admin and User Accounts</title>
<simpara>The main administration account is the <emphasis>highest authority account</emphasis> within SUSE Manager and therefore account access information should be stored in a secure location.</simpara>
<simpara>For security it is recommended that the main administrator creates <emphasis>low level admin accounts</emphasis> designated for administration of organizations and individual groups.</simpara>
</warning>
<orderedlist xml:id="suma.setup.admin.account" numeration="arabic">
<title>Procedure: Setup the Main Administration Account</title>
<listitem>
<simpara>In the browser, enter the address provided after completing setup and open the SUSE Manager Web UI.</simpara>
</listitem>
<listitem>
<simpara>Add your organization name to the <menuchoice><guimenu>Create Organization</guimenu> <guimenuitem>Organization Name</guimenuitem></menuchoice> field.</simpara>
</listitem>
<listitem>
<simpara>Add your username and password to the <menuchoice><guimenu>Create Organization</guimenu> <guimenuitem>Desired Login</guimenuitem></menuchoice> and <menuchoice><guimenu>Create Organization</guimenu> <guimenuitem>Desired Password</guimenuitem></menuchoice> fields.</simpara>
</listitem>
<listitem>
<simpara>Fill in the Account Information fields including an email for system notifications.</simpara>
</listitem>
<listitem>
<simpara>Select <guimenu>Create Organization</guimenu> to finish creating your administration account.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="quickstart-mgr-setup-admin1.png" width="80%"/>
</imageobject>
<textobject><phrase>quickstart mgr setup admin1</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</orderedlist>
<simpara>You should now be presented with the SUSE Manager Front Page. In the next section you will prepare the server for connecting the first client.</simpara>
</section>
<section xml:id="quickstart.first.channel.sync">
<title>Syncing Products from SUSE Customer Center</title>
<simpara>SUSE Customer Center (SCC) maintains a collection of repositories which contain packages, software and updates for all supported enterprise client systems.
These repositories are organized into channels each of which provide software specific to a distribution, release and architecture.
After synchronizing with SCC clients may receive updates, and be organized into groups and assigned to specific product software channels.</simpara>
<simpara>This section covers synchronizing with SCC from the Web UI and adding your first client channel.</simpara>
<orderedlist xml:id="proc-quickstart-first-channel-sync" numeration="arabic">
<title>Procedure: Synchronizing with SUSE Customer Center</title>
<listitem>
<simpara>From the SUSE Manager Web UI start page select <menuchoice><guimenu>Admin</guimenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice> page select the <guibutton>SUSE Products</guibutton> tab.
Wait a moment for the products list to populate.
If you previously registered with SUSE Customer Center a list of products will populate the table.
This table lists architecture, channels, and status information.
For more information, see:
<xref linkend="vle.webui.admin.wizard.products"/></simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_suse_products.png" width="80%"/>
</imageobject>
<textobject><phrase>admin suse products</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Since Your SUSE Linux Enterprise client is based on <literal role="systemitem">x86_64</literal> architecture scroll down the page and select the check box for this channel now.</simpara>
<itemizedlist>
<listitem>
<simpara>Add channels to SUSE Manager by selecting the check box to the left of each channel.
Click the arrow symbol to the left of the description to unfold a product and list available modules.</simpara>
</listitem>
<listitem>
<simpara>Start product synchronization by clicking the <guibutton>Add Products</guibutton> button.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>After adding the channel SUSE Manager will schedule the channel to be copied.
This can take a long time as SUSE Manager will copy channel software sources from the SUSE repositories located at SUSE Customer Center to local <literal role="path">/var/spacewalk/</literal> directory of your server.</simpara>
<tip>
<title>PostgreSQL and Transparant Huge Pages</title>
<simpara>In some environments, <emphasis>Transparent Huge Pages</emphasis> provided by the kernel may slow down PostgreSQL workloads significantly.</simpara>
<simpara>To disable <emphasis>Transparant Huge Pages</emphasis> set the <literal role="option">transparent_hugepage</literal> kernel parameter to <literal role="option">never</literal>.
This has to be changed in <literal role="path">/etc/default/grub</literal> and added to the line <literal role="option">GRUB_CMDLINE_LINUX_DEFAULT</literal>, for example:</simpara>
<screen>GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts elevator=noop transparent_hugepage=never"</screen>
<simpara>To write the new configuration run <literal role="command">grub2-mkconfig -o /boot/grub2/grub.cfg</literal>.
To update the grub2 during boot run <literal role="command">grub2-install /dev/sda</literal>.</simpara>
</tip>
<simpara>Monitor channel synchronization process in real-time by viewing channel log files located in the directory <literal role="path">/var/log/rhn/reposync</literal>:</simpara>
<screen>tailf /var/log/rhn/reposync/&lt;CHANNEL_NAME&gt;.log</screen>
<simpara>After the channel sync process has completed proceed to:
 <xref linkend="preparing.and.registering.clients"/></simpara>
</section>
</section>
</chapter>
<chapter xml:id="preparing.and.registering.clients">
<title>Registering Clients</title>
<section xml:id="_introduction">
<title>Introduction</title>
<simpara>For SUSE Manager&#160;3 and later, you can choose to use either traditional or Salt client management framework, or a mixture of both, depending on your environment and requirements.</simpara>
<variablelist>
<varlistentry>
<term>Salt</term>
<listitem>
<simpara>Is an end-to-end data-center automation tool which may also be used outside the scope of SUSE Manager to introduce reactive, real-time orchestration, and configuration management.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="create.act.keys">
<title>Creating Activation Keys</title>
<simpara>Activation keys are used with both traditional and Salt clients to ensure that your clients have the correct software entitlements, are connecting to the appropriate channels, and are subscribed to the relevant groups.
Each activation key is bound to an organization, which you can set when you create the key.</simpara>
<simpara>This section contains information on how to create activation keys for both traditional and Salt clients, and provides some best practices for working with activation keys.</simpara>
<orderedlist xml:id="create.activation.keys" numeration="arabic">
<title>Procedure: Creating Activation Keys</title>
<listitem>
<simpara>As the administrator login to the SUSE Manager Web UI.</simpara>
</listitem>
<listitem>
<simpara>Navigate to <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>To open the <literal role="guimenu">Activation Key Details</literal> page click the <guibutton>Create Key</guibutton> button in the upper right corner.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_create_activation_key.png" width="80%"/>
</imageobject>
<textobject><phrase>systems create activation key</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>On the <literal role="guimenu">Activation Key Details</literal> page in the <literal role="guimenu">Description</literal> field, enter a name for the activation key.</simpara>
</listitem>
<listitem>
<simpara>In the <literal role="guimenu">Key</literal> field, enter the distribution and service pack associated with the key. For example, <literal>SLES12-SP4</literal> for SUSE Linux Enterprise Server&#160;12&#160;SP4.</simpara>
<warning>
<title>Allowed Characters</title>
<simpara>Do not use commas in the <literal role="guimenu">Key</literal> field for any SUSE products.
However, you <emphasis role="strong">must</emphasis> use commas for Red Hat Products.
For more information, see <xref linkend="ref.webui.systems.activ-keys"/>.</simpara>
</warning>
</listitem>
<listitem>
<simpara>In the <literal role="guimenu">Base Channels</literal> drop-down box, select the SUSE Linux Enterprise channel that you added during
<link xl:href="proc-quickstart-first-channel-sync.xml#proc-quickstart-first-channel-sync">First Channel Sync</link>.</simpara>
</listitem>
<listitem>
<simpara>When the base channel is selected the list of available child channels will get fetched and displayed in real time below the base channel.
Select the child channels you need (for example, the SUSE Manager tools and the updates channels that are actually mandatory).</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_create_activation_key_childchannels.png" width="80%"/>
</imageobject>
<textobject><phrase>systems create activation key childchannels</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>We recommend you leave the <literal role="guimenu">Contact Method</literal> set to <literal role="guimenu">Default</literal>.</simpara>
</listitem>
<listitem>
<simpara>We recommend you leave the <literal role="guimenu">Universal Default</literal> setting unchecked.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Update Activation Key</guibutton> to create the activation key.</simpara>
</listitem>
<listitem>
<simpara>Check the <literal role="guimenu">Configuration File Deployment</literal> check box to enable configuration management for this key, and click <guibutton>Update Activation Key</guibutton> to save this change.</simpara>
</listitem>
</orderedlist>
<simpara>When you create activation keys, keep these best practices in mind:</simpara>
<itemizedlist>
<listitem>
<simpara>Avoid using the <literal role="systemitem">SUSE Manager Default</literal> parent channel.
This setting forces SUSE Manager to choose a parent channel that best corresponds to the installed operating system, which can sometimes lead to unexpected behavior.
Instead, we recommend you create activation keys specific to each distribution and architecture.</simpara>
</listitem>
<listitem>
<simpara>If you are using bootstrap scripts, consider creating an activation key for each script.
This will help you align channel assignments, package installation, system group memberships, and configuration channel assignments.
You will also need less manual interaction with your system after registration.</simpara>
</listitem>
<listitem>
<simpara>If you do not enter a human-readable name for your activation keys, the system will automatically generate a number string, which can make it difficult to manage your keys.
Consider a naming scheme for your activation keys to help you keep track of them.</simpara>
</listitem>
<listitem>
<simpara>Note that the <literal role="guimenu">Configuration File Deployment</literal> check box does not appear until after you have created the activation key.
Ensure you go back and check the box if you need to enable configuration management.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="create.tools.repository">
<title>Creating the SUSE Manager Tools Repository</title>
<simpara>In this section you will create a tools repository on the SUSE Manager Server for providing client tools.
The client tools repository contains packages for installing Salt on minions as well as required packages for registering traditional clients during the bootstrapping procedure.
These packages will be installed from the newly generated repository during the registration process.
In the following procedure you will create the SUSE Linux Enterprise tools repository.</simpara>
<important>
<title>Creating a Tools Repository when an SCC Channel has not been Synced</title>
<simpara>Before following the procedure to create the tools repository make sure the SUSE vendor channel you will be using with your client has been completely synced.
You can check this by running <literal role="command">tail -f /var/log/rhn/reposync/</literal>&lt;CHANNEL_NAME&gt;<literal>.log</literal> as <emphasis>root</emphasis>.
In the following example replace <literal role="replaceable">version</literal> with the actual version string:</simpara>
<screen># tail -f /var/log/rhn/reposync/sles`version`-pool-x86_64.log</screen>
<simpara>Once completed you should see the following output in your terminal:</simpara>
<screen>2017/12/12 15:20:32 +02:00 Importing packages started.
2017/12/12 15:22:02 +02:00 1.07 %
...
2017/12/12 15:34:25 +02:00 86.01 %
2017/12/12 15:35:49 +02:00 Importing packages finished.
2017/12/12 15:35:49 +02:00 Linking packages to channel.
...
2017/12/12 15:35:59 +02:00 Sync completed.</screen>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Generating the Tools Repository for SUSE Linux Enterprise</title>
<listitem>
<simpara>Open a terminal on the server as root and enter the following command to list available bootstrap repositories:</simpara>
<screen>mgr-create-bootstrap-repo -l SLE-`version`-x86_64</screen>
</listitem>
<listitem>
<simpara>Then invoke the same command using the listed repository as the product label to actually create the bootstrap repository:</simpara>
<screen>mgr-create-bootstrap-repo -c SLE-`version`-x86_64</screen>
</listitem>
<listitem>
<simpara>SUSE Manager will create and add the client tools to the newly created <literal role="path">repositories</literal> directory located at <literal role="path">/srv/www/htdocs/pub/repositories/</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>This repository is suitable for both Server and Desktop of SUSE Linux Enterprise.</simpara>
<note>
<title>Support for SUSE Linux Enterprise 15 Products</title>
<simpara>If you have mirrored more than one SUSE Linux Enterprise 15 Product (for example, SLES, {slda}, and SLES for SAP Application), you can specify the one you are actually interested in. First check what is avaiable:</simpara>
<screen>mgr-create-bootstrap-repo -c SLE-15-x86_64 --with-custom-channel
Multiple options for parent channel found. Please use option
--with-parent-channel &lt;label&gt; and choose one of:
- sle-product-sles15-pool-x86_64
- sle-product-sles_sap15-pool-x86_64
- sle-product-sled15-pool-x86_64</screen>
<simpara>Then specify it with <literal role="literal">--with-parent-channel</literal>:</simpara>
<screen>mgr-create-bootstrap-repo -c SLE-15-x86_64 --with-parent-channel sle-product-sled15-pool-x86_64</screen>
</note>
</section>
<section xml:id="registering.clients.traditional">
<title>Registering Traditional Clients</title>
<section xml:id="generate.bootstrap.script">
<title>Generating a Bootstrap Script</title>
<simpara>This section goes over generating a template bootstrap script which will be copied and modified for use with <quote>traditional</quote> clients.
Traditional clients register with SUSE Manager via a bootstrap script executed on the client which deploys all necessary packages to it.
The bootstrap script contains parameters which assigns a client system to its base channel.
Two of these important parameters are:</simpara>
<itemizedlist>
<listitem>
<simpara>Activation Keys</simpara>
</listitem>
<listitem>
<simpara>GNU Privacy Guard (GPG) Keys</simpara>
</listitem>
</itemizedlist>
<note>
<title>SLES 15 and Python 3</title>
<simpara>SLES 15 utilizes Python 3 by default.  Because of this change any older
bootstrap scripts (based on python 2) must be re-created for SLES 15 systems. Attempting to
register SLES 15 systems with SUSE Manager using Python 2 versions of the bootstrap script will
fail.</simpara>
</note>
<simpara>The following procedure will guide you through generating a bootstrap script.</simpara>
<orderedlist xml:id="create.boot.script" numeration="arabic">
<title>Procedure: Creating a Bootstrap Script</title>
<listitem>
<simpara>From the SUSE Manager Web UI, browse to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guisubmenu>Manager Configuration</guisubmenu> <guimenuitem>Bootstrap Script</guimenuitem></menuchoice>. For more information, see <xref linkend="s3-sattools-config-bootstrap"/>.</simpara>
</listitem>
<listitem>
<simpara>In the <literal role="guimenu">SUSE Manager Configuration - Bootstrap</literal> dialog disable <literal role="guimenu">Bootstrap using Salt</literal>.
Use default settings and click the <guibutton>Update</guibutton> button.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="mgr_configuration_bootstrap_trad.png" width="80%"/>
</imageobject>
<textobject><phrase>mgr configuration bootstrap trad</phrase></textobject>
</mediaobject>
</informalfigure>
<warning>
<title>Using SSL</title>
<simpara>Unchecking <guimenu>Enable SSL</guimenu> in the Web UI or setting <literal>USING_SSL=0</literal> in the bootstrap script is not recommended.
If you disable SSL nevertheless you will need to manage custom CA certificates to be able to run the registration process successfully.</simpara>
</warning>
</listitem>
<listitem>
<simpara>A template bootstrap script is generated and stored on the server&#8217;s file system in the <literal role="path">/srv/www/htdocs/pub/bootstrap</literal> directory.</simpara>
<screen>cd /srv/www/htdocs/pub/bootstrap</screen>
<simpara>The bootstrap script is also available at <literal role="path"><link xl:href="https://example.com/pub/bootstrap/bootstrap.sh">https://example.com/pub/bootstrap/bootstrap.sh</link></literal>
.</simpara>
</listitem>
</orderedlist>
<simpara><xref linkend="modify.bootstrap.script"/> will cover copying and modifying your bootstrap template for use with each client.</simpara>
</section>
<section xml:id="modify.bootstrap.script">
<title>Editing the Bootstrap Script</title>
<simpara>In this section you will copy and modify the template bootstrap script you created from <xref linkend="generate.bootstrap.script"/>.</simpara>
<simpara>A minimal requirement when modifying a bootstrap script for use with SUSE Manager is the inclusion of an activation key.
Depending on your organizations security requirements it is strongly recommended to include one or more (GPG) keys (for example, your organization key, and package signing keys).
For this tutorial you will be registering with the activation keys created in the previous section.</simpara>
<orderedlist xml:id="mod.bootstrap.script" numeration="arabic">
<title>Procedure: Modifying the Bootstrap Script</title>
<listitem>
<simpara>Login as root from the command line on your SUSE Manager server.</simpara>
</listitem>
<listitem>
<simpara>Navigate to the bootstrap directory with:</simpara>
<screen>cd /srv/www/htdocs/pub/bootstrap/</screen>
</listitem>
<listitem>
<simpara>Create and rename two copies of the template bootstrap script for use with each of your clients.</simpara>
<screen>cp bootstrap.sh bootstrap-sles11.sh
cp bootstrap.sh bootstrap-sles12.sh</screen>
</listitem>
<listitem>
<simpara>Open <literal role="path">sles12.sh</literal> for modification.
Scroll down and modify both lines marked in green.
You must comment out <literal>exit 1</literal> with a hash mark (<literal>#</literal>) to activate the script and then enter the name of the key for this script in the <literal>ACTIVATION_KEYS=</literal> field as follows:</simpara>
<screen>echo "Enable this script: comment (with #'s) this block (or, at least just"
echo "the exit below)"
echo
#exit 1

# can be edited, but probably correct (unless created during initial install):
# NOTE: ACTIVATION_KEYS *must* be used to bootstrap a client machine.
ACTIVATION_KEYS=1-sles12
ORG_GPG_KEY=</screen>
</listitem>
<listitem>
<simpara>Once you have completed your modifications save the file and repeat this procedure for the second bootstrap script.
Proceed to <xref linkend="connect.first.client"/>.</simpara>
</listitem>
</orderedlist>
<note>
<title>Finding Your Keys</title>
<simpara>To find key names you have created: In the Web UI, click <menuchoice><guimenu>Home</guimenu> <guisubmenu>Overview</guisubmenu> <guisubmenu>Manage Activation keys</guisubmenu> <guimenuitem>Key Field</guimenuitem></menuchoice>.
All keys created for channels are listed on this page.
You must enter the full name of the key you wish to use in the bootstrap script exactly as presented in the key field.</simpara>
</note>
</section>
<section xml:id="connect.first.client">
<title>Connecting Clients</title>
<simpara>This section covers connecting your clients to SUSE Manager with the modified bootstrap script.</simpara>
<orderedlist xml:id="run.bootstrap.script" numeration="arabic">
<title>Procedure: Running the Bootstrap Script</title>
<listitem>
<simpara>From your SUSE Manager Server command line as root navigate to the following directory:</simpara>
<screen>cd /srv/www/htdocs/pub/bootstrap/</screen>
</listitem>
<listitem>
<simpara>Run the following command to execute the bootstrap script on the client:</simpara>
<screen>cat MODIFIED-SCRIPT.SH | ssh root@example.com /bin/bash</screen>
</listitem>
<listitem>
<simpara>The script will execute and proceed to download the required dependencies located in the repositories directory you created earlier.
Once the script has finished running, log in to the Web UI and click <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Overview</guimenuitem></menuchoice> to see the new client listed.</simpara>
</listitem>
</orderedlist>
<simpara>This concludes the bootstrap section of this guide. <xref linkend="preparing.and.registering.clients.salt"/> will go over registering Salt minions for use with SUSE Manager.</simpara>
</section>
<section xml:id="sect.tradclient.packagelock">
<title>Package Locks</title>
<simpara>Package locks are used to prevent unauthorized installation or upgrades to software packages on traditional clients.
When a package has been locked, it will display to users with a padlock icon, indicating that it can not be installed.
Any attempt to install a locked package will be reported as an error in the event log.</simpara>
<simpara>Locked packages can not be installed, upgraded, or removed, either through the SUSE Manager Web UI, or directly on the client machine using a package manager.
Locked packages will also indirectly lock any dependent packages.</simpara>
<note>
<simpara>Package locks can only be used on traditional clients that use the Zypper package manager.
The feature is not currently supported on Red Hat Enterprise Linux or Salt clients.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Using Package Locks</title>
<listitem>
<simpara>On the client machine, install the <literal role="package">zypp-plugin-spacewalk</literal> package:</simpara>
<screen># zypper in zypp-plugin-spacewalk</screen>
</listitem>
<listitem>
<simpara>Navigate to the <menuchoice><guimenu>Software</guimenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>Lock</guimenuitem></menuchoice> tab on the managed system to see a list of all available packages.</simpara>
</listitem>
<listitem>
<simpara>Select the packages to lock, and click <guibutton>Request Lock</guibutton>.
You can also choose to enter a date and time for the lock to activate.
Note that even if you do not select a date and time, the lock might not activate immediately.</simpara>
</listitem>
<listitem>
<simpara>To remove a package lock, select the packages to unlock and click <guibutton>Request Unlock</guibutton>.
You can also choose to enter a date and time for the lock to deactivate.
Note that even if you do not select a date and time, the lock might not deactivate immediately.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="preparing.and.registering.clients.salt">
<title>Registering Salt Clients</title>
<simpara>There are currently three methods for registering Salt minions.
This section describes the first method and uses a bootstrap repository.
The second method uses the bootstrap script, and is mostly similar to the procedure described in <xref linkend="registering.clients.traditional"/>-the difference is enabling <literal role="guimenu">Bootstrap using Salt</literal> and the activation key option <literal role="guimenu">Configuration File Deployment</literal> that applies highstate automatically.
The third method uses the Web UI, and is described in <xref linkend="ref.webui.systems.bootstrapping"/>.</simpara>
<simpara>You can also use these methods to change existing traditional clients into Salt minions.</simpara>
<simpara>The rest of this section assumes you have created a SUSE Manager tools repository.
You can review creating a tools repository in <xref linkend="create.tools.repository"/>.</simpara>
<simpara>When you have fully synchronized a base channel from the Web UI for clients to obtain software packages from (for example: <literal>SLES12-SP4-Pool_for_x86_64</literal>) perform the following procedure to register a Salt minion.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Registering Salt Minions</title>
<listitem>
<simpara>On your minion as root enter the following command:</simpara>
<screen>zypper ar http://FQDN.server.example.com/pub/repositories/sle/12/4/bootstrap/ \
   sles12-sp4</screen>
<note>
<simpara>Do not use <literal>HTTPS</literal>.
Use <literal>HTTP</literal> instead to avoid errors.</simpara>
</note>
</listitem>
<listitem>
<simpara>After adding the repository containing the necessary Salt packages execute:</simpara>
<screen>zypper in salt-minion</screen>
</listitem>
<listitem>
<simpara>Modify the minion configuration file to point to the fully qualified domain name (<literal role="replaceable">FQDN</literal>) of the SUSE Manager server (master):</simpara>
<screen>vi /etc/salt/minion</screen>
<simpara>Find and change the line:</simpara>
<screen>master: salt</screen>
<simpara>to:</simpara>
<screen>master: FQDN.server.example.com</screen>
</listitem>
<listitem>
<simpara>Restart the Salt minion with:</simpara>
<screen>systemctl restart salt-minion</screen>
</listitem>
</orderedlist>
<simpara>Your newly registered minion should now show up within the Web UI under <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Keys</guimenuitem></menuchoice>.
Accept the <literal role="guimenu">pending</literal> key to begin management.</simpara>
</section>
<section xml:id="_troubleshooting_salt_clients">
<title>Troubleshooting Salt Clients</title>
<section xml:id="_mounting_tmp_with_noexec">
<title>Mounting /tmp with noexec</title>
<simpara>Salt runs remote commands from <literal role="filename">/tmp</literal> of the client&#8217;s filesystem.
Therefore you must not mount <literal role="filename">/tmp</literal> with the <literal role="option">noexec</literal> option.</simpara>
</section>
<section xml:id="_cloned_salt_clients">
<title>Cloned Salt Clients</title>
<simpara>If you have used your hypervisor clone utility, and attempted to register the cloned Salt client, you might get this error:</simpara>
<screen>We're sorry, but the system could not be found.</screen>
<simpara>This is caused by the new, cloned, system having the same machine ID as an existing, registered, system.
You can adjust this manually to correct the error and register the cloned system successfully.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="salt.gs.guide.introduction">
<title>Getting Started with Salt</title>
<section xml:id="salt.gs.guide.intro">
<title>Introduction</title>
<simpara>This section introduces you to the new Salt features added in SUSE Manager 3.
This chapter assumes you have completed all previous Getting Started sections.
At a minimum have the following setup:</simpara>
<itemizedlist>
<listitem>
<simpara>A freshly installed SUSE Manager server with a main admin account and a synced product channel</simpara>
</listitem>
<listitem>
<simpara>Preferably two registered Salt minions to experiment with.</simpara>
</listitem>
</itemizedlist>
<simpara>If you find yourself stuck at any point refer to the <emphasis><phrase role="ref">SaltStack Get Started</phrase></emphasis> tutorial located at <link xl:href="https://docs.saltstack.com/en/getstarted/fundamentals/index.html">https://docs.saltstack.com/en/getstarted/fundamentals/index.html</link>.</simpara>
<note>
<simpara>This guide does not attempt to cover all that Salt has to offer.
This guide is a primer for using Salt with SUSE Manager.
For comprehensive Salt documentation, see <link xl:href="https://docs.saltstack.com/en/latest/contents.html">https://docs.saltstack.com/en/latest/contents.html</link>.</simpara>
</note>
<simpara>The current version of Salt in SUSE Manager is 2018.3.0.</simpara>
</section>
<section xml:id="salt.gs.guide.testing.first.minion">
<title>Understanding Salt Calls</title>
<variablelist>
<varlistentry>
<term>Salt Calls</term>
<listitem>
<simpara>Salt calls are defined by three main properties:</simpara>
<screen>salt 'target' &lt;function&gt; [arguments]</screen>
<variablelist>
<varlistentry>
<term>Target</term>
<listitem>
<simpara>Use the second property in a Salt call to target a single machine or group of machines.
Specify the minion or group of minions you would like to run a function on.</simpara>
<variablelist>
<varlistentry>
<term>General Targeting</term>
<listitem>
<simpara>List available grains on all minions:</simpara>
<screen>salt '*' grains.ls</screen>
<simpara>Ping a specific minion:</simpara>
<screen>salt 'web1.example.com' test.ping</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Glob Targeting</term>
<listitem>
<simpara>Ping all minions using a domain:</simpara>
<screen>salt '*example.com' test.ping</screen>
<simpara>Display the OS name of all minions with the <literal>webserver</literal> label:</simpara>
<screen>salt 'webserver*' grains.item oscodename</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>List Targeting</term>
<listitem>
<screen>salt -L 'webserver.example.com,db.example.com' test.ping</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Regular Expression Targeting</term>
<listitem>
<simpara>You may use PCRE-compliant regular expressions:</simpara>
<screen>salt -E '(?!web)' test.ping</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>IP Address Targeting</term>
<listitem>
<simpara>List minion IP addresses:</simpara>
<screen>salt '*' network.ip_addrs</screen>
<simpara>Ping a specific minion IP address:</simpara>
<screen>salt -S '172.31.60.74' test.ping</screen>
<simpara>Ping all minions on a subnet:</simpara>
<screen>salt -S 172.31.0.0/16 test.ping</screen>
<tip>
<title>Lookup a Subnet Using the <literal role="command">ip</literal> Command</title>
<simpara>You can use the <literal role="command">ip</literal> command to find the subnet mask in the format of <literal>192.168.1.1/24</literal>:</simpara>
<screen>ip -o -f inet addr show | awk '/scope global/ {print $4}'</screen>
</tip>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry>
<term>Function</term>
<listitem>
<simpara>Once you have specified a target, provide the function you would like to call.
Functions also accept arguments.
Arguments are space-delimited, for example:</simpara>
<screen>salt '*' cmd.run 'echo "Hello: $FIRST_NAME"' env='{FIRST_NAME: "John"}'</screen>
<variablelist>
<varlistentry>
<term>Locating Additional Minion Functions</term>
<listitem>
<simpara>Find more functions which can be called on minions by running:</simpara>
<screen>salt '*' sys.doc</screen>
<simpara>A full list of callable functions are located here: <link xl:href="https://docs.saltstack.com/en/2015.8/ref/modules/all/index.html">https://docs.saltstack.com/en/2015.8/ref/modules/all/index.html</link></simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Arguments</term>
<listitem>
<simpara>Provides the extra data needed by a function you are calling.
The command <literal role="command">pkg.install</literal> requires an argument specifying a package to install. YaST has been selected for installation, for example:</simpara>
<screen>salt '*' pkg.install yast2</screen>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="salt.gs.guide.term.overview">
<title>Common Salt Terminology</title>
<variablelist>
<varlistentry>
<term>Grains</term>
<listitem>
<simpara>Grains provide information about the hardware of a minion.
For example, the operating system, IP addresses, network interfaces, memory, etc.
When running a Salt command from keep in mind any modules and functions called are run locally from the system being called.
Salt modules are stored on minions and master within the following directory:</simpara>
<screen>/usr/lib/python2.7/site-packages/salt/</screen>
<simpara>List all available grains with the <literal role="command">grains.ls</literal> function:</simpara>
<screen>salt '*' grains.ls</screen>
<simpara>List collected grain system data by using the <literal role="command">grains.ls</literal> function:</simpara>
<screen>salt '*' grains.items</screen>
<simpara>For more information on grains, see <link xl:href="https://docs.saltstack.com/en/latest/topics/grains/">https://docs.saltstack.com/en/latest/topics/grains/</link>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>States</term>
<listitem>
<simpara>States are templates which place systems into a known configuration, for example which applications and services are installed and running on those systems.
States are a way for you to describe what each of your systems should look like.
Once written, states are applied to target systems automating the process of managing and maintaining a large numbers of systems into a known state.
For more information on states, see <link xl:href="https://docs.saltstack.com/en/latest/topics/tutorials/starting_states.html">https://docs.saltstack.com/en/latest/topics/tutorials/starting_states.html</link>.</simpara>
<warning>
<title>Updating Salt</title>
<simpara>Do not update <phrase role="package">salt</phrase> itself using Salt states.
First update all other system packages using Salt states then update <phrase role="package">salt</phrase> as a separate stand-alone step from the SUSE Manager Web UI.</simpara>
</warning>
</listitem>
</varlistentry>
<varlistentry>
<term>Pillar</term>
<listitem>
<simpara>Pillars unlike grains are created on the master.
Pillar files contain information about a minion or group of minions.
Pillars allow you to send confidential information to a targeted minion or group of minions.
Pillars are useful for sensitive data, configuration of minions, variables, and any arbitrary data which should be defined.
For more information on pillars, see <link xl:href="https://docs.saltstack.com/en/latest/topics/tutorials/pillar.html">https://docs.saltstack.com/en/latest/topics/tutorials/pillar.html</link>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Beacons</term>
<listitem>
<simpara>Beacons allow an admin to use the event system in Salt to monitor non-Salt processes.
Minions may use beacons to hook into many types of system proceses for constant monitoring.
Once a targeted monitored activity occurs an event is sent on the Salt event bus that may be used to trigger a reactor.</simpara>
<important>
<title>Enabling Beacons</title>
<simpara>To work with beacons on Salt minions the package python-pyinotify must be installed for SUSE systems.
For RES systems install python-inotify.
This package is not installed automatically during the salt minion package installation.</simpara>
</important>
<note>
<title>Peer Communication with salt-broker</title>
<simpara>The salt-broker acts like a switch and not like a hub, therefore Peer communication will only work for minions behind the same broker/Proxy.
For more information on Salt and peer communication see: <link xl:href="https://docs.saltstack.com/en/latest/ref/peer.html">https://docs.saltstack.com/en/latest/ref/peer.html</link></simpara>
</note>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="salt.gs.guide.useful.salt.commands">
<title>Useful Salt Commands</title>
<simpara>The following list provides several useful Salt commands.</simpara>
<variablelist>
<varlistentry>
<term>salt-run</term>
<listitem>
<simpara>Print a list of all minions that are up:</simpara>
<screen>salt-run manage.up</screen>
<simpara>Print a list of all minions that are down:</simpara>
<screen>salt-run manage.down</screen>
<simpara>Print a list with the current status of all Salt minions:</simpara>
<screen>salt-run manage.status</screen>
<simpara>Check the version of Salt running on the master and active minions:</simpara>
<screen>salt-run manage.versions</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>salt-cp</term>
<listitem>
<simpara>Copy a file to a minion or set of minions.</simpara>
<screen>salt-cp '*' foo.conf /root</screen>
<simpara>For more information, see <link xl:href="https://docs.saltstack.com/en/latest/ref/cli/salt-cp.html">https://docs.saltstack.com/en/latest/ref/cli/salt-cp.html</link>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>salt-key -l</term>
<listitem>
<simpara>List public keys:</simpara>
<screen>salt-key -l</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>salt-key -A</term>
<listitem>
<simpara>Accept all pending keys:</simpara>
<screen>salt-key -A</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="salt.gs.guide.salt.file.locations">
<title>Salt File Locations and Structure</title>
<simpara>The following screen describes Salt file structures and their locations used by the SUSE Manager Server.
These files are listed in <literal role="path">/etc/salt/master.d/susemanager.conf</literal>:</simpara>
<screen># Configure different file roots

file_roots:
  base:
    - /usr/share/susemanager/salt    #Should not be touched by a user
    - /srv/susemanager/salt          #Should not be touched by a user
    - /srv/salt                      #Your custom states go here

# Configure different pillar roots

pillar_roots:
  base:
    - /usr/share/susemanager/pillar  #Should not be touched by a user
    - /srv/pillar                    #Custom pillars go here

# Extension modules path

extension_modules: /usr/share/susemanager/modules

# Master top configuration

master_tops:
  mgr_master_tops: True</screen>
<simpara>The following tips should be kept in mind when working with <literal role="path">/etc/salt/master.d/susemanager.conf</literal>.</simpara>
<itemizedlist>
<listitem>
<simpara>Files listed are searched in the order they appear.</simpara>
</listitem>
<listitem>
<simpara>The first file found is called.</simpara>
</listitem>
</itemizedlist>
<section xml:id="salt.gs.guide.salt.file.locations.file.roots">
<title>file_roots</title>
<simpara>SUSE Manager as the Salt master reads its state data from three specific file root directories.</simpara>
<variablelist>
<varlistentry>
<term>/usr/share/susemanager/salt</term>
<listitem>
<simpara>This directory is created by SUSE Manager and its content generated by the <literal role="path">/usr/share/susemanager/modules/tops/mgr_master_tops.py</literal> python module.
It is shipped and updated together with SUSE Manager and includes certificate setup and common state logic that will be applied to packages and channels.</simpara>
<warning>
<title>Do Not Edit</title>
<simpara>You should not edit or add custom Salt data to this directory.</simpara>
</warning>
</listitem>
</varlistentry>
<varlistentry>
<term>/srv/susemanager/salt</term>
<listitem>
<simpara>This directory is created by SUSE Manager and contains assigned channels and packages for minions, groups, and organizations.
These files will be overwritten and regenerated.
A good analogy for this directory would be the SUSE Manager database translated into Salt directives.</simpara>
<warning>
<title>Do Not Edit</title>
<simpara>You should not edit or add custom Salt data to this directory.</simpara>
</warning>
</listitem>
</varlistentry>
<varlistentry>
<term>/srv/salt</term>
<listitem>
<simpara>The directory <literal role="path">/srv/salt</literal> is for your custom state data, salt modules etc.
SUSE Manager does not perform any actions on this directory.
However the state data placed here affects the Highstate of minions and is merged with the result generated by SUSE Manager.</simpara>
<note>
<title>Editable</title>
<simpara>Place custom Salt data here.</simpara>
</note>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="salt.gs.guide.salt.file.locations.pillar.roots">
<title>pillar_roots</title>
<simpara>SUSE Manager as the Salt master reads its pillar data from two specific pillar root directories.</simpara>
<variablelist>
<varlistentry>
<term>/usr/share/susemanager/pillar</term>
<listitem>
<simpara>This directory is generated by SUSE Manager.
It is shipped and updated together with SUSE Manager.</simpara>
<warning>
<title>Do Not Edit</title>
<simpara>You should not edit or add custom Salt data to this directory.</simpara>
</warning>
</listitem>
</varlistentry>
<varlistentry>
<term>/srv/pillar</term>
<listitem>
<simpara>SUSE Manager by default does not touch or do anything with this directory.
However the custom pillar data placed here is merged with the pillar result created by SUSE Manager.</simpara>
<tip>
<title>Editable Directory</title>
<simpara>Place your custom Salt pillar data here.</simpara>
</tip>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section xml:id="_install_the_suse_manager_locale_formula">
<title>Install the SUSE Manager Locale Formula</title>
<simpara>The following section provides guidance on installing and using SUSE provided Salt formulas.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Installing the Locale Formula</title>
<listitem>
<simpara>Install the locale formula with:</simpara>
<screen>zypper install locale-formula</screen>
<note>
<simpara>This installs the package contents to <literal role="path">/usr/share/susemanager/formulas/{metadata,states}</literal></simpara>
</note>
</listitem>
<listitem>
<simpara>After installing the RPM, log in to the SUSE Manager Web UI.</simpara>
</listitem>
<listitem>
<simpara>Browse to the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>System Details</guimenuitem></menuchoice> page of any minion you would like to apply the formula to.</simpara>
</listitem>
<listitem>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>System Details</guimenuitem></menuchoice> page you will see a new <guibutton>Formulas</guibutton> tab.
Select it to view a list of installed formulas.</simpara>
</listitem>
<listitem>
<simpara>From the <guibutton>Formulas</guibutton> list select <menuchoice><guimenu>Formulas</guimenu> <guimenuitem>Locale</guimenuitem></menuchoice> and click <guibutton>Save</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>A new tab will appear next to the <menuchoice><guimenu>Formula</guimenu> <guimenuitem>Locale</guimenuitem></menuchoice> subtab. Select the new <menuchoice><guimenu>Formulas</guimenu> <guimenuitem>Locale</guimenuitem></menuchoice> tab.</simpara>
</listitem>
<listitem>
<simpara>The <menuchoice><guimenu>Formalas</guimenu> <guimenuitem>Locale</guimenuitem></menuchoice> tab contains options for setting the language, keyboard layout, timezone, and whether hardware clock is set to UTC. Select the desired options and click <guibutton>Save</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Run the following command to verify pillar settings. The output has been truncated.</simpara>
<screen>salt '$your_minion' pillar.items</screen>
<screen>...
   keyboard_and_language:
       ----------
       keyboard_layout:
           English (US)
       language:
           English (US)
   machine_password:
       foobar
   mgr_server:
       manager_server
   org_id:alt '$your_minion_here'
       1
   timezone:
       ----------
       hardware_clock_set_to_utc:
           True
       name:
           CET
    ...</screen>
</listitem>
<listitem>
<simpara>Apply this state to your minion by applying the highstate from the command line with:</simpara>
<screen>salt '$your_minion' state.highstate</screen>
<note>
<simpara>You can also apply the highstate from the previous formula tab from the SUSE Manager Web UI by selecting <menuchoice><guimenu>System Details</guimenu> <guimenuitem>States</guimenuitem></menuchoice> and clicking <guibutton>Apply Highstate</guibutton>.</simpara>
</note>
</listitem>
</orderedlist>
</section>
<section xml:id="salt.pillars.setpackageendpoint">
<title>Use Pillars to Set the Package Download Endpoint</title>
<simpara>By default, SUSE Manager assumes that the download endpoint to use is the FQDN of the SUSE Manager server, or the SUSE Manager Proxy.
However, there are some cases where you might like to use a different FQDN as the download endpoint.
The most common example is if you need to use load balancing, caching proxies, or in environments with complicated networking requirements.</simpara>
<simpara>To change the package download endpoint, you can manually adjust three salt pillars:
* <literal role="systemitem">pkg_download_point_protocol</literal>, defaults to <literal role="systemitem">https</literal>.
* <literal role="systemitem">pkg_download_point_host</literal>, defaults to the FQDN of the SUSE Manager Server (or Proxy, if in use).
* <literal role="systemitem">pkg_download_point_port</literal>, defaults to <literal role="systemitem">443</literal>.</simpara>
<simpara>If you do not adjust these pillars directly, SUSE Manager will fall back to the default values.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Changing the package download endpoint pillar</title>
<listitem>
<simpara>Navigate to <literal role="path">/srv/pillar/</literal> and create a file called <literal role="filename">top.sls</literal>  with these contents:</simpara>
<screen>base:
  '*':
    - pkg_download_endpoints</screen>
<simpara>This example directs Salt to look at the <literal role="filename">pkg_download_endpoints.sls</literal> file to determine the base URL to use.
You can adjust this file to target different minions or groups, depending on your environment.</simpara>
</listitem>
<listitem>
<simpara>Remain in <literal role="path">/srv/pillar/</literal> and create a file called <literal role="filename">pkg_download_endpoints.sls</literal> with the base URLs you want to use.
For example:</simpara>
<screen>pkg_download_point_protocol: http
pkg_download_point_host: example.com
pkg_download_point_port: 444</screen>
</listitem>
<listitem>
<simpara>OPTIONAL: You can use grains to set conditional values, for example:</simpara>
</listitem>
</orderedlist>
<screen>{% if grains['fqdn'] == 'minion1.example.com' %}
    pkg_download_point: example1.com
{% elif grains['fqdn'] == 'minion2.example.com' %}
    pkg_download_point: example2.com
{% else %}
    pkg_download_point: example.com
{% endif %}</screen>
<orderedlist numeration="arabic">
<listitem>
<simpara>OPTIONAL: If you want to use external pillars, for example Group IDs, open the master configuration file and set the <literal role="systemitem">ext_pillar_first</literal> parameter to <literal role="systemitem">true</literal>.
You can then use Group IDs to set conditional values, for example:</simpara>
<screen>{% if pillar['group_ids'] is defined and Group_ID in pillar['group_ids'] %}
  pkg_download_point_protocol: http
  pkg_download_point_host: example.com
  pkg_download_point_port: 444
{% else %}
  pkg_download_point_protocol: ftp
  pkg_download_point_host: example.com
  pkg_download_point_port: 445
{% endif %}</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="_disabling_the_salt_mine">
<title>Disabling the Salt Mine</title>
<simpara>In older versions, SUSE Manager used a tool called Salt mine to check minion availability.
The Salt mine would cause minions to contact the server every hour, which created significant load.
With the introduction of a more efficient mechanism in SUSE Manager&#160;3.2, the Salt mine is no longer required.
Instead, the SUSE Manager server uses Taskomatic to ping only the minions that appear to have been offline for twelve hours or more, with all minions being contacted at least once in every twenty four hour period by default.
You can adjust this by changing the <literal role="systemitem">web.system_checkin_threshold</literal> parameter in <literal role="path">rhn.conf</literal>.
The value is expressed in days, and the default value is <literal role="literal">1</literal>.</simpara>
<simpara>Newly registered Salt minions will have the Salt mine disabled by default.
If the Salt mine is running on your system, you can reduce load by disabling it.
This is especially effective if you have a large number of minions.</simpara>
<simpara>Disable the Salt mine by running this command on the server:</simpara>
<screen>salt '*' state.sls util.mgr_mine_config_clean_up</screen>
<simpara>This will restart the minions and generate some Salt events to be processed by the server.
If you have a large number of minions, handling these events could create excessive load.
To avoid this, you can execute the command in batch mode with this command:</simpara>
<screen>salt --batch-size 50 '*' state.sls util.mgr_mine_config_clean_up</screen>
<simpara>You will need to wait for this command to finish executing.
Do not end the process with <keycombo><keycap>Ctrl</keycap><keycap>C</keycap></keycombo>.</simpara>
</section>
</chapter>
</part>
<part xml:id="book.suma.best.practices">
<title>Best Practices</title>
<chapter xml:id="mgr.conceptual.overview">
<title>Introduction</title>
<simpara>This document targets system administrators.</simpara>
<section xml:id="_whats_covered_in_this_guide">
<title>What&#8217;s Covered in this Guide?</title>
<simpara>This document describes SUSE recommended best practices for SUSE Manager.
This information has been collected from a large number of successful SUSE Manager real world implementations and includes feedback provided by product management, sales and engineering.</simpara>
<note>
<title>SUSE Manager Version Information</title>
<simpara>In this manual if not other specified, SUSE Manager version 3.2 is assumed and this version is required if a feature is discussed.
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy were originally released as a SLES 12 SP3 extension.
With the next maintenance update (December 2018),
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy will be based on SLES 12 SP4 and support SLE 12 SP4 clients officially.
In the following sections and chapters, it is highly recommended to use SLE 12 SP4 instead of SP3.
Whenever features of the SUSE Manager 3.2 host operating system are documented and not other specified version 12 SP4 is assumed.</simpara>
</note>
<simpara>This chapter will discuss the following topics:</simpara>
<itemizedlist>
<listitem>
<simpara>Prerequisites</simpara>
</listitem>
<listitem>
<simpara>Network Requirements</simpara>
</listitem>
<listitem>
<simpara>Hardware Requirements</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_prerequisites">
<title>Prerequisites</title>
<formalpara>
<title>Purchased Registration Keys</title>
<para>During initial setup SUSE Manager will request a product <literal role="systemitem">Registration Key</literal>.
This key will be provided to you after purchasing the product.
You can find your key located under your SUSE Customer Center account.
Log-in with your SUSE Customer Center credentials or register for a new account. -https://scc.suse.com</para>
</formalpara>
<formalpara>
<title>Evaluation Keys</title>
<para>If you wish to run a test system (non-production) a 60 day evaluation key may be obtained.
On the SUSE Manager product page click <guibutton>TRY SUSE MANAGER</guibutton>.
The evaluation key limits the number of systems that may be registered with SUSE Manager to 10.
For more information see:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://www.suse.com/products/suse-manager/">https://www.suse.com/products/suse-manager/</link></simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>SCC Organization Credentials</title>
<para>During setup you will also be asked to enter your SUSE Customer Center <literal role="systemitem">Organization Credentials</literal>.</para>
</formalpara>
<formalpara>
<title>Users and Passwords</title>
<para>During both the SUSE Linux Enterprise installation and setup of SUSE Manager several users and passwords will be created:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>SUSE Linux Enterprise root user account</simpara>
</listitem>
<listitem>
<simpara>PostgreSQL database user and password</simpara>
</listitem>
<listitem>
<simpara>Certificate of Authority password</simpara>
</listitem>
<listitem>
<simpara>SUSE Manager administrator user and password</simpara>
</listitem>
</itemizedlist>
<tip>
<title>Safe Passwords</title>
<simpara>Maintain security by creating safe passwords.
Store passwords within a secure location.
Use the following guidelines when creating your passwords.</simpara>
<itemizedlist>
<listitem>
<simpara>At least 8 characters long</simpara>
</listitem>
<listitem>
<simpara>Should contain uppercase characters <literal role="command">A B C</literal></simpara>
</listitem>
<listitem>
<simpara>Should contain lowercase characters <literal role="command">a b c</literal></simpara>
</listitem>
<listitem>
<simpara>Should contain numbers <literal role="command">1 2 3</literal></simpara>
</listitem>
<listitem>
<simpara>Should contain symbols <literal role="command">~ ! @ #</literal></simpara>
</listitem>
</itemizedlist>
</tip>
</section>
<section xml:id="bp.chapt.intro.network.requires">
<title>Network Requirements</title>
<simpara>SUSE Manager and SUSE Manager Proxy both contact several external addresses in order to maintain updates and subscriptions.
The following lists provide the up-to-date hostnames for each service requiring permission when used in combination with corporate firewall and content filters.</simpara>
<itemizedlist>
<title>SUSE Customer Center Hostnames (Required)</title>
<listitem>
<simpara><link xl:href="https://scc.suse.com">https://scc.suse.com</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://updates.suse.com">https://updates.suse.com</link></simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>Novell Customer Center Hostnames (Legacy)</title>
<listitem>
<simpara><link xl:href="https://secure-www.novell.com">https://secure-www.novell.com</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://nu.novell.com">https://nu.novell.com</link></simpara>
</listitem>
</itemizedlist>
<simpara>For SUSE Manager to function properly it requires the following pre-configured components within your network.</simpara>
<important>
<title>Websocket Support</title>
<simpara>If SUSE Manager is accessed via an HTTP proxy (Squid, etc) the proxy must support websocket connections.</simpara>
</important>
<formalpara>
<title>Networking Hardware</title>
<para>The following table provides networking hardware info.
As SUSE Manager will likely be managing a large number of systems (quite possibly numbering in hundreds or even thousands), networking hardware that increases bandwidth becomes increasingly more valuable.</para>
</formalpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Recommended</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>100Mbits/s Link</simpara></entry>
<entry align="left" valign="top"><simpara>Non-production test server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>1Gb/s Link<?asciidoc-br?></simpara></entry>
<entry align="left" valign="top"><simpara>Production Server</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<formalpara>
<title>DHCP Server</title>
<para>The purpose of the Dynamic Host Configuration Protocol (DHCP) is to assign network settings centrally (from a server) rather than configuring them locally on each and every workstation.
A host configured to use DHCP does not have control over its own static address.
It is enabled to configure itself completely and automatically according to directions from the server.
A DHCP server supplies not only the IP address and the netmask, but also the host name, domain name, gateway, and name server addresses for the client to use.
For more information on configuring DHCP see also:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_dhcp.html">https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_dhcp.html</link></simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>FQDN (Fully Qualified Domain Name)</title>
<para>DNS assists in assigning an IP address to one or more names and assigning a name to an IP address.
In Linux, this conversion is usually carried out by a special type of software known as bind.
The machine that takes care of this conversion is called a <emphasis>name server</emphasis>.
The names make up a hierarchical system in which each name component is separated by a period.
The name hierarchy is, however, independent of the IP address hierarchy described above.
Consider a complete name, such as <literal role="replaceable">jupiter.example.com</literal>, written in the format <literal role="replaceable">hostname.domain</literal>.
A full name, referred to as a <emphasis>fully qualified domain name</emphasis> (FQDN), consists of a host name and a domain name (example.com).
For more information on configuring a name server see also:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_basicnet_nameres.html">https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_basicnet_nameres.html</link></simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>DNS (Dynamic Name System) Server</title>
<para>A DNS Server is required for resolving domain names and host names into IP addresses.
For example, the IP address 192.168.2.100 could be assigned to the host name jupiter.
In the case of SUSE Manager the DNS server must be resolvable both via DNS and reverse lookup.
For more information on configuring DNS see also:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_dns.html">https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_dns.html</link></simpara>
</listitem>
</itemizedlist>
<important>
<title>Microsoft NT Lan Manager Compatibility</title>
<simpara>Microsoft NT Lan Manager can be configured for use with basic authentication and will work with SUSE Manager but authentication using native (NTLM) Microsoft protocols is not supported.</simpara>
</important>
<formalpara>
<title>Open Port List</title>
<para>During the setup process of SUSE Manager all required ports will be opened automatically.
The following tables provide you with an overview of ports which are used by SUSE Manager.</para>
</formalpara>
<table xml:id="tab.install.ports.server" frame="all" rowsep="1" colsep="1">
<title>Required Server Ports</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Port</entry>
<entry align="left" valign="top">Protocol</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>22</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>SSH</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>67</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>DHCP</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>69</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>TFTP, used to support PXE services</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>80</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>HTTP, used in some bootstrap cases</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>123</simpara></entry>
<entry align="left" valign="top"><simpara>UDP</simpara></entry>
<entry align="left" valign="top"><simpara>NTP time service</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>443</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>HTTPS, used for Web UI, client, Proxy server, and API traffic</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>4505</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>Salt, used by the Salt-master to accept communication requests from minions</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>4506</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>Salt, used by the Salt-master to accept communication requests from minions</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>5222</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>XMPP client, used for communications with the <literal role="systemitem">osad</literal> daemon on traditional client systems</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>5269</simpara></entry>
<entry align="left" valign="top"><simpara>TCP</simpara></entry>
<entry align="left" valign="top"><simpara>XMPP server, used for pushing actions to SUSE Manager Proxy</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>For more information, see <link xl:href="advanced.topics.app.ports.server#at-ports">Port Listing</link>.</simpara>
<tip>
<title>Denying External Network Access</title>
<simpara>When your network requires denying external network access to and from SUSE Manager, an RMT or SMT Server may be registered against SUSE Manager.
The RMT or SMT server can then be used to synchronize the necessary SUSE repositories.
For more information on utilizing an RMT or SMT Server, see: <xref linkend="disconnect-setup"/>.</simpara>
</tip>
<note>
<title>Blocking Port 80</title>
<simpara>Port 80 may be blocked as traffic is automatically redirected through port 443.
It should be noted you will lose redirection.
Keep in mind you will need additional ports open when using traditional clients in combination with <literal role="systemitem">osad</literal> (XMPP TCP 5222).</simpara>
</note>
</section>
<section xml:id="_hardware_recommendations">
<title>Hardware Recommendations</title>
<simpara>This section provides tested production recommendations for small to mid size networks that will be managed by SUSE Manager.</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Recommended</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>CPU</simpara></entry>
<entry align="left" valign="top"><simpara>Multi-core 64bit CPU (x86_64, ppc64le).</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>RAM</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 4 GB+ for test server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara>Minimum 16 GB+ for base installation</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara>Minimum 32 GB+ for a production server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Free Disk Space</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 100 GB+ for root partition</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara>Minimum 50 GB+ for <literal role="path">/var/lib/pgsql</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara>Minimum 50 GB per SUSE product, or 200 GB per Red Hat product <literal role="path">/var/spacewalk</literal></simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<formalpara>
<title>Advised Number of CPUs</title>
<para>Review the following list for CPU recommendations.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>Connecting 200 systems or less to SUSE Manager : 4 CPUs</simpara>
</listitem>
<listitem>
<simpara>Connecting 500 systems or less to SUSE Manager : 4-8 CPUs</simpara>
</listitem>
<listitem>
<simpara>When implementing RHEL channels: 8 CPUs</simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>Disk Space</title>
<para>SUSE Manager stores information in several directories.
For these directories it is strongly recommend that you create separate file-systems or use an NFS share.
During installation one VG will be created that contains all disks selected during installation.
Therefore the first disk should be large enough to contain the OS.
Normally 20GB - 50GB is sufficient.
A 50 GB partition would be the recommended size.
The following directories should be created on a separate file-system.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><literal role="path">/var/spacewalk</literal> This directory will contain all rpm&#8217;s. Each RPM will be stored only once.
The needed size will depend on the number of channels and type of channels that will be downloaded.
The general rule would be that per SUSE Service Pack (including SUSE RedHat Expanded Support) around 50 GB should be enough.
An extra 150 GB for RES/CentOS repositories should be added on top.
If other non-enterprise distributions (eg OpenSUSE) are added,  calculated 50 GB per distribution.
This directory could also be stored on an NFS share.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/lib/pgsql</literal> This directory contains the PostgreSQL database.
Recommended is to create a file-system of 50 GB.
This volume should be monitored, because a full file-system where the database is running on can cause unexpected errors (and this even months after it happened).</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/tftpboot</literal> If PXE/cobbler is used, this directory will contain the images (initrd and linux) for all created auto-installation profiles.
Each image is around 50 MB.
Depending on the number of profiles a decision has to be made if it would be useful to move this directory to a separate file-system.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/log</literal> As SUSE Manager writes a large number of logs, it is recommended to create a separate file-system for /var/log.
The size should be around 20 GB.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/spacewalk/db_backup</literal> For the backup of the PostgreSQL database, it is recommended the create a separate directory.
As the database can be rather large, it is advised to mount it on a separate file-system.
A safe estimate would be to provide twice space as for the directory created for <literal role="path">/var/lib/pqsql</literal>.</simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>Supported Databases</title>
<para>SUSE Manager 3 and later no longer provides support for an external Oracle database.
The default database is an embedded PostgreSQL.
During SUSE Manager setup the database will be created and configured.</para>
</formalpara>
</section>
</chapter>
<chapter xml:id="suma.choosing.dist.scheme">
<title>Managing Your Subscriptions</title>
<simpara>There are two methods for managing your subscriptions.
Both methods access SUSE Customer Center
and provide specialized benefits.</simpara>
<itemizedlist>
<listitem>
<simpara>Directly connecting to SUSE Customer Center is the recommended default way of managing your SUSE Manager server.</simpara>
</listitem>
<listitem>
<simpara>If you have special network security requirements which do not allow access from your internal network to the internet then you can use SUSE Linux Enterprise Server 12 running the Repository Management Tool (RMT) or Repository Management Tool (SMT).  These tools will contact SUSE Customer Center from a system connected to the external network and obtain updates for your clients which you may then mount on your internal SUSE Manager server. This is the preferred method for managing client systems within a highly secure network infrastructure.</simpara>
</listitem>
</itemizedlist>
<section xml:id="scc">
<title>SUSE Customer Center (SCC)</title>
<simpara>SUSE Customer Center
(SCC) is the central place to manage your purchased SUSE
subscriptions, helping you access your update channels and get in contact with SUSE
experts.
The user-friendly interface gives you a centralized view of all your SUSE
subscriptions, allowing you to easily find all subscription information you need.
The improved registration provides faster access to your patches and updates. SUSE Customer Center
is also designed to provide a common platform for your support requests and feedback.
Discover a new way of managing your SUSE
account and subscriptions via one interface&#8212;&#8203;anytime, anywhere.
For more information on using SUSE Customer Center
, see <link xl:href="https://scc.suse.com/docs/userguide">https://scc.suse.com/docs/userguide</link>.</simpara>
</section>
<section xml:id="disconnect-setup">
<title>Disconnected Setup with RMT or SMT (DMZ)</title>
<simpara>If it is not possible to connect SUSE Manager
directly or via a proxy to the Internet, a disconnected setup in combination with RMT or SMT is the recommended solution.
In this scenario, RMT or SMT stays in an <quote>external</quote>
 network with a connection to SUSE Customer Center
 and synchronizes the software channels and repositories on a removable storage medium.
Then you separate the storage medium from RMT or SMT, and mount it locally on your SUSE Manager
 server to read the updated data.</simpara>
<formalpara>
<title>RMT</title>
<para>The successor of SMT and currently runs on the following systems:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>SUSE Linux Enterprise 15 (when available)</simpara>
</listitem>
<listitem>
<simpara>Temporarily (for testing only): 12 SP2, and 12 SP3</simpara>
</listitem>
<listitem>
<simpara>Not officially supported: openSUSE Leap 42.2, Leap 42.3, and openSUSE Tumbleweed</simpara>
</listitem>
</itemizedlist>
<simpara>RMT allows you to provision updates for all of your devices running a product based on SUSE Linux Enterprise
 12 SPx and later as well as openSUSE Leap.</simpara>
<formalpara>
<title>SMT</title>
<para>The predecessor of RMT and is no longer actively developed.
It runs on SUSE Linux Enterprise Server
 12 SPx and allows you to provision updates for products based on SUSE Linux Enterprise
 12 SPx and earlier.
You will still need it, if you want to update SUSE Linux Enterprise
 11 clients.</para>
</formalpara>
<section xml:id="rmtool">
<title>Repository Management Tool (RMT) and Disconnected Setup (DMZ)</title>
<simpara>The following procedure will guide you through using RMT.
It will work best with a dedicated RMT instance per SUSE Manager
.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: RMT: Fetching Repository Data from SUSE Customer Center</title>
<listitem>
<simpara>Configure RMT in the external network with SCC. For details about configuring RMT, see the official guide (when available).</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Preparation work:</simpara>
<simpara>Run <literal role="command">rmt-cli sync</literal> to download available products and repositories data for your organization from SCC.</simpara>
<simpara>Run <literal role="command">rmt-cli products list --all</literal> to see the list of products that are available for your organization.</simpara>
<simpara>Run <literal role="command">rmt-cli repos list --all</literal> to see the list of all repositories available.</simpara>
</listitem>
<listitem>
<simpara>With <literal role="command">rmt-cli repos enable</literal> enable repositories you want to mirror.</simpara>
</listitem>
<listitem>
<simpara>With <literal role="command">rmt-cli products enable</literal>enable products. For example, to enable SLES _15:</simpara>
<screen>rmt-cli product enable sles/15/x86_64</screen>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Using RMT, mirror all required repositories.</simpara>
</listitem>
<listitem>
<simpara>Get the required JSON responses from SCC and save them as files at the specified path (for example, <literal role="path">/mnt/usb</literal> ).</simpara>
<important>
<title>Write Permissions for RMT User</title>
<simpara>The directory being written to must be writeable for the same user as the rmt service.
The rmt user setting is defined in the <literal>cli</literal> section of <literal role="path">/etc/rmt.conf</literal>
.</simpara>
</important>
<simpara>Enter:</simpara>
<screen>{prompt.root}rmt-cli export data /mnt/usb</screen>
</listitem>
<listitem>
<simpara>Export settings about repositories to mirror to the specified path (in this case, <literal role="path">/mnt/usb</literal> ); this command will create a <literal role="path">repos.json</literal> file there:</simpara>
<screen>{prompt.root}rmt-cli export settings /mnt/usb</screen>
</listitem>
<listitem>
<simpara>Mirror the repositories according to the settings in the <literal role="path">repos.json</literal> file to the specified path (in this case, <literal role="path">/mnt/usb</literal> ).</simpara>
<screen>{prompt.root}rmt-cli export repos /mnt/usb</screen>
</listitem>
<listitem>
<simpara>Unmount the storage medium and carry it securely to your SUSE Manager server.</simpara>
</listitem>
</orderedlist>
<simpara>On the SUSE Manager
server, continue with <xref linkend="disconnect.mgr.update-repos"/>.</simpara>
</section>
<section xml:id="sub.mgr.tool">
<title>Repository Management Tool (SMT) and Disconnected Setup (DMZ)</title>
<simpara>The following procedure will guide you through using SMT.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: SMT: Fetching Repository Data from SUSE Customer Center</title>
<listitem>
<simpara>Configure SMT in the external network with SCC. For details about configuring SMT with SUSE Linux Enterprise 12, see <link xl:href="https://www.suse.com/documentation/sles-12/book_smt/data/book_smt.html">https://www.suse.com/documentation/sles-12/book_smt/data/book_smt.html</link>.</simpara>
</listitem>
<listitem>
<simpara>Using SMT, mirror all required repositories.</simpara>
</listitem>
<listitem>
<simpara>Create a <quote>database replacement file</quote> (for example, <literal role="path">/tmp/dbrepl.xml</literal> ).</simpara>
<screen>{prompt.root}smt-sync --createdbreplacementfile /tmp/dbrepl.xml</screen>
</listitem>
</orderedlist>
<orderedlist xml:id="pro.mgr.tool.mount.storage" numeration="arabic">
<listitem>
<simpara>Mount a removable storage medium such as an external hard disk or USB flash drive.</simpara>
</listitem>
<listitem>
<simpara>Export the data to the mounted medium:</simpara>
<screen>smt-sync --todir /media/disk/
smt-mirror --dbreplfile /tmp/dbrepl.xml --directory /media/disk \
           --fromlocalsmt -L /var/log/smt/smt-mirror-export.log</screen>
<important>
<title>Write Permissions for SMT User</title>
<simpara>The directory being written to must be writeable for the same user as the smt daemon (user=smt). The smt user setting is defined in <literal role="path">/etc/smt.conf</literal>
.
You can check if the correct user is specified via the following command:</simpara>
</important>
</listitem>
</orderedlist>
<screen>{prompt.root}egrep '^smtUser' /etc/smt.conf</screen>
<simpara>+</simpara>
<simpara>+
.Keeping the Disconnected Server Up-to-date
NOTE: <literal role="command">smt-sync</literal> also exports your subscription data.
To keep SUSE Manager
 up-to-date with your subscriptions, you must frequently import and export this data.</simpara>
<simpara>+</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Unmount the storage medium and carry it securely to your SUSE Manager server.</simpara>
</listitem>
</orderedlist>
<simpara>On the SUSE Manager
server, continue with <xref linkend="disconnect.mgr.update-repos"/>.</simpara>
</section>
<section xml:id="disconnect.mgr.update-repos">
<title>Updating Repositories on SUSE Manager From Storage Media</title>
<simpara>This procedure will show you how to update the repositories on the SUSE Manager
server from the storage media.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Updating the SUSE ManagerServer from the Storage Medium</title>
<listitem>
<simpara>Mount the storage medium on your SUSE Manager server (for example, at <literal role="path">/media/disk</literal> ).</simpara>
</listitem>
<listitem>
<simpara>Specify the local path on the SUSE Manager server in <literal>/etc/rhn/rhn.conf</literal>:</simpara>
<screen>server.susemanager.fromdir = /media/disk</screen>
<simpara>This setting is mandatory for SUSE Customer Center
and <literal role="command">mgr-sync</literal>.</simpara>
</listitem>
<listitem>
<simpara>Restart Tomcat:</simpara>
<screen>systemctl restart tomcat</screen>
</listitem>
</orderedlist>
<orderedlist xml:id="pro.mgr.tool.sync" numeration="arabic">
<listitem>
<simpara>Before performing another operation on the server execute a full sync:</simpara>
<screen>mgr-sync refresh   # SCC (fromdir in rhn.conf required!)</screen>
</listitem>
<listitem>
<simpara><literal role="command">mgr-sync</literal> can now be executed normally:</simpara>
<screen>mgr-sync list channels
mgr-sync add channel channel-label</screen>
<warning>
<title>Data Corruption</title>
<simpara>The disk must always be available at the same mount point.
To avoid data corruption, do not trigger a sync, if the storage medium is not mounted.
If you have already added a channel from a local repository path, you will not be able to change its URL to point to a different path afterwards.</simpara>
</warning>
</listitem>
</orderedlist>
<simpara>Up-to-date data is now available on your SUSE Manager
server and is ready for updating client systems.
According to your maintenance windows or update schedule refresh the data on the storage medium with RMT or SMT.</simpara>
</section>
<section xml:id="_refreshing_data_on_the_storage_medium">
<title>Refreshing Data on the Storage Medium</title>
<orderedlist numeration="arabic">
<title>Procedure: Refreshing Data on the Storage Medium from RMT or SMT</title>
<listitem>
<simpara>On your SUSE Manager server, unmount the storage medium and carry it to your RMT or SMT.</simpara>
</listitem>
<listitem>
<simpara>On your RMT or SMT system, continue with the synchronization step.</simpara>
<warning>
<title>Data Corruption</title>
<simpara>The storage medium must always be available at the same mount point.
To avoid data corruption, do not trigger a sync if the storage medium is not mounted.</simpara>
</warning>
</listitem>
</orderedlist>
<simpara>This concludes using RMT or SMT with SUSE Manager
.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="bp.expanded-support">
<title>Expanded Support</title>
<simpara>In the following sections find information about Red Hat, CentOS, and Ubuntu clients.</simpara>
<section xml:id="bp.expanded-support.resclients">
<title>Managing Red Hat Enterprise Linux Clients</title>
<simpara>The following sections provide guidance on managing Red Hat Expanded Support clients, this includes Salt minions and traditional systems.</simpara>
<section xml:id="bp.expanded-support.resclients.server">
<title>Server Configuration for Red Hat Enterprise Linux Channels</title>
<simpara>This section provides guidance on server configuration for Red Hat Enterprise Linux Channels provided by SUSE.</simpara>
<itemizedlist>
<listitem>
<simpara>Minimum of 8 GB RAM and at least two physical or virtual CPUs. Taskomatic will use one of these CPUs.</simpara>
</listitem>
<listitem>
<simpara>Taskomatic requires of minimum of 3072 MB RAM. This should be set in <literal role="path">/etc/rhn/rhn.conf</literal>:</simpara>
<screen>taskomatic.java.maxmemory=3072</screen>
</listitem>
<listitem>
<simpara>Provision enough disk space. <literal role="path">/var/spacewalk</literal> contains all mirrored RPMs. For example, Red Hat Enterprise Linux 6 x86_64 channels require 90 GB and more.</simpara>
</listitem>
<listitem>
<simpara>LVM or an NFS mount is recommended.</simpara>
</listitem>
<listitem>
<simpara>Access to RHEL 5/6/7 Subscription Media.</simpara>
</listitem>
</itemizedlist>
<warning>
<title>Access to RHEL Media or Repositories</title>
<simpara>Access to Red Hat base media repositories and RHEL installation media is the responsibility of the user.
Ensure that all your RHEL systems obtain support from RHEL or all your RHEL systems obtain support from SUSE.
If you do not follow these practices you may violate terms with Red Hat.</simpara>
</warning>
</section>
<section xml:id="bp.expanded-support.resclients.tips">
<title>Red Hat Enterprise Linux Channel Management Tips</title>
<simpara>This section provides tips on Red Hat Enterprise Linux channel management.</simpara>
<itemizedlist>
<listitem>
<simpara>The base parent distribution Red Hat Enterprise Linux channel per architecture contains zero packages. No base media is provided by SUSE. The RHEL media or installation ISOs should be added as child channels of the Red Hat Enterprise Linux parent channel.</simpara>
</listitem>
<listitem>
<simpara>The Red Hat Enterprise Linux and tools channels are provided by SUSE Customer Center (SCC) using <literal role="command">mgr-sync</literal>.</simpara>
</listitem>
<listitem>
<simpara>It can take up to 24 hours for an initial channel synchronization to complete.</simpara>
</listitem>
<listitem>
<simpara>When you have completed the initial synchronization process of any Red Hat Enterprise Linux channel it is recommended to clone the channel before working with it. This provides you with a backup of the original synchronization.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_mirroring_rhel_media_into_a_channel">
<title>Mirroring RHEL Media into a Channel</title>
<simpara>The following procedure guides you through setup of the RHEL media as a SUSE Manager channel.
All packages on the RHEL media will be mirrored into a child channel located under RES 5/6/7 distribution per architecture.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Mirroring RHEL Media into a Channel</title>
<listitem>
<simpara>Create a new Channel by log in to the Web UI and selecting <menuchoice><guimenu>Channels</guimenu> <guisubmenu>Manage Software Channels</guisubmenu> <guimenuitem>Create Channel</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>Fill in basic channel details and add the channel as a child to the corresponding RES 5/6/7 distribution channel per architecture from SCC. The base parent channel should contain zero packages.</simpara>
</listitem>
<listitem>
<simpara>Modify the RES 5/6/7 activation key to include this new child channel.</simpara>
</listitem>
<listitem>
<simpara>As root on the SUSE Manager command line copy the ISO to the <literal role="path">/tmp</literal> directory.</simpara>
</listitem>
<listitem>
<simpara>Create a directory to contain the media content:</simpara>
<screen>{prompt.root}mkdir -p /srv/www/htdocs/pub/rhel</screen>
</listitem>
<listitem>
<simpara>Mount the ISO:</simpara>
<screen>{prompt.root}mount -o loop /tmp/name_of_iso /srv/www/htdocs/pub/rhel</screen>
</listitem>
<listitem>
<simpara>Start <literal role="command">spacewalk-repo-sync</literal> to synchronize Red Hat Enterprise Linux 7 packages:</simpara>
<screen>{prompt.root}spacewalk-repo-sync -c channel_name -u https://127.0.0.1/pub/rhel/
Repo URL: https://127.0.0.1/pub/rhel/
Packages in repo:              [...]
Packages already synced:       [...]
Packages to sync:              [...]
[...]</screen>
<simpara>To synchronize RES 5/6 packages:</simpara>
<screen>{prompt.root}spacewalk-repo-sync -c channel_name -u https://127.0.0.1/pub/rhel/Server/
Repo URL: https://127.0.0.1/pub/rhel/Server/
Packages in repo:              [...]
Packages already synced:       [...]
Packages to sync:              [...]
[...]</screen>
</listitem>
<listitem>
<simpara>When the channel has completed the synchronization process you can use the channel as any normal SUSE Manager channel.</simpara>
</listitem>
</orderedlist>
<simpara>Attempting to synchronize the repository will sometimes fail with this error:</simpara>
<screen>[Errno 256] No more mirrors to try.</screen>
<simpara>To troubleshoot this error, look at the HTTP protocol to determine if <literal role="command">spacewalk-repo-sync</literal> is running:</simpara>
<orderedlist numeration="arabic">
<title>procedure: Debug spacewalk-repo-sync</title>
<listitem>
<simpara>Start debugging mode with <literal role="command">export URLGRABBER_DEBUG=DEBUG</literal></simpara>
</listitem>
<listitem>
<simpara>Check the output of <literal role="command">/usr/bin/spacewalk-repo-sync --channel <emphasis>&lt;channel-label&gt;</emphasis> --type yum</literal></simpara>
</listitem>
<listitem>
<simpara>If you want to disable debug mode, use <literal role="command">unset URLGRABBER_DEBUG</literal></simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_registering_res_salt_minions_with_suse_manager">
<title>Registering RES Salt Minions with SUSE Manager</title>
<simpara>This section will guide you through registering RHEL minions with SUSE Manager.</simpara>
<simpara>This section assumes you have updated your server to the latest patch level.</simpara>
<section xml:id="_synchronizing_appropriate_red_hat_enterprise_linux_channels">
<title>Synchronizing Appropriate Red Hat Enterprise Linux Channels</title>
<simpara>Ensure you have the corresponding Red Hat Enterprise Linux product enabled and required channels have been fully synchronized:</simpara>
<itemizedlist>
<title>RHEL 7.x</title>
<listitem>
<simpara>Product: Red Hat Enterprise Linux 7</simpara>
</listitem>
<listitem>
<simpara>Mandatory channels: <literal role="systemitem">rhel-x86_64-server-7</literal> , <literal role="systemitem">res7-suse-manager-tools-x86_64</literal> , <literal role="systemitem">res7-x86_64</literal> systemitem&gt;</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>RHEL 6.x</title>
<listitem>
<simpara>Product: Red Hat Enterprise Linux 6</simpara>
</listitem>
<listitem>
<simpara>Mandatory channels: <literal role="systemitem">rhel-x86_64-server-6</literal> , <literal role="systemitem">res6-suse-manager-tools-x86_64</literal> , <literal role="systemitem">res6-x86_64</literal></simpara>
</listitem>
</itemizedlist>
<tip>
<title>Checking Synchronization Progress</title>
<simpara>To check if a channel has finished synchronizing you can do one of the following:</simpara>
<itemizedlist>
<listitem>
<simpara>From the SUSE ManagerWeb UI browse to <menuchoice><guimenu>Admin</guimenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice> and select the <guimenu>SUSE Products</guimenu> tab. Here you will find a percent completion bar for each product.</simpara>
</listitem>
<listitem>
<simpara>Alternatively, you may check the synchronization log file located under <literal role="path">/var/log/rhn/reposync/channel-label.log</literal> using cat or the tailf command. Keep in mind that base channels can contain multiple child channels. Each of these child channels will generate its own log during the synchronization progress. Do not assume a channel has finished synchronizing until you have checked all relevant log files including base and child channels.</simpara>
</listitem>
</itemizedlist>
</tip>
<simpara>Create an activation key associated with the Red Hat Enterprise Linux channel.</simpara>
</section>
<section xml:id="_creating_a_bootstrap_repository">
<title>Creating a Bootstrap Repository</title>
<simpara>The following procedure demonstrate creating a bootstrap repository for RHEL:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>On the server command line as root, create a bootstrap repo for RHEL with the following command:</simpara>
<screen>mgr-create-bootstrap-repo RHEL_activation_channel_key</screen>
<simpara>If you use a dedicated channel per RHEL version, specify it with the <literal role="literal">--with-custom-channel</literal> option.</simpara>
</listitem>
<listitem>
<simpara>Rename <literal role="command">bootstrap.sh</literal> to <literal role="command">resversion-boostrap.sh</literal>:</simpara>
<screen>{prompt.root}cp bootstrap.sh res7-bootstrap.sh</screen>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="_register_a_salt_minion_via_bootstrap">
<title>Register a Salt Minion via Bootstrap</title>
<simpara>The following procedure will guide you through registering a Salt minion using the bootstrap script.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Registration Using the Bootstrap Script</title>
<listitem>
<simpara>For your new minion download the bootstrap script from the SUSE Manager server:</simpara>
<screen>wget --no-check-certificate https://`server`/pub/bootstrap/res7-bootstrap.sh</screen>
</listitem>
<listitem>
<simpara>Add the appropriate res-gpg-pubkey-<emphasis role="marked"><emphasis role="marked"></emphasis>-<emphasis role="marked"></emphasis></emphasis>.key to the <literal>ORG_GPG_KEY</literal> key parameter, comma delimited in your <literal role="command">res7-bootstrap.sh</literal> script. These are located on your SUSE Manager server at:</simpara>
<screen>http://`server`/pub/</screen>
</listitem>
<listitem>
<simpara>Make the <literal role="command">res7-bootstrap.sh</literal> script executable and run it. This will install necessary Salt packages from the bootstrap repository and start the Salt minion service:</simpara>
<screen>{prompt.root}chmod +x res7-bootstrap.sh{prompt.root}./res7-boostrap.sh</screen>
</listitem>
<listitem>
<simpara>From the SUSE Manager Web UI select <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Keys</guimenuitem></menuchoice> and accept the new minion&#8217;s key.</simpara>
</listitem>
</orderedlist>
<important>
<title>Troubleshooting Bootstrap</title>
<simpara>If bootstrapping a minion fails it is usually caused by missing packages.
These missing packages are contained on the RHEL installation media.
The RHEL installation media should be loop mounted and added as a child channel to the Red Hat Enterprise Linux channel.
See the warning in <xref linkend="bp.expanded-support.resclients"/> on access to RHEL Media.</simpara>
</important>
</section>
<section xml:id="_manual_salt_minion_registration">
<title>Manual Salt Minion Registration</title>
<simpara>The following procedure will guide you through the registration of a Salt minion manually.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Add the bootstrap repository:</simpara>
<screen>yum-config-manager --add-repo https://`server`/pub/repositories/res/7/bootstrap</screen>
</listitem>
<listitem>
<simpara>Install the <phrase role="package">salt-minion</phrase> package:</simpara>
<screen>{prompt.root}yum install salt-minion</screen>
</listitem>
<listitem>
<simpara>Edit the Salt minion configuration file to point to the SUSE Manager server:</simpara>
<screen>{prompt.root}mkdir /etc/salt/minion.d{prompt.root}echo "master:`server_fqdn`" &gt; /etc/salt/minion.d/susemanager.conf</screen>
</listitem>
<listitem>
<simpara>Start the minion service:</simpara>
<screen>{prompt.root}systemctl start salt-minion</screen>
</listitem>
<listitem>
<simpara>From the SUSE Manager Web UI select the <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Keys</guimenuitem></menuchoice> and accept the new minion&#8217;s key.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="bp.expanded-support.centos_repos.trad">
<title>Preparing Channels and Repositories for CentOS Traditional Clients</title>
<simpara>This following section provides an example procedure for configuring CentOS channels and repositories and finally registering a CentOS client with SUSE Manager.</simpara>
<simpara>These steps will be identical for Scientific Linux and Fedora.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Preparing Channels and Repositories</title>
<listitem>
<simpara>As root install <phrase role="package">spacewalk-utils</phrase> on your SUSE Manager server:</simpara>
<screen>zypper in spacewalk-utils</screen>
<important>
<title>Supported Tools</title>
<simpara>The <phrase role="package">spacewalk-utils</phrase> package contains a collection of upstream command line tools which provide assistance with spacewalk administrative operations.
You will be using the <literal role="command">spacewalk-common-channels</literal> tool.
Keep in mind SUSE only provides support for <literal role="command">spacewalk-clone-by-date</literal> and <literal role="command">spacewalk-manage-channel-lifecycle</literal> tools.</simpara>
</important>
</listitem>
<listitem>
<simpara>Run the <literal role="command">spacewalk-common-channels</literal> script to add the CentOS7 base, updates, and Spacewalk client channels.</simpara>
<screen>{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'centos7'{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'centos7-updates'{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'spacewalk26-client-centos7'</screen>
<note>
<title>Required Channel References</title>
<simpara>The <literal role="path">/etc/rhn/spacewalk-common-channels.ini</literal> must contain the channel references to be added.
If a channel is not listed, check the latest version here for updates: <link xl:href="https://github.com/spacewalkproject/spacewalk/tree/master/utils">https://github.com/spacewalkproject/spacewalk/tree/master/utils</link></simpara>
</note>
</listitem>
<listitem>
<simpara>From the Web UI select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>Manage Software Channels</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>. Select the base channel you want to synchronize, in this case <literal>CentOS7 (x86_64)</literal>. Select <menuchoice><guimenu>Repositories</guimenu> <guimenuitem>Sync</guimenuitem></menuchoice>. Check the channels you want to synchronize and then click the <guibutton>Sync Now</guibutton> button or, optionally, schedule a regular synchronization time.</simpara>
</listitem>
<listitem>
<simpara>Copy all relevant GPG keys to <literal role="path">/srv/www/htdocs/pub</literal>. Depending on what distribution you are interested in managing these could include an EPEL key, SUSE keys, Red Hat keys, and CentOS keys. After copying these you can reference them in a comma-delimited list within your bootstrap script (see <xref linkend="proc.bp.expanded-support.centos-repos.trad.bsscript"/>).</simpara>
<itemizedlist>
<listitem>
<simpara>CentOS7 key files: <link xl:href="http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7">http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7</link></simpara>
</listitem>
<listitem>
<simpara>EPEL key file: <link xl:href="http://mirrors.kernel.org/fedora-epel/RPM-GPG-KEY-EPEL-7">http://mirrors.kernel.org/fedora-epel/RPM-GPG-KEY-EPEL-7</link></simpara>
</listitem>
<listitem>
<simpara>Spacewalk key: <link xl:href="http://spacewalk.redhat.com/yum/RPM-GPG-KEY-spacewalk-2015">http://spacewalk.redhat.com/yum/RPM-GPG-KEY-spacewalk-2015</link></simpara>
</listitem>
<listitem>
<simpara>Red Hat keys: <link xl:href="http://www.redhat.com/contact/security-response-team/gpg-keys.html">http://www.redhat.com/contact/security-response-team/gpg-keys.html</link></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Install and setup a CentOS 7 client with the default installation packages.</simpara>
</listitem>
<listitem>
<simpara>Ensure the client machine can resolve itself and your SUSE Manager server via DNS. Validate that there is an entry in <literal role="path">/etc/hosts</literal> for the real IP address of the client.</simpara>
</listitem>
<listitem>
<simpara>Create an activation key (<literal>centos7</literal>) on the SUSE Manager server that points to the correct parent/child channels, including the CentOS base repo, updates, and Spacewalk client.</simpara>
</listitem>
</orderedlist>
<simpara>Now prepare the bootstrap script.</simpara>
<orderedlist xml:id="proc.bp.expanded-support.centos-repos.trad.bsscript" numeration="arabic">
<title>Procedure: Preparing the Bootstrap Script</title>
<listitem>
<simpara>Create/edit your bootstrap script to correctly reflect the following:</simpara>
<screen># can be edited, but probably correct (unless created during initial install):

# NOTE: ACTIVATION_KEYS *must* be used to bootstrap a client machine.

ACTIVATION_KEYS=1-centos7

ORG_GPG_KEY=res.key,RPM-GPG-KEY-CentOS-7,suse-307E3D54.key,suse-9C800ACA.key,RPM-GPG-KEY-spacewalk-2015

FULLY_UPDATE_THIS_BOX=0

yum clean all
# Install the prerequisites
yum -y install yum-rhn-plugin rhn-setup</screen>
</listitem>
<listitem>
<simpara>Add the following lines to the bottom of your script, (just before <literal>echo <quote>-bootstrap complete -</quote></literal>):</simpara>
<screen># This section is for commands to be executed after registration
mv /etc/yum.repos.d/Cent* /root/
yum clean all
chkconfig rhnsd on
chkconfig osad on
service rhnsd restart
service osad restart</screen>
</listitem>
<listitem>
<simpara>Continue by following normal bootstrap procedures to bootstrap the new client.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.expanded-support.centos_salt">
<title>Registering CentOS Salt Minions with SUSE Manager</title>
<simpara>The following procedure will guide you through registering a CentOS Minion.</simpara>
<warning>
<title>Support for CentOS Patches</title>
<simpara>CentOS uses patches originating from CentOS is not officially supported by SUSE
.
See the matrix of SUSE Manager clients on the main page of the SUSE Manager wiki, linked from the <emphasis><phrase role="ref">Quick Links</phrase></emphasis> section: <link xl:href="https://wiki.microfocus.com/index.php?title=SUSE_Manager">https://wiki.microfocus.com/index.php?title=SUSE_Manager</link></simpara>
</warning>
<orderedlist numeration="arabic">
<title>Procedure: Register a CentOS 7 Minion</title>
<listitem>
<simpara>Add the Open Build Service repo for Salt:</simpara>
<screen>{prompt.root}yum-config-manager --add-repo http://download.opensuse.org/repositories/systemsmanagement:/saltstack:/products/RHEL_7/</screen>
</listitem>
<listitem>
<simpara>Import the repo key:</simpara>
<screen>{prompt.root}rpm --import http://download.opensuse.org/repositories/systemsmanagement:/saltstack:/products/RHEL_7/repodata/repomd.xml.key</screen>
</listitem>
<listitem>
<simpara>Check if there is a different repository that contains Salt. If there is more than one repository listed disable the repository that contains Salt apart from the OBS one.</simpara>
<screen>{prompt.root}yum list --showduplicates salt</screen>
</listitem>
<listitem>
<simpara>Install the Salt minion:</simpara>
<screen>{prompt.root}yum install salt salt-minion</screen>
</listitem>
<listitem>
<simpara>Change the Salt configuration to point to the SUSE Manager server:</simpara>
<screen>{prompt.root}mkdir -p /etc/salt/minion.d{prompt.root}echo "master:`server_fqdn`" &gt; /etc/salt/minion.d/susemanager.conf</screen>
</listitem>
<listitem>
<simpara>Restart the minion</simpara>
<screen>{prompt.root}systemctl restart salt-minion</screen>
</listitem>
<listitem>
<simpara>Proceed to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Salt</guisubmenu> <guimenuitem>Keys</guimenuitem></menuchoice> from the Web UI and accept the minion&#8217;s key.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.expanded-support.ubuntu">
<title>Managing Ubuntu Clients</title>
<simpara>Support for Ubuntu Clients was added in SUSE Manager 3.2.
Currently, Salt minions running Ubuntu 16.04 LTS and 18.04 LTS are supported.</simpara>
<note>
<simpara>Ubuntu clients must be Salt minions.
Traditional clients are not supported.</simpara>
</note>
<simpara>Bootstrapping is supported for starting Ubuntu clients and performing initial state runs such as setting repositories and performing profile updates.
However, the root user on Ubuntu is disabled by default, so in order to use bootstrapping, you will require an existing user with <literal role="command">sudo</literal> privileges for Python.</simpara>
<simpara>Other supported features:</simpara>
<itemizedlist>
<listitem>
<simpara>Synchronizing <literal role="systemitem">.deb</literal> channels</simpara>
</listitem>
<listitem>
<simpara>Assigning <literal role="systemitem">.deb</literal> channels to minions</simpara>
</listitem>
<listitem>
<simpara>GPG signing <literal role="systemitem">.deb</literal> repositories</simpara>
</listitem>
<listitem>
<simpara>Information displayed in System details pages</simpara>
</listitem>
<listitem>
<simpara>Package install, update, and remove</simpara>
</listitem>
<listitem>
<simpara>Package install using <literal role="systemitem">Package States</literal></simpara>
</listitem>
<listitem>
<simpara>Configuration and state channels</simpara>
</listitem>
</itemizedlist>
<simpara>Some actions are not yet supported:</simpara>
<itemizedlist>
<listitem>
<simpara>Patch and errata support</simpara>
</listitem>
<listitem>
<simpara>Bare metal installations, PXE booting, and virtual host provisioning</simpara>
</listitem>
<listitem>
<simpara>Live patching</simpara>
</listitem>
<listitem>
<simpara>CVE Audit</simpara>
</listitem>
<listitem>
<simpara>If you use are using a repository from storage media (<literal>server.susemanager.fromdir = &#8230;&#8203;</literal> option in rhn.conf), Ubuntu Client Tools will not work.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_prepare_to_register_ubuntu_clients">
<title>Prepare to Register Ubuntu Clients</title>
<simpara>Some preparation is required before you can register Ubuntu clients to SUSE Manager Server.</simpara>
<simpara>Before you begin, ensure you have the Ubuntu product enabled, and have synchronized the Ubuntu channels:</simpara>
<simpara>For Ubuntu 18.04:</simpara>
<itemizedlist>
<listitem>
<simpara>Product: Ubuntu Client 18.04</simpara>
</listitem>
<listitem>
<simpara>Mandatory channels: <literal role="systemitem">ubuntu-18.04-pool-amd64</literal></simpara>
</listitem>
</itemizedlist>
<simpara>For Ubuntu 16.04:</simpara>
<itemizedlist>
<listitem>
<simpara>Product: Ubuntu Client 16.04</simpara>
</listitem>
<listitem>
<simpara>Mandatory channels: <literal role="systemitem">ubuntu-16.04-pool-amd64</literal></simpara>
</listitem>
</itemizedlist>
<note>
<simpara>The mandatory channels do not contain Ubuntu upstream packages.
The repositories and channels for synchronizing upstream content must be configured manually.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Preparing to Register Ubuntu Clients</title>
<listitem>
<simpara>Ensure that you have the appropriate software channels available on your system.
In the SUSE Manager Web UI, navigate to <menuchoice><guimenu>Software</guimenu> <guisubmenu>Channel List</guisubmenu> <guimenuitem>All</guimenuitem></menuchoice>.
You should see a base channel and a child channel for your architecture, for example:</simpara>
<screen> ubuntu-18.04-pool for amd64
 |
 +- Ubuntu-18.04-SUSE-Manager-Tools for amd64</screen>
</listitem>
<listitem>
<simpara>Create custom repositories to mirror the Ubuntu packages.
For example:</simpara>
<simpara>For <literal>main</literal>:</simpara>
<itemizedlist>
<listitem>
<simpara>Repository Label: ubuntu-bionic-main</simpara>
</listitem>
<listitem>
<simpara>Repository URL: <link xl:href="http://ubuntumirror.example.com/ubuntu/dists/bionic/main/binary-amd64/">http://ubuntumirror.example.com/ubuntu/dists/bionic/main/binary-amd64/</link></simpara>
</listitem>
<listitem>
<simpara>Repository Type: deb</simpara>
<simpara>For <literal>main-updates</literal>:</simpara>
</listitem>
<listitem>
<simpara>Repository Label: ubuntu-bionic-main-updates</simpara>
</listitem>
<listitem>
<simpara>Repository URL: <link xl:href="http://ubuntumirror.example.com/ubuntu/dists/bionic-updates/main/binary-amd64/">http://ubuntumirror.example.com/ubuntu/dists/bionic-updates/main/binary-amd64/</link></simpara>
</listitem>
<listitem>
<simpara>Repository Type: deb</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Create custom channels under the <literal>pool</literal> channel, mirroring the vendor channels.
Ensure the custom channels you create have <literal>AMD64 Debian</literal> architecture.</simpara>
<simpara>For example:</simpara>
<screen> ubuntu-18.04-pool for amd64 (vendor channel)
 |
 +- Ubuntu-18.04-SUSE-Manager-Tools for amd64 (vendor channel)
 |
 +- ubuntu-18.04-amd64-main (custom channel)
 |
 +- ubuntu-18.04-amd64-main-updates (custom channel)</screen>
</listitem>
<listitem>
<simpara>Associate the custom channels with the appropriate custom repositories.</simpara>
</listitem>
<listitem>
<simpara>Synchronize the new custom channels.
You can check the progress of your synchronization from the command line with this command:</simpara>
</listitem>
</orderedlist>
<screen>tail -f /var/log/rhn/reposync.log /var/log/rhn/reposync/*</screen>
<orderedlist numeration="arabic">
<listitem>
<simpara>To use bootstrap with Ubuntu, you will need to create a bootstrap repository.
You can  do this from the command line with <literal role="command">mgr-create-bootstrap-repo</literal>:</simpara>
<screen>mgr-create-bootstrap-repo --with-custom-channels</screen>
</listitem>
</orderedlist>
<simpara>The root user on Ubuntu is disabled by default.
You can enable it by editing the <literal role="filename">sudoers</literal> file.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Granting Root User Access</title>
<listitem>
<simpara>On the client, edit the <literal role="filename">sudoers</literal> file:</simpara>
<screen>sudo visudo</screen>
<simpara>Grant <literal role="command">sudo</literal> access to the user by adding this line to the <literal role="filename">sudoers</literal> file. Replace <literal role="systemitem">&lt;user&gt;</literal> with the name of the user that will be used to bootsrap the client in the Web UI:</simpara>
<screen>&lt;user&gt;   ALL=NOPASSWD: /usr/bin/python, /usr/bin/python2, /usr/bin/python3</screen>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="best.practice.salt.formulas.and.forms">
<title>Salt Formulas and SUSE Manager</title>
<simpara>This chapter provides an introduction for using Salt Formulas with SUSE Manager.
Creation of custom formulas will also be introduced.</simpara>
<section xml:id="best.practice.salt.formulas.what">
<title>What are Salt Formulas?</title>
<simpara>Formulas are collections of Salt States that have been pre-written by other Salt users and contain generic parameter fields.
Formulas allow for reliable reproduction of a specific configuration again and again.
Formulas can be installed from RPM packages or an external git repository.</simpara>
<simpara>This list will help you decide whether to use a state or a formula:</simpara>
<itemizedlist>
<title>Formula Tips</title>
<listitem>
<simpara>When writing states for trivial tasks, formulas are probably not worth the time investment.</simpara>
</listitem>
<listitem>
<simpara>For large, non-trivial configurations use formulas.</simpara>
</listitem>
<listitem>
<simpara>Formulas and States both act as a kind of configuration documentation.
Once written and stored you will have a snapshot of what your infrastructure should look like.</simpara>
</listitem>
<listitem>
<simpara>Pre-written formulas are available from the <link xl:href="https://github.com/saltstack-formulas">Saltstack formula repository on Github</link>.
Use these as a starting point for your own custom formulas.</simpara>
</listitem>
<listitem>
<simpara>Formula data can be managed via the XMLRPC API.</simpara>
</listitem>
</itemizedlist>
<note>
<title>Formula with Forms Improvements</title>
<simpara>Forms are a graphical representation of the formulas parameter data.
You can customize these configuration data in the SUSE Manager Web UI, with entry fields, drop-down, check boxes, etc.</simpara>
<simpara>For more information, see <link xl:href="https://www.suse.com/c/forms-formula-success/">https://www.suse.com/c/forms-formula-success/</link>.</simpara>
</note>
</section>
<section xml:id="best.practice.salt.formulas.install">
<title>Installing Salt Formulas via RPM</title>
<simpara>SUSE releases formulas as RPM packages.</simpara>
<note>
<title>Formula Channel Location</title>
<simpara>Available formulas can be located within the <literal role="systemitem">SUSE-Manager-Server-3.2-Pool</literal> channel.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Installing Salt Formulas from an RPM</title>
<listitem>
<simpara>To search for available formulas, execute the following command on your SUSE Manager server:</simpara>
<screen>zypper se --type package formula</screen>
<simpara>You will see a list of available Salt formulas:</simpara>
<screen>S | Name              | Summary                                                    | Type
--+-------------------+------------------------------------------------------------+-----------
  | locale-formula    | Locale Salt Formula for SUSE Manager                       | package</screen>
</listitem>
<listitem>
<simpara>For more information about a formula, run the following command:</simpara>
<screen>zypper info locale-formula</screen>
<screen>Information for package locale-formula:
-----------------------------------------
Repository: SUSE-Manager-Server-{productnumber}-Pool
Name:  locale-formula
Version:  0.2-1.1
Arch: noarch
Vendor:  SUSE LLC &lt;https://www.suse.com/&gt;
Support Level: Level 3
Status: not installed
Installed Size: 47.9 KiB
Installed: No
Source package : locale-formula-0.2-1.1.src
Summary        : Locale Salt Formula for SUSE Manager
Description    :
    Salt Formula for SUSE Manager. Sets up the locale.</screen>
</listitem>
<listitem>
<simpara>To install a formula run as root:</simpara>
<screen>zypper in locale-formula</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="best.practice.salt.formulas.filedir">
<title>File Structure Overview</title>
<simpara>RPM-based formulas must be placed in a specific directory structure to ensure proper functionality.
A formula always consists of two separate directories: The <literal role="path">states</literal> directory and the <literal role="path">metadata</literal> directory.
Folders in these directories need to have an exactly matching name, for example <literal>locale</literal>.</simpara>
<variablelist>
<varlistentry>
<term>The Formula State Directory</term>
<listitem>
<simpara>The formula states directory contains anything necessary for a Salt state to work independently.
This includes <literal role="path">.sls</literal> files, a <literal role="path">map.jinja</literal> file and any other required files.
This directory should only be modified by RPMs and should not be edited manually.
For example, the <phrase role="package">locale-formula</phrase> states directory is located in:</simpara>
<screen>/usr/share/susemanager/formulas/states/locale/</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>The Formula Metadata Directory</term>
<listitem>
<simpara>The metadata directory contains a <literal role="path">form.yml</literal> file which defines the forms for SUSE Manager and an optional <literal role="path">metadata.yml</literal> file that can contain additional information about a formula.
For example, the <phrase role="package">locale-formula</phrase> metadata directory is located in:</simpara>
<screen>/usr/share/susemanager/formulas/metadata/locale/</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Custom Formulas</term>
<listitem>
<simpara>Custom formula data or (non-RPM) formulas need to be placed into any state directory configured as a Salt file root:</simpara>
<variablelist>
<varlistentry>
<term>State directory</term>
<listitem>
<simpara>Custom state formula data need to be placed in:</simpara>
<screen>/srv/salt/custom/</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Metadata Directory</term>
<listitem>
<simpara>Custom metadata (information) need to be placed in:</simpara>
<screen>/srv/formula_metadata/custom/</screen>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
<simpara>All custom folders located in the following directories need to contain a <literal role="path">form.yml</literal> file.
These files are detected as form recipes and may be applied to groups and systems from the Web UI:</simpara>
<screen>/srv/formula_metadata/&lt;custom-formula-name&gt;/form.yml</screen>
</section>
<section xml:id="best.practice.salt.formulas.pillar">
<title>Editing Pillar Data in SUSE Manager</title>
<simpara>SUSE Manager requires a file called <literal role="path">form.yml</literal>, to describe how formula data should look within the Web UI.
<literal role="path">form.yml</literal> is used by SUSE Manager to generate the desired form, with values editable by a user.</simpara>
<simpara>For example, the <literal role="path">form.yml</literal> that is included with the <phrase role="package">locale-formula</phrase> is placed in:</simpara>
<screen>/usr/share/susemanager/formulas/metadata/locale/form.yml</screen>
<simpara>See part of the following <phrase role="package">locale-formula</phrase> example:</simpara>
<screen># This file is part of locale-formula.
#
# Foobar is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Foobar is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Foobar.  If not, see &lt;http://www.gnu.org/licenses/&gt;.

timezone:
  $type: group

  name:
    $type: select
    $values: ["CET",
              "CST6CDT",
              "EET",
              "EST",
              "EST5EDT",
              "GMT",
              "GMT+0",
              "GMT-0",
              "GMT0",
              "Greenwich",
              "HST",
              "MET",
              "MST",
              "MST7MDT",
              "NZ",
              "NZ-CHAT",
              "Navajo",
              "PST8PDT",
              "UCT",
              "UTC",
              "Universal",
              "W-SU",
              "WET",
              "Zulu",
              "Etc/GMT+1",
              "Etc/GMT+2",
              "Etc/GMT+3",
              "Etc/GMT+4",
              "Etc/GMT+5",
              "Etc/GMT+6",
              "Etc/GMT+7",
              "Etc/GMT+8",
              "Etc/GMT+9",
              "Etc/GMT+10",
              "Etc/GMT+11",
              "Etc/GMT+12",
              "Etc/GMT-1",
              "Etc/GMT-2",
              "Etc/GMT-3",
              "Etc/GMT-4",
              "Etc/GMT-5",
              "Etc/GMT-6",
              "Etc/GMT-7",
              "Etc/GMT-8",
              "Etc/GMT-9",
              "Etc/GMT-10",
              "Etc/GMT-11",
              "Etc/GMT-12",
              "Etc/GMT-13",
              "Etc/GMT-14",
              "Etc/GMT",
              "Etc/GMT+0",
              "Etc/GMT-0",
              "Etc/GMT0",
              "Etc/Greenwich",
              "Etc/UCT",
              "Etc/UTC",
              "Etc/Universal",
              "Etc/Zulu"
              ]
    $default: CET

  hardware_clock_set_to_utc:
    $type: boolean
    $default: True
...</screen>
<simpara><literal role="path">form.yml</literal> contains additional information that describes how the form for a pillar should look for SUSE Manager.
This information is contained in attributes that always start with a <literal>$</literal> sign.</simpara>
<important>
<title>Ignored Values</title>
<simpara>All values that start with a <literal>$</literal> sign are annotations used to display the UI that users interact with.
These annotations are not part of pillar data itself and are handled as metadata.</simpara>
</important>
<simpara>The following are valid attributes.</simpara>
<variablelist>
<varlistentry>
<term>$type</term>
<listitem>
<simpara>The most important attribute is the <literal>$type</literal> attribute.
It defines the type of the pillar value and the form-field that is generated.
The following represent the supported types:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>text</literal></simpara>
</listitem>
<listitem>
<simpara><literal>password</literal></simpara>
</listitem>
<listitem>
<simpara><literal>number</literal></simpara>
</listitem>
<listitem>
<simpara><literal>url</literal></simpara>
</listitem>
<listitem>
<simpara><literal>email</literal></simpara>
</listitem>
<listitem>
<simpara><literal>date</literal></simpara>
</listitem>
<listitem>
<simpara><literal>time</literal></simpara>
</listitem>
<listitem>
<simpara><literal>datetime</literal></simpara>
</listitem>
<listitem>
<simpara><literal>boolean</literal></simpara>
</listitem>
<listitem>
<simpara><literal>color</literal></simpara>
</listitem>
<listitem>
<simpara><literal>select</literal></simpara>
</listitem>
<listitem>
<simpara><literal>group</literal></simpara>
</listitem>
<listitem>
<simpara><literal>edit-group</literal></simpara>
</listitem>
<listitem>
<simpara><literal>namespace</literal></simpara>
</listitem>
<listitem>
<simpara><literal>hidden-group</literal> (obsolete, renamed to <literal>namespace</literal>)</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<note>
<title>Text Attribute</title>
<simpara>The text attribute is the default and does not need to be specified explicitly.</simpara>
</note>
<simpara>Many of these values are self-explanatory:</simpara>
<itemizedlist>
<listitem>
<simpara>The <literal>text</literal> type generates a simple text field</simpara>
</listitem>
<listitem>
<simpara>The <literal>password</literal> type generates a password field</simpara>
</listitem>
<listitem>
<simpara>The <literal>color</literal> type generates a color picker</simpara>
</listitem>
</itemizedlist>
<simpara>The <literal>group</literal>, <literal>edit-group</literal>, and <literal>namespace</literal> (formerly <literal>hidden-group</literal>) types do not generate an editable field and are used to structure form and pillar data.
The difference between <literal>group</literal> and <literal>namespace</literal> is <literal>group</literal> generates a visible border with a heading, and <literal>namespace</literal> shows nothing visually (and is only used to structure pillar data).
The difference between <literal>group</literal> and <literal>edit-group</literal> is: <literal>edit-group</literal> allows to structure and restrict editable fields in a more flexible way.
<literal>edit-group</literal> is a collection of items of the same kind; collections can have the following four "shapes":</simpara>
<itemizedlist>
<listitem>
<simpara>A list of primitive items</simpara>
</listitem>
<listitem>
<simpara>A list of dictionaries</simpara>
</listitem>
<listitem>
<simpara>A dictionary of primitive items</simpara>
</listitem>
<listitem>
<simpara>A dictionary of dictionaries</simpara>
</listitem>
</itemizedlist>
<simpara>The size of each collection is variable; users can add or remove elements.</simpara>
<simpara>For example, <literal>edit-group</literal> supports the <literal>$minItems</literal> and <literal>$maxItems</literal> attributes, and thus it simplifies complex and repeatable input structures.
These, and also <literal>itemName</literal>, are optional.
For an <literal>edit-group</literal> example, see <xref linkend="salt.formulas.ex.edit-group"/>.</simpara>
<variablelist>
<varlistentry>
<term>$default</term>
<listitem>
<simpara><literal>$default</literal> allows you to specify a default value that is displayed and used, if no other value is entered.
In an <literal>edit-group</literal> it allows to create initial members of the group and populate them with specified data.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$optional</term>
<listitem>
<simpara><literal>$optional</literal> is a boolean attribute.
If it is <literal>true</literal> and the field is empty in the form, then this field will not be generated in the formula data and the generated dictionary will not contain the field name key.
If <literal>$optional</literal> is <literal>false</literal> and the field is empty, the formula data will contain a <literal>&lt;field name&gt;: null</literal> entry.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$ifEmpty</term>
<listitem>
<simpara>The value to be used if the field is empty (because the user did not input
any value).
<literal>ifEmpty</literal> can only be used when <literal>$optional</literal> is <literal>false</literal> or not defined at all!
If <literal>$optional</literal> is <literal>true</literal>, then <literal>$ifEmpty</literal> is ignored.
In the following example, the <literal>DP2</literal> string would be used if user leaves the field empty:</simpara>
<screen>displayName:
  $type: string
  $ifEmpty: DP2</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>$name</term>
<listitem>
<simpara><literal>$name</literal> allows you to specify the name of a value that is shown in the form.
If this value is not set, the pillar name is used and capitalized without underscores and dashes.
You reference it in the same section with <literal>${name}</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$help and $placeholder</term>
<listitem>
<simpara>The <literal>$help</literal> and <literal>$placeholder</literal> attributes are used to give a user a better understanding of what the value should be.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>$help</literal> defines the message a user sees when hovering over a field</simpara>
</listitem>
<listitem>
<simpara><literal>$placeholder</literal> displays a gray placeholder text in the field</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<simpara><literal>$placeholder</literal> may only be used with text fields like text, password, email or date.
It does not make sense to add a placeholder if you also use <literal>$default</literal> as this will hide the placeholder.</simpara>
<variablelist>
<varlistentry>
<term>$key</term>
<listitem>
<simpara><literal>$key</literal> is applicable if the <literal>edit-group</literal> has the "shape" of a dictionary; you use it when the pillar data is supposed to be a dictionary.
The <literal>$key</literal> attribute then determines the key of an entry in the dictionary.
Example:</simpara>
<screen>user_passwords:
  $type: edit-group
  $minItems: 1
  $prototype:
    $key:
        $type: text
    $type: text
  $default:
    alice: secret-password
    bob: you-shall-not-pass</screen>
<simpara>Pillar:</simpara>
<screen>user_passwords:
  alice:
    secret-password
  bob:
    you-shall-not-pass</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>$minItems and $maxItems</term>
<listitem>
<simpara>In an <literal>edit-group</literal>, <literal>$minItems</literal> and <literal>$maxItems</literal> allow you to specify the lowest and highest number the group can occur.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$itemName</term>
<listitem>
<simpara>In an <literal>edit-group</literal>, <literal>$itemName</literal> allows you to define a template for the name to be used for the members of the group.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$prototype</term>
<listitem>
<simpara>In an <literal>edit-group</literal>, <literal>$prototype</literal> is mandatory and allows to define default (or pre-filled) values for newly added members in the group.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$scope</term>
<listitem>
<simpara><literal>$scope</literal> allows you to specify a hierarchy level at which a value may be edited.
Possible values are <literal>system</literal>, <literal>group</literal>, and <literal>readonly</literal>.</simpara>
<simpara>The default <literal>$scope: system</literal> allows values to be edited at group and system levels.
A value can be entered for each system but if no value is entered the system will fall back to the group default.</simpara>
<simpara>If using <literal>$scope: group</literal>, a value may only be edited for a group.
On the system level you will be able to see the value, but not edit it.</simpara>
<simpara>The <literal>$scope: readonly</literal> option makes a field read-only.
It can be used to show a user data which should be known, but should not be editable.
This option only makes sense in combination with the <literal>$default</literal> attribute.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>$visibleIf</term>
<listitem>
<simpara><literal>$visibleIf</literal> allows you to show a field or group if a simple condition is met.
A condition always looks similar to the following example:</simpara>
<screen>some_group#another_group#my_checkbox == true</screen>
<simpara>The left part of the above statement is the path to another value, and groups are separated by <literal>$</literal> signs.
The middle section of the command should be either <literal>==</literal> for a value to be equal or <literal>!=</literal> for values that should be not equal.
The last field in the statement can be any value which a field should have or not have.</simpara>
<simpara>The field with this attribute associated with it will now be shown only when the condition is met.
In this example the field will be shown only if <literal>my_checkbox</literal> is checked.
The ability to use conditional statements is not limited to check boxes.
It may also be used to check values of select-fields, text-fields, etc.</simpara>
<simpara>A check box should be structured like the following example:</simpara>
<screen>some_group:
  $type: group

  another_group:
    $type: group

      my_checkbox:
        $type: boolean</screen>
<simpara>Relative paths can be specified using prefix dots. One dot means sibling, 2 dots mean parent, etc. This is mostly useful for <literal>edit-group</literal>.</simpara>
<screen>some_group:
  $type: group

  another_group:
    $type: group

    my_checkbox:
      $type: boolean

    my_text:
      $visibleIf: .my_checkbox

  yet_another_group:
    $type: group

    my_text2:
      $visibleIf: ..another_group#my_checkbox</screen>
<simpara>By using multiple groups with the attribute, you can allow a user to select an option and show a completely different form, dependent upon the selected value.</simpara>
<simpara>Values from hidden fields may be merged into the pillar data and sent to the minion.
A formula must check the condition again and use the appropriate data.
For example:</simpara>
<screen>show_option:
  $type: checkbox
some_text:
  $visibleIf: show_option == true</screen>
<screen>{% if pillar.show_option %}
do_something:
  with: {{ pillar.some_text }}
{% endif %}</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>$values</term>
<listitem>
<simpara><literal>$values</literal> can only be used together with <literal>$type</literal>: select to specify the different options in the select-field.
<literal>$values</literal> must be a list of possible values to select.
For example:</simpara>
<screen>select_something:
  $type: select
  $values: ["option1", "option2"]</screen>
<simpara>Or alternatively:</simpara>
<screen>select_something:
  $type: select
  $values:
    - option1
    - option2</screen>
</listitem>
</varlistentry>
</variablelist>
<section xml:id="salt.formulas.ex.edit-group">
<title>Simple edit-group Example</title>
<simpara>See the following <emphasis role="strong">edit-group</emphasis> example:</simpara>
<screen>partitions:
  $name: "Hard Disk Partitions"
  $type: "edit-group"
  $minItems: 1
  $maxItems: 4
  $itemName: "Partition ${name}"
  $prototype:
    name:
      $default: "New partition"
    mountpoint:
      $default: "/var"
    size:
      $type: "number"
      $name: "Size in GB"
  $default:
    - name: "Boot"
      mountpoint: "/boot"
    - name: "Root"
      mountpoint: "/"
      size: 5000</screen>
<simpara>After clicking <guibutton>Add</guibutton> for one time you will see <xref linkend="fig-formula-custom-harddisk-partitions"/> filled with the default values.
The formula itself is called <literal role="path">hd-partitions</literal> and will appear as <literal role="guimenu">Hd Partitions</literal> in the Web UI.</simpara>
<figure xml:id="fig-formula-custom-harddisk-partitions">
<title><literal>edit-group</literal> Example in the Web UI</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-custom-harddisk-partitions.png"/>
</imageobject>
<textobject><phrase>formula custom harddisk partitions</phrase></textobject>
</mediaobject>
</figure>
<simpara>To remove the definition of a partition click the minus symbol in the title line of an inner group.
When form fields are properly filled confirm with clicking <guibutton>Save Formula</guibutton> in the upper right corner of the formula.</simpara>
</section>
</section>
<section xml:id="best.practice.salt.formulas.writing">
<title>Writing Salt Formulas</title>
<simpara>Salt formulas are pre-written Salt states, which may be configured with pillar data.
You can parametrize state files using Jinja.
Jinja allows you to access pillar data by using the following syntax.
This syntax works best when you are uncertain whether a pillar value exists as it will throw an error:</simpara>
<screen>pillar.some.value</screen>
<simpara>When you are sure a pillar exists you may also use the following syntax:</simpara>
<screen>salt['pillar.get']('some:value', 'default value')</screen>
<simpara>You may also replace the <literal>pillar</literal> value with <literal>grains</literal> (for example, <literal>grains.some.value</literal>) allowing access to grains.</simpara>
<simpara>Using data this way allows you to make a formula configurable.
The following code snippet will install a package specified in the pillar <literal>package_name</literal>:</simpara>
<screen>install_a_package:
  pkg.installed:
    - name: {{ pillar.package_name }}</screen>
<simpara>You may also use more complex constructs such as <literal>if/else</literal> and <literal>for-loops</literal> to provide greater functionality:</simpara>
<screen>{% if pillar.installSomething %}
something:
  pkg.installed
{% else %}
anotherPackage:
  pkg.installed
{% endif %}</screen>
<simpara>Another example:</simpara>
<screen>{% for service in pillar.services %}
start_{{ service }}:
  service.running:
    - name: {{ service }}
{% endfor %}</screen>
<simpara>Jinja also provides other helpful functions.
For example, you can iterate over a dictionary:</simpara>
<screen>{% for key, value in some_dictionary.items() %}
do_something_with_{{ key }}: {{ value }}
{% endfor %}</screen>
<simpara>You may want to have Salt manage your files (for example, configuration files for a program), and you can change these with pillar data.
For example, the following snippet shows how you can manage a file using Salt:</simpara>
<screen>/etc/my_program/my_program.conf:
  file.managed:
    - source: salt://my_state/files/my_program.conf
    - template: jinja</screen>
<simpara>Salt will copy the file <literal role="path">salt-file_roots/my_state/files/my_program.conf</literal> on the salt master to <literal role="path">/etc/my_program/my_program.conf</literal> on the minion and template it with Jinja.
This allows you to use Jinja in the file, exactly like shown above for states:</simpara>
<screen>some_config_option = {{ pillar.config_option_a }}</screen>
</section>
<section xml:id="best.practice.salt.formulas.data">
<title>Separating Data</title>
<simpara>It is often a good idea to separate data from a state to increase its flexibility and add re-usability value.
This is often done by writing values into a separate file named <literal role="path">map.jinja</literal>.
This file should be placed within the same directory as your state files.</simpara>
<simpara>The following example will set <literal>data</literal> to a dictionary with different values, depending on which system the state runs on.
It will also merge data with the pillar using the <literal>some.pillar.data</literal> value so you can access <literal>some.pillar.data.value</literal> by just using <literal>data.value</literal>.</simpara>
<simpara>You can also choose to override defined values from pillars (for example, by overriding <literal>some.pillar.data.package</literal> in the example).</simpara>
<screen>{% set data = salt['grains.filter_by']({
    'Suse': {
        'package': 'packageA',
        'service': 'serviceA'
    },
    'RedHat': {
        'package': 'package_a',
        'service': 'service_a'
    }
}, merge=salt['pillar.get']('some:pillar:data')) %}</screen>
<simpara>After creating a map file like the above example, you can maintain compatibility with multiple system types while accessing "deep" pillar data in a simpler way.
Now you can import and use <literal>data</literal> in any file.
For example:</simpara>
<screen>{% from "some_folder/map.jinja" import data with context %}

install_package_a:
  pkg.installed:
    - name: {{ data.package }}</screen>
<simpara>You can also define multiple variables by copying the <literal>{% set &#8230;&#8203;%}</literal> statement with different values and then merge it with other pillars.
For example:</simpara>
<screen>{% set server = salt['grains.filter_by']({
    'Suse': {
        'package': 'my-server-pkg'
    }
}, merge=salt['pillar.get']('myFormula:server')) %}
{% set client = salt['grains.filter_by']({
    'Suse': {
        'package': 'my-client-pkg'
    }
}, merge=salt['pillar.get']('myFormula:client')) %}</screen>
<simpara>To import multiple variables, separate them with a comma.
For Example:</simpara>
<screen>{% from "map.jinja" import server, client with context %}</screen>
<simpara>Formulas utilized with SUSE Manager should follow formula conventions listed in the official documentation:</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html">https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="best.practice.salt.formulas.pillardata">
<title>SUSE Manager Generated Pillar Data</title>
<simpara>When pillar data is generated (for example, after applying the highstate) the following external pillar script generates pillar data for packages, group ids, etc. and includes all pillar data for a system:</simpara>
<screen>/usr/share/susemanager/modules/pillar/suma_minion.py</screen>
<simpara>The process is executed as follows:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>The <literal>suma_minion.py</literal> script starts and finds all formulas for a system (by checking the <literal>group_formulas.json</literal> and <literal>server_formulas.json</literal> files).</simpara>
</listitem>
<listitem>
<simpara><literal>suma_minion.py</literal> loads the values for each formula (groups and from the system) and merges them with the highstate (default: if no values are found, a group overrides a system if $scope: group etc.).</simpara>
</listitem>
<listitem>
<simpara><literal>suma_minion.py</literal> also includes a list of formulas applied to the system in a pillar named formulas.
This structure makes it possible to include states.
The top file (in this case specifically generated by the <literal>mgr_master_tops.py</literal> script) includes a state called formulas for each system.
This includes the <literal>formulas.sls</literal> file located in:</simpara>
<screen>/usr/share/susemanager/formulas/states/</screen>
<simpara>The content looks similar to the following:</simpara>
<screen>include: {{ pillar["formulas"] }}</screen>
<simpara>This pillar includes all formulas, that are specified in pillar data generated from the external pillar script.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="best.practice.salt.formulas.req">
<title>Formula Requirements</title>
<simpara>Formulas should be designed/created directly after a SUSE Manager installation, but if you encounter any issues check the following:</simpara>
<itemizedlist>
<listitem>
<simpara>The external pillar script (<literal>suma_minion.py</literal>) must include formula data.</simpara>
</listitem>
<listitem>
<simpara>Data is saved to <literal role="path">/srv/susemanager/formula_data</literal> and the <literal role="path">pillar</literal> and <literal role="path">group_pillar</literal> sub-directories.
These should be automatically generated by the server.</simpara>
</listitem>
<listitem>
<simpara>Formulas must be included for every minion listed in the top file.
Currently this process is initiated by the <literal role="path">mgr_master_tops.py</literal> script which includes the <literal>formulas.sls</literal> file located in:</simpara>
<screen>/usr/share/susemanager/formulas/states/</screen>
<simpara>This directory must be a salt file root.
File roots are configured on the salt-master (SUSE Manager) located in:</simpara>
<screen>/etc/salt/master.d/susemanager.conf</screen>
</listitem>
</itemizedlist>
</section>
<section xml:id="best.practice.salt.formulas.using">
<title>Using Salt Formulas with SUSE Manager</title>
<simpara>The following procedure provides an overview on using Salt Formulas with SUSE Manager.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Official formulas may be installed as RPMs.
Place the custom states within <literal role="path">/srv/salt/your-formula-name/</literal> and the metadata (<literal role="path">form.yml</literal> and <literal role="path">metadata.yml</literal>) in <literal role="path">/srv/formula_metadata/your-formula-name/</literal>.
After installing your formulas they will appear in <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Formula Catalog</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>To begin using a formula, apply it to a group or system.
Apply a formula to a group or system by selecting the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Formulas</guimenuitem></menuchoice> tab of a <literal role="guimenu">System Details</literal> page or <literal role="guimenu">System Group</literal>. From the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Formulas</guimenuitem></menuchoice> page you can select any formulas you wish to apply to a group or system.
Click the <guibutton>Save</guibutton> button to save your changes to the database.</simpara>
</listitem>
<listitem>
<simpara>After applying one or more formulas to a group or system, additional tabs will become available from the top menu, one for each formula selected.
From these tabs you may configure your formulas.</simpara>
</listitem>
<listitem>
<simpara>When you have finished customizing your formula values you will need to apply the highstate for them to take effect.
Applying the highstate will execute the state associated with the formula and configure targeted systems.
You can use the <guibutton>Apply Highstate</guibutton> button from any formulas page of a group.</simpara>
</listitem>
<listitem>
<simpara>When a change to any of your values is required or you need to re-apply the formula state because of a failure or bug, change values located on your formula pages and re-apply the highstate.
Salt will ensure that only modified values are adjusted and restart or reinstall services only when necessary.</simpara>
</listitem>
</orderedlist>
<simpara>This conclude your introduction to Salt Formulas.
For additional information, see:</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html">https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="retail.formulas">
<title>SUSE Manager for Retail Salt Formulas</title>
<simpara>This section provides an introduction to Salt Formulas shipped with SUSE Manager for Retail.
These formulas such as the PXE boot, branch server network, or saltboot formulas are used to fine-tune the SUSE Manager for Retail infrastructure.</simpara>
<section xml:id="retail.formulas.pxe">
<title>Pxe Formula</title>
<simpara>The Pxe formula (<literal role="package">pxe-formula</literal>) for installing, setting up, and uninstalling syslinux PXE boot on the POS branchserver.</simpara>
<figure xml:id="fig-formula-pxe">
<title>pxe formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-pxe.png"/>
</imageobject>
<textobject><phrase>formula pxe</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="retail.formulas.branch-network">
<title>Branch Network Formula</title>
<simpara>The Branch Network formula (<literal role="package">branch-network-formula</literal>) for configuring the branch server network.</simpara>
<figure xml:id="fig-formula-branch-network">
<title>branch network formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-branch-network.png"/>
</imageobject>
<textobject><phrase>formula branch network</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="retail.formulas.saltboot">
<title>Saltboot Formula</title>
<simpara>The Saltboot formula (<literal role="package">saltboot-formula</literal>) is a formula for configuring a boot image of a POS terminal.</simpara>
<figure xml:id="fig-formula-saltboot-01">
<title>saltboot formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-saltboot-01.png"/>
</imageobject>
<textobject><phrase>formula saltboot 01</phrase></textobject>
</mediaobject>
</figure>
<simpara>Then you configure one or more partitions:</simpara>
<figure xml:id="fig-formula-saltboot-02">
<title>saltboot formula partitions</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-saltboot-02.png"/>
</imageobject>
<textobject><phrase>formula saltboot 02</phrase></textobject>
</mediaobject>
</figure>
<simpara>In the Saltboot formula settings, configure either the <literal role="systemitem">filesystem</literal> parameter, or the <literal role="systemitem">image</literal> parameter, not both.
If the <literal role="systemitem">filesystem</literal> and <literal role="systemitem">image</literal> fields both contain values, the <literal role="systemitem">filesystem</literal> parameter will be ignored and the <literal role="systemitem">image</literal> field settings will be used.</simpara>
</section>
<section xml:id="retail.formulas.image-sync">
<title>Image Sync Formula</title>
<simpara>The Image Sync formula (<literal role="package">image-sync-formula</literal>) is a formula for syncing images to a Branch Server.</simpara>
<simpara>For now, there is nothing configurable and it is not part of the highstate.
This means it is not visible in the Web UI.  Apply it from the command-line or via cron as follows (replace <emphasis>&lt;branchserver&gt;</emphasis> with the name of your branch server):</simpara>
<screen>salt &lt;branchserver&gt; state.apply image-sync</screen>
</section>
</section>
<section xml:id="bp.saltforms.susemgr">
<title>Salt Formulas Coming with SUSE Manager</title>
<simpara>For general information, see the <literal>Salt Formulas installation and usage instructions</literal> at <link xl:href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html">https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html</link>.</simpara>
<section xml:id="bp.saltforms.susemgr.locale">
<title>Locale</title>
<simpara>The locale formula allows setting <literal role="guimenu">Timezone` and [guimenu]</literal>Keyboard and Language`.</simpara>
</section>
<section xml:id="bp.saltforms.susemgr.dns">
<title>Domain Name System (Bind)</title>
<simpara>With the bind formula you set up and configure a Domain Name System (DNS) server.
For technical information about the bind formula and low-level pillar data, see the <literal role="path">README.rst</literal> file on the SUSE Manager server: <literal role="path">/usr/share/susemanager/formulas/metadata/bind/README.rst</literal>.</simpara>
<simpara>DNS is needed to resolve the domain names and host names into IP addresses.
For more information about DNS, see the SLES Administration Guide, Services, The Domain Name System.</simpara>
<figure xml:id="fig-formula-bind-01">
<title>Bind Formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-bind-01.png"/>
</imageobject>
<textobject><phrase>formula bind 01</phrase></textobject>
</mediaobject>
</figure>
<simpara>In the <literal role="guimenu">Config</literal> group you can set arbitrary options such as <literal>directory</literal> where are the zone data files (usually <literal role="path">/var/lib/named/</literal>) or  <literal>forwarders</literal>.
Click <guibutton>Add Item</guibutton> to provide more Key/Value fields for configuration.</simpara>
<simpara>Check <literal>Include Forwarders</literal> if you want to rely on an external DNS server if your DNS is down (or is otherwise not able to resolve an address).</simpara>
<simpara>At least, you will configure one zone.  In <literal>Configured Zones</literal> define
your zone; for example, <literal>example.com</literal>.  Then in <literal>Available Zones</literal>
configure this zone: as <literal>Name</literal> enter your zone (in this case
<literal>example.com</literal>) and the <literal>File</literal> to which this configuration should be
written (<literal>example.com.txt</literal>).  Enter the mandatory <literal>SOA</literal> record (start
of authority), and the A, NS, and CNAME <literal>Records</literal> you need.</simpara>
<simpara>On the other hand, if no <literal>records</literal> entry exists, the zone file is not generated by this state rather than taken from <literal>salt://zones</literal>.  For how to overwrite
this URL, see <literal role="path">pillar.example</literal>.</simpara>
<figure xml:id="fig-formula-bind-02">
<title>bind-02-zones</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-bind-02-zones.png"/>
</imageobject>
<textobject><phrase>formula bind 02 zones</phrase></textobject>
</mediaobject>
</figure>
<figure xml:id="fig-formula-bind-03">
<title>bind-03-records</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-bind-03-records.png"/>
</imageobject>
<textobject><phrase>formula bind 03 records</phrase></textobject>
</mediaobject>
</figure>
<figure xml:id="fig-formula-bind-03-2">
<title>bind-03-records2</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-bind-03-records2.png"/>
</imageobject>
<textobject><phrase>formula bind 03 records2</phrase></textobject>
</mediaobject>
</figure>
<simpara>In <literal>Generate Reverse</literal>, and define reverse mapping and for which zones:</simpara>
<figure xml:id="fig-formula-bind-04">
<title>bind-04-reverse</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-bind-04-reverse.png"/>
</imageobject>
<textobject><phrase>formula bind 04 reverse</phrase></textobject>
</mediaobject>
</figure>
<simpara>When saved, data is written to <literal role="path">/srv/susemanager/formula_data/pillar/&lt;salt-minion.example.com&gt;_bind.json</literal>.</simpara>
<simpara>If you apply the highstate (<menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice>), it first ensures that <literal role="package">bind</literal> and all required packages will get installed.
Then it will start the DNS service (<literal>named</literal>).</simpara>
</section>
<section xml:id="bp.saltforms.susemgr.dhcp">
<title>Dhcpd</title>
<simpara>With the dhcpd formula you set up and configure a DHCP server (Dynamic Host Configuration Protocol).
For technical information about the dhcpd formula and low-level pillar data, see the Pillar example file
<literal role="path">/usr/share/susemanager/formulas/metadata/dhcpd/pillar.example</literal>.</simpara>
<simpara>DHCP is needed to define network settings centrally (on a server) and let clients retrieve and use this information for local host configuration.
For more information about DHCP, see the SLES Administration Guide, Services, DHCP.</simpara>
<figure xml:id="fig-formula-dhcpd-01">
<title>dhcpd formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-dhcpd-01.png"/>
</imageobject>
<textobject><phrase>formula dhcpd 01</phrase></textobject>
</mediaobject>
</figure>
<simpara>Domain Name.</simpara>
<simpara><literal>Domain Name Servers</literal>.  One or more Domain Name Service (DNS) servers.</simpara>
<simpara>On which interface(s) the DHCP server should listen (<literal>Listen interfaces</literal>).
Set option for this interface:
Authoritative:
Max Lease Time:
Default Lease Time:</simpara>
<simpara>Next is at least one network in the <literal>Network configuration (subnet)</literal> group (with IP address, netmask, etc.).  You define every network with <literal>Dynamic IP range</literal>, <literal>Routers</literal>, and <literal>Hosts with static IP addresses (with defaults from subnet)</literal> (optionally).</simpara>
<simpara>And finally <literal>Hosts with static IP addresses (with global defaults)</literal>.</simpara>
<simpara>If you apply the highstate (<menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice>), it first ensures that <literal role="package">dhcp-server</literal> and all required packages will get installed.
Then it will start the DHCP service (<literal>dhcpd</literal>).</simpara>
</section>
<section xml:id="bp.saltforms.susemgr.tftp">
<title>Tftpd</title>
<simpara>With the tftpd formula you set up and configure a TFTP server (Trivial File Transfer Protocol).
A TFTP server is a component that provides infrastructure for booting with PXE.</simpara>
<simpara>For more information about setting up TFTP, see the SLES Deployment Guide, Preparing Network Boot Environment, Setting Up a TFTP Server.</simpara>
<figure xml:id="fig-formula-tftpd-01">
<title>tftpd formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-tftpd-01.png"/>
</imageobject>
<textobject><phrase>formula tftpd 01</phrase></textobject>
</mediaobject>
</figure>
<simpara>For setting up a TFTP server, specify the <literal>Internal Network Address</literal>, <literal>TFTP base directory</literal> (default: <literal role="path">/srv/tftpboot</literal>), and <literal>run TFTP under user</literal> (default: <literal role="systemitem">sftp</literal>).</simpara>
<simpara>If you apply the highstate (<menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice>), it first ensures that <literal role="package">atftp</literal> and all required packages will get installed.
Then it will start TFTP (<literal>atftpd</literal>).</simpara>
</section>
<section xml:id="bp.saltforms.susemgr.vsftp">
<title>Vsftpd</title>
<simpara>With the vsftpd formula you set up and configure Vsftpd.  Vsftpd is an FTP server or daemon, written with security in mind.  "vs" in its name stands for "Very Secure".</simpara>
<figure xml:id="fig-formula-vsftpd-01">
<title>vsftpd formula</title>
<mediaobject>
<imageobject>
<imagedata fileref="formula-vsftpd-01.png"/>
</imageobject>
<textobject><phrase>formula vsftpd 01</phrase></textobject>
</mediaobject>
</figure>
<simpara>For configuring a VSFTP server, specify the settings and options in the Vsftpd formula.
There are settings such as
<literal>FTP server directory</literal>,
<literal>Internal Network Address</literal>
<literal>Enable ssl</literal>, etc.</simpara>
<simpara>If you apply the highstate (<menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice>), it first ensures that <literal role="package">vsftpd</literal> and all required packages will get installed.
Then it will start the VSFTP service (<literal>vsftpd</literal>).</simpara>
<simpara>For more information about setting up and tuning Vsftpd, see the documentation coming with the <literal role="package">vsftpd</literal> package (<literal role="path">/usr/share/doc/packages/vsftpd/</literal> when the package is installed).</simpara>
</section>
</section>
</chapter>
<chapter xml:id="bp.chapt.config.management.with.salt">
<title>Configuration Management with Salt</title>
<section xml:id="bp.chapt.config.mgr.overview">
<title>Configuration Management Overview</title>
<simpara>Salt is capable of applying states by matching minions with relevant state data.
This data comes from SUSE Manager in the form of package and custom states.</simpara>
</section>
<section xml:id="bp.chapt.config.mgr.level.hierarchy">
<title>State Data: Levels of Hierarchy</title>
<simpara>State data comes from SUSE Manager in the form of package and custom states and targets minions at three specific levels of hierarchy.
The state hierarchy is defined by the following order or priority: individual minions have priority on packages and custom states over groups; next a group has priority over the organization.</simpara>
<itemizedlist>
<listitem>
<simpara>Minion Level</simpara>
<simpara><menuchoice><guimenu>Systems</guimenu> <guisubmenu>Specific Minion</guisubmenu> <guimenuitem>States</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara>Group Level</simpara>
<simpara><menuchoice><guimenu>Systems</guimenu> <guimenuitem>System Groups</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara>Organization Level</simpara>
<simpara><menuchoice><guimenu>Systems</guimenu> <guisubmenu>Manage System Types:</guisubmenu> <guimenuitem>My Organization</guimenuitem></menuchoice></simpara>
</listitem>
</itemizedlist>
<simpara>For example:</simpara>
<itemizedlist>
<listitem>
<simpara>Org1 requires that vim version 1 is installed</simpara>
</listitem>
<listitem>
<simpara>Group1 requires that vim version 2 is installed</simpara>
</listitem>
<listitem>
<simpara>Group2 requires any version installed</simpara>
</listitem>
</itemizedlist>
<simpara>This would lead to the following order of hierarchy:</simpara>
<itemizedlist>
<listitem>
<simpara>Minion1 part of [Org1, Group1] wants vim removed, vim is removed (Minion Level)</simpara>
</listitem>
<listitem>
<simpara>Minion2 part of [Org1, Group1] wants vim version 2 gets version 2 (Group Level)</simpara>
</listitem>
<listitem>
<simpara>Minion3 part of [Org1, Group1] wants any version, gets version 2 (Org Level)</simpara>
</listitem>
<listitem>
<simpara>Minion4 part of[Org1, Group2] wants any version, gets vim version 1 (Org Level)</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="bp.chapt.config.mgr.salt.states.storage.locations">
<title>Salt States Storage Locations</title>
<simpara>The SUSE Manager salt-master reads its state data from three file root locations.</simpara>
<simpara>The directory <literal role="path">/usr/share/susemanager/salt</literal>
 is used by SUSE Manager and comes from the susemanager-sls.
It is shipped and updated together with SUSE Manager and includes certificate setup and common state logic to be applied to packages and channels.</simpara>
<simpara>The directory <literal role="path">/srv/susemanager/salt</literal> is generated by SUSE Manager and based on assigned channels and packages for minions, groups and organizations.
This file will be overwritten and regenerated.
This could be thought of as the SUSE Manager database translated into salt directives.</simpara>
<simpara>The third directory <literal role="path">/srv/salt</literal> is for custom state data, modules etc.
SUSE Manager does not operate within or utilize this directory.
However the state data placed here affects the Highstate of minions and is merged with the total state result generated by SUSE Manager.</simpara>
</section>
<section xml:id="bp.chapt.config.mgr.susemgr.states">
<title>SUSE Manager States</title>
<simpara>All sls files created by users will be saved to disk on the salt-master server.
These files will be placed in <literal role="path">/srv/susemanager/salt/</literal>
 and each organization will be placed within its own directory.
Although these states are custom, these states are created using SUSE Manager
.
The following provides an overview of directory structure:</simpara>
<screen>├── manager_org_DEVEL
│   ├── files
│   │    ... files needed by states (uploaded by users)...
│   └── state.sls
         ... other sls files (created by users)...
E.g.:
├── manager_org_TESTING
│   ├── files
│   │   └── motd     # user created
│   │    ... other files needed by states ...
│   └── motd.sls     # user created
            ... other sls files ...</screen>
</section>
<section xml:id="bp.chapt.config.mgr.pillar.data">
<title>Pillar Data</title>
<simpara>SUSE Manager exposes a small amount of internal data as Pillars which can be used with custom SUSE Linux Enterprise Server states.
Data that is exposed includes group membership, organization membership, and file roots.
These are managed either automatically by SUSE Manager, or manually by the user.</simpara>
<simpara>To avoid hard-coding organization IDs within SUSE Linux Enterprise Server files, a pillar entry is added for each organization:</simpara>
<screen>org-files-dir: relative_path_to_files</screen>
<simpara>The specified file is available for all minions which belong to the organization.</simpara>
<simpara>This is an example of a Pillar located at <literal role="path">/etc/motd</literal>:</simpara>
<screen>file.managed:
    - source: salt://{{ pillar['org-files-dir']}}/motd
    - user: root
    - group: root
    - mode: 644</screen>
</section>
<section xml:id="bp.sect.groupstates">
<title>Group States</title>
<simpara>Pillar data can be used to perform bulk actions, like applying all assigned states to minions within the group.
This section contains some example of bulk actions that you can take using group states.</simpara>
<simpara>In order to perform these actions, you will need to determine the ID of the group that you want to manipulate.
You can determine the Group ID by using the <literal role="command">spacecmd</literal> command:</simpara>
<screen>spacecmd group_details</screen>
<simpara>In these examples we will use an example Group ID of <literal role="systemitem">GID</literal>.</simpara>
<simpara>To apply all states assigned to the group:</simpara>
<screen>salt -I 'group_ids:GID' state.apply custom.group_GID</screen>
<simpara>To apply any state (whether or not it is assigned to the group):</simpara>
<screen>salt -I 'group_ids:GID' state.apply ``state``</screen>
<simpara>To apply a custom state:</simpara>
<screen>salt -I 'group_ids:2130' state.apply manager_org_1.``customstate``</screen>
<simpara>Apply the highstate to all minions in the group:</simpara>
<screen>salt -I 'group_ids:GID' state.apply</screen>
</section>
</chapter>
<chapter xml:id="bp.chap.salt.minion.scaleability">
<title>Salt Minion Scalability</title>
<section xml:id="_salt_minion_onboarding_rate">
<title>Salt Minion Onboarding Rate</title>
<simpara>The rate at which SUSE Manager can on-board minions (accept Salt keys) is limited and depends on hardware resources.
On-boarding minions at a faster rate than SUSE Manager is configured for will build up a backlog of unprocessed keys slowing the process and potentially exhausting resources.
It is recommended to limit the acceptance key rate pro-grammatically.
A safe starting point would be to on-board a minion every 15 seconds, which can be implemented via the following command:</simpara>
<screen>for k in $(salt-key -l un|grep -v Unaccepted); do salt-key -y -a $k; sleep 15; done</screen>
</section>
<section xml:id="bp.chap.salt.minion.scaleability.unaccepted">
<title>Minions Running with Unaccepted Salt Keys</title>
<simpara>Minions which have not been on-boarded, (minions running with unaccepted Salt keys) consume resources, in particular inbound network bandwidth for ~2.5 Kb/s per minion.
1000 idle minions will consume around ~2.5 Mb/s, and this number will drop to almost 0 once on-boarding has been completed.
Limit non-onboarded systems for optimal performance.</simpara>
</section>
<section xml:id="bp.chap.salt.minion.scaleability.timeouts">
<title>Salt Timeouts</title>
<simpara>Salt features two timeout parameters called <literal>timeout</literal> and <literal>gather_job_timeout</literal> that are relevant during the execution of Salt commands and jobs&#8212;&#8203;it does not matter whether they are triggered using the command line interface or API.
These two parameters are explained in the following article.</simpara>
<simpara>This is a normal workflow when all minions are well reachable:</simpara>
<itemizedlist>
<listitem>
<simpara>A salt command or job is executed:</simpara>
<screen>salt '*' test.ping</screen>
</listitem>
<listitem>
<simpara>Salt master publishes the job with the targeted minions into the Salt PUB channel.</simpara>
</listitem>
<listitem>
<simpara>Minions take that job and start working on it.</simpara>
</listitem>
<listitem>
<simpara>Salt master is looking at the Salt RET channel to gather responses from the minions.</simpara>
</listitem>
<listitem>
<simpara>If Salt master gets all responses from targeted minions, then everything is completed and Salt master will return a response containing all the minion responses.</simpara>
</listitem>
</itemizedlist>
<simpara>If some of the minions are down during this process, the workflow continues as follows:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>If <literal>timeout</literal> is reached before getting all expected responses from the minions, then Salt master would trigger an additional job (a Salt <literal role="command">find_job</literal> job) targeting only pending minions to check whether the job is already running on the minion.</simpara>
</listitem>
<listitem>
<simpara>Now <literal>gather_job_timeout</literal> is evaluated. A new counter is now triggered.</simpara>
</listitem>
<listitem>
<simpara>If this new <literal role="command">find_job</literal> job responses that the original job is actually running on the minion, then Salt master will wait for that minion&#8217;s response.</simpara>
</listitem>
<listitem>
<simpara>In case of reaching <literal>gather_job_timeout</literal> without having any response from the minion (neither for the initial <literal role="command">test.ping</literal> nor for the <literal role="command">find_job</literal> job), Salt master will return with only the gathered responses from the responding minions.</simpara>
</listitem>
</orderedlist>
<simpara>By default, SUSE Manager globally sets <literal>timeout</literal> and <literal>gather_job_timeout</literal> to 120 seconds.
So, in the worst case, a Salt call targeting unreachable minions will end up <emphasis>with 240 seconds of waiting</emphasis> until getting a response.</simpara>
<section xml:id="bp.chap.salt.minion.scaleability.timeouts.presence">
<title>Presence Ping Timeout</title>
<simpara>There are two parameters that control how presence pings from the Salt master are handled, one for the ping timeout, and one for the ping gather job.</simpara>
<simpara>Salt batch calls begin with the Salt master performing a presence ping on the target minions.
A ping gather job runs on the Salt master to handle the incoming pings from the minions.
Batched commands will begin only after all minions have either responded to the ping, or timed out.</simpara>
<simpara>The presence ping is an ordinary Salt command, but is not subject to the same timeout parameters as all other Salt commands (<literal>timeout</literal>/<literal>gather_job_timeout</literal>), rather, it has its own parameters (<literal>presence_ping_timeout</literal>/<literal>presence_ping_gather_job_timeout</literal>).
You can configure the global timeout values in the <literal role="filename">/etc/salt/master.d/custom.conf</literal> configuration file.
However, to allow for quicker detection of unresponsive minions, the timeout values for presence pings are by default significantly shorter than those used elsewhere.
You can configure the presence ping parameters in <literal role="filename">/etc/rhn/rhn.conf</literal>, however the default values should be sufficient in most cases.</simpara>
<simpara>A lower total presence ping timeout value will increase the chance of false negatives.
In some cases, a minion might be marked as non-responding, when it is responding, but did not respond quickly enough.
A higher total presence ping timeout will increase the accuracy of the test, as even slow minions will respond to the presence ping before timing out.
Additionally, a higher presence ping timeout could limit throughput if you are targeting a large number of minions, when some of them are slow.</simpara>
<simpara>If a minion does not reply to a ping within the allocated time, it will be marked as <literal role="systemitem">not available</literal>, and will be excluded from the command.
The Web UI will show a <literal role="systemitem">minion is down</literal> message in this case.</simpara>
<simpara>For more information on minion timeouts, see <link xl:href="scale-minions.xml">scale-minions.xml</link>.</simpara>
<simpara>The presence ping timeout parameter changes the timeout setting for the presence ping, in seconds.
Adjust the <literal role="systemitem">java.salt_presence_ping_timeout</literal> parameter.
Defaults to 4 seconds.</simpara>
<simpara>The presence ping gather job parameter changes the timeout setting for gathering the presence ping, in seconds.
Adjust the <literal role="systemitem">java.salt_presence_ping_gather_job_timeout</literal> parameter.
Defaults to 1 second.</simpara>
</section>
</section>
<section xml:id="_batching">
<title>Batching</title>
<simpara>There are two parameters that control how actions are sent to clients, one for the batch size, and one for the delay.</simpara>
<simpara>When the Salt master sends a batch of actions to the target minions, it will send it to the number of minions determined in the batch size parameter.
After the specified delay period, commands will be sent to the next batch of minions.
The number of minions in each subsequent batch is equal to the number of minions that have completed in the previous batch.</simpara>
<simpara>Choosing a lower batch size will reduce system load and parallelism, but might reduce overall performance for processing actions.</simpara>
<simpara>The batch size parameter sets the maximum number of clients that can execute a single action at the same time.
Adjust the <literal role="systemitem">java.salt_batch_size</literal> parameter.
Defaults to 100.</simpara>
<simpara>Increasing the delay increases the chance that multiple minions will have completed before the next action is issued, resulting in fewer overall commands, and reducing load.</simpara>
<simpara>The batch delay parameter sets the amount of time, in seconds, to wait after a command is processed before beginning to process the command on the next minion.
Adjust the <literal role="systemitem">java.salt_batch_delay</literal> parameter.
Defaults to 1.0 seconds.</simpara>
<section xml:id="_salt_ssh_minions_ssh_push">
<title>Salt SSH Minions (SSH Push)</title>
<simpara>Salt SSH minions are slightly different that regular minions (zeromq). Salt SSH minions do not use Salt PUB/RET channels but a wrapper Salt command inside of an SSH call.
Salt <literal>timeout</literal> and <literal>gather_job_timeout</literal> are not playing a role here.</simpara>
<simpara>SUSE Manager defines a timeout for SSH connections in <literal role="path">/etc/rhn/rhn.conf</literal>:</simpara>
<screen># salt_ssh_connect_timeout = 180</screen>
<simpara>The presence ping mechanism is also working with SSH minions.
In this case, SUSE Manager will use <literal>salt_presence_ping_timeout</literal> to override the default timeout value for SSH connections.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="bp.key.managment">
<title>Activation Key Management</title>
<section xml:id="_what_are_activation_keys">
<title>What are Activation Keys?</title>
<simpara>An <literal>activation key</literal> in SUSE Manager is a group of configuration settings with a label.
You can apply all configuration settings associated with an activation key by adding its label as a parameter to a bootstrap script.
Under normal operating conditions best practices suggest using an activation key label in combination with a bootstrap script.</simpara>
<simpara>An activation key can specify:</simpara>
<itemizedlist>
<listitem>
<simpara>Channel Assignment</simpara>
</listitem>
<listitem>
<simpara>System Types (Traditionally called Add-on Entitlements)</simpara>
</listitem>
<listitem>
<simpara>Contact Method</simpara>
</listitem>
<listitem>
<simpara>Configuration Files</simpara>
</listitem>
<listitem>
<simpara>Packages to be Installed</simpara>
</listitem>
<listitem>
<simpara>System Group Assignment</simpara>
</listitem>
</itemizedlist>
<simpara>Activation keys are just a collection of configuration settings which have been given a label name and then added to a bootstrap script.
When the bootstrap script is executed all configuration settings associated with the label are applied to the system the script is run on.</simpara>
</section>
<section xml:id="_provisioning_and_configuration">
<title>Provisioning and Configuration</title>
<figure>
<title>Provisioning and Configuration Overview</title>
<mediaobject>
<imageobject>
<imagedata fileref="provision-config-keys.png" width="80%"/>
</imageobject>
<textobject><phrase>provision config keys</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="_activation_keys_best_practices">
<title>Activation Keys Best Practices</title>
<simpara>There are a few important concepts which should be kept in mind when creating activation keys.
The following sections provide insight when creating and naming your activation keys.</simpara>
<section xml:id="_key_label_naming">
<title>Key Label Naming</title>
<simpara>One of the most important things to consider during activation key creation is label naming.
Creating names which are associated with your organization&#8217;s infrastructure will make it easier for you when performing more complex operations.
When naming key labels keep the following in mind:</simpara>
<itemizedlist>
<listitem>
<simpara>OS naming (mandatory): Keys should always refer to the OS they provide settings for</simpara>
</listitem>
<listitem>
<simpara>Architecture naming (recommended): Unless your company is running on one architecture only, for example x86_64, then providing labels with an architecture type is a good idea.</simpara>
</listitem>
<listitem>
<simpara>Server type naming: What is, or what will this server be used for?</simpara>
</listitem>
<listitem>
<simpara>Location naming: Where is the server located? Room, building, or department?</simpara>
</listitem>
<listitem>
<simpara>Date naming: Maintenance windows, quarter, etc.</simpara>
</listitem>
<listitem>
<simpara>Custom naming: What naming scheme suits your organizations needs?</simpara>
</listitem>
</itemizedlist>
<simpara>Example activation key label names:</simpara>
<screen>sles12-sp2-web_server-room_129-x86_64</screen>
<screen>sles12-sp2-test_packages-blg_502-room_21-ppc64le</screen>
</section>
<section xml:id="_channels_which_will_be_included">
<title>Channels which will be Included</title>
<simpara>When creating activation keys you also need to keep in mind which channels (software sources) will be associated with it.</simpara>
<important>
<title>Default Base Channel</title>
<simpara>Keys should have a specific base channel assigned to it, for example <literal>SLES12-SP2-Pool-x86_64</literal>.
If this is not the case SUSE Manager cannot use specific stages.
Using the default base channel is not recommended and may cause problems.</simpara>
</important>
<itemizedlist>
<listitem>
<simpara>Channels to be included:</simpara>
<itemizedlist>
<listitem>
<simpara>suse-manager-tools</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Typical packages to be included:</simpara>
<itemizedlist>
<listitem>
<simpara>osad (pushing tasks)</simpara>
<itemizedlist>
<listitem>
<simpara>Installs <phrase role="package">python-jabberpy</phrase> and <phrase role="package">pyxml</phrase> as dependencies</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><phrase role="package">rhncfg-actions</phrase> (Remote Command, Configuration Managment)</simpara>
<itemizedlist>
<listitem>
<simpara>Installs <phrase role="package">rhncfg</phrase> and <phrase role="package">rhncfg-client</phrase> as dependencies</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="_combining_activation_keys">
<title>Combining Activation Keys</title>
<simpara>You can combine activation keys when executing the bootstrap script on your clients.
Combining keys allows for more control on what is installed on your systems and reduces duplication of keys for large complex environments.</simpara>
<figure>
<title>Combining Activation Keys</title>
<mediaobject>
<imageobject>
<imagedata fileref="combine-keys.png" width="80%"/>
</imageobject>
<textobject><phrase>combine keys</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Combining Activation Keys 2</title>
<mediaobject>
<imageobject>
<imagedata fileref="combine-keys2.png" width="80%"/>
</imageobject>
<textobject><phrase>combine keys2</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="_using_activation_keys_and_bootstrap_with_traditional_clients_non_salt">
<title>Using Activation Keys and Bootstrap with Traditional Clients (Non-Salt)</title>
<simpara>Create the initial bootstrap script template from the command line on the SUSE Manager
server with:</simpara>
<screen># mgr-bootstrap</screen>
<simpara>This command will generate the bootstrap script and place them in <literal role="path">/srv/www/htdocs/pub/bootstrap</literal>
.</simpara>
<simpara>Alternatively you may use the Web UI
to create your bootstrap script template.
For more information, see <xref linkend="s3-sattools-config-bootstrap"/>.</simpara>
<simpara>Use the Web UI
to create your keys.
From the Web UI
proceed to <menuchoice><guimenu>Overview</guimenu> <guisubmenu>Tasks</guisubmenu> <guimenuitem>Manage
   Activation Keys</guimenuitem></menuchoice>
.</simpara>
</section>
<section xml:id="bp.chapt.act.keys.with.salt.minions">
<title>Using Activation Keys when Registering Salt Minions</title>
<simpara>With the addition of Salt to SUSE Manager
 3 states should now be considered best practice over the more traditional way of combining activation keys.
Although states allow for more configuration options you need to place the new system within the correct group so the desired states will be applied to the system.
Using an activation key on your minions will place the system within the correct group automatically.</simpara>
<simpara>You should be aware of a few facts when working with Salt over traditional activation keys:</simpara>
<itemizedlist>
<listitem>
<simpara>Currently we do not support specifying an activation key on the minion on-boarding page.</simpara>
</listitem>
<listitem>
<simpara>Activation keys used with Salt minions are the same as those used with traditional systems and may be shared.</simpara>
</listitem>
<listitem>
<simpara>The equivalent of specifying a key using the traditional bootstrap method is to place the desired key in the grain of a minion. For more information on grains, see <link xl:href="https://docs.saltstack.com/en/latest/topics/targeting/grains.html">https://docs.saltstack.com/en/latest/topics/targeting/grains.html</link></simpara>
</listitem>
<listitem>
<simpara>Once a minion has been accepted either from the <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Keys</guimenuitem></menuchoice> page located in the Web UI or from the command line, all configurations specified by the activation key placed within a salt grain will be applied.</simpara>
</listitem>
<listitem>
<simpara>Currently you may only use one activation key when working with salt. You cannot combine them, despite this, salt states allow for even more control.</simpara>
</listitem>
</itemizedlist>
<section xml:id="_using_an_activation_key_and_custom_grains_file">
<title>Using an Activation Key and Custom Grains File</title>
<simpara>Create a custom grains file and place it on the minion here:</simpara>
<screen># /etc/salt/grains</screen>
<simpara>Then add the following lines to the grains file replacing 1-sles12-sp2 with your activation key label:</simpara>
<screen>susemanager:
  activation_key: 1-sles12-sp2</screen>
<simpara>Now restart the minion with:</simpara>
<screen># systemctl restart salt-minion</screen>
</section>
<section xml:id="_using_an_activation_key_in_the_minion_configuration_file">
<title>Using an Activation Key in the Minion Configuration File</title>
<simpara>You may also place the activation key grain within the minion configuration file located in:</simpara>
<screen># /etc/salt/minion</screen>
<simpara>Now add the following lines to the minion configuration file replacing 1-sles12-sp2 with your activation key label:</simpara>
<screen>grains:
  susemanager:
    activation_key: 1-sles12-sp2</screen>
<simpara>Reboot the minion with:</simpara>
<screen># systemctl restart salt-minion</screen>
</section>
</section>
</chapter>
<chapter xml:id="bp.systems.management">
<title>Contact Methods</title>
<section xml:id="_selecting_a_contact_method">
<title>Selecting a Contact Method</title>
<simpara>SUSE Manager provides several methods for communication between client and server.
All commands your SUSE Manager server sends its clients to do will be routed through one of them.
Which one you select will depend on your network infrastructure.
The following sections provide a starting point for selecting a method which best suits your network environment.</simpara>
<note>
<title>Contact Methods and Salt</title>
<simpara>This chapter is only relevant for traditional clients as Salt clients (minions) utilize a Salt specific contact method.
For general information about Salt clients, see <xref linkend="salt.gs.guide.intro"/>.</simpara>
</note>
</section>
<section xml:id="bp.contact.methods.rhnsd">
<title>Traditional Contact Method (rhnsd)</title>
<simpara>The SUSE Manager daemon (<literal role="command">rhnsd</literal>) runs on traditional client systems and periodically connects with SUSE Manager to check for new updates and notifications.
The daemon is started by <literal role="path">/etc/init.d/rhnsd</literal>.
It is only still in use on SUSE Linux Enterprise 11 and Red Hat Enterprise Linux Server 6-these are systems that are not based on systemd.
On later systems, a systemd timer (<literal role="systemitem">rhnsd.timer</literal>) is used and controlled by <literal role="systemitem">rhnsd.service</literal>.</simpara>
<simpara>By default, rhnsd will check every 4 hours for new actions, therefore it may take some time for your clients to begin updating after actions have been scheduled for them.</simpara>
<simpara>To check for updates, <literal role="systemitem">rhnsd</literal> runs the external <literal role="systemitem">mgr_check</literal> program located in <literal role="path">/usr/sbin/</literal>.
This is a small application that establishes the network connection to SUSE Manager.
The SUSE Manager daemon does not listen on any network ports or talk to the network directly.
All network activity is done via the <literal role="systemitem">mgr_check</literal> utility.</simpara>
<warning>
<title>Auto accepting (EULAs)</title>
<simpara>When new packages or updates are installed on the client using SUSE Manager, any end user licence agreements (EULAs) are automatically accepted.
To review a package EULA, open the package detail page in the Web UI.</simpara>
</warning>
<simpara>This figure provides an overview of the default <literal role="systemitem">rhnsd</literal> process path.
All items left of the <literal role="systemitem">Python XMLRPC server</literal> block represent processes running on a SUSE Manager client.</simpara>
<figure>
<title>rhnsd Contact Method</title>
<mediaobject>
<imageobject>
<imagedata fileref="rhnsd-taigon.png" width="80%"/>
</imageobject>
<textobject><phrase>rhnsd taigon</phrase></textobject>
</mediaobject>
</figure>
<section xml:id="_configuring_suse_manager_rhnsd_daemon_or_timer">
<title>Configuring SUSE Manager rhnsd Daemon or Timer</title>
<simpara>The SUSE Manager daemon can be configured by editing the file on the client:</simpara>
<screen>/etc/sysconfig/rhn/rhnsd</screen>
<simpara>This is the configuration file the rhnsd initialization script uses.
An important parameter for the daemon is its check-in frequency.
The default interval time is four hours (240 minutes). If you modify the configuration file, you must as root restart the daemon with:</simpara>
<screen>/etc/init.d/rhnsd restart</screen>
<important>
<title>Minimum Allowed Check-in Parameter</title>
<simpara>The minimum allowed time interval is one hour (60 minutes).
If you set the interval below one hour, it will change back to the default of 4 hours (240 minutes).</simpara>
</important>
<simpara>On systemd-based systems (for example, SLE 12 and later), the default time interval is set in <literal role="path">/etc/systemd/system/timers.target.wants/rhnsd.timer</literal>:</simpara>
<screen>[Timer]
OnCalendar=00/4:00
RandomizedDelaySec=30min</screen>
<simpara>You can create an overriding drop-in file of <literal role="path">rhnsd.timer</literal> with:</simpara>
<screen>systemctl edit rhnsd.timer</screen>
<simpara>For example, if you want configure a two hour time interval, enter:</simpara>
<screen>[Timer]
OnCalendar=00/2:00</screen>
<simpara>On write, the file will be saved as <literal role="path">/etc/systemd/system/rhnsd.timer.d/override.conf</literal>.
For more information about system timers, see the manpages of <literal role="command">systemd.timer</literal> and <literal role="command">systemctl</literal>.</simpara>
</section>
<section xml:id="_viewing_rhnsd_daemon_or_timer_status">
<title>Viewing rhnsd Daemon or Timer Status</title>
<simpara>As the root you may view the status of the <literal role="systemitem">rhnsd</literal> daemon with:</simpara>
<screen>/etc/init.d/rhnsd status</screen>
<simpara>And the status of the <literal role="systemitem">rhnsd</literal> service with:</simpara>
<screen>service rhnsd status</screen>
</section>
</section>
<section xml:id="bp.contact.methods.ssh.push">
<title>Push via SSH</title>
<simpara>Push via SSH is intended to be used in environments where your clients cannot reach the SUSE Manager server directly to regularly check in and, for example, fetch package updates.</simpara>
<simpara>In detail, this feature enables a SUSE Manager located within an internal network to manage clients located on a <quote>Demilitarized Zone</quote> (DMZ) outside of the firewall protected network.
Due to security reasons, no system on a DMZ is authorized to open a connection to the internal network and therefore your SUSE Manager server.
The solution is to configure Push via SSH which utilizes an encrypted tunnel from your SUSE Manager server on the internal network to the clients located on the DMZ.
After all actions/events are executed, the tunnel is closed.
The server will contact the clients in regular intervals (using SSH) to check in and perform all actions and events.</simpara>
<important>
<title>Push via SSH Unsupported Actions</title>
<simpara>Certain actions are currently not supported on scheduled clients which are managed via Push via SSH.
This includes re-installation of systems using the provisioning module.</simpara>
</important>
<simpara>The following figure provides an overview of the Push via SSH process path.
All items left of the <literal role="systemitem">Taskomatic</literal>
 block represent processes running on a SUSE Manager client.</simpara>
<figure>
<title>Push via SSH Contact Method</title>
<mediaobject>
<imageobject>
<imagedata fileref="sshpush-taigon.png" width="80%"/>
</imageobject>
<textobject><phrase>sshpush taigon</phrase></textobject>
</mediaobject>
</figure>
<section xml:id="bp.contact.methods.ssh.push.requirements">
<title>Configuring the Server for Push via SSH</title>
<simpara>For tunneling connections via SSH, two available port numbers are required, one for tunneling HTTP and the second for tunneling via HTTPS (HTTP is only necessary during the registration process). The port numbers used by default are <literal>1232</literal> and <literal>1233</literal>.
To overwrite these, add two custom port numbers greater than 1024 to <literal role="path">/etc/rhn/rhn.conf</literal>
 like this:</simpara>
<screen>ssh_push_port_http = high port 1
ssh_push_port_https = high port 2</screen>
<simpara>If you would like your clients to be contacted via their hostnames instead of an IP address, set the following option:</simpara>
<screen>ssh_push_use_hostname = true</screen>
<simpara>It is also possible to adjust the number of threads to use for opening client connections in parallel.
By default two parallel threads are used.
Set <literal role="systemitem">taskomatic.ssh_push_workers</literal>
 in <literal role="path">/etc/rhn/rhn.conf</literal>
 like this:</simpara>
<screen>taskomatic.ssh_push_workers = number</screen>
</section>
<section xml:id="bp.contact.methods.ssh.push.sudo">
<title>Using sudo with Push via SSH</title>
<simpara>For security reasons you may desire to use sudo and SSH into a system as a user other than root
.
The following procedure will guide you through configuring sudo for use with Push via SSH.</simpara>
<note>
<title>sudo Requirements</title>
<simpara>The packages <literal role="path">spacewalk-taskomatic &gt;= 2.1.165.19</literal>
 and <literal role="path">spacewalk-certs-tools &#8658; 2.1.6.7</literal>
 are required for using sudo with Push via SSH.</simpara>
</note>
<orderedlist xml:id="pro.bp.contact.methods.ssh.push.sudo.user" numeration="arabic">
<title>Procedure: Configuring sudo</title>
<listitem>
<simpara>Set the following parameter on the server located in <literal role="path">/etc/rhn/rhn.conf</literal> .</simpara>
<screen>ssh_push_sudo_user =`user`</screen>
<simpara>The server will use sudo to ssh as the configured <literal role="replaceable">user</literal>.</simpara>
</listitem>
<listitem>
<simpara>You must create the user specified in <xref linkend="pro.bp.contact.methods.ssh.push.sudo.user"/> on each of your clients and the following parameters should be commented out within each client&#8217;s <literal role="path">/etc/sudoers</literal> file:</simpara>
<screen>#Defaults targetpw   # ask for the password of the target user i.e. root
#ALL    ALL=(ALL) ALL   # WARNING! Only use this together with 'Defaults targetpw'!</screen>
</listitem>
<listitem>
<simpara>Add the following lines beneath the <literal>\## User privilege specification</literal> section of each client&#8217;s <literal role="path">/etc/sudoers</literal> file:</simpara>
<screen>&lt;user&gt; ALL=(ALL) NOPASSWD:/usr/sbin/mgr_check
&lt;user&gt; ALL=(ALL) NOPASSWD:/home/&lt;user&gt;/enable.sh
&lt;user&gt; ALL=(ALL) NOPASSWD:/home/&lt;user&gt;/bootstrap.sh</screen>
</listitem>
<listitem>
<simpara>On each client add the following two lines to the <literal role="path">/home/user/.bashrc</literal> file:</simpara>
<screen>PATH=$PATH:/usr/sbin
export PATH</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="_client_registration">
<title>Client Registration</title>
<simpara>As your clients cannot reach the server, you will need to register your clients from the server.
A tool for performing registration of clients from the server is included with SUSE Manager and is called <literal role="command">mgr-ssh-push-init</literal>.
This tool expects a client&#8217;s hostname or IP address and the path to a valid bootstrap script located in the server&#8217;s filesystem for registration as parameters.</simpara>
<important>
<title>Specifying Ports for Tunneling before Registering Clients</title>
<simpara>The ports for tunneling need to be specified before the first client is registered.
Clients already registered before changing the port numbers must be registered again, otherwise the server will not be able to contact them anymore.</simpara>
</important>
<note>
<title><literal role="command">mgr-ssh-push-init</literal> Disables rhnsd</title>
<simpara>The <literal role="command">mgr-ssh-push-init</literal> command disables the <literal role="systemitem">rhnsd</literal>
 daemon which normally checks for updates every 4 hours.
Because your clients cannot reach the server without using the Push via SSH contact method, the <literal role="systemitem">rhnsd</literal>
 daemon is disabled.</simpara>
</note>
<simpara>For registration of systems which should be managed via the Push via SSH tunnel contact method, it is required to use an activation key that is configured to use this method.
Normal <literal role="systemitem">Push via SSH</literal>
 is unable to reach the server.
For managing activation keys, see <xref linkend="bp.key.managment"/>.</simpara>
<simpara>Run the following command as root
on the server to register a client:</simpara>
<screen># mgr-ssh-push-init --client client --register \
/srv/www/htdocs/pub/bootstrap/bootstrap_script --tunnel</screen>
<simpara>To enable a client to be managed using Push via SSH (without tunneling), the same script may be used.
Registration is optional since it can also be done from within the client in this case. <literal role="command">mgr-ssh-push-init</literal> will also automatically generate the necessary SSH key pair if it does not yet exist on the server:</simpara>
<screen># mgr-ssh-push-init --client`client`--register bootstrap_script</screen>
<simpara>When using the Push via SSH tunnel contact method, the client is configured to connect SUSE Manager via the high ports mentioned above (see <literal role="path">/etc/sysconfig/rhn/up2date</literal>
). Tools like <literal role="command">rhn_check</literal> and <literal role="command">zypper</literal> will need an active SSH session with the proper port forwarding options in order to access the SUSE Manager API.
To verify the Push via SSH tunnel connection manually, run the following command on the SUSE Manager server:</simpara>
<screen># ssh -i /root/.ssh/id_susemanager -R high port: susemanager :443`client`zypper ref</screen>
</section>
<section xml:id="bp.contact.methods.ssh.push.api.support">
<title>API Support for Push via SSH</title>
<simpara>The contact method to be used for managing a server can also be modified via the API.
The following example code (python) shows how to set a system&#8217;s contact method to <literal>ssh-push</literal>.
Valid values are:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>default</literal> (pull)</simpara>
</listitem>
<listitem>
<simpara><literal>ssh-push</literal></simpara>
</listitem>
<listitem>
<simpara><literal>ssh-push-tunnel</literal></simpara>
</listitem>
</itemizedlist>
<screen>client = xmlrpclib.Server(SUMA_HOST + "/rpc/api", verbose=0)
key = client.auth.login(SUMA_LOGIN, SUMA_PASSWORD)
client.system.setDetails(key, 1000012345, {'contact_method' : 'ssh-push'})</screen>
<note>
<title>Migration and Management via Push via SSH</title>
<simpara>When a system should be migrated and managed using Push via SSH, it requires setup using the <literal role="systemitem">mgr-ssh-push-init</literal>
 script before the server can connect via SSH.
This separate command requires human interaction to install the server&#8217;s SSH key onto the managed client (root
 password). The following procedure illustrates how to migrate an already registered system:</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Migrating Registered Systems</title>
<listitem>
<simpara>Setup the client using the <literal role="systemitem">mgr-ssh-push-init</literal> script (without <literal role="option">--register</literal>).</simpara>
</listitem>
<listitem>
<simpara>Change the client&#8217;s contact method to <literal>ssh-push</literal> or <literal>ssh-push-tunnel</literal> respectively (via API or Web UI).</simpara>
</listitem>
</orderedlist>
<simpara>Existing activation keys can also be edited via API to use the Push via SSH contact method for clients registered with these keys:</simpara>
<screen>client.activationkey.setDetails(key, '1-mykey', {'contact_method' : 'ssh-push'})</screen>
</section>
<section xml:id="bp.contact.methods.ssh.push.proxy.support">
<title>Proxy Support with Push via SSH</title>
<simpara>It is possible to use Push via SSH to manage systems that are connected to the SUSE Manager server via a proxy.
To register a system, run <literal role="systemitem">mgr-ssh-push-init</literal>
 on the proxy system for each client you wish to register.
Update your proxy with the latest packages to ensure the registration tool is available.
It is necessary to copy the ssh key to your proxy.
This can be achieved by executing the following command from the server:</simpara>
<screen>{prompt.root}mgr-ssh-push-init --client`proxy`</screen>
</section>
</section>
<section xml:id="bp.contact.methods.saltssh.push">
<title>Push via Salt SSH</title>
<simpara>Push via Salt SSH is intended to be used in environments where your Salt clients cannot reach the SUSE Manager server directly to regularly checking in and, for example, fetch package updates.</simpara>
<note>
<title>Push via SSH</title>
<simpara>This feature is not related to Push via SSH for the traditional clients.
For Push via SSH, see <xref linkend="bp.contact.methods.ssh.push"/>.</simpara>
</note>
<section xml:id="_overview">
<title>Overview</title>
<figure>
<title>Push via Salt SSH Contact Method</title>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-contact-taigon.png" width="80%"/>
</imageobject>
<textobject><phrase>salt ssh contact taigon</phrase></textobject>
</mediaobject>
</figure>
<simpara>Salt provides <quote>Salt SSH</quote>
 (<literal role="command">salt-ssh</literal>), a feature to manage clients from a server.
It works without installing Salt related software on clients.
Using Salt SSH there is no need to have minions connected to the Salt master.
Using this as a SUSE Manager connect method, this feature provides similar functionality for Salt clients as the traditional Push via SSH feature for traditional clients.</simpara>
<simpara>This feature allows:</simpara>
<itemizedlist>
<listitem>
<simpara>Managing Salt entitled systems with the Push via SSH contact method using Salt SSH.</simpara>
</listitem>
<listitem>
<simpara>Bootstrapping such systems.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_requirements">
<title>Requirements</title>
<itemizedlist>
<listitem>
<simpara>SSH daemon must be running on the remote system and reachable by the <literal role="systemitem">salt-api</literal> daemon (typically running on the SUSE Manager server).</simpara>
</listitem>
<listitem>
<simpara>Python must be available on the remote system (Python must be supported by the installed Salt). Currently: python 2.6.</simpara>
</listitem>
</itemizedlist>
<note>
<title>Unsupported Systems</title>
<simpara>Red Hat Enterprise Linux
and CentOS versions &#8656; 5 are not supported because they do not have Python 2.6 by default.</simpara>
</note>
</section>
<section xml:id="_bootstrapping">
<title>Bootstrapping</title>
<simpara>To bootstrap a Salt SSH system, proceed as follows:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Open the <menuchoice><guimenu>Bootstrap Minions</guimenu> <guimenuitem>] dialog in the Web UI (menu:Systems[Bootstrapping</guimenuitem></menuchoice> ).</simpara>
</listitem>
<listitem>
<simpara>Fill out the required fields. Select an <menuchoice><guimenu>Activation Key</guimenu> <guimenuitem>] with the menu:Push via SSH[</guimenuitem></menuchoice> contact method configured. For more information about activation keys, see <xref linkend="ref.webui.systems.activ-keys"/>.</simpara>
</listitem>
<listitem>
<simpara>Check the <guimenu>Manage system completely via SSH</guimenu> option.</simpara>
</listitem>
<listitem>
<simpara>Confirm with clicking the <guimenu>Bootstrap</guimenu> button.</simpara>
</listitem>
</orderedlist>
<simpara>Now the system will be bootstrapped and registered in SUSE Manager.
If done successfully, it will appear in the <guimenu>Systems</guimenu> list.</simpara>
</section>
<section xml:id="_configuration">
<title>Configuration</title>
<simpara>There are two kinds of parameters for Push via Salt SSH:</simpara>
<itemizedlist>
<listitem>
<simpara>Bootstrap-time parameters - configured in the <guimenu>Bootstrapping</guimenu> page:</simpara>
<itemizedlist>
<listitem>
<simpara>Host</simpara>
</listitem>
<listitem>
<simpara>Activation key</simpara>
</listitem>
<listitem>
<simpara>Password - used only for bootstrapping, not saved anywhere; all future SSH sessions are authorized via a key/certificate pair</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Persistent parameters - configured SUSE Manager-wide:</simpara>
<itemizedlist>
<listitem>
<simpara>sudo user - same as in <xref linkend="bp.contact.methods.ssh.push.sudo"/>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
<section xml:id="_action_execution">
<title>Action Execution</title>
<simpara>The Push via Salt SSH feature uses a taskomatic job to execute scheduled actions using <literal role="command">salt-ssh</literal>.
The taskomatic job periodically checks for scheduled actions and executes them.
While on traditional clients with SSH push configured only <literal role="command">rhn_check</literal> is executed via SSH, the Salt SSH push job executes a complete <literal role="command">salt-ssh</literal> call based on the scheduled action.</simpara>
</section>
<section xml:id="_known_limitation">
<title>Known Limitation</title>
<itemizedlist>
<listitem>
<simpara>OpenSCAP auditing is not available on Salt SSH minions.</simpara>
</listitem>
<listitem>
<simpara>Beacons do not work with Salt SSH.</simpara>
<itemizedlist>
<listitem>
<simpara>Installing a package on a system using <literal role="command">zypper</literal> will not invoke the package refresh.</simpara>
</listitem>
<listitem>
<simpara>Virtual Host functions (for example, a host to guests) will not work if the virtual host system is Salt SSH-based.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
<section xml:id="_for_more_information">
<title>For More Information</title>
<simpara>For more information, see</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://wiki.microfocus.com/index.php/SUSE_Manager/SaltSSHServerPush">https://wiki.microfocus.com/index.php/SUSE_Manager/SaltSSHServerPush</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/ssh/">https://docs.saltstack.com/en/latest/topics/ssh/</link></simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="bp.contact.methods.osad">
<title>OSAD</title>
<simpara>OSAD is an alternative contact method between SUSE Manager and its clients.
By default, SUSE Manager uses <literal role="systemitem">rhnsd</literal>, which contacts the server every four hours to execute scheduled actions.
OSAD allows registered client systems to execute scheduled actions immediately.</simpara>
<note>
<title>Keep <literal role="systemitem">rhnsd</literal> Running</title>
<simpara>Use OSAD only in addition to <literal role="systemitem">rhnsd</literal>.
If you disable <literal role="systemitem">rhnsd</literal> your client will be shown as not checking in after 24 hours.</simpara>
</note>
<simpara>OSAD has several distinct components:</simpara>
<itemizedlist>
<listitem>
<simpara>The <literal role="systemitem">osa-dispatcher</literal> service runs on the server, and uses database checks  to determine if clients need to be pinged, or if actions need to be executed.</simpara>
</listitem>
<listitem>
<simpara>The <literal role="systemitem">osad</literal> service runs on the client. It responds to pings from <literal role="systemitem">osa-dispatcher</literal> and runs <literal role="command">mgr_check</literal> to execute actions when directed to do so.</simpara>
</listitem>
<listitem>
<simpara>The <literal role="systemitem">jabberd</literal> service is a daemon that uses the <literal role="systemitem">XMPP</literal> protocol for communication between the client and the server.
The <literal role="systemitem">jabberd</literal> service also handles authentication.</simpara>
</listitem>
<listitem>
<simpara>The <literal role="command">mgr_check</literal> tool runs on the client to execute actions.
It is triggered by communication from the <literal role="systemitem">osa-dispatcher</literal> service.</simpara>
</listitem>
</itemizedlist>
<simpara>The <literal role="systemitem">osa-dispatcher</literal> periodically runs a query to check when clients last showed network activity.
If it finds a client that has not shown activity recently, it will use <literal role="systemitem">jabberd</literal> to ping all <literal role="systemitem">osad</literal> instances running on all clients registered with your SUSE Manager server.
The <literal role="systemitem">osad</literal> instances respond to the ping using <literal role="systemitem">jabberd</literal>, which is running in the background on the server.
When the <literal role="systemitem">osa-dispatcher</literal> receives the response, it marks the client as online.
If the <literal role="systemitem">osa-dispatcher</literal> fails to receive a response within a certain period of time, it marks the client as offline.</simpara>
<simpara>When you schedule actions on an OSAD-enabled system, the task will be carried out  immediately.
The <literal role="systemitem">osa-dispatcher</literal> periodically checks clients for actions that need to be executed.
If an outstanding action is found, it uses <literal role="systemitem">jabberd</literal> to execute <literal role="command">mgr_check</literal> on the client, which will then execute the action.</simpara>
<section xml:id="_enabling_and_configuring_osad">
<title>Enabling and Configuring OSAD</title>
<simpara>This section covers enabling the <literal role="systemitem">osa-dispatcher</literal> and <literal role="systemitem">osad</literal> services, and performing initial setup.</simpara>
<simpara>OSAD clients use the fully qualified domain name (FQDN) of the server to communicate with the <literal role="systemitem">osa-dispatcher</literal> service.</simpara>
<simpara>SSL is required for <literal role="systemitem">osad</literal> communication.
If SSL certificates are not available, the daemon on your client systems will fail to connect.
Make sure your firewall rules are set to allow the required ports.
For more information, see <xref linkend="tab.install.ports.server"/>.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Enabling OSAD</title>
<listitem>
<simpara>On your SUSE Manager server, as the root user, start the <literal role="systemitem">osa-dispatcher</literal> service:</simpara>
<screen>systemctl start osa-dispatcher</screen>
</listitem>
<listitem>
<simpara>On each client machine, install the <literal role="systemitem">osad</literal> package from the <literal role="systemitem">Tools</literal> child channel.
The <literal role="systemitem">osad</literal> package should be installed on clients only.
If you install the <literal role="systemitem">osad</literal> package on your SUSE Manager Server, it will conflict with the <literal role="systemitem">osa-dispatcher</literal> package.</simpara>
</listitem>
<listitem>
<simpara>On the client systems, as the root user, start the <literal role="systemitem">osad</literal> service:</simpara>
<screen>systemctl start osad</screen>
<simpara>Because <literal role="systemitem">osad</literal> and <literal role="systemitem">osa-dispatcher</literal> are run as services, you can use standard commands to manage them, including <literal role="command">stop</literal>, <literal role="command">restart</literal>, and <literal role="command">status</literal>.</simpara>
</listitem>
</orderedlist>
<formalpara>
<title>Configuration and Log Files</title>
<para>Each OSAD component is configured by local configuration files.
We recommend you keep the default configuration parameters for all OSAD components.</para>
</formalpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Component</entry>
<entry align="left" valign="top">Location</entry>
<entry align="left" valign="top">Path to Configuration File</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal role="systemitem">osa-dispatcher</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Server</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/etc/rhn/rhn.conf</literal> Section: <literal role="systemitem">OSA configuration</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal role="systemitem">osad</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Client</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/etc/sysconfig/rhn/osad.conf</literal> <literal role="path">/etc/syseconfig/rhn/up2date</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal role="systemitem">osad</literal>  log file</simpara></entry>
<entry align="left" valign="top"><simpara>Client</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/log/osad</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal role="systemitem">jabberd</literal> log file</simpara></entry>
<entry align="left" valign="top"><simpara>Both</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="path">/var/log/messages</literal></simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<formalpara>
<title>Troubleshooting OSAD</title>
<para>If your OSAD clients cannot connect to the server, or if the <literal role="systemitem">jabberd</literal> service takes a lot of time responding to port 5552, it could be because you have exceeded the open file count.</para>
</formalpara>
<simpara>Every client needs one always-open TCP connection to the server, which consumes a single file handler.
If the number of file handlers currently open exceeds the maximum number of files that <literal role="systemitem">jabberd</literal> is allowed to use, <literal role="systemitem">jabberd</literal> will queue the requests, and refuse connections.</simpara>
<simpara>To resolve this issue, you can increase the file limits for <literal role="systemitem">jabberd</literal> by editing the <literal role="path">/etc/security/limits.conf</literal> configuration file and adding these lines:</simpara>
<screen>jabbersoftnofile5100
jabberhardnofile6000</screen>
<simpara>Calculate the limits required for your environment by adding 100 to the number of clients for the soft limit, and 1000 to the current number of clients for the soft limit.
In the example above, we have assumed 500 current clients, so the soft limit is 5100, and the hard limit is 6000.</simpara>
<simpara>You will also need to update the <literal role="systemitem">max_fds</literal> parameter in the <literal role="path">/etc/jabberd/c2s.xml</literal> file with your chosen hard limit:</simpara>
<screen>&lt;max_fds&gt;6000&lt;/max_fds&gt;</screen>
</section>
</section>
</chapter>
<chapter xml:id="bp.susecom.lifecycle.management">
<title>Advanced Patch Lifecycle Management</title>
<simpara>Keeping systems patched and secure remains one of the greatest ongoing challenges that you will face as an administrator.
Both proprietary and open-source companies are constantly working to provide updates which fix flaws discovered within their software products.</simpara>
<simpara>For the official <emphasis><phrase role="ref">Best Practice Guide</phrase></emphasis>
 on <quote>Advanced Patch Lifecycle Management</quote>
, see <link xl:href="https://www.suse.com/documentation/suse-best-practices/susemanager/data/susemanager.html">https://www.suse.com/documentation/suse-best-practices/susemanager/data/susemanager.html</link>.</simpara>
</chapter>
<chapter xml:id="bp.live.patching">
<title>Live Patching with SUSE Manager</title>
<section xml:id="live.patching.intro">
<title>Introduction</title>
<simpara>Under normal circumstances a system needs to be rebooted after a kernel update.
SLE Live Patching allows you skipping the reboot by applying a subset of Linux kernel releases injected via kGraft live patching technology.</simpara>
<simpara>In the following sections you will learn how to use SLE Live Patching to avoid the typical reboot requirement after updating a system kernel.</simpara>
<simpara>For in depth information covering kGraft use, see <link xl:href="https://www.suse.com/documentation/sles-12/singlehtml/book_sle_admin/book_sle_admin.html#cha.kgraft">https://www.suse.com/documentation/sles-12/singlehtml/book_sle_admin/book_sle_admin.html#cha.kgraft</link>.</simpara>
</section>
<section xml:id="live.patching.req">
<title>Initial Setup Requirements</title>
<simpara>To work with SLE Live Patching the following expectations are assumed:</simpara>
<itemizedlist>
<listitem>
<simpara>SUSE Manager fully updated.</simpara>
</listitem>
<listitem>
<simpara>At least 1 Salt Minion running SLES 12 SP1 or later and registered with SUSE Manager.</simpara>
</listitem>
<listitem>
<simpara>The matching SLES 12 SPx channels including the SLE Live Patching child channel fully synced.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="live.patching.setup">
<title>Live Patching Setup</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>Subscribe all systems to be managed via live patching to your fully synced live patching child channels within your systems base channel by browsing to <menuchoice><guimenu>Software</guimenu> <guimenuitem>Software Channels</guimenuitem></menuchoice>. Select both live patching channels and change subscription.</simpara>
<note>
<simpara>When subscribing to a channel that contains a product, the product package will automatically be installed on traditionaly registered systems and added to the package state on Salt managed systems.
For Salt managed systems please apply the highstate to push these changes to your systems.</simpara>
</note>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="enable_live_patching_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>enable live patching channels</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Use the search field listed under <menuchoice><guimenu>Software</guimenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>Install</guimenuitem></menuchoice> to install the latest <literal role="path">kgraft</literal> package to all systems to be managed via live patching.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="enable_live_patching_kgraft_install.png" width="80%"/>
</imageobject>
<textobject><phrase>enable live patching kgraft install</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Apply the highstate to enable live patching:</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="enable_live_patching_apply_highstate.png" width="80%"/>
</imageobject>
<textobject><phrase>enable live patching apply highstate</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Once the highstate has been applied on Salt systems or the package has been installed on traditional systems browse to the systems details page for confirmation that live patching has been enabled. You can check the live patching state listed under the <menuchoice><guimenu>System Info</guimenu> <guimenuitem>Kernel</guimenuitem></menuchoice> table field:</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="enable_live_patching_successful.png" width="80%"/>
</imageobject>
<textobject><phrase>enable live patching successful</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="live.patching.clones">
<title>Cloning Channels</title>
<simpara>It is considered best practice to clone a vendor channel that will be modified into a new channel with one of the following prefix names: <literal>dev</literal>, <literal>testing</literal>, and <literal>prod</literal>.
In the following procedure you will clone the default vendor channel into a new channel named <literal role="systemitem">dev-sles12-sp3-pool-x86_64</literal> using the command line.</simpara>
<orderedlist xml:id="proc.live.patching.clones" numeration="arabic">
<listitem>
<simpara>Open a terminal and as root enter:</simpara>
<screen># spacewalk-manage-channel-lifecycle --list-channels
Spacewalk Username: admin
Spacewalk Password:
Channel tree:

 1. sles{sles-version}-sp{sp-ver}-pool-x86_64
      \__ sle-live-patching{sles-version}-pool-x86_64-sp{sp-ver}
      \__ sle-live-patching{sles-version}-updates-x86_64-sp{sp-ver}
      \__ sle-manager-tools{sles-version}-pool-x86_64-sp{sp-ver}
      \__ sle-manager-tools{sles-version}-updates-x86_64-sp{sp-ver}
      \__ sles{sles-version}-sp{sp-ver}-updates-x86_64</screen>
</listitem>
<listitem>
<simpara>Now use the <emphasis>--init</emphasis> argument to automatically create a new development clone of the original vendor channel:</simpara>
<screen>spacewalk-manage-channel-lifecycle --init -c sles{sles-version}-sp{sp-ver}-pool-x86_64</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="live.patching.kernel">
<title>Removing Non-live Kernel Patches from the Cloned Channels</title>
<simpara>In the following procedure you will remove all kernel patch updates located in the dev-sles12-sp4-updates-x86_64 channel that require a reboot.
You created dev-sles12-sp4-updates-x86_64 during <xref linkend="live.patching.clones"/>.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Check the current kernel version in use on your client:</simpara>
<screen># uname -r
3.12.62-60.64.8-default</screen>
</listitem>
<listitem>
<simpara>From the SUSE Manager Web UI select <menuchoice><guimenu>Software</guimenu> <guisubmenu>Manage Software Channels</guisubmenu> <guisubmenu>Overview</guisubmenu> <guisubmenu>dev-sles12-sp3-updates-x86_64</guisubmenu> <guisubmenu>Patches</guisubmenu> <guimenuitem>List/Remove</guimenuitem></menuchoice> . Type <literal>kernel</literal> in the search field. Find the kernel version that matches the kernel in use on your minion.</simpara>
</listitem>
<listitem>
<simpara>Remove all kernel update versions that are later than the current kernel.</simpara>
</listitem>
<listitem>
<simpara>Your channel is now ready to promote for testing SLE Live Patching.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="live.patching.channel-promo">
<title>Promoting Channels</title>
<simpara>The following procedure will guide you through promoting and cloning a development channel to a testing channel.
You will change the subscription from the dev repositories on your client to the new testing channel repositories.
You will also add the SLE Live Patching child channels to your client.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Promote and clone the <literal>dev-sles12 -sp4 -pool-x86_64</literal> to a new testing channel:</simpara>
<screen>{prompt.root}spacewalk-manage-channel-lifecycle --promote -c dev-sles{sles-version}-sp{sp-ver}-pool-x86_64</screen>
</listitem>
<listitem>
<simpara>From the SUSE Manager Web UI under the <literal role="guimenu">Systems</literal> tab select your client system to view the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>] page. Select menu:Software[Software Channels</guimenuitem></menuchoice>. From the Software Channels page you can edit which channels a system is subscribed to. Select the new base software channel, in this case it should be <literal role="systemitem">test-sles12-sp3-pool-x86_64</literal>. Click the <guibutton>Confirm</guibutton> button to switch the Base Software Channel and finalize it by clicking the <guibutton>Modify Base Software Channel</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>From the <guimenu>Software Channels</guimenu> page select and add both SLE Live Patching child channels by clicking the <guibutton>Change Subscriptions</guibutton> button.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="live.patching.applying">
<title>Applying Live Patches to a Kernel</title>
<simpara>The following procedure will guide you through selecting and viewing available CVE Patches (Common Vulnerabilities and Exposures) then applying these kernel updates using the new SLE Live Patching feature.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select your SLES 12 SP4 minion from the <literal role="guimenu">Systems</literal> page to view its <guimenu>System Details</guimenu> . Once you have added the SLES 12 SP4 Updates child channel to your client, you should see several <literal>Critical</literal> software updates available. Click on <literal>Critical</literal> to see a list of available patches. Select any of these patches listed with the following synopsis: <emphasis>Important: Security update for the Linux kernel</emphasis>. All fixed security bugs will be listed along with their number. For example:(CVE-2016-8666)</simpara>
<important>
<title>Reboot Icon</title>
<simpara>Normal or non-live kernel patches always require a reboot.
In SUSE Manager these are represented by a <literal>Reboot Required</literal> icon located next to the <literal>Security</literal> shield icon.</simpara>
</important>
</listitem>
<listitem>
<simpara>You can search for individual CVE&#8217;s by selecting the <guimenu>Audit</guimenu> tab from the navigation menu. Try searching for <literal>CVE-2016-8666</literal>. You will see that the patch is available in the vendor update channel and the systems it applies to will be listed.</simpara>
</listitem>
</orderedlist>
<important>
<title>CVE Availability</title>
<simpara>Not all security issues can be fixed by applying a live patch.
Some security issues can only be fixed by applying a full kernel update and will required a reboot.
The assigned CVE numbers for these issues are not included in live patches.
A CVE audit will display this requirement.</simpara>
</important>
</section>
</chapter>
<chapter xml:id="bp.sp.migration">
<title>SUSE Manager Server Migration</title>
<section xml:id="bp.sp.migration.sp.intro">
<title>Service Pack Migration Introduction</title>
<simpara>You can upgrade the underlying operating system and also migrate SUSE Manager server from one patch level to the other (SP migration) or from one version to the next.
This works for migrating SUSE Manager server 3.0 to version 3.1, or version 3.1 to version 3.2.
For migrating version 3.0 to version 3.1, see the product documentation for SUSE Manager 3.1:</simpara>
<screen>https://www.suse.com/documentation/suse-manager-3/</screen>
</section>
<section xml:id="bp.sp.migration.sp">
<title>Service Pack Migration</title>
<simpara>SUSE Manager uses SUSE Linux Enterprise Server 12 as its underlying operating system.
Therefore Service Pack migration (for example, from version 12 SP1 to 12 SP3) may be performed in the same way as a typical SLES migration.</simpara>
<warning>
<title>Upgrading PostgreSQL to Version 9.6 Before Migrating to SLES12 SP3 or Later</title>
<simpara>Before migrating the underlying system to SUSE Linux Enterprise 12 SP3 or later, you must upgrade PostgreSQL to version 9.6.</simpara>
<simpara>The migration needs PostgreSQL 9.4 and 9.6 installed in parallel and PostgreSQL 9.4 is only available in SUSE Linux Enterprise 12 SP2.
For more information, see <xref linkend="sp.migration.postgresql"/>.</simpara>
</warning>
<simpara>SUSE offers a graphical and command line tool for upgrading to a new service pack.
Comprehensive documentation for executing service pack migration scenarios is located in the SUSE Linux Enterprise Server documentation chapter <link xl:href="https://www.suse.com/documentation/sles-12/book_sle_deployment/data/cha_update_sle.html">https://www.suse.com/documentation/sles-12/book_sle_deployment/data/cha_update_sle.html</link>.</simpara>
</section>
<section xml:id="sp.migration.postgresql">
<title>Upgrading PostgreSQL to Version 9.6</title>
<warning>
<title>Migrating to SLES 12 SP3</title>
<simpara>SUSE Manager Server 3.1 must <emphasis>not</emphasis> be migrated to SLES 12 SP3 or later before upgrading PostgreSQL to version 9.6.</simpara>
</warning>
<simpara>The upgrade needs PostgreSQL 9.4 and 9.6 installed in parallel.
PostgreSQL 9.4 is only available in SLES 12 SP2.</simpara>
<simpara>Before starting the update, prepare an up-to-date backup of your database.</simpara>
<simpara>On existing installations of SUSE Manager Server 3.1 you must migrate from PostgreSQL 9.4 to version 9.6.</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate.sh</screen>
<simpara>During the upgrade your SUSE Manager Server will not be accessible.</simpara>
<simpara>The upgrade will create a copy of the database under <literal role="path">/var/lib/pgsql</literal> and thus needs sufficient disk space to hold two copies (versions 9.4 and 9.6) of the database.
Because it does a full copy of the database, it also needs considerable time depending on the size of the database and the I/O speed of the storage system.</simpara>
<simpara>If your system is short on disk space you can do a fast, in-place upgrade by running</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate.sh fast</screen>
<simpara>The fast upgrade usually only takes a few minutes and uses no additional disk space.
However, if the upgrade fails, you will need to restore the database from a backup.</simpara>
<simpara>For more information, see <link xl:href="https://wiki.microfocus.com/index.php?title=SUSE_Manager/postgresql96">https://wiki.microfocus.com/index.php?title=SUSE_Manager/postgresql96</link>.</simpara>
</section>
<section xml:id="update.suse.manager">
<title>Updating SUSE Manager</title>
<simpara>This section provides information on performing regular updates and running a <literal role="command">spacewalk-schema-upgrade</literal> on your PostgreSQL database.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Updating SUSE Manager</title>
<listitem>
<simpara>As the root user, stop Spacewalk services:</simpara>
<screen>spacewalk-service stop</screen>
</listitem>
<listitem>
<simpara>Apply the latest patches:</simpara>
<screen>zypper patch</screen>
</listitem>
<listitem>
<simpara>You will be informed if a new database schema was included in the latest patch. Ensure the database service is running:</simpara>
<screen>rcpostgresql start</screen>
</listitem>
<listitem>
<simpara>Perform the upgrade:</simpara>
<screen>spacewalk-schema-upgrade</screen>
</listitem>
<listitem>
<simpara>Restart Spacewalk services:</simpara>
<screen>spacewalk-service start</screen>
<important>
<title>Restart of Services and Applications</title>
<simpara>Services affected by a package update are not automatically restarted after an update.
You need to restart these services manually to avoid potential failures.</simpara>
<simpara>You may use <literal role="command">zypper ps</literal> to check for any applications which may be using old code.
Restart these applications.</simpara>
</important>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.sp.migration.version">
<title>Migrating SUSE Manager version 3.1 to 3.2</title>
<simpara>The migration can either be done with the Online Migration tool (YaST) or with the Zypper command line tool.</simpara>
<formalpara>
<title>Requirements</title>
<para>SUSE Manager 3.2 requires SLES 12 SP3 or later, with PostgreSQL version 9.6.
Check the release notes for more information about these requirements.
If you want to upgrade from an earlier version of SUSE Manager, check the relevant product documentation.</para>
</formalpara>
<note>
<title>Reduce Installation Size</title>
<simpara>When performing the migration, YaST will install all recommended packages.
Especially in the case of custom minimal installations, this may increase the installation size of the system significantly.</simpara>
<simpara>To change this default behavior and allow only required packages, adjust <literal role="path">/etc/zypp/zypp.conf</literal> and set the following variable:</simpara>
<screen>solver.onlyRequires = true
installRecommends=false # or commented</screen>
<simpara>This changes the behavior of all package operations, such as the installation of patches or new packages.</simpara>
</note>
<section xml:id="bp.sp.migration.version.yast">
<title>Using YaST</title>
<warning>
<title>Checking PostgreSQL Version</title>
<simpara>Before migrating to SLES 12 SP3 or later, check whether PostgreSQL is already updated to version 9.6.
For more information, see <xref linkend="sp.migration.postgresql"/>.</simpara>
</warning>
<simpara>To perform the migration with YaST, use the <guimenu>Online Migration</guimenu> tool:</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Migrating using YaST</title>
<listitem>
<simpara>If you are logged into a GNOME session running on the machine you are going to update, switch to a text console.
Running the update from within a GNOME session is not recommended.
This does not apply when being logged in from a remote machine (unless you are running a VNC session with GNOME).</simpara>
</listitem>
<listitem>
<simpara>Start in YaST<menuchoice><guimenu>System</guimenu> <guimenuitem>Online Migration</guimenuitem></menuchoice> (<literal role="command">yast2 migration</literal>).
YaST will show possible migration targets with detailed summaries.</simpara>
<simpara>In case of trouble, resolve the following issues first:</simpara>
<itemizedlist>
<listitem>
<simpara>If the <guimenu>Online Migration</guimenu> is not available, install the <phrase role="package">yast2-migration</phrase> package and its dependencies.
Restart YaST , otherwise the newly installed module will not be shown in the control center.</simpara>
</listitem>
<listitem>
<simpara>If there are <quote>old</quote> online updates available for installation, the migration tool will warn and ask to install them now before starting the actual migration.
It is recommended to install all updates before proceeding.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.sp.migration.version.zypper">
<title>Using zypper</title>
<warning>
<title>Checking PostgreSQL Version</title>
<simpara>Before migrating to SLES 12 SP3 or later, check whether PostgreSQL is already updated to version 9.6.
For more information, see <xref linkend="sp.migration.postgresql"/>.</simpara>
</warning>
<simpara>To perform the migration with Zypper on the command-line, use the <literal role="command">zypper migration</literal> subcommand tool:</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Migrating using <literal role="command">zypper migration</literal></title>
<listitem>
<simpara>If you are logged into a GNOME session running on the machine you are going to update, switch to a text console.
Running the update from within a GNOME session is not recommended.
This does not apply when being logged in from a remote machine (unless you are running a VNC session with GNOME).</simpara>
</listitem>
<listitem>
<simpara>The <literal role="command">zypper migration</literal> subcommand show possible migration targets and a summary.</simpara>
<simpara>In case of trouble, resolve the following issues first:</simpara>
<itemizedlist>
<listitem>
<simpara>If the <literal role="command">migration</literal> subcommand is not available install the <phrase role="package">zypper-migration-plugin</phrase> package and its dependencies.</simpara>
</listitem>
<listitem>
<simpara>If there are <quote>old</quote> online updates available for installation, the migration tool will warn and ask to install them now before starting the actual migration.
It is recommended to install all updates before proceeding.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>If more than one migration target is available for your system, select one from the list (specify the number).</simpara>
</listitem>
<listitem>
<simpara>Read the notification and update the SUSE Manager database schema as described (<literal role="command">spacewalk-schema-upgrade</literal>).</simpara>
</listitem>
<listitem>
<simpara>Make sure SUSE Manager is up and running (<literal role="command">spacewalk-service start</literal>).</simpara>
</listitem>
</orderedlist>
<simpara>After finishing the migration procedure SUSE Manager 3.2 on SLES 12 SP3 or later is available to be used.</simpara>
</section>
</section>
<section xml:id="bp.chap.mgr.migration">
<title>SUSE Manager Migration from Version 2.1 to Version 3</title>
<simpara>The migration from SUSE Manager 2.1 to SUSE Manager 3 works in the same way as a migration from Red Hat Satellite to SUSE Manager.
The migration happens from the original machine to a new one.
There is no in-place migration.
While this has the drawback that you temporarily need two machines, it also has the advantage that the original machine will remain fully functional in case something goes wrong.</simpara>
<important>
<title>Migration Process</title>
<simpara>The whole process may be tricky, so it is strongly advised that the migration is done by an experienced consultant.</simpara>
</important>
<simpara>Given the complexity of the product, the migration is an <quote>all-or-nothing</quote>
 procedure-
if something goes wrong you will need to start all over.
Error handling is very limited.
Nevertheless it should work more or less out of the box if all the steps are carefully executed as documented.</simpara>
<note>
<title>Time-Consuming Operation</title>
<simpara>The migration involves dumping the whole database on the source machine and restoring it on the target machine.
Also all of the channels and packages need to be copied to the new machine, so expect the whole migration to take several hours,</simpara>
</note>
<section xml:id="bp.sec.mgr.migration.prereq">
<title>Prerequisites</title>
<warning>
<title>Latest Updates</title>
<simpara>The source machine needs to run SUSE Manager 2.1 with all the latest updates applied.
Before starting the migration process, make sure that the machine is up to date and all updates have been installed sucessfully.</simpara>
</warning>
<simpara>Only machines running with the embedded PostgreSQL database may be migrated in one go.
For the migration of an Oracle based installation, a two-step migration is required: First the installation needs to get migrated from Oracle to PostgreSQL (by means of a separate tool) and afterwards the migration to SUSE Manager 3 can be performed as documented here.</simpara>
<simpara>SUSE Manager 3 no longer supports Novell Customer Center but only SCC (SUSE Customer Center).
Therefore, you can migrate a machine only after it has been switched to SCC.
The migration script will check if the installation has already been switched to SCC and will terminate if this is not the case.
Switch to SCC on the source machine and repeat the migration.
During migration the database from the source machine needs to get dumped and this dump needs to be temporarily stored on the target system.
The dump gets compressed with <literal role="command">gzip</literal> using the default compression options (maximum compression only yields about 10% of space savings but costs a lot of runtime); so check the disk usage of the database with:</simpara>
<screen>{prompt.root}du -sch /var/lib/pgsql/data</screen>
<simpara>This will ensure that you have at least 30 % of this value available in <literal role="path">/var/spacewalk/tmp</literal>
.</simpara>
<simpara>These values from a test migration should aid in illustrating space requirements:</simpara>
<screen>suma21:/var/lib/pgsql# du -sch data
1,8G    data
1,8G    total
suma21:/var/spacewalk/tmp# ls -lh susemanager.dmp.gz
-rw-r--r-- 1 root root 506M Jan 12 14:58 susemanager.dmp.gz</screen>
<simpara>This is a small test installation; for bigger installations the ratio might be better (space required for the database dump might be less than 30%). The dump will be written to the directory <literal role="path">/var/spacewalk/tmp</literal>
, the directory will be created if it does not exist yet.
If you want the dump to be stored somewhere else, change the definition of the variable <literal role="var">$TMPDIR</literal> on the beginning of the script to suit your needs.</simpara>
</section>
<section xml:id="bp.sec.mgr.migration.setup.target">
<title>Setup the Target Machine</title>
<simpara>To prepare the target machine (with the example host name <literal>suma30</literal>) proceed as follows:</simpara>
<orderedlist xml:id="proc.mgr.migration.setup.target" numeration="arabic">
<title>Procedure: Setup Target Machine</title>
<listitem>
<simpara>On the target machine install SUSE Linux Enterprise Server 12 SP2 including the extension product <quote>SUSE Manager</quote> .</simpara>
<important>
<title>Background Information on Required Target Machine</title>
<simpara>It is actually required to install version 12 SP2 on the target machine.
On that version you will upgrade the PostgreSQL database from version_9.4 to 9.6.
For more information about the PostgreSQL upgrade, see <xref linkend="sp.migration.postgresql"/>.</simpara>
</important>
</listitem>
<listitem>
<simpara>Initiate <literal role="command">yast2 susemanagersetup</literal> as you would normally do for an installation of SUSE Manager.</simpara>
<simpara>For more information about installing SUSE Manager, see <xref linkend="sles.installation.within.kvm.jeos"/>.</simpara>
</listitem>
<listitem>
<simpara>On the first SUSE Manager setup screen, ensure that <menuchoice><guimenu>Migrate a SUSE Manager compatible server</guimenu> <guimenuitem>] is marked instead of menu:Set up SUSE Manager from scratch[</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>On the second screen, enter the name of the source system as <guimenu>Hostname of source SUSE Manager Server</guimenu> as well as the domain name. Also enter the database credentials of the source system.</simpara>
</listitem>
<listitem>
<simpara>On the next screen, you will need to specify the IP address of the SUSE Manager 3 target system. Normally this value should be pre-set to the correct value and you only should need to press <keycap>Enter</keycap> . Only in the case of multiple IP addresses you might need to specify the one that should be used during migration.</simpara>
<important>
<title>Faking the Host Name</title>
<simpara>During the migration process, the target system will fake its host name to be the same as the source system, this is necessary as the host name of a SUSE Manager installation is vital and should not be changed once set.
Therefore do not be confused when logging in to your systems during migration; they both will present you with the same host name.</simpara>
</important>
</listitem>
<listitem>
<simpara>Continue by following the normal installation steps.</simpara>
<important>
<title>Database Parameters</title>
<simpara>Specify the database parameters using the same database parameters as the source system is recommended.
At least, using the the same database credentials as when creating the source or original SUSE Manager database is mandatory.</simpara>
</important>
<simpara>Enter your SCC credentials.
After all the data has been gathered, YaST
will terminate.</simpara>
</listitem>
</orderedlist>
<simpara>The actual migration will not start automatically but needs to be triggered manually as outlined in <xref linkend="bp.sec.mgr.migration.performing"/>.</simpara>
</section>
<section xml:id="bp.sec.mgr.migration.performing">
<title>Performing the Migration</title>
<simpara>A migration is performed by excecuting the following command:</simpara>
<screen>/usr/lib/susemanager/bin/mgr-setup -m</screen>
<simpara>This command reads the data gathered during <xref linkend="proc.mgr.migration.setup.target"/>, sets up SUSE Manager onto a new target machine and transfers all of the data from the source machine.
As several operations need to be performed on the source machine via SSH, you will be prompted once for the root password of the source machine.
A temporary SSH key named <literal>migration-key</literal> is created and installed on the source machine, so you need to give the root
 password only once.
The temporary SSH key will be deleted after successful migration.
Ideally, this is all you will need to do.</simpara>
<simpara>Depending on the size of the installation, the actual migration will take up to several hours.
Once finished, you will be prompted to shutdown the source machine, re-configure the network of the target machine to use the same IP address and host name as the original machine and restart it.
It should now be a fully functional replacement for your previous SUSE Manager 2.1 installation.
The following numbers illustrate the runtime for dumping and importing a small database:</simpara>
<screen>14:53:37   Dumping remote database to /var/spacewalk/tmp/susemanager.dmp.gz on target system. Please wait...
14:58:14   Database successfully dumped. Size is: 506M
14:58:29   Importing database dump. Please wait...
15:05:11   Database dump successfully imported.</screen>
<simpara>For this example dumping the database takes around five minutes to complete.
Importing the dump onto the target system will take an additional seven minutes.
For big installations this can take up to several hours.
You should also account for the time it takes to copy all the package data to the new machine.
Depending on your network infrastructure and hardware, this can also take a significant amount of time.</simpara>
</section>
<section xml:id="bp.sec.mgr.migration.speedup">
<title>Speeding up the Migration</title>
<simpara>A complete migration can consume a lot of time.
This is caused by the amount of data that must be copied.
Total migration time can be greatly decreased by eliminating the need to copy data prior to performing the migration (for example, channels, packages, auto-install images, and any additional data). You can gather all data via YaST
by running the command <literal role="command">mgr-setup -r</literal>.</simpara>
<simpara>Executing <literal role="command">mgr-setup -r</literal> will copy the data from the old server to the new one.
This command may be run at any time and your current server will remain fully functional.
Once the migration has been initiated only data changed since running <literal role="command">mgr-setup -r</literal> will need to be transferred which will significantly reduces downtime.</simpara>
<simpara>On large installations transfering the database (which involves dumping the database onto the source machine and then importing the dump onto the target system) will still take some time.
During the database transfer no write operations should occur therefore the migration script will shut down any SUSE Manager database services running on the source machine.</simpara>
</section>
<section xml:id="bp.sec.mgr.migration.pkg.extern">
<title>Packages on External Storage</title>
<simpara>Some installations may store the package data on external storage (for example, NFS mount on <literal role="path">/var/spacewalk/packages</literal>
). You do not need to copy this data to the new machine.
Edit the script located in <literal role="path">/usr/lib/susemanager/bin/mgr-setup</literal>
 and remove the respective <literal role="command">rsync</literal> command (located around line 345).</simpara>
<important>
<title>Mounting External Storage</title>
<simpara>Make sure your external storage is mounted on the new machine before starting the system for the first time.
Analogue handling for <literal role="path">/srv/www/htdocs/pub</literal>
 if appropriate.</simpara>
<simpara>In general, all needed files and directories, not copied by the migration tool, should be copied to the new server manually.</simpara>
</important>
</section>
<section xml:id="bp.sec.mgr.migration.trouble">
<title>Troubleshooting a Broken Web UI after Migration</title>
<simpara>It is possible that the Web UI
may break during migration.
This behavior is not a bug, but a browser caching issue.
The new machine has the same host name and IP address as the old machine.
This duplication can confuse some Web browsers.
If you experience this issue reload the page.
For example, in Firefox pressing the key combination <keycombo><keycap>Ctrl</keycap><keycap>F5</keycap></keycombo>
 should resume normal functionality.</simpara>
</section>
<section xml:id="bp.sec.mgr.migration.example">
<title>Example Session</title>
<simpara>This is the output of a typical migration:</simpara>
<screen>suma30# /usr/lib/susemanager/bin/mgr-setup -m
  Filesystem type for /var/spacewalk is ext4 - ok.
  Open needed firewall ports...
  Migration needs to execute several commands on the remote machine.
  Please enter the root password of the remote machine.
Password:
  Remote machine is SUSE Manager
  Remote system is already migrated to SCC. Good.
  Shutting down remote spacewalk services...
  Shutting down spacewalk services...
  Stopping Taskomatic...
  Stopped Taskomatic.
  Stopping cobbler daemon: ..done

  Stopping rhn-search...
  Stopped rhn-search.
  Stopping MonitoringScout ...
  [ OK ]
  Stopping Monitoring ...
  [ OK ]
  Shutting down osa-dispatcher: ..done
  Shutting down httpd2 (waiting for all children to terminate) ..done
  Shutting down Tomcat (/usr/share/tomcat6)
  ..done
  Terminating jabberd processes...
        Stopping router ..done
        Stopping sm ..done
        Stopping c2s ..done
        Stopping s2s ..done
  Done.
  CREATE ROLE
  * Loading answer file: /root/spacewalk-answers.
  ** Database: Setting up database connection for PostgreSQL backend.
  ** Database: Populating database.
  ** Database: Skipping database population.
  * Configuring tomcat.
  * Setting up users and groups.
  ** GPG: Initializing GPG and importing key.
  * Performing initial configuration.
  * Configuring apache SSL virtual host.
  ** /etc/apache2/vhosts.d/vhost-ssl.conf has been backed up to vhost-ssl.conf-swsave
  * Configuring jabberd.
  * Creating SSL certificates.
  ** Skipping SSL certificate generation.
  * Deploying configuration files.
  * Setting up Cobbler..
  * Setting up Salt Master.
  11:26:47   Dumping remote database. Please wait...
  11:26:50   Database successfully dumped.
  Copy remote database dump to local machine...
  Delete remote database dump...
  11:26:50   Importing database dump. Please wait...
  11:28:55   Database dump successfully imported.
  Schema upgrade: [susemanager-schema-2.1.50.14-3.2.devel21] -&gt; [susemanager-schema-3.0.5-5.1.develHead]
  Searching for upgrade path to: [susemanager-schema-3.0.5-5.1]
  Searching for upgrade path to: [susemanager-schema-3.0.5]
  Searching for upgrade path to: [susemanager-schema-3.0]
  Searching for start path:  [susemanager-schema-2.1.50.14-3.2]
  Searching for start path:  [susemanager-schema-2.1.50.14]
  The path: [susemanager-schema-2.1.50.14] -&gt; [susemanager-schema-2.1.50.15] -&gt; [susemanager-schema-2.1.51] -&gt; [susemanager-schema-3.0]
  Planning to run schema upgrade with dir '/var/log/spacewalk/schema-upgrade/schema-from-20160112-112856'
  Executing spacewalk-sql, the log is in [/var/log/spacewalk/schema-upgrade/schema-from-20160112-112856-to-susemanager-schema-3.0.log].
(248/248) apply upgrade [schema-from-20160112-112856/99_9999-upgrade-end.sql]        e-suse-channels-to-public-channel-family.sql.postgresql]
  The database schema was upgraded to version [susemanager-schema-3.0.5-5.1.develHead].
  Copy files from old SUSE Manager...
  receiving incremental file list
  ./
  packages/

  sent 18 bytes  received 66 bytes  168.00 bytes/sec
  total size is 0  speedup is 0.00
  receiving incremental file list
  ./
  RHN-ORG-TRUSTED-SSL-CERT
  res.key
  rhn-org-trusted-ssl-cert-1.0-1.noarch.rpm
  suse-307E3D54.key
  suse-39DB7C82.key
  suse-9C800ACA.key
  bootstrap/
  bootstrap/bootstrap.sh
  bootstrap/client-config-overrides.txt
  bootstrap/sm-client-tools.rpm

  sent 189 bytes  received 66,701 bytes  44,593.33 bytes/sec
  total size is 72,427  speedup is 1.08
  receiving incremental file list
  ./
  .mtime
  lock
  web.ss
  config/
  config/distros.d/
  config/images.d/
  config/profiles.d/
  config/repos.d/
  config/systems.d/
  kickstarts/
  kickstarts/autoyast_sample.xml
  loaders/
  snippets/
  triggers/
  triggers/add/
  triggers/add/distro/
  triggers/add/distro/post/
  triggers/add/distro/pre/
  triggers/add/profile/
  triggers/add/profile/post/
  triggers/add/profile/pre/
  triggers/add/repo/
  triggers/add/repo/post/
  triggers/add/repo/pre/
  triggers/add/system/
  triggers/add/system/post/
  triggers/add/system/pre/
  triggers/change/
  triggers/delete/
  triggers/delete/distro/
  triggers/delete/distro/post/
  triggers/delete/distro/pre/
  triggers/delete/profile/
  triggers/delete/profile/post/
  triggers/delete/profile/pre/
  triggers/delete/repo/
  triggers/delete/repo/post/
  triggers/delete/repo/pre/
  triggers/delete/system/
  triggers/delete/system/post/
  triggers/delete/system/pre/
  triggers/install/
  triggers/install/post/
  triggers/install/pre/
  triggers/sync/
  triggers/sync/post/
  triggers/sync/pre/

  sent 262 bytes  received 3,446 bytes  7,416.00 bytes/sec
  total size is 70,742  speedup is 19.08
  receiving incremental file list
  kickstarts/
  kickstarts/snippets/
  kickstarts/snippets/default_motd
  kickstarts/snippets/keep_system_id
  kickstarts/snippets/post_delete_system
  kickstarts/snippets/post_reactivation_key
  kickstarts/snippets/redhat_register
  kickstarts/snippets/sles_no_signature_checks
  kickstarts/snippets/sles_register
  kickstarts/snippets/sles_register_script
  kickstarts/snippets/wait_for_networkmanager_script
  kickstarts/upload/
  kickstarts/wizard/

  sent 324 bytes  received 1,063 bytes  2,774.00 bytes/sec
  total size is 12,133  speedup is 8.75
  receiving incremental file list
  ssl-build/
  ssl-build/RHN-ORG-PRIVATE-SSL-KEY
  ssl-build/RHN-ORG-TRUSTED-SSL-CERT
  ssl-build/index.txt
  ssl-build/index.txt.attr
  ssl-build/latest.txt
  ssl-build/rhn-ca-openssl.cnf
  ssl-build/rhn-ca-openssl.cnf.1
  ssl-build/rhn-org-trusted-ssl-cert-1.0-1.noarch.rpm
  ssl-build/rhn-org-trusted-ssl-cert-1.0-1.src.rpm
  ssl-build/serial
  ssl-build/d248/
  ssl-build/d248/latest.txt
  ssl-build/d248/rhn-org-httpd-ssl-archive-d248-1.0-1.tar
  ssl-build/d248/rhn-org-httpd-ssl-key-pair-d248-1.0-1.noarch.rpm
  ssl-build/d248/rhn-org-httpd-ssl-key-pair-d248-1.0-1.src.rpm
  ssl-build/d248/rhn-server-openssl.cnf
  ssl-build/d248/server.crt
  ssl-build/d248/server.csr
  ssl-build/d248/server.key
  ssl-build/d248/server.pem

  sent 380 bytes  received 50,377 bytes  101,514.00 bytes/sec
  total size is 90,001  speedup is 1.77
  SUSE Manager Database Control. Version 1.5.2
  Copyright (c) 2012 by SUSE Linux Products GmbH

  INFO: Database configuration has been changed.
  INFO: Wrote new general configuration. Backup as /var/lib/pgsql/data/postgresql.2016-01-12-11-29-42.conf
  INFO: Wrote new client auth configuration. Backup as /var/lib/pgsql/data/pg_hba.2016-01-12-11-29-42.conf
  INFO: New configuration has been applied.
  Database is online
  System check finished

  ============================================================================
  Migration complete.
  Please shut down the old SUSE Manager server now.
  Reboot the new server and make sure it uses the same IP address and hostname
  as the old SUSE Manager server!

  IMPORTANT: Make sure, if applicable, that your external storage is mounted
  in the new server as well as the ISO images needed for distributions before
  rebooting the new server!
  ============================================================================</screen>
</section>
</section>
</chapter>
<chapter xml:id="bp.client.migration">
<title>Client Migration</title>
<simpara>Upgrading from SLE&#160;12 with the latest service pack (SP) to SLE&#160;15 can be automated, but requires some preparation steps.</simpara>
<simpara>To upgrade the SP version on SLE&#160;12 (for example, upgrading from SLE&#160;12 or any SLE&#160;12&#160;SPx to SLE&#160;12&#160;SP4) can be fully automated and requires no additional preparation.</simpara>
<section xml:id="bp.client.migration.sle">
<title>Upgrading SLE&#160;12&#160;SPx to version 15</title>
<simpara>SLE&#160;12&#160;SPx clients can be auto-upgraded to SLE&#160;15 with YaST auto-installation.
This also applies for other supported products based on SLE&#160;12.</simpara>
<note>
<title>Supported Upgrade Paths</title>
<simpara>For generally supported SUSE Linux Enterprise upgrade paths, see  <link xl:href="https://www.suse.com/documentation/sles-15/book_sle_upgrade/data/sec_upgrade-paths_supported.html">https://www.suse.com/documentation/sles-15/book_sle_upgrade/data/sec_upgrade-paths_supported.html</link> (SUSE Linux Enterprise Upgrade Guide, Chapter <quote>Supported Upgrade Paths to SLE 15</quote>).
It is important that you migrate the client to the latest available SP first.
Upgrade to SLE 12 SP4 after December 2018.</simpara>
</note>
<important>
<title>Auto-Upgrading Salt Minions Currently Not Supported</title>
<simpara>This procedure will work for traditionally  managed systems (system type <literal role="systemitem">management</literal>).
It is not currently available for systems using Salt (system type <literal role="systemitem">salt</literal>).</simpara>
</important>
<simpara>During the procedure, the machine reboots and performs the system upgrade.
The process is controlled by YaST and AutoYaST, not by <literal role="command">zypper</literal> commands.</simpara>
<important>
<simpara>Only perform this migration procedure on client systems managed by SUSE Manager servers.
For upgrading the SUSE Manager server itself, see <xref linkend="bp.sp.migration"/>.
This is a viable method for major version upgrades such as an upgrade from SUSE Linux Enterprise 12 to 15.</simpara>
</important>
<section xml:id="bp.proc.client.migration.sle.prep">
<title>System Upgrade Preparation</title>
<simpara>Make sure your SUSE Manager and all the clients you want to upgrade have installed all available updates, including the SUSE Manager tools.
This is absolutely necessary, otherwise the system upgrade will fail.</simpara>
<simpara>The preparation process contains several steps:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Download and save installation media</simpara>
</listitem>
<listitem>
<simpara>Create an auto-installation distribution</simpara>
</listitem>
<listitem>
<simpara>Create an activation key</simpara>
</listitem>
<listitem>
<simpara>Upload an AutoYaST profile</simpara>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: Download and Save Installation Media</title>
<listitem>
<simpara>On the SUSE Manager server, create a local directory for the SLE&#160;15 installation media.</simpara>
</listitem>
<listitem>
<simpara>Download an ISO image with the installation sources, and mount the ISO image on your server:</simpara>
<screen>mkdir /mnt/sle15
mount -o loop DVD1.iso /mnt/sle15</screen>
</listitem>
</orderedlist>
<formalpara>
<title>Procedure: Create an Auto-Installation Distribution</title>
<para>For all distributions you want to upgrade, create a SLE&#160;15 distribution in SUSE Manager.</para>
</formalpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>In the SUSE Manager Web UI, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>Autoinstallation</guisubmenu> <guimenuitem>Distributions</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Enter a <literal role="guimenu">Distribution Label</literal> for your distribution (for example, <literal>autumn2018</literal>)</simpara>
</listitem>
<listitem>
<simpara>Specify the <literal role="guimenu">Tree Path</literal>, which is the root directory of the SLE&#160;15 installation sources (for example, <literal role="path">/mnt/sle15</literal>).</simpara>
</listitem>
<listitem>
<simpara>For <literal role="guimenu">Base Channel</literal>, use the update target distribution <literal role="systemitem">SLE-Product-SLES15-Pool for x86_64</literal>.</simpara>
</listitem>
<listitem>
<simpara>Confirm with <literal role="guimenu">Create Autoinstallable Distribution</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>For more information about Autoinstallation, see <xref linkend="ref.webui.systems.autoinst"/>.</simpara>
<formalpara>
<title>Procedure: Create an Activation Key</title>
<para>In order to switch from the old SLE&#160;12&#160;SP4 base channel to the new SLE&#160;15 channel, you need an activation key.</para>
</formalpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Go to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice> and click <literal role="guimenu">Create Key</literal>.</simpara>
</listitem>
<listitem>
<simpara>Enter a description for your key.</simpara>
</listitem>
<listitem>
<simpara>Enter a key or leave it blank to generate an automatic key.</simpara>
</listitem>
<listitem>
<simpara>If you want to limit the usage, enter your value in the <literal role="guimenu">Usage</literal> text field.</simpara>
</listitem>
<listitem>
<simpara>Select the <literal role="systemitem">SLE-Product-SLES15-Pool for x86_64</literal> base channel.</simpara>
</listitem>
<listitem>
<simpara>Decide about <literal role="guimenu">Add-On System Types</literal>.
If in doubt, see <link xl:href="https://www.suse.com/documentation/sles-15/book_quickstarts/data/art_modules.html">https://www.suse.com/documentation/sles-15/book_quickstarts/data/art_modules.html</link> (SUSE Linux Enterprise Modules &amp; Extensions Quick Start).</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Create Activation Key</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Child Channels</literal> tab and select the required channels. Finish with <guibutton>Update Key</guibutton>.</simpara>
</listitem>
</orderedlist>
<formalpara>
<title>Procedure: Upload an AutoYaST Profile</title>
<para>Create an AutoYaST XML file according to <xref linkend="ap-sample-autoinst-system-upgrade"/>.
For more information about AutoYaST, see <xref linkend="ref.webui.systems.autoinst.ay_intro"/>.</para>
</formalpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Go to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Autoinstallation</guimenuitem></menuchoice> and click <literal role="guimenu">Upload Kickstart/Autoyast File</literal>.</simpara>
</listitem>
<listitem>
<simpara>Paste the XML content in the text area or select the file to upload and click <guibutton>Create</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Add <literal>autoupgrade=1</literal> in the <literal role="guimenu">Kernel Options</literal> of the <literal role="guimenu">Details</literal> tab and click <guibutton>Update</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Switch to the <literal role="guimenu">Variable</literal> tab.</simpara>
</listitem>
<listitem>
<simpara>In the text field <literal>registration_key=</literal> enter the key from the preparation above.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Update Variables</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>After you have successfully finished this process, you are ready to perform the upgrade.
For upgrade instruction, see <xref linkend="bp.proc.client.migration.sle.upgrade"/>.</simpara>
<warning xml:id="bp.proc.client.migration.sle.upgrade">
<title>Synchronizing Target Channels</title>
<simpara>Before successfully initializing the product migration, make sure that the migration target channels are completely mirrored.
For the upgrade to SUSE Linux Enterprise 15, at least the <literal role="systemitem">SLE-Product-SLES15-Pool</literal> base channel with the <literal role="systemitem">SLE-Manager-Tools15-Pool</literal> child channel for your architecture is required.
The matching update channels such as <literal role="systemitem">SLE-Manager-Tools15-Updates</literal> and <literal role="systemitem">SLE-Product-SLES15-Updates</literal> are recommended.
Watch the mirroring progress in <literal role="path">/var/log/rhn/reposync/sles15-pool-x86_64.log</literal>.</simpara>
</warning>
<orderedlist numeration="arabic">
<listitem>
<simpara>Go to the system via <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice> and click the name of the system. Then click <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Provisioning</guisubmenu> <guisubmenu>Autoinstallation</guisubmenu> <guimenuitem>Schedule</guimenuitem></menuchoice>, and choose the AutoYaST XML profile you have uploaded above.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Schedule Autoinstallation and Finish</guibutton>.</simpara>
<simpara>Next time the machine asks the SUSE Manager server for jobs, it will receive a reinstallation job which fetches kernel and initrd and writes a new <literal role="path">/boot/grub/menu.lst</literal> (containing pointers to the new kernel and initrd).</simpara>
<simpara>When the machine boots, it will use the Grub configuration and boots the new kernel with its initrd.
No PXE boot is required for this process.
A shutdown of the machine is initiated as well, effectively 3 minutes after the job was fetched.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="ap-sample-autoinst-system-upgrade">
<title>Sample Autoinstallation Script for System Upgrade (SLES 12 SP4 to SLES 15)</title>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns"
         xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;general&gt;
  $SNIPPET('spacewalk/sles_no_signature_checks')
    &lt;mode&gt;
      &lt;confirm config:type="boolean"&gt;false&lt;/confirm&gt;
    &lt;/mode&gt;
  &lt;/general&gt;
  &lt;add-on&gt;
    &lt;add_on_products config:type="list"&gt;
      &lt;listentry&gt;
        &lt;ask_on_error config:type="boolean"&gt;true&lt;/ask_on_error&gt;
        &lt;media_url&gt;http://$redhat_management_server/ks/dist/child/sle15-updates-x86_64/autumn2018&lt;/media_url&gt;
        &lt;name&gt;SLE15 Updates&lt;/name&gt;
        &lt;product&gt;SLE15&lt;/product&gt;
        &lt;product_dir&gt;/&lt;/product_dir&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;ask_on_error config:type="boolean"&gt;true&lt;/ask_on_error&gt;
        &lt;media_url&gt;http://$redhat_management_server/ks/dist/child/sle-manager-tools15-pool-x86_64/summer2017&lt;/media_url&gt;
        &lt;name&gt;SLE15 Manager Tools Pool&lt;/name&gt;
        &lt;product&gt;SLE15&lt;/product&gt;
        &lt;product_dir&gt;/&lt;/product_dir&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;ask_on_error config:type="boolean"&gt;true&lt;/ask_on_error&gt;
        &lt;media_url&gt;http://$redhat_management_server/ks/dist/child/sle-manager-tools15-updates-x86_64/autumn2018&lt;/media_url&gt;
        &lt;name&gt;SLE15 Manager Tools Updates&lt;/name&gt;
        &lt;product&gt;SLE15&lt;/product&gt;
        &lt;product_dir&gt;/&lt;/product_dir&gt;
      &lt;/listentry&gt;
    &lt;/add_on_products&gt;
  &lt;/add-on&gt;
  &lt;upgrade&gt;
    &lt;only_installed_packages config:type="boolean"&gt;false&lt;/only_installed_packages&gt;
    &lt;stop_on_solver_conflict config:type="boolean"&gt;true&lt;/stop_on_solver_conflict&gt;
  &lt;/upgrade&gt;
  &lt;backup&gt;
    &lt;sysconfig config:type="boolean"&gt;true&lt;/sysconfig&gt;
    &lt;modified config:type="boolean"&gt;true&lt;/modified&gt;
    &lt;remove_old config:type="boolean"&gt;false&lt;/remove_old&gt;
  &lt;/backup&gt;
  &lt;networking&gt;
    &lt;keep_install_network config:type="boolean"&gt;true&lt;/keep_install_network&gt;
    &lt;start_immediately config:type="boolean"&gt;true&lt;/start_immediately&gt;
  &lt;/networking&gt;
   &lt;scripts&gt;
    &lt;init-scripts config:type="list"&gt;
      $SNIPPET('spacewalk/sles_register_script')
    &lt;/init-scripts&gt;
  &lt;/scripts&gt;
&lt;/profile&gt;</screen>
</section>
</section>
<section xml:id="bp.client.migration.sle12">
<title>Migrating SLE&#160;12 or later to version 12&#160;SP4</title>
<simpara>Existing SLE&#160;12 clients (SLE) may be upgraded to SP4 with the <guimenu>SP Migration</guimenu> procedure provided by the Web UI.
The same applies for other supported products based on SUSE Linux Enterprise 12.</simpara>
<warning>
<title>Synchronizing Target Channels</title>
<simpara>Before successfully initializing the product migration, you first must make sure that the migration target channels are completely mirrored.
For the upgrade to SLE&#160;12&#160;SP4, at least the <literal role="systemitem">SLES12-SP4-Pool</literal> base channel with the <literal role="systemitem">SLE-Manager-Tools12-Pool</literal> child channel for your architecture is required.
The matching update channels such as <literal role="systemitem">SLE-Manager-Tools12-Updates</literal> and <literal role="systemitem">SLES12-SP4-Updates</literal> are recommended.</simpara>
</warning>
<orderedlist numeration="arabic">
<title>Procedure: Migrating SLE&#160;12 Client to SP4</title>
<listitem>
<simpara>Direct your browser to the SUSE Manager Web UI where your client is registered, and login.</simpara>
</listitem>
<listitem>
<simpara>On the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>All</guimenuitem></menuchoice> page select your client system from the table.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_old_details_page.png" width="80%"/>
</imageobject>
<textobject><phrase>sles old details page</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If there are <menuchoice><guimenu>Software Updates Available</guimenu> <guimenuitem>] in the menu:System Status[</guimenuitem></menuchoice> notification install these updates first to avoid trouble during the migration process.</simpara>
</listitem>
<listitem>
<simpara>On the system&#8217;s detail page select the <menuchoice><guimenu>Software</guimenu> <guisubmenu>] tab</guisubmenu> <guimenuitem>then the menu:SP Migration[</guimenuitem></menuchoice> tab.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_old_details_spmigration.png" width="80%"/>
</imageobject>
<textobject><phrase>sles old details spmigration</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>From this tab you will see the installed products listed on your client. Select the wanted <guimenu>Target Products</guimenu> (if there is more than one), which is <literal role="systemitem">SUSE Linux Enterprise Server 12&#160;SP4</literal>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_migration_target.png" width="80%"/>
</imageobject>
<textobject><phrase>sles migration target</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Then confirm with <guimenu>Select Channels</guimenu>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_migration_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>sles migration channels</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Select <menuchoice><guimenu>Schedule Migration</guimenu> <guisubmenu>]</guisubmenu> <guimenuitem>and then menu:Confirm[</guimenuitem></menuchoice>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_migration_schedule.png" width="80%"/>
</imageobject>
<textobject><phrase>sles migration schedule</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</orderedlist>
<simpara>Check the <guimenu>System Status</guimenu> on the system&#8217;s details when the migration is done.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sles_migrated.png" width="80%"/>
</imageobject>
<textobject><phrase>sles migrated</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If the <menuchoice><guimenu>System Status</guimenu> <guimenuitem>] notification does not report a successful migration but lists menu:Software Updates Available[</guimenuitem></menuchoice>, install the update now and then check again.</simpara>
<simpara>Finally, consider to schedule a reboot.</simpara>
</section>
</chapter>
<chapter xml:id="bp.postgresql.database.migration">
<title>PostgreSQL Database Migration</title>
<simpara>SUSE Manager 3 uses PostgreSQL version 9.4.
SUSE Manager 3.2 uses PostgreSQL version 10.</simpara>
<simpara>PostgreSQL version 9.6 has been released for SUSE Linux Enterprise Server 12 SP3.
PostgreSQL version 10 has been released for SUSE Linux Enterprise Server 12 SP4 and later.
This chapter provides guidance on migrating your SUSE Manager Server from PostgreSQL 9.4 to 9.6, or migrating from 9.6 to 10.</simpara>
<section xml:id="bp.postgresql.database.migration.new.installations">
<title>New SUSE Manager Installations</title>
<simpara>PostgreSQL version 10 is now supported on SUSE Manager.
New SUSE Manager installations will have PostgreSQL version 10 installed by default.
When you install SUSE Manager on SUSE Linux Enterprise&#160;12 SP4, the latest version of PostgreSQL will be installed by default.
This will be fully transparent to the user.
Check the active PostgreSQL version with this command:</simpara>
<screen>suse-manager-example-srv:~ # psql --version
psql (PostgreSQL) 10.9</screen>
</section>
<section xml:id="bp.postgresql.database.migrating.existing.installations">
<title>Migrating an Existing Installation</title>
<warning>
<simpara>Always create a database backup before performing a migration.
For more information about a database backup, see <xref linkend="bp.chap.suma.backup"/>.</simpara>
</warning>
<simpara>PostgreSQL upgrades can be performed in two ways: a regular upgrade, or a fast upgrade:</simpara>
<simpara>A regular upgrade will create a complete copy of the database, so you will need double the existing database size of space available.
Regular upgrades can take a considerable amount of time, depending on the size of the database and the speed of the storage system.</simpara>
<simpara>A fast upgrade only takes a few minutes, and uses almost no additional disk space.
However, if a fast upgrade fails, you must restore the database from the backup.
A fast upgrade reduces the risk of running out of disk space.
The regular upgrade will copy the database files instead of hardlinking them.</simpara>
<simpara>PostgreSQL stores data at <literal role="path">/var/lib/pgsql/data/</literal>, and logs to <literal role="path">/var/lib/pgsql/data/pg_xlog/</literal>.</simpara>
<section xml:id="_upgrade_from_postgresql9_4_to9_6">
<title>Upgrade from PostgreSQL 9.4 to 9.6</title>
<simpara>Before you migrate to PostgreSQL 9.6, ensure SUSE Manager is the latest version, and fully updated.
You can check if the system is ready to use PostgreSQL 9.6 with:</simpara>
<screen>psql --version</screen>
<simpara>If you are using PostgreSQL&#160;9.4, you can upgrade to PostgreSQL&#160;9.6.</simpara>
<important>
<simpara>PostgreSQL 9.6 requires smdba version 1.5.8 or higher.
Check with:</simpara>
<screen>rpm -q smdba</screen>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Regular Upgrade</title>
<listitem>
<simpara>Perform a database backup.
For more information on backing up, see <xref linkend="bp.chap.suma.backup"/>.</simpara>
</listitem>
<listitem>
<simpara>Start the upgrade:</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate.sh</screen>
</listitem>
<listitem>
<simpara>When the upgrade has successfully completed, you can safely delete the old database directory and reclaim lost disk space.
The old directory is renamed to <literal role="path">/var/lib/pgsql/data-pg94</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>The <literal role="path">pg-migrate.sh</literal> script performs these operations:</simpara>
<itemizedlist>
<listitem>
<simpara>Stop spacewalk services</simpara>
</listitem>
<listitem>
<simpara>Shut down the running database</simpara>
</listitem>
<listitem>
<simpara>Check if PostgreSQL 9.6 is installed and install it if necessary</simpara>
</listitem>
<listitem>
<simpara>Switch from PostgreSQL 9.4 to PostgreSQL 9.6 as the new default</simpara>
</listitem>
<listitem>
<simpara>Start the database migration</simpara>
</listitem>
<listitem>
<simpara>Create a PostgreSQL configuration file tuned for use by SUSE Manager</simpara>
</listitem>
<listitem>
<simpara>Start the database and spacewalk services</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>If the upgrade fails, the migration script will attempt to restore the database to its original state.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Fast PostgreSQL Upgrade</title>
<listitem>
<simpara>Perform a database backup.
Without a verified database backup, you must not initiate a fast upgrade.
For more information on backing up, see <xref linkend="bp.chap.suma.backup"/>.</simpara>
</listitem>
<listitem>
<simpara>Begin the upgrade:</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate.sh fast</screen>
</listitem>
<listitem>
<simpara>When the upgrade has successfully completed, you can safely delete the old database directory and reclaim lost disk space.
The old directory is renamed to <literal role="path">/var/lib/pgsql/data-pg94</literal>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_upgrade_from_postgresql9_6_to10">
<title>Upgrade from PostgreSQL 9.6 to 10</title>
<simpara>Before you migrate to PostgreSQL 9.10, ensure SUSE Manager is the latest version, and fully updated.
You can check if the system is ready to use PostgreSQL 9.10 with:</simpara>
<screen>psql --version</screen>
<simpara>If you are using PostgreSQL&#160;9.6, you can upgrade to PostgreSQL&#160;10.</simpara>
<important>
<simpara>PostgreSQL 9.10 requires smdba version 1.6.2 or higher.
Check with:</simpara>
<screen>rpm -q smdba</screen>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Regular Upgrade</title>
<listitem>
<simpara>Perform a database backup.</simpara>
</listitem>
<listitem>
<simpara>Start the upgrade:</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate-96-to-10.sh</screen>
</listitem>
<listitem>
<simpara>When the upgrade has successfully completed, you can safely delete the old database directory and reclaim lost disk space.
The old directory is renamed to <literal role="path">/var/lib/pgsql/data-pg96</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>The <literal role="path">pg-migrate-96-to-10.sh</literal> script performs these operations:</simpara>
<itemizedlist>
<listitem>
<simpara>Stop spacewalk services</simpara>
</listitem>
<listitem>
<simpara>Shut down the running database</simpara>
</listitem>
<listitem>
<simpara>Check if PostgreSQL&#160;10 is installed and install it if necessary</simpara>
</listitem>
<listitem>
<simpara>Switch from PostgreSQL&#160;9.6 to PostgreSQL&#160;10 as the new default</simpara>
</listitem>
<listitem>
<simpara>Initiate the database migration</simpara>
</listitem>
<listitem>
<simpara>Create a PostgreSQL configuration file tuned for use by SUSE Manager</simpara>
</listitem>
<listitem>
<simpara>Start the database and spacewalk services</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>If the upgrade fails, the migration script will attempt to restore the database to its original state.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Fast PostgreSQL Upgrade</title>
<listitem>
<simpara>Perform a database backup.
Without a verified database backup, you must not initiate a fast upgrade.</simpara>
</listitem>
<listitem>
<simpara>Start the upgrade:</simpara>
<screen>/usr/lib/susemanager/bin/pg-migrate-96-to-10.sh fast</screen>
</listitem>
<listitem>
<simpara>When the upgrade has successfully completed, you can safely delete the old database directory and reclaim lost disk space.
The old directory is renamed to <literal role="path">/var/lib/pgsql/data-pg96</literal>.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="_typical_migration_sample_session">
<title>Typical Migration Sample Session</title>
<simpara>A slow migration should provide you with the following output:</simpara>
<screen>d235:~ # /usr/lib/susemanager/bin/pg-migrate.sh
15:58:00   Shut down spacewalk services...
Shutting down spacewalk services...
Done.
15:58:03   Checking postgresql version...
15:58:03   Installing postgresql 9.6...
Dienst 'SUSE_Linux_Enterprise_Server_12_SP2_x86_64' wird aktualisiert.
Dienst 'SUSE_Manager_Server_3.1_x86_64' wird aktualisiert.
Repository-Daten werden geladen...
Installierte Pakete werden gelesen...
Paketabhängigkeiten werden aufgelöst...

Die folgenden 3 NEUEN Pakete werden installiert:
  postgresql96 postgresql96-contrib postgresql96-server

3 neue Pakete zu installieren.
Gesamtgröße des Downloads: 5,7 MiB. Bereits im Cache gespeichert: 0 B. Nach der Operation werden zusätzlich 25,3 MiB belegt.
Fortfahren? [j/n/...? zeigt alle Optionen] (j): j
Paket postgresql96-9.6.3-2.4.x86_64 abrufen (1/3),   1,3 MiB (  5,1 MiB entpackt)
Abrufen: postgresql96-9.6.3-2.4.x86_64.rpm [fertig]
Paket postgresql96-server-9.6.3-2.4.x86_64 abrufen (2/3),   3,7 MiB ( 17,9 MiB entpackt)
Abrufen: postgresql96-server-9.6.3-2.4.x86_64.rpm [.fertig]
Paket postgresql96-contrib-9.6.3-2.4.x86_64 abrufen (3/3), 648,9 KiB (  2,2 MiB entpackt)
Abrufen: postgresql96-contrib-9.6.3-2.4.x86_64.rpm [fertig]
Überprüfung auf Dateikonflikte läuft: [......fertig]
(1/3) Installieren: postgresql96-9.6.3-2.4.x86_64 [............fertig]
(2/3) Installieren: postgresql96-server-9.6.3-2.4.x86_64 [............fertig]
(3/3) Installieren: postgresql96-contrib-9.6.3-2.4.x86_64 [............fertig]
15:58:08   Ensure postgresql 9.6 is being used as default...
15:58:09   Successfully switched to new postgresql version 9.6.
15:58:09   Create new database directory...
15:58:09   Initialize new postgresql 9.6 database...
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.UTF-8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/pgsql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
running bootstrap script ... ok
performing post-bootstrap initialization ... ok
syncing data to disk ... ok

WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.

Success. You can now start the database server using:

    pg_ctl -D /var/lib/pgsql/data -l logfile start

15:58:12   Successfully initialized new postgresql 9.6 database.
15:58:12   Upgrade database to new version postgresql 9.6...
Performing Consistency Checks
-----------------------------
Checking cluster versions                                   ok
Checking database user is the install user                  ok
Checking database connection settings                       ok
Checking for prepared transactions                          ok
Checking for reg* system OID user data types                ok
Checking for contrib/isn with bigint-passing mismatch       ok
Checking for roles starting with 'pg_'                      ok
Creating dump of global objects                             ok
Creating dump of database schemas
  postgres
  susemanager
  template1
                                                            ok
Checking for presence of required libraries                 ok
Checking database user is the install user                  ok
Checking for prepared transactions                          ok

If pg_upgrade fails after this point, you must re-initdb the
new cluster before continuing.

Performing Upgrade
------------------
Analyzing all rows in the new cluster                       ok
Freezing all rows on the new cluster                        ok
Deleting files from new pg_clog                             ok
Copying old pg_clog to new server                           ok
Setting next transaction ID and epoch for new cluster       ok
Deleting files from new pg_multixact/offsets                ok
Copying old pg_multixact/offsets to new server              ok
Deleting files from new pg_multixact/members                ok
Copying old pg_multixact/members to new server              ok
Setting next multixact ID and offset for new cluster        ok
Resetting WAL archives                                      ok
Setting frozenxid and minmxid counters in new cluster       ok
Restoring global objects in the new cluster                 ok
Restoring database schemas in the new cluster
  postgres
  susemanager
  template1
                                                            ok
Copying user relation files
  /var/lib/pgsql/data-pg94/base/12753/12710

[...]

  /var/lib/pgsql/data-pg94/base/1/12574
                                                            ok
Setting next OID for new cluster                            ok
Sync data directory to disk                                 ok
Creating script to analyze new cluster                      ok
Creating script to delete old cluster                       ok

Upgrade Complete
----------------
Optimizer statistics are not transferred by pg_upgrade so,
once you start the new server, consider running:
    ./analyze_new_cluster.sh

Running this script will delete the old cluster's data files:
    ./delete_old_cluster.sh
15:58:51   Successfully upgraded database to postgresql 9.6.
15:58:51   Tune new postgresql configuration...
INFO: Database configuration has been changed.
INFO: Wrote new general configuration. Backup as /var/lib/pgsql/data/postgresql.2017-07-26-15-58-51.conf
INFO: Wrote new client auth configuration. Backup as /var/lib/pgsql/data/pg_hba.2017-07-26-15-58-51.conf
INFO: Configuration has been changed, but your database is right now offline.
Database is offline
System check finished
15:58:51   Successfully tuned new postgresql configuration.
15:58:51   Starting spacewalk services...
Starting spacewalk services...
Done.</screen>
</section>
</chapter>
<chapter xml:id="bp.chap.suma.backup">
<title>Backup and Restore</title>
<simpara>Back up your SUSE Manager installation regularly, in order to prevent data loss.
Because SUSE Manager relies on a database as well as the installed program and configurations, it is important to back up all components of your installation.
This chapter contains information on the files you need to back up, and introduces the <literal role="command">smdba</literal> tool to manage database backups.
It also contains information about restoring from your backups in the case of a system failure.</simpara>
<important>
<title>Backup Space Requirements</title>
<simpara>Regardless of the backup method you use, you must have available at least three times the amount of space your current installation uses.
Running out of space can result in backups failing, so check this often.</simpara>
</important>
<section xml:id="_backing_up_suse_manager">
<title>Backing up SUSE Manager</title>
<simpara>The most comprehensive method for backing up your SUSE Manager installation is to back up the relevant files and directories.
This can save you time in administering your backup, and can be faster to reinstall and re-synchronize in the case of failure.
However, this method requires significant disk space and could take a long time to perform the backup.</simpara>
<note>
<simpara>If you want to only back up the required files and directories, use the following list.
To make this process simpler, and more comprehensive, we recommend backing up the entire <literal role="path">/etc</literal> and <literal role="path">/root</literal> directories, not just the ones specified here.
Some files only exist if you are actually using the related SUSE Manager feature.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara><literal role="path">/etc/cobbler/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/dhcp.conf</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/fstab</literal> and any ISO mountpoints you require.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/rhn/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/salt</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/sudoers</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/etc/sysconfig/rhn/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/root/.gnupg/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/root/.ssh</literal></simpara>
<simpara>This file exists if you are using an SSH tunnel or SSH <literal role="command">push</literal>.
You will also need to have saved a copy of the <literal>id-susemanager</literal> key.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">/root/ssl-build/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/formula_metadata</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/pillar</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/salt</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/susemanager</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/tftpboot/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/www/cobbler</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/www/htdocs/pub/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/srv/www/os-images</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/cache/rhn</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/cache/salt</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/lib/cobbler/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/lib/Kiwi</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/lib/rhn/</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">/var/spacewalk/</literal></simpara>
</listitem>
<listitem>
<simpara>Plus any directories containing custom data such as scripts, Kickstart profiles, AutoYaST, and custom RPMs.</simpara>
</listitem>
</itemizedlist>
<important>
<simpara>You will also need to back up your database, which you can do by using the <literal role="command">smdba</literal> tool, which is explained in <xref linkend="bp.sect.backup.smdba.admin"/>.</simpara>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Restore from a Manual Backup</title>
<listitem>
<simpara>Re-install SUSE Manager.  For more information, see <xref linkend="config-smdb.recover-root"/>.</simpara>
</listitem>
<listitem>
<simpara>Re-synchronize your SUSE Manager repositories with the <literal role="command">mgr-sync</literal> tool.
For more information about the <literal role="command">mgr-sync</literal> tool, see <xref linkend="syncing.suse.mgr.repositories.scc"/>.</simpara>
</listitem>
<listitem>
<simpara>You can choose to re-register your product, or skip the registration and SSL certificate generation sections.</simpara>
</listitem>
<listitem>
<simpara>Re-install the <literal role="path">/root/ssl-build/rhn-org-httpd-ssl-key-pair-MACHINE_NAME-VER-REL.noarch.rpm</literal> package.</simpara>
</listitem>
<listitem>
<simpara>Schedule the re-creation of search indexes next time the <literal role="command">rhn-search</literal> service is started:</simpara>
<screen>rhn-search cleanindex</screen>
<simpara>This command produces only debug messages.
It does not produce error messages.</simpara>
</listitem>
<listitem>
<simpara>If you did not have <literal role="path">/var/spacewalk/packages/</literal> in your backup, but the source repository still exists, you can restore it by performing a complete channel synchronization with:</simpara>
<screen>mgr-sync refresh --refresh-channels</screen>
<simpara>You can check the progress by running <literal role="command">tail -f /var/log/rhn/reposync/</literal>&lt;CHANNEL_NAME&gt;<literal>.log</literal> as <emphasis>root</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.sect.backup.smdba.admin">
<title>Administering the Database with smdba</title>
<simpara>The <literal role="command">smdba</literal> tool is used for managing a local PostgreSQL database.
It allows you to back up and restore your database, and manage backups.
It can also be used to check the status of your database, and perform administration tasks, such as restarting.</simpara>
<note>
<simpara>The <literal role="command">smdba</literal> tool works with local PostgreSQL databases only, it will not work with remotely accessed databases, or Oracle databases.</simpara>
</note>
<important>
<simpara>The <literal role="command">smdba</literal> tool requires <literal role="command">sudo</literal> access, in order to execute system changes.
Ensure you have enabled <literal role="command">sudo</literal> access for the <literal role="username">admin</literal> user before you begin, by checking the <literal role="path">/etc/sudoers</literal> file for this line:</simpara>
<screen>admin   ALL=(postgres) /usr/bin/smdba</screen>
</important>
<simpara>Check the runtime status of your database with the <literal role="command">smdba db-status</literal> command.
This command will return either <literal>online</literal> or <literal>offline</literal>:</simpara>
<screen>smdba db-status
Checking database core...       online</screen>
<simpara>To check the full connection to the database, use the <literal role="command">smdba db-check</literal> command.
Depending on your environment, this command will report on the status of listeners, in addition to connectivity status.</simpara>
<screen>smdba db-check</screen>
<simpara>Starting and stopping the database can be performed with <literal role="command">smdba db-start</literal> and <literal role="command">smdba db-stop</literal>.</simpara>
<screen>smdba db-start
Starting core...       done</screen>
<screen>smdba db-stop
Stopping the SUSE Manager database...
Stopping core:         done</screen>
</section>
<section xml:id="bp.sect.backup.smdba.performbackup">
<title>Database Backup with smdba</title>
<simpara>The <literal role="command">smdba</literal> tool performs a continuous archiving backup.
This backup method combines a log of every change made to the database during the current session, with a series of more traditional backup files.
When a crash occurs, the database state is first restored from the most recent backup file on disk, then the log of the current session is replayed exactly, to bring the database back to a current state.
A continuous archiving backup with <literal role="command">smdba</literal> is performed with the database running, so there is no need for downtime.</simpara>
<simpara>This method of backing up is stable and generally creates consistent snapshots, however it can take up a lot of storage space.
Ensure you have at least three times the current database size of space available for backups.
You can check your current database size by navigating to <literal role="path">/var/lib/pgsql/</literal> and running <literal role="command">df -h</literal>.</simpara>
<simpara>The <literal role="command">smdba</literal> tool also manages your archives, keeping only the most recent backup, and the current archive of logs.
The log files can only be a maximum file size of 16&#160;MB, so a new log file will be created when the files reach this size.
Every time you create a new backup, previous backups will be purged to release disk space.
We recommend you use <literal role="command">cron</literal> to schedule your <literal role="command">smdba</literal> backups to ensure that your storage is managed effectively, and you always have a backup ready in case of failure.</simpara>
<section xml:id="_performing_a_manual_database_backup">
<title>Performing a Manual Database Backup</title>
<simpara>The <literal role="command">smdba</literal> tool can be run directly from the command line.
We recommend you run a manual database backup immediately after installation, or if you have made any significant changes to your configuration.</simpara>
<note>
<simpara>When <literal role="command">smdba</literal> is run for the first time, or if you have changed the location of the backup, it will need to restart your database before performing the archive.
This will result in a small amount of downtime.
Regular database backups will not require any downtime.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Manual Database Backup</title>
<listitem>
<simpara>Allocate permanent storage space for your backup.
This example uses a directory located at <literal role="path">/var/spacewalk/</literal>.
This will become a permanent target for your backup, so ensure it will remain accessible by your server at all times.</simpara>
</listitem>
<listitem>
<simpara>In your backup location, create a directory for the backup:</simpara>
<screen>sudo -u postgres mkdir /var/spacewalk/db-backup</screen>
<simpara>Or, as root:</simpara>
<screen>install -d -o postgres -g postgres -m 700 /var/spacewalk/db-backup</screen>
</listitem>
<listitem>
<simpara>Ensure you have the correct permissions set on the backup location:</simpara>
<screen>chown postgres:postgres /var/spacewalk/db-backup</screen>
</listitem>
<listitem>
<simpara>To run a backup for the first time, run the <literal role="command">smdba backup-hot</literal> command with the <literal role="command">enable</literal> option set.
This will create the backup in the specified directory, and, if necessary, restart the database:</simpara>
<screen>smdba backup-hot --enable=on --backup-dir=/var/spacewalk/db-backup</screen>
<simpara>This command produces debug messages and finishes sucessfully with the output:</simpara>
<screen>INFO: Finished</screen>
</listitem>
<listitem>
<simpara>Check that the backup files exist in the <literal role="path">/var/spacewalk/db-backup</literal> directory, to ensure that your backup has been successful.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="smdba.automatic.backup.with.cron">
<title>Scheduling Automatic Backups</title>
<simpara>You do not need to shut down your system in order to perform a database backup with <literal role="command">smdba</literal>.
However, because it is a large operation, database performance can slow down while the backup is running.
We recommend you schedule regular database backups for a low-traffic period, to minimize disruption.</simpara>
<important>
<simpara>Ensure you have at least three times the current database size of space available for backups.
You can check your current database size by navigating to <literal role="path">/var/lib/pgsql/</literal> and running <literal role="command">df -h</literal>.</simpara>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Scheduling Automatic Backups</title>
<listitem>
<simpara>Create a directory for the backup, and set the appropriate permissions:</simpara>
<screen># install -m 700 -o postgres -g postgres /var/spacewalk/db-backup</screen>
</listitem>
<listitem>
<simpara>Open <literal role="path">/etc/cron.d/db-backup-mgr</literal>, or create it if it does not exist, and add the following line to create the cron job:</simpara>
<screen>0 2 * * * root /usr/bin/smdba backup-hot --enable=on --backup-dir=/var/spacewalk/db-backup</screen>
</listitem>
<listitem>
<simpara>Check the backup directory regularly to ensure the backups are working as expected.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="bp.sect.backup.smdba.restore">
<title>Restoring from Backup</title>
<simpara>The <literal role="command">smdba</literal> tool can be used to restore from backup in the case of failure.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Restoring from Backup</title>
<listitem>
<simpara>Shut down the database:</simpara>
<screen>smdba db-stop</screen>
</listitem>
<listitem>
<simpara>Start the restore process and wait for it to complete:</simpara>
<screen>smdba backup-restore start</screen>
</listitem>
<listitem>
<simpara>Restart the database:</simpara>
<screen>smdba db-start</screen>
</listitem>
<listitem>
<simpara>Check if there are differences between the RPMs and the database.</simpara>
</listitem>
</orderedlist>
<screen>spacewalk-data-fsck</screen>
</section>
<section xml:id="config-smdb.archivelog">
<title>Archive Log Settings</title>
<simpara>In SUSE Manager with an embedded database, archive logging is enabled by default.
This feature allows the database management tool <literal role="command">smdba</literal> to perform hot backups.</simpara>
<simpara>With archive log enabled, even more data is stored on the hard disk:</simpara>
<itemizedlist>
<listitem>
<simpara>PostgreSQL maintains a limited number of archive logs.
Using the default configuration, approximately 64 files with a size of 16 MiB are stored.</simpara>
</listitem>
</itemizedlist>
<simpara>Creating a user and syncing the channels:</simpara>
<itemizedlist>
<listitem>
<simpara>SLES12-SP2-Pool-x86_64</simpara>
</listitem>
<listitem>
<simpara>SLES12-SP2-Updates-x86_64</simpara>
</listitem>
<listitem>
<simpara>SLE-Manager-Tools12-Pool-x86_64-SP2</simpara>
</listitem>
<listitem>
<simpara>SLE-Manager-Tools12-Updates-x86_64-SP2</simpara>
</listitem>
</itemizedlist>
<simpara>PostgreSQL will generate an additional roughly 1 GB of data.
So it is important to think about a backup strategy and create a backups in a regular way.</simpara>
<simpara>Archive logs are stored at <literal role="path">/var/lib/pgsql/data/pg_xlog/</literal> (postgresql).</simpara>
</section>
<section xml:id="config-smdb.spaces">
<title>Retrieving an Overview of Occupied Database Space</title>
<simpara>Database administrators may use the subcommand <literal role="command">space-overview</literal> to get a report about occupied table spaces, for example:</simpara>
<screen>smdba space-overview
SUSE Manager Database Control. Version 1.5.2
Copyright (c) 2012 by SUSE Linux Products GmbH


Tablespace  | Size (Mb) | Avail (Mb) | Use %
------------+-----------+------------+------
postgres    | 7         | 49168      | 0.013
susemanager | 776       | 48399      | 1.602</screen>
<simpara>The <literal role="command">smdba</literal> command is available for PostgreSQL.
For a more detailed report, use the <literal role="command">space-tables</literal> subcommand.
It lists the table and its size, for example:</simpara>
<screen>smdba space-tables
SUSE Manager Database Control. Version 1.5.2
Copyright (c) 2012 by SUSE Linux Products GmbH


Table                                 | Size
--------------------------------------+-----------
public.all_primary_keys               | 0 bytes
public.all_tab_columns                | 0 bytes
public.allserverkeywordsincereboot    | 0 bytes
public.dblink_pkey_results            | 0 bytes
public.dual                           | 8192 bytes
public.evr_t                          | 0 bytes
public.log                            | 32 kB
...</screen>
</section>
<section xml:id="_moving_the_database">
<title>Moving the Database</title>
<simpara>It is possible to move the database to another location.
For example if your database storage space is running low.
The following procedure will guide you through moving the database to a new location for use by SUSE Manager.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Moving the Database</title>
<listitem>
<simpara>The default storage location for SUSE Manager is <literal role="path">/var/lib/pgsql/</literal>. If you would like to move it, for example to <literal role="path">/storage/postgres/</literal>, proceed as follows.</simpara>
</listitem>
<listitem>
<simpara>Stop the running database with:</simpara>
<screen># rcpostgresql stop</screen>
<simpara>Shut down the running spacewalk services with:</simpara>
<screen># spacewalk-service stop</screen>
</listitem>
<listitem>
<simpara>Copy the current working directory structure with <literal role="command">cp</literal> using the <literal role="option">-a, --archive</literal> option.
For example:</simpara>
<screen># cp --archive /var/lib/pgsql/ /storage/postgres/</screen>
<simpara>This command will copy the contents of <literal role="path">/var/lib/pgsql/</literal>
to <literal role="path">/storage/postgres/pgsql/</literal>.</simpara>
<important>
<simpara>The contents of the <literal role="path">/var/lib/pgsql</literal> directory needs to remain the same, otherwise the SUSE Manager database may malfunction.
You also should ensure there is enough available disk space.</simpara>
</important>
</listitem>
<listitem>
<simpara>Mount the new database directory with:</simpara>
<screen># mount /storage/postgres/pgsql</screen>
</listitem>
<listitem>
<simpara>Make sure ownership is <literal>postgres:postgres</literal> and not <literal>root:root</literal> by changing to the new directory and running the following commands:</simpara>
<screen># cd /storage/postgres/pgsql/
# ls -l
total 8
drwxr-x---  4 postgres postgres   47 Jun  2 14:35 ./</screen>
</listitem>
<listitem>
<simpara>Add the new database mount location to your servers fstab by editing  <literal role="path">etc/fstab</literal>.</simpara>
</listitem>
<listitem>
<simpara>Start the database with:</simpara>
<screen># rcpostgresql start</screen>
<simpara>Start the spacewalk services with:</simpara>
<screen># spacewalk-service start</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="config-smdb.recover-root">
<title>Recovering from a Crashed Root Partition</title>
<simpara>This section provides guidance on restoring your server after its root partition has crashed.
This section assumes you have set up your server similar to the procedure explained in the Getting Started guide with separate partitions for the database and for channels mounted at <literal role="path">/var/lib/pgsql</literal> and <literal role="path">/var/spacewalk/</literal>.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Recovering from a Crashed Root Partition</title>
<listitem>
<simpara>Install SUSE Linux Enterprise Server 12 SPx and the SUSE Manager Extension. Do not mount the <literal role="path">/var/spacewalk</literal> and <literal role="path">/var/lib/pgsql</literal> partitions.</simpara>
</listitem>
<listitem>
<simpara>When the installation of SUSE Manager has completed shut down the spacewalk services with <literal role="command">spacewalk-service shutdown</literal> and the database with <literal role="command">rcpostgresql stop</literal>.</simpara>
</listitem>
<listitem>
<simpara>Mount your <literal role="path">/var/spacewalk</literal> and <literal role="path">/var/lib/pgsql</literal> partitions and restore the directories listed in the section above.</simpara>
</listitem>
<listitem>
<simpara>Start SUSE Manager services and the database with <literal role="command">spacewalk-service start</literal> and <literal role="command">rcpostgresql start</literal>.</simpara>
</listitem>
<listitem>
<simpara>SUSE Manager now operates normally without loss of your database or synchronized channels.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_database_connection_information">
<title>Database Connection Information</title>
<simpara>The information for connecting to the SUSE Manager database is located in <literal role="path">/etc/rhn/rhn.conf</literal>:</simpara>
<screen>db_backend = postgresql
db_user = susemanager
db_password = susemanager
db_name = susemanager
db_host = localhost
db_port = 5432
db_ssl_enabled =</screen>
</section>
</chapter>
<chapter xml:id="bp.authentication.with.pam.and.ad">
<title>Authentication Methods</title>
<section xml:id="_authentication_via_pam">
<title>Authentication Via PAM</title>
<simpara>As security measures become increasingly complex, SUSE Manager supports network-based authentication systems via Pluggable Authentication Modules (PAM). PAM is a suite of libraries that allows to integrate SUSE Manager with a centralized authentication mechanism, thus eliminating the need to remember multiple passwords.
SUSE Manager supports LDAP, Kerberos, and other network-based authentication systems via PAM.
To enable SUSE Manager to use PAM in your organization&#8217;s authentication infrastructure, follow the steps below.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Set up a PAM service file (default location: <literal role="path">/etc/pam.d/susemanager</literal> ) then enforce its use by adding the following line to <literal role="path">/etc/rhn/rhn.conf</literal> :</simpara>
<screen>pam_auth_service = susemanager</screen>
<note>
<simpara>This assumes the PAM service file is named susemanager.</simpara>
</note>
</listitem>
<listitem>
<simpara>To enable a new or existing user to authenticate with PAM, proceed to the <guimenu>Create User</guimenu> page and select the checkbox labeled Pluggable Authentication Modules (PAM) positioned below the password and password confirmation fields.</simpara>
</listitem>
<listitem>
<simpara>To authenticate a SLES system against Kerberos add the following lines to <literal role="path">/etc/pam.d/susemanager</literal> :</simpara>
<screen>#%PAM-1.0
 auth     include        common-auth
 account  include        common-account
 password include        common-password
 session  include        common-session</screen>
<note>
<simpara>To register a Red Hat Enterprise Linux System against Kerberos add the following lines to <literal role="path">/etc/pam.d/susemanager</literal></simpara>
</note>
</listitem>
</orderedlist>
<screen>#%PAM-1.0
 auth        required      pam_env.so
 auth        sufficient    pam_krb5.so no_user_check
 auth        required      pam_deny.so
 account     required      pam_krb5.so no_user_check</screen>
<simpara>+</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>YaST can now be used to configure PAM, when packages such as yast2-ldap-client and yast2-kerberos-client are installed; for detailed information on configuring PAM, see the SUSE Linux Enterprise Server Security Guide <link xl:href="https://www.suse.com/documentation/sles-12/book_security/data/part_auth.html">https://www.suse.com/documentation/sles-12/book_security/data/part_auth.html</link>. This example is not limited to Kerberos; it is generic and uses the current server configuration. Note that only network based authentication services are supported.</simpara>
<important>
<title>Changing Passwords</title>
<simpara>Changing the password on the SUSE Manager Web interface changes only the local password on the SUSE Manager server.
But this password may not be used at all if PAM is enabled for that user.
In the above example, for instance, the Kerberos password will not be changed.</simpara>
</important>
</listitem>
</orderedlist>
</section>
<section xml:id="_authentication_via_edirectory_and_pam">
<title>Authentication Via eDirectory and PAM</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>First check to ensure eDirectory authentication is working with your current OS for example:</simpara>
<screen>#getent passwd</screen>
</listitem>
<listitem>
<simpara>If users are returned from eDirectory then create the following file:</simpara>
<screen># cat /etc/pam.d/susemanager</screen>
</listitem>
<listitem>
<simpara>And add the following content:</simpara>
<screen>#%PAM-1.0
 auth     include        common-auth
 account  include        common-account
 password include        common-password
 session  include        common-session
 #</screen>
</listitem>
<listitem>
<simpara>Finally add the following lines to the SUSE Manager conf file:</simpara>
<screen># grep -i pam /etc/rhn/rhn.conf
 pam_auth_service = susemanager</screen>
</listitem>
<listitem>
<simpara>You may now create users with the same id that appears on eDirectory and mark the Use PAM check-box from the SUSE Manager WebUI.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_example_quest_vas_active_directory_authentication_template">
<title>Example Quest VAS Active Directory Authentication Template</title>
<simpara>If you are using Quest VAS for active directory authentication, you can use the following <literal role="path">/etc/pam.d/susemanager</literal>
 file.</simpara>
<screen>#%PAM-1.0
auth       required       pam_env.so
auth       sufficient     pam_vas3.so no_user_check
auth       requisite      pam_vas3.so echo_return
auth       required       pam_deny.so
account    required       pam_vas3.so no_user_check</screen>
</section>
</chapter>
<chapter xml:id="bp.chap.bring.your.own.cert">
<title>Using a Custom SSL Certificate</title>
<simpara>The following section will guide you through using a custom certificate with SUSE Manager 3.2
and SUSE Manager Proxy 3.2
.</simpara>
<section xml:id="bp.cert.custom.req">
<title>Prerequisites</title>
<simpara>The following list provides requirements for using a custom certificate.</simpara>
<itemizedlist>
<listitem>
<simpara>A Certificate Authority (CA) SSL public certificate file</simpara>
</listitem>
<listitem>
<simpara>A Web server SSL private key file</simpara>
</listitem>
<listitem>
<simpara>A Web server SSL public certificate file</simpara>
</listitem>
<listitem>
<simpara>Key and Certificate files must be in PEM format</simpara>
</listitem>
</itemizedlist>
<important>
<title>Hostname and SSL Keys</title>
<simpara>The hostname of the web server&#8217;s SSL keys and relevant certificate files must match the hostname of the machine which they will be deployed on.</simpara>
</important>
<tip>
<title>Intermediate Certificates</title>
<simpara>In case you want to use CAs with intermediate certificates, merge the intermediate and root CA certificates into one file.
It is important that the intermediate certificate comes first within the combined file.</simpara>
</tip>
</section>
<section xml:id="bp.cert.custom.setup">
<title>Setup</title>
<simpara>After completing YaST
firstboot procedures, export your current environment variables and point them to the correct SSL files to be imported.
Running these commands will make the default certificate obsolete after executing the <literal role="command">yast2 susemanagersetup</literal> command.
For more information on YaST
 firstboot, see <link xl:href="https://www.suse.com/documentation/suse-manager-3/singlehtml/suse_manager21/book_susemanager_install/book_susemanager_install.html#sec.manager.inst.setup">https://www.suse.com/documentation/suse-manager-3/singlehtml/suse_manager21/book_susemanager_install/book_susemanager_install.html#sec.manager.inst.setup</link>.</simpara>
<orderedlist xml:id="bp.cert.custom.setup.proc.export" numeration="arabic">
<listitem>
<simpara>Export the environment variables and point to the SSL files to be imported:</simpara>
<screen>export CA_CERT=`path_to_CA_certificate_file`export SERVER_KEY=`path_to_web_server_key`export SERVER_CERT=`path_to_web_server_certificate`</screen>
</listitem>
<listitem>
<simpara>Execute SUSE Manager setup with</simpara>
<screen>yast2 susemanagersetup</screen>
<simpara>Proceed with the default setup.
Upon reaching the Certificate Setup window during YaST
installation, fill in random values, as these will be overridden with the values specified in <xref linkend="bp.cert.custom.setup.proc.export"/>.</simpara>
<note>
<title>Shell Requirements</title>
<simpara>Make sure that you execute <literal role="command">yast2
      susemanagersetup</literal> from within the same shell the environment variables were exported from.</simpara>
</note>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.cert.custom.proxy">
<title>Using a Custom Certificate with SUSE Manager Proxy</title>
<simpara>After completing the installation with yast found in <xref linkend="advanced.topics.proxy.quickstart"/> continue with a modified <xref linkend="at.manager.proxy.run.confproxy"/> procedure:</simpara>
<orderedlist xml:id="bp.cert.custom.proxy.proc" numeration="arabic">
<listitem>
<simpara>Execute <literal role="command">configure-proxy.sh</literal>.</simpara>
</listitem>
<listitem>
<simpara>When prompted with:</simpara>
<screen>Do you want to import existing certificates?</screen>
<simpara>Answer with <keycap>y</keycap>
.</simpara>
</listitem>
<listitem>
<simpara>Continue by following the script prompts.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="bp.chapt.suma3.troubleshooting">
<title>Troubleshooting</title>
<simpara>This chapter provides guidance on registering cloned systems with SUSE Manager.
This includes both Salt and Traditional clients.
For more information, see <link xl:href="https://www.novell.com/support/kb/doc.php?id=7012170">https://www.novell.com/support/kb/doc.php?id=7012170</link>.</simpara>
<section xml:id="bp.chapt.suma3.troubleshooting.registering.cloned.salt.systems">
<title>Registering Cloned Salt Minions</title>
<orderedlist numeration="arabic">
<title>Procedure: Registering a Cloned Salt Minion with SUSE Manager</title>
<listitem>
<simpara>Clone your system (for example using the existing cloning mechanism of your favorite Hypervisor)</simpara>
<note>
<title>Quick Tips</title>
<simpara>Each step in this section is performed on the cloned system, this procedure does not manipulate the original system, which will still be registered to SUSE Manager.
The cloned virtual machine should have a different UUID from the original (this UUID is generated by your hypervisor) or SUSE Manager will overwrite the original system data with the new one.</simpara>
</note>
</listitem>
<listitem>
<simpara>Make sure your machines have different hostnames and IP addresses, also check that /etc/hosts contains the changes you made and the correct host entries.</simpara>
</listitem>
</orderedlist>
<simpara>The next step you take will depend on the Operating System of the clone.</simpara>
<simpara>The following scenario can occur after on-boarding cloned Salt minions.
If after accepting all cloned minion keys from the onboarding page and you see only one minion on the System Overview page, this is likely due to these machines being clones of the original and using a duplicate machine-id.
Perform the following steps to resolve this conflict based on OS.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: SLES 12 Registering Salt Clones</title>
<listitem>
<simpara>SLES 12: If your machines have the same machine ids then delete the file on each minion and recreate it:</simpara>
<screen># rm /etc/machine-id
# rm /var/lib/dbus/machine-id
# dbus-uuidgen --ensure
# systemd-machine-id-setup</screen>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: SLES 11 Registering Salt Clones</title>
<listitem>
<simpara>SLES 11: As there is no systemd machine id, generate one from dbus:</simpara>
<screen># rm /var/lib/dbus/machine-id
# dbus-uuidgen --ensure</screen>
</listitem>
</orderedlist>
<simpara>If your machines still have the same minion id then delete the minion_id file on each minion (FQDN will be used when it is regenerated on minion restart):</simpara>
<screen># rm /etc/salt/minion_id</screen>
<simpara>Finally delete accepted keys from Onboarding page and system profile from SUSE Manager, and restart the minion with:</simpara>
<screen># systemctl restart salt-minion</screen>
<simpara>You should be able to re-register them again, but each minion will use a different '/etc/machine-id' and should now be correctly displayed on the System Overview page.</simpara>
</section>
<section xml:id="bp.chapt.suma3.troubleshooting.registering.cloned.traditional.systems">
<title>Registering Cloned Traditional Systems</title>
<simpara>This section provides guidance on troubleshooting cloned traditional systems registered via bootstrap.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Registering a Cloned System with SUSE Manager (Traditional Systems)</title>
<listitem>
<simpara>Clone your system (using your favorite hypervisor.)</simpara>
<note>
<title>Quick Tips</title>
<simpara>Each step in this section is performed on the cloned system, this procedure does not manipulate the original system, which will still be registered to SUSE Manager.
The cloned virtual machine should have a different UUID from the original (this UUID is generated by your hypervisor) or SUSE Manager will overwrite the original system data with the new one.</simpara>
</note>
</listitem>
<listitem>
<simpara>Change the Hostname and IP addresses, also make sure /etc/hosts contains the changes you made and the correct host entries.</simpara>
</listitem>
<listitem>
<simpara>Stop the rhnsd daemon, on Red Hat Enterprise Linux Server 6 and SUSE Linux Enterprise 11 with:</simpara>
<screen># /etc/init.d/rhnsd stop</screen>
<simpara>or, on newer systemd-based systems, with:</simpara>
<screen># service rhnsd stop</screen>
</listitem>
<listitem>
<simpara>Stop osad with:</simpara>
<screen># /etc/init.d/osad stop</screen>
<simpara>or alternativly:</simpara>
<screen># rcosad stop</screen>
</listitem>
<listitem>
<simpara>Remove the osad authentifcation configuration file and the systemid with:</simpara>
<screen># rm -f /etc/sysconfig/rhn/{osad-auth.conf,systemid}</screen>
</listitem>
</orderedlist>
<simpara>The next step you take will depend on the Operating System of the clone.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: SLES 12 Registering A Cloned Traditional System</title>
<listitem>
<simpara></simpara>
<simpara>If your machines have the same machine ids then delete the file on each client and recreate it:</simpara>
<screen># rm /etc/machine-id
# rm /var/lib/dbus/machine-id
# dbus-uuidgen --ensure
# systemd-machine-id-setup</screen>
</listitem>
<listitem>
<simpara>Remove the following credential files:</simpara>
<screen># rm  -f /etc/zypp/credentials.d/{SCCcredentials,NCCcredentials}</screen>
</listitem>
<listitem>
<simpara>Re-run the bootstrap script. You should now see the cloned system in SUSE Manager without overwriting the system it was cloned from.</simpara>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: SLES 11 Registering A Cloned Traditional System</title>
<listitem>
<simpara>Continued from section 1 step 5:</simpara>
<screen># suse_register -E</screen>
<simpara>(--erase-local-regdata, Erase all local files created from a previous executed registration.
This option make the system look like never registered)</simpara>
</listitem>
<listitem>
<simpara>Re-run the bootstrap script. You should now see the cloned system in SUSE Manager without overwriting the system it was cloned from.</simpara>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: SLES 10 Registering A Cloned Traditional System</title>
<listitem>
<simpara>Continued from section 1 step 5:</simpara>
<screen># rm -rf /etc/{zmd,zypp}</screen>
</listitem>
<listitem>
<simpara></simpara>
<screen># ¡¡¡¡¡ everthing in /var/lib/zypp/ except /var/lib/zypp/db/products/ !!!!!
# check whether this command works for you
# rm -rf /var/lib/zypp/!(db)</screen>
</listitem>
<listitem>
<simpara></simpara>
<screen># rm -rf /var/lib/zmd/</screen>
</listitem>
<listitem>
<simpara>Re-run the bootstrap script. You should now see the cloned system in SUSE Manager without overwriting the system it was cloned from.</simpara>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: RHEL 5,6 and 7</title>
<listitem>
<simpara>Continued from section 1 step 5:</simpara>
<screen># rm  -f /etc/NCCcredentials</screen>
</listitem>
<listitem>
<simpara>Re-run the bootstrap script. You should now see the cloned system in SUSE Manager without overwriting the system it was cloned from.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.chapt.suma3.troubleshooting.osad.jabberd">
<title>Typical OSAD/jabberd Challenges</title>
<simpara>This section provides answers for typical issues regarding OSAD and jabberd.</simpara>
<section xml:id="_open_file_count_exceeded">
<title>Open File Count Exceeded</title>
<simpara><literal>SYMPTOMS</literal>: OSAD clients cannot contact the SUSE Manager Server, and jabberd requires long periods of time to respond on port 5222.</simpara>
<simpara><literal>CAUSE</literal>: The number of maximum files that a jabber user can open is lower than the number of connected clients.
Each client requires one permanently open TCP connection and each connection requires one file handler.
The result is jabberd begins to queue and refuse connections.</simpara>
<simpara><literal>CURE</literal>: Edit the <literal role="path">/etc/security/limits.conf</literal>
 to something similar to the following: <literal>jabbersoftnofile&lt;#clients + 100&gt;
    jabberhardnofile&lt;#clients + 1000&gt;</literal></simpara>
<simpara>This will vary according to your setup.
For example in the case of 5000 clients: <literal>jabbersoftnofile5100 jabberhardnofile6000</literal></simpara>
<simpara>Ensure you update the <literal role="path">/etc/jabberd/c2s.xml</literal>
 max_fds parameter as well.
For example: <literal>&lt;max_fds&gt;6000&lt;/max_fds&gt;</literal></simpara>
<simpara><literal>EXPLANATION</literal>: The soft file limit is the limit of the maximum number of open files for a single process.
In SUSE Manager the highest consuming process is c2s, which opens a connection per client.
100 additional files are added, here, to accommodate for any non-connection file that c2s requires to work correctly.
The hard limit applies to all processes belonging to the jabber user, and accounts for open files from the router, s2s and sm processes additionally.</simpara>
</section>
<section xml:id="_jabberd_database_corruption">
<title>jabberd Database Corruption</title>
<simpara><literal>SYMPTOMS</literal>: After a disk is full error or a disk crash event, the jabberd database may have become corrupted.
jabberd may then fail to start during spacewalk-service start:</simpara>
<screen>Starting spacewalk services...
   Initializing jabberd processes...
       Starting router                                                                   done
       Starting sm startproc:  exit status of parent of /usr/bin/sm: 2                   failed
   Terminating jabberd processes...</screen>
<simpara>/var/log/messages shows more details:</simpara>
<screen>jabberd/sm[31445]: starting up
jabberd/sm[31445]: process id is 31445, written to /var/lib/jabberd/pid/sm.pid
jabberd/sm[31445]: loading 'db' storage module
jabberd/sm[31445]: db: corruption detected! close all jabberd processes and run db_recover
jabberd/router[31437]: shutting down</screen>
<simpara><literal>CURE</literal>: Remove the jabberd database and restart.
Jabberd will automatically re-create the database:</simpara>
<screen>spacewalk-service stop
 rm -Rf /var/lib/jabberd/db/*
 spacewalk-service start</screen>
<simpara>An alternative approach would be to test another database, but SUSE Manager does not deliver drivers for this:</simpara>
<screen>rcosa-dispatcher stop
 rcjabberd stop
 cd /var/lib/jabberd/db
 rm *
 cp /usr/share/doc/packages/jabberd/db-setup.sqlite .
 sqlite3 sqlite.db &lt; db-setup.sqlite
 chown jabber:jabber *
 rcjabberd start
 rcosa-dispatcher start</screen>
</section>
<section xml:id="_capturing_xmpp_network_data_for_debugging_purposes">
<title>Capturing XMPP Network Data for Debugging Purposes</title>
<simpara>If you are experiencing bugs regarding OSAD, it can be useful to dump network messages in order to help with debugging.
The following procedures provide information on capturing data from both the client and server side.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Server Side Capture</title>
<listitem>
<simpara>Install the <phrase role="package">tcpdump</phrase> package on the SUSE Manager Server as root: <literal role="command">zypper in tcpdump </literal></simpara>
</listitem>
<listitem>
<simpara>Stop the OSA dispatcher and Jabber processes with <literal role="command">rcosa-dispatcher stop</literal> and <literal role="command">rcjabberd stop.</literal></simpara>
</listitem>
<listitem>
<simpara>Start data capture on port 5222: <literal role="command">tcpdump -s 0 port 5222 -w server_dump.pcap</literal></simpara>
</listitem>
<listitem>
<simpara>Start the OSA dispatcher and Jabber processes: <literal role="command">rcosa-dispatcher start</literal> and <literal role="command">rcjabberd start</literal>.</simpara>
</listitem>
<listitem>
<simpara>Open a second terminal and execute the following commands: <literal role="command">rcosa-dispatcher start</literal> and <literal role="command">rcjabberd start</literal>.</simpara>
</listitem>
<listitem>
<simpara>Operate the SUSE Manager server and clients so the bug you formerly experienced is reproduced.</simpara>
</listitem>
<listitem>
<simpara>Once you have finished your capture re-open terminal 1 and stop the capture of data with: <keycombo><keycap>CTRL</keycap><keycap>c</keycap></keycombo></simpara>
</listitem>
</orderedlist>
<orderedlist numeration="arabic">
<title>Procedure: Client Side Capture</title>
<listitem>
<simpara>Install the tcpdump package on your client as root: <literal role="command">zypper in tcpdump</literal></simpara>
</listitem>
<listitem>
<simpara>Stop the OSA process: <literal role="command">rcosad stop</literal>.</simpara>
</listitem>
<listitem>
<simpara>Begin data capture on port 5222: <literal role="command">tcpdump -s 0 port 5222 -w client_client_dump.pcap</literal></simpara>
</listitem>
<listitem>
<simpara>Open a second terminal and start the OSA process: <literal role="command">rcosad start</literal></simpara>
</listitem>
<listitem>
<simpara>Operate the SUSE Manager server and clients so the bug you formerly experienced is reproduced.</simpara>
</listitem>
<listitem>
<simpara>Once you have finished your capture re-open terminal 1 and stop the capture of data with: <keycombo><keycap>CTRL</keycap><keycap>c</keycap></keycombo></simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="_engineering_notes_analyzing_captured_data">
<title>Engineering Notes: Analyzing Captured Data</title>
<simpara>This section provides information on analyzing the previously captured data from client and server.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Obtain the certificate file from your SUSE Manager server: /etc/pki/spacewalk/jabberd/server.pem</simpara>
</listitem>
<listitem>
<simpara>Edit the certificate file removing all lines before <literal>----BEGIN RSA PRIVATE KEY-----</literal>, save it as key.pem</simpara>
</listitem>
<listitem>
<simpara>Install Wireshark as root with: <literal role="command">zypper in wireshark</literal></simpara>
</listitem>
<listitem>
<simpara>Open the captured file in wireshark.</simpara>
</listitem>
<listitem>
<simpara>From <menuchoice><guimenu>Eidt</guimenu> <guimenuitem>]menu:Preferences[</guimenuitem></menuchoice> select SSL from the left pane.</simpara>
</listitem>
<listitem>
<simpara>Select RSA keys list: <menuchoice><guimenu>Edit</guimenu> <guimenuitem>]menu:New[</guimenuitem></menuchoice></simpara>
<itemizedlist>
<listitem>
<simpara>IP Address any</simpara>
</listitem>
<listitem>
<simpara>Port: 5222</simpara>
</listitem>
<listitem>
<simpara>Protocol: xmpp</simpara>
</listitem>
<listitem>
<simpara>Key File: open the key.pem file previously edited.</simpara>
</listitem>
<listitem>
<simpara>Password: leave blank</simpara>
</listitem>
</itemizedlist>
<simpara>For more information see also:</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://wiki.wireshark.org/SSL">https://wiki.wireshark.org/SSL</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3444">https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3444</link></simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="bp.chapt.suma3.troubleshooting.spacewalk-report">
<title>Gathering Information with <literal role="command">spacewalk-report</literal></title>
<simpara>The <literal role="command">spacewalk-report</literal> command is used to produce a variety of reports for system administrators.
These reports can be helpful for taking inventory of your entitlements, subscribed systems, users, and organizations.
Using reports is often simpler than gathering information manually from the SUSE Manager Web UI, especially if you have many systems under management.</simpara>
<note>
<title><literal role="package">spacewalk-reports</literal> Package</title>
<simpara>To use spacewalk-report, you must have the <literal role="package">spacewalk-reports</literal> package installed.</simpara>
</note>
<simpara><literal role="command">spacewalk-report</literal> allows administrators to organize and display reports about content, systems, and user resources across SUSE Manager.
Using <literal role="command">spacewalk-report</literal>, you can receive reports on:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>System Inventory: lists all of the systems registered to SUSE Manager.</simpara>
</listitem>
<listitem>
<simpara>Entitlements: lists all organizations on SUSE Manager, sorted by system or channel entitlements.</simpara>
</listitem>
<listitem>
<simpara>Patches: lists all the patches relevant to the registered systems and sorts patches by severity, as well as the systems that apply to a particular patch.</simpara>
</listitem>
<listitem>
<simpara>Users: lists all the users registered to SUSE Manager and any systems associated with a particular user.</simpara>
</listitem>
</orderedlist>
<simpara><literal role="command">spacewalk-report</literal> allows administrators to organize and display reports about content, systems, and user resources across SUSE Manager.
To get the report in CSV format, run the following at the command line of your SUSE Manager server.</simpara>
<screen>spacewalk-report report_name</screen>
<simpara>The following reports are available:</simpara>
<table xml:id="tab.bp.troubleshooting.spacewalk-report" frame="all" rowsep="1" colsep="1">
<title><literal role="command">spacewalk-report</literal> Reports</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Report</entry>
<entry align="left" valign="top">Invoked as</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Channel Packages</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">channel-packages</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of packages in a channel.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Channel Report</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">channels</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Detailed report of a given channel.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Cloned Channel Report</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">cloned-channels</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Detailed report of cloned channels.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Custom Info</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">custom-info</literal></simpara></entry>
<entry align="left" valign="top"><simpara>System custom information.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Entitlements</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">entitlements</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Lists all organizations on SUSE Manager with their system or channel entitlements.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Patches in Channels</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">errata-channels</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Lists of patches in channels.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Patches Details</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">errata-list</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Lists all patches that affect systems registered to SUSE Manager.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>All patches</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">errata-list-all</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Complete list of all patches.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Patches for Systems</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">errata-systems</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Lists applicable patches and any registered systems that are affected.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Host Guests</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">host-guests</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of host-guests mapping.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Inactive Systems</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">inactive-systems</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of inactive systems.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Inventory</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">inventory</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of systems registered to the server, together with hardware and software information.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Kickstart Trees</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">kickstartable-trees</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of kickstartable trees.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>All Upgradable Versions</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">packages-updates-all</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of all newer package versions that can be upgraded.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Newest Upgradable Version</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">packages-updates-newest</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of only newest package versions that can be upgraded.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Result of SCAP</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">scap-scan</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Result of OpenSCAP sccdf eval.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Result of SCAP</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">scap-scan-results</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Result of OpenSCAP sccdf eval, in a different format.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Data</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">splice-export</literal></simpara></entry>
<entry align="left" valign="top"><simpara>System data needed for splice integration.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Groups</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">system-groups</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of system groups.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Activation Keys for System Groups</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">system-groups-keys</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of activation keys for system groups.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Systems in System Groups</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">system-groups-systems</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of systems in system groups.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Groups Users</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">system-groups-users</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Report of system groups users.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Installed Packages</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">system-packages-installed</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of packages installed on systems.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Users in the System</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">users</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Lists all users registered to SUSE Manager.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Systems administered</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">users-systems</literal></simpara></entry>
<entry align="left" valign="top"><simpara>List of systems that individual users can administer.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>For more information about an individual report, run <literal role="command">spacewalk-report</literal> with the option <literal role="option">--info</literal> or <literal role="option">--list-fields-info</literal> and the report name.
The description and list of possible fields in the report will be shown.</simpara>
<simpara>For further information on program invocations and options, see the <literal role="literal">spacewalk-report(8)</literal> man page as well as the <literal role="option">--help</literal>parameter of the <literal role="command">spacewalk-report</literal>.</simpara>
</section>
<section xml:id="bp.troubleshooting.timeouts">
<title>RPC Connection Timeout Settings</title>
<simpara><indexterm>
<primary>connection timeout</primary>
</indexterm></simpara>
<simpara><indexterm>
<primary>timeout settings</primary><secondary>RPC connection</secondary>
</indexterm>
<indexterm>
<primary>RPC connection</primary>
</indexterm></simpara>
<simpara>RPC connection timeouts are configurable on the SUSE Manager server, SUSE Manager Proxy server, and the clients.
For example, if package downloads take longer then expected, you can increase timeout values. <literal role="command">spacewalk-proxy restart</literal> should be run after the setting is added or modified.</simpara>
<simpara>Set the following variables to a value in seconds specifying how long an RPC connection may take at maximum:</simpara>
<variablelist>
<varlistentry>
<term>Server -<literal role="path">/etc/rhn/rhn.conf</literal> </term>
<listitem>
<screen>server.timeout =`number`</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Proxy Server -<literal role="path">/etc/rhn/rhn.conf</literal> </term>
<listitem>
<screen>proxy.timeout =`number`</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>SUSE Linux Enterprise Server Clients (using <phrase role="package">zypp-plugin-spacewalk</phrase> ) -<literal role="path">/etc/zypp/zypp.conf</literal> </term>
<listitem>
<screen>## Valid values:  [0,3600]
## Default value: 180
download.transfer_timeout = 180</screen>
<simpara>This is the maximum time in seconds that a transfer operation is allowed to take.
This is useful for preventing batch jobs from hanging for hours due to slow networks or links going down.
If limiting operations to less than a few minutes, you risk aborting perfectly normal operations.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Red Hat Enterprise Linux Clients (using <phrase role="package">yum-rhn-plugin</phrase> ) -<literal role="path">/etc/yum.conf</literal> </term>
<listitem>
<screen>timeout =`number`</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="bp.troubleshooting.package.inconsistency">
<title>Client/Server Package Inconsistency</title>
<simpara>In some cases, updates are available in the web interface, but not appearing on the client.
If you schedule an update on the client, it will fail with an error stating that no updates are available.
This can be caused by a metadata regeneration problem, or because update packages have been locked.</simpara>
<simpara>The notice that updates are available will appear immediately, but new metadata is only generated on the server after synchronizing.
In this case, an inconsistency can occur if taskomatic crashes, or because taskomatic is still running and creating new metadata.</simpara>
<simpara>To address this issue, check the <literal role="path">/var/log/rhn/rhn_taskomatic_daemon.log</literal> file to determine if any processess are still running, or an exception which could indicate a crash.
In the case of a crash, restart taskomatic.</simpara>
<simpara>Check package locks and exclude lists to determine if packages are locked or excluded on the client:</simpara>
<simpara>On Expanded Support Platform, check <literal role="path">/etc/yum.conf</literal> and search for <literal>exclude=</literal>.</simpara>
<simpara>On SUSE Linux Enterprise Server, use the <literal role="command">zypper locks</literal> command.</simpara>
</section>
<section xml:id="bp.troubleshooting.Corrupt.Repo.Data">
<title>Corrupted Repository Data</title>
<simpara>If the information in <literal role="path">/var/cache/rhn/repodata/sles12-sp4-updates-x86_64</literal> becomes out of date, it will cause problems with updating the server.
The repository data file can be regenerated using the <literal role="command">spacemd</literal> command:</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Rebuild repodata file</title>
<listitem>
<simpara>Remove all files from <literal role="path">/var/cache/rhn/repodata/sles12-sp4-updates-x86_64</literal></simpara>
</listitem>
<listitem>
<simpara>Regenerate the file with <literal>spacecmd softwarechannel_regenerateyumcache sles12-sp4-updates-x86_64</literal></simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="bp.troubleshooting.Local.Issuer.Certificate">
<title>Unable to Get Local Issuer Certificate</title>
<simpara>Some older bootstrap scripts will will create a link to the local certificate in the wrong place, which can cause problems with zypper returning an <literal>Unrecognized error</literal> about the local issuer certificate.
In this case, ensure that the link to the local issuer certificate has been created in <literal role="path">/etc/ssl/certs/</literal>, and consider updating your bootstrap scripts.</simpara>
</section>
</chapter>
<chapter xml:id="mgr.additional.resources">
<title>Additional Resources</title>
<simpara>This chapter contains links to helpful resources.</simpara>
<section xml:id="_learning_yaml_syntax_for_salt_states">
<title>Learning YAML Syntax for Salt States</title>
<simpara>Learn how to write states and pillars with YAML.</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/yaml/index.html">https://docs.saltstack.com/en/latest/topics/yaml/index.html</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="http://yaml-online-parser.appspot.com/">http://yaml-online-parser.appspot.com/</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_getting_started_with_jinja_templates">
<title>Getting Started with Jinja Templates</title>
<simpara>Learn how to begin writing templates in Jinja</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/jinja/index.html">https://docs.saltstack.com/en/latest/topics/jinja/index.html</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="http://jinja.pocoo.org/docs/dev/">http://jinja.pocoo.org/docs/dev/</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_salt_best_practices">
<title>Salt Best Practices</title>
<simpara>Best practices from the Salt team.</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://docs.saltstack.com/en/latest/topics/best_practices.html">https://docs.saltstack.com/en/latest/topics/best_practices.html</link></simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="mgr.product.comparison">
<title>A SUSE Manager 2.1 and 3.2 Product Comparison</title>
<simpara>You may already have experience managing your systems using SUSE Manager 2.1.
The good news is all the features you are used to working with, (regarding the traditional stack) have not changed.
The only real exception is that the original built-in monitoring feature has been removed.
Icinga, a third party monitoring solution is included within the SUSE Manager Tools Channel for SLES 12.
SUSE Manager 3.2 supports managing systems via the popular IT orchestration engine Salt, in addition to the previously existing traditional management stack.</simpara>
<important>
<title>Selecting a Management Method</title>
<simpara>You cannot and should not mix a single system with both methods although you can have Salt managed systems and traditionally managed systems coexisting and managed by a SUSE Manager server.
You may for example have a development department and assign all machines in this department as Salt minions, likewise you could also have a production department and assign machines as traditional bootstrap clients.
Remember a single machine is either traditionally managed or Salt but never both.</simpara>
</important>
<simpara>Keep in mind that minions are not traditional clients and their feature set is currently limited.
Future maintenance updates will provide feature parity over time and your feedback for prioritization of these features is welcome! The following tables provide a comparison between each feature set.
This includes features in development and features available only to their parent management stack.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Comparing Traditional Management and Salt Management</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Feature/Function</entry>
<entry align="left" valign="top">Traditional Management</entry>
<entry align="left" valign="top">Salt Management</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Registration</simpara></entry>
<entry align="left" valign="top"><simpara>bootstrap/rhnreg_ks</simpara></entry>
<entry align="left" valign="top"><simpara>bootstrap scripts and Web UI</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Install Packages</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Install Patches</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Remote Commands</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Package States</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Custom States</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Group Custom States</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Organization Custom States</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Set Manager</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Service Pack Migration</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Virtualization Host Management: <emphasis>Auto-installation/bare metal installation support</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported (read-only)</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Redeployment: <emphasis>With Auto-installation</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Coming Soon</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Contact Methods: <emphasis>How the server communicates with a client</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>osad, rhnsd, ssh push</simpara></entry>
<entry align="left" valign="top"><simpara>zeromq: Salt default salt-ssh</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Red Hat Network Clients <emphasis>RHEL 6, 7</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SUSE Manager Proxy</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Action Chains</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Software Crash Reporting</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Staging</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Duplicate Package Reporting <emphasis>Example: Multiple Versions of the Linux Kernel</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SCAP Auditing</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Support for Multiple Organizations</simpara></entry>
<entry align="left" valign="top"><simpara>Supported  **</simpara></entry>
<entry align="left" valign="top"><simpara>Supported **</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Package Verification</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Under Review</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>System Locking</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Under Review</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Configuration File Management</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Snapshots and Profiles</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Under Review (Profiles are supported, syncing is not)</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Power Management</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Coming Soon</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<warning>
<title>Isolation Enforcement **</title>
<simpara>SUSE Manager 2.1 is multi-tenant and organizations are completely isolated from one another.
This isolation includes both privacy and security.</simpara>
<simpara>For example: User A in Org_1 cannot see user B in Org_2.
(This relates to any data specific to an organization including: servers, channels, activation keys, configuration channels, files and so on.)</simpara>
<simpara>In SUSE Manager 3.2 Salt currently does not support any level of multi-tenancy and therefore information specific to an organization is accessible across organizations.
For example:</simpara>
<screen>salt '*' cmd.run "some_dangerous_command"</screen>
<simpara>The above command will target all organization, groups and single systems including their files, channels, activation keys etc.
This should be kept in mind when working with Salt.</simpara>
</warning>
<simpara>The following table provides an overview of differences in functionality between SUSE Manager 2.1 and 3.2.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Comparing SUSE Manager 2.1 and 3.2 Functionality</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Functionality</entry>
<entry align="left" valign="top">SUSE Manager 2.1</entry>
<entry align="left" valign="top">SUSE Manager 3.2</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Configuration Management</simpara></entry>
<entry align="left" valign="top"><simpara>Based on Static Configuration</simpara></entry>
<entry align="left" valign="top"><simpara>Redesigned with Salt Integration</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Configuration Management</simpara></entry>
<entry align="left" valign="top"><simpara>No Concept of States</simpara></entry>
<entry align="left" valign="top"><simpara>States are Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Subscription Management</simpara></entry>
<entry align="left" valign="top"><simpara>Limited Functionality</simpara></entry>
<entry align="left" valign="top"><simpara>New Design, Full Featured</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Monitoring</simpara></entry>
<entry align="left" valign="top"><simpara>Traditional Monitoring Supported until End of Life</simpara></entry>
<entry align="left" valign="top"><simpara>Nagios Compatible, Icinga Monitoring Server is Included</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Installation Approach</simpara></entry>
<entry align="left" valign="top"><simpara>Appliance Based</simpara></entry>
<entry align="left" valign="top"><simpara>Installed as an Add-on</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Compatibility</simpara></entry>
<entry align="left" valign="top"><simpara>Compatibility Carried Forward to SUSE Manager 3</simpara></entry>
<entry align="left" valign="top"><simpara>Maintains full SUSE Manager 2.1 Functionality <emphasis>Traditional Monitoring Removed</emphasis></simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</chapter>
<appendix xml:id="_gnu_licenses">
<title>GNU Licenses</title>
<simpara>This appendix contains the GNU Free Documentation License version 1.2.</simpara>
</appendix>
<chapter xml:id="_gnu_free_documentation_license">
<title>GNU Free Documentation License</title>
<simpara>Copyright &#169; 2000, 2001, 2002 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.</simpara>
<bridgehead xml:id="_0_preamble" renderas="sect2">0. PREAMBLE</bridgehead>
<simpara>The purpose of this License is to make a manual, textbook, or other functional and useful document "free" in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others.</simpara>
<simpara>This License is a kind of "copyleft", which means that derivative works of the document must themselves be free in the same sense.
It complements the GNU General Public License, which is a copyleft license designed for free software.</simpara>
<simpara>We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does.
But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book.
We recommend this License principally for works whose purpose is instruction or reference.</simpara>
<bridgehead xml:id="_1_applicability_and_definitions" renderas="sect2">1. APPLICABILITY AND DEFINITIONS</bridgehead>
<simpara>This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License.
Such a notice grants a world-wide, royalty-free license, unlimited in duration, to use that work under the conditions stated herein.
The "Document", below, refers to any such manual or work.
Any member of the public is a licensee, and is addressed as "you". You accept the license if you copy, modify or distribute the work in a way requiring permission under copyright law.</simpara>
<simpara>A "Modified Version" of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language.</simpara>
<simpara>A "Secondary Section" is a named appendix or a front-matter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document&#8217;s overall subject (or to related matters) and contains nothing that could fall directly within that overall subject.
(Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them.</simpara>
<simpara>The "Invariant Sections" are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License.
If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant.
The Document may contain zero Invariant Sections.
If the Document does not identify any Invariant Sections then there are none.</simpara>
<simpara>The "Cover Texts" are certain short passages of text that are listed, as Front-Cover Texts or Back-Cover Texts, in the notice that says that the Document is released under this License.
A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at most 25 words.</simpara>
<simpara>A "Transparent" copy of the Document means a machine-readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters.
A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount of text.
A copy that is not "Transparent" is called "Opaque".</simpara>
<simpara>Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, LaTeX input format, SGML or XML using a publicly available DTD, and standard-conforming simple HTML, PostScript or PDF designed for human modification.
Examples of transparent image formats include PNG, XCF and JPG.
Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine-generated HTML, PostScript or PDF produced by some word processors for output purposes only.</simpara>
<simpara>The "Title Page" means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page.
For works in formats which do not have any title page as such, "Title Page" means the text near the most prominent appearance of the work&#8217;s title, preceding the beginning of the body of the text.</simpara>
<simpara>A section "Entitled XYZ" means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language.
(Here XYZ stands for a specific section name mentioned below, such as "Acknowledgements", "Dedications", "Endorsements", or "History".) To "Preserve the Title" of such a section when you modify the Document means that it remains a section "Entitled XYZ" according to this definition.</simpara>
<simpara>The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document.
These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License.</simpara>
<bridgehead xml:id="_2_verbatim_copying" renderas="sect2">2. VERBATIM COPYING</bridgehead>
<simpara>You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License.
You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute.
However, you may accept compensation in exchange for copies.
If you distribute a large enough number of copies you must also follow the conditions in section 3.</simpara>
<simpara>You may also lend copies, under the same conditions stated above, and you may publicly display copies.</simpara>
<bridgehead xml:id="_3_copying_in_quantity" renderas="sect2">3. COPYING IN QUANTITY</bridgehead>
<simpara>If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document&#8217;s license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on the back cover.
Both covers must also clearly and legibly identify you as the publisher of these copies.
The front cover must present the full title with all words of the title equally prominent and visible.
You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects.</simpara>
<simpara>If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages.</simpara>
<simpara>If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine-readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computer-network location from which the general network-using public has access to download using public-standard network protocols a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public.</simpara>
<simpara>It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document.</simpara>
<bridgehead xml:id="_4_modifications" renderas="sect2">4. MODIFICATIONS</bridgehead>
<simpara>You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy of it.
In addition, you must do these things in the Modified Version:</simpara>
<orderedlist numeration="upperalpha">
<listitem>
<simpara>Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission.</simpara>
</listitem>
<listitem>
<simpara>List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement.</simpara>
</listitem>
<listitem>
<simpara>State on the Title page the name of the publisher of the Modified Version, as the publisher.</simpara>
</listitem>
<listitem>
<simpara>Preserve all the copyright notices of the Document.</simpara>
</listitem>
<listitem>
<simpara>Add an appropriate copyright notice for your modifications adjacent to the other copyright notices.</simpara>
</listitem>
<listitem>
<simpara>Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below.</simpara>
</listitem>
<listitem>
<simpara>Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document&#8217;s license notice.</simpara>
</listitem>
<listitem>
<simpara>Include an unaltered copy of this License.</simpara>
</listitem>
<listitem>
<simpara>Preserve the section Entitled "History", Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled "History" in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence.</simpara>
</listitem>
<listitem>
<simpara>Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on. These may be placed in the "History" section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission.</simpara>
</listitem>
<listitem>
<simpara>For any section Entitled "Acknowledgements" or "Dedications", Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein.</simpara>
</listitem>
<listitem>
<simpara>Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles.</simpara>
</listitem>
<listitem>
<simpara>Delete any section Entitled "Endorsements". Such a section may not be included in the Modified Version.</simpara>
</listitem>
<listitem>
<simpara>Do not retitle any existing section to be Entitled "Endorsements" or to conflict in title with any Invariant Section.</simpara>
</listitem>
<listitem>
<simpara>Preserve any Warranty Disclaimers.</simpara>
</listitem>
</orderedlist>
<simpara>If the Modified Version includes new front-matter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant.
To do this, add their titles to the list of Invariant Sections in the Modified Version&#8217;s license notice.
These titles must be distinct from any other section titles.</simpara>
<simpara>You may add a section Entitled "Endorsements", provided it contains nothing but endorsements of your Modified Version by various parties&#8212;&#8203;for example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard.</simpara>
<simpara>You may add a passage of up to five words as a Front-Cover Text, and a passage of up to 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified Version.
Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or through arrangements made by) any one entity.
If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one.</simpara>
<simpara>The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version.</simpara>
<bridgehead xml:id="_5_combining_documents" renderas="sect2">5. COMBINING DOCUMENTS</bridgehead>
<simpara>You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers.</simpara>
<simpara>The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy.
If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work.</simpara>
<simpara>In the combination, you must combine any sections Entitled "History" in the various original documents, forming one section Entitled "History"; likewise combine any sections Entitled "Acknowledgements", and any sections Entitled "Dedications". You must delete all sections Entitled "Endorsements".</simpara>
<bridgehead xml:id="_6_collections_of_documents" renderas="sect2">6. COLLECTIONS OF DOCUMENTS</bridgehead>
<simpara>You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects.</simpara>
<simpara>You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document.</simpara>
<bridgehead xml:id="_7_aggregation_with_independent_works" renderas="sect2">7. AGGREGATION WITH INDEPENDENT WORKS</bridgehead>
<simpara>A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an "aggregate" if the copyright resulting from the compilation is not used to limit the legal rights of the compilation&#8217;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document.</simpara>
<simpara>If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document&#8217;s Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole aggregate.</simpara>
<bridgehead xml:id="_8_translation" renderas="sect2">8. TRANSLATION</bridgehead>
<simpara>Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections.
You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers.
In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail.</simpara>
<simpara>If a section in the Document is Entitled "Acknowledgements", "Dedications", or "History", the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title.</simpara>
<bridgehead xml:id="_9_termination" renderas="sect2">9. TERMINATION</bridgehead>
<simpara>You may not copy, modify, sublicense, or distribute the Document except as expressly provided for under this License.
Any other attempt to copy, modify, sublicense or distribute the Document is void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.</simpara>
<bridgehead xml:id="_10_future_revisions_of_this_license" renderas="sect2">10. FUTURE REVISIONS OF THIS LICENSE</bridgehead>
<simpara>The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time.
Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
See <link xl:href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</link>.</simpara>
<simpara>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this License "or any later version" applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation.
If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation.</simpara>
<bridgehead xml:id="_addendum_how_to_use_this_license_for_your_documents" renderas="sect2">ADDENDUM: How to use this License for your documents</bridgehead>
<screen>Copyright (c) YEAR YOUR NAME.
   Permission is granted to copy, distribute and/or modify this document
   under the terms of the GNU Free Documentation License, Version 1.2
   or any later version published by the Free Software Foundation;
   with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
   A copy of the license is included in the section entitled{ldquo}GNU
   Free Documentation License{rdquo}.</screen>
<simpara>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the &#8220;
with&#8230;&#8203;Texts.&#8221;
line with this:</simpara>
<screen>with the Invariant Sections being LIST THEIR TITLES, with the
   Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.</screen>
<simpara>If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation.</simpara>
<simpara>If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software.</simpara>
</chapter>
</part>
<part xml:id="book.suma.reference.manual">
<title>Reference Manual</title>
<preface xml:id="preface.susemanager.user">
<title>About This Guide</title>
<simpara>SUSE Manager enables you to efficiently manage a set of Linux systems and keep them up-to-date.
It provides automated and cost-effective software management, asset management, system provisioning, and monitoring capabilities.
SUSE Manager is compatible with {rh} Satellite Server and offers seamless management of both SUSE Linux Enterprise and Red Hat Enterprise Linux client systems.</simpara>
<note>
<title>SUSE Manager Version Information</title>
<simpara>In this manual if not other specified, SUSE Manager version 3.2 is assumed and this version is required if a feature is discussed.
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy were originally released as a SLES 12 SP3 extension.
With the next maintenance update (December 2018),
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy will be based on SLES 12 SP4 and support SLE 12 SP4 clients officially.
In the following sections and chapters, it is highly recommended to use SLE 12 SP4 instead of SP3.
Whenever features of the SUSE Manager 3.2 host operating system are documented and not other specified version 12 SP4 is assumed.</simpara>
</note>
<simpara>This manual explains the features of the Web interface and is intended for SUSE Manager administrators and administrators with restricted roles for specific tasks.
On certain topics we also provide background information, while some chapters contain links to additional documentation resources.
The latter include additional documentation available on the installed system as well as documentation on the Internet.</simpara>
<simpara>For an overview of the documentation available for your product and the latest documentation updates, refer to <link xl:href="http://www.suse.com/documentation/suse-manager-3/">Available Documentation</link> or to the following section.</simpara>
<simpara>HTML versions of the manuals are also available from the <emphasis role="strong">Help</emphasis> menu of the SUSE Manager Web interface.</simpara>
<note>
<title>Obtaining the Release Notes</title>
<simpara>Although this manual reflects the most current information possible, read the <emphasis><phrase role="ref">SUSE Manager Release Notes</phrase></emphasis> for information that may not have been available prior to the finalization of the documentation.
The release notes can be found at <link xl:href="http://www.suse.com/documentation/suse-manager-3/">SUSE Manager Release Notes</link>.</simpara>
</note>
</preface>
<chapter xml:id="_available_documentation">
<title>Available Documentation</title>
<simpara>The following manuals are available on this product:</simpara>
<variablelist>
<varlistentry>
<term><xref linkend="book.suma.getting-started"/></term>
<listitem>
<simpara>Lists installation scenarios and example topologies for different SUSE Manager setups.
Guides you step by step through the installation, setup and basic configuration of SUSE Manager.
Also contains detailed information about SUSE Manager maintenance and troubleshooting.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><xref linkend="book.suma.reference.manual"/></term>
<listitem>
<simpara>Reference documentation that covers the Web interface to SUSE Manager (Web UI).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><xref linkend="book.suma.best.practices"/></term>
<listitem>
<simpara>Best practices on selected topics.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><xref linkend="book.suma.advanced.topics"/></term>
<listitem>
<simpara>A collection of advanced topics not covered under the Best Practices Guide.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>HTML versions of the product manuals can be found in the installed system under <literal role="path">/usr/share/doc/manual</literal>.
Find the latest documentation updates at <link xl:href="http://www.suse.com/documentation/suse-manager/">Latest Docmentation</link> where you can download PDF or HTML versions of the manuals for your product.</simpara>
</chapter>
<chapter xml:id="common-documents-feedback">
<title>Feedback</title>
<simpara>Several feedback channels are available:</simpara>
<variablelist>
<varlistentry>
<term>Bugs and Enhancement Requests</term>
<listitem>
<simpara>For services and support options available for your product, refer to <link xl:href="http://www.suse.com/support/">http://www.suse.com/support/</link>.</simpara>
<simpara>To report bugs for a product component, go to <link xl:href="https://scc.suse.com/support/requests">https://scc.suse.com/support/requests</link>, log in, and click <emphasis role="strong">Create New</emphasis>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>User Comments</term>
<listitem>
<simpara>We want to hear your comments about and suggestions for this manual and the other documentation included with this product.
Use the User Comments feature at the bottom of each page in the online documentation.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Mail</term>
<listitem>
<simpara>For feedback on the documentation of this product, you can also send a mail to <link xl:href="mailto:doc-team@suse.de">&lt;<link xl:href="mailto:doc-team@suse.com">doc-team@suse.com</link>&gt;</link>.
Make sure to include the document title, the product version and the publication date of the documentation.
To report errors or suggest enhancements, provide a concise description of the problem and refer to the respective section number and page (or URL).</simpara>
</listitem>
</varlistentry>
</variablelist>
</chapter>
<chapter xml:id="common-documentation-conventions">
<title>Documentation Conventions</title>
<simpara>The following typographical conventions are used in this manual:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="path">/etc/passwd</literal> : directory names and file names</simpara>
</listitem>
<listitem>
<simpara><literal role="replaceable">placeholder</literal>: replace <literal role="replaceable">placeholder</literal> with the actual value</simpara>
</listitem>
<listitem>
<simpara><literal role="var">PATH</literal>: the environment variable PATH</simpara>
</listitem>
<listitem>
<simpara><literal role="command">ls</literal>, <literal role="option">--help</literal>: commands, options, and parameters</simpara>
</listitem>
<listitem>
<simpara><literal role="username">user</literal> : users or groups</simpara>
</listitem>
<listitem>
<simpara><phrase role="package">packagename</phrase> : name of a package</simpara>
</listitem>
<listitem>
<simpara><keycap>Alt</keycap> , <keycombo><keycap>Alt</keycap><keycap>F1</keycap></keycombo> : a key to press or a key combination; keys are shown in uppercase as on a keyboard</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>File</guimenu> <guimenuitem>Save As</guimenuitem></menuchoice>, <guibutton>Cancel</guibutton>: menu items, buttons</simpara>
</listitem>
<listitem>
<simpara>This paragraph is only relevant for the x86_64 architecture. The arrows mark the beginning and the end of the text block.</simpara>
<simpara>This paragraph is only relevant for the architectures <literal>z Systems</literal> and <literal>POWER</literal>.
The arrows mark the beginning and the end of the text block.</simpara>
</listitem>
<listitem>
<simpara><emphasis>Dancing Penguins</emphasis> (Chapter <emphasis>Penguins</emphasis>,  Another Manual): This is a reference to a chapter in another manual.</simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="common-special-documentation-conventions">
<title>Special SUSE Manager Documentation Conventions</title>
<simpara>Additionally, the following typographical conventions are used in this manual:</simpara>
<itemizedlist>
<listitem>
<simpara>[<emphasis>system_type</emphasis>]: This tag is used in chapter or section titles and indicates that this feature is only available for registered client of that system type. For example, these system types could appear in this context: [Management] (= clients registered via the traditional bootstrap method), [Salt] (= Salt minions), [Proxy], etc.</simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="ref.webui.overview">
<title>Overview and Navigation</title>
<section xml:id="ref.webui.overview.intro">
<title>Overview</title>
<simpara>This topic introduces you to the SUSE Manager Web UI.
This section covers the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Home</guimenuitem></menuchoice> menu.</simpara>
<simpara>Entering the SUSE Manager URL in a browser leads you to the <literal role="guimenu">Sign In</literal> screen.</simpara>
<simpara>Before logging in, select [guimenu]``About, to browse and search for available documentation topics.
You may reset your username and password from the <menuchoice><guimenu>About</guimenu> <guimenuitem>Lookup Login/Password</guimenuitem></menuchoice> page.
For more information, see <xref linkend="ref.webui.overview.account"/>.</simpara>
</section>
</chapter>
<chapter xml:id="ref.webui.intro">
<title>Navigation</title>
<simpara>The top bar provides access to commonly used tools and user settings.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="topnav.png" width="80%"/>
</imageobject>
<textobject><phrase>topnav</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The right part of the top bar contains functionalities such as a bell icon with a counter bubble of unread notification messages, optionally, an eye icon with a context legend to the current page, quick search, links to background information, user preferences, and sign off.
On the left is the so-called breadcrumb.
The breadcrumb tells you how far you are from the root of the menu and it brings you back to any previous step.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home-overview-legend.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview legend</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The left navigation bar is the main menu to the SUSE Manager Web UI from where you load the Web UI pages.
If you click a the label of a menu entry you either open that page, or, if it is just a container of sub-entries, it expands this part of the menu tree without actually loading a page.
To collaps all open parts of the menu system, click the <guibutton>Clear Menus</guibutton> button at the top of menu, right to the <literal role="guimenu">Search page</literal> field.
If you click the small circle icon on the right of a menu label, the first available page of that menu entry will get loaded and displayed automatically.
Enter a search string in the <literal role="guimenu">Search page</literal> field to find an entry of the menu tree.
Available menu entries depend on the roles of the user.</simpara>
<simpara>Only SUSE Manager Administrators see the following navigation items:</simpara>
<itemizedlist>
<listitem>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Images</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Users</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Admin</guimenuitem></menuchoice></simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sidenav.png" width="40%"/>
</imageobject>
<textobject><phrase>sidenav</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Some pages have tabs and subtabs. These tabs offer an additional layer of granularity in performing tasks for systems or users.
The following example displays the tabs and subtabs available under <literal role="guimenu">System Details</literal>.
Green bars underline active tabs.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="subtabs.png" width="60%"/>
</imageobject>
<textobject><phrase>subtabs</phrase></textobject>
</mediaobject>
</informalfigure>
<important>
<title>Views Depending on User Roles</title>
<simpara>This guide covers the administrator user role level, some tabs, pages, and even whole categories described here may not be visible to you. Text markers are not used to identify which functions are available to each user role level.</simpara>
</important>
<section xml:id="ref.webui.intro.categories_pages">
<title>Categories and Pages</title>
<simpara>This section summarizes all of the categories and primary pages (those linked from the left navigation bar) within the SUSE Manager Web interface (Web UI). It does not list the many subpages, tabs and subtabs accessible from the individual pages.
Each area of the Web interface is explained in detail later in this guide.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sidenav.png" width="40%"/>
</imageobject>
<textobject><phrase>sidenav</phrase></textobject>
</mediaobject>
</informalfigure>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Home</guimenuitem></menuchoice></title>
<para>Check your tasks and systems.
View and manage your primary account information and get help.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Overview</guimenu></title>
<para>Obtain a quick overview of your account.
This page notifies you if your systems need attention, provides a quick link directly to these systems, displays the most recent patch alerts for your account, and recently registered systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Your Account</guimenu></title>
<para>Update your personal profile, addresses, email, and credentials.
Deactivate your account.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Your Preferences</guimenu></title>
<para>Indicate if you wish to receive email notifications about available patches for your systems.
Set how many items are displayed in system and group lists.
Set contents of the overview start page.
Select your preferred CSV separator.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Locale Preferences</guimenu></title>
<para>Configure timezone.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Your Organization</guimenu></title>
<para>Update organization configuration and display organization trusts.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice></title>
<para>Manage all your systems (including virtual guests) here.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Overview</guimenu></title>
<para>View a summary of your systems or system groups showing how many available patches each system has and which systems are entitled.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Systems</guimenu></title>
<para>Select and view subsets of your systems by specific criteria, such as Virtual Systems, Unprovisioned Systems, Recently Registered, Proxy, and Inactive.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>System Groups</guimenu></title>
<para>List your system groups.
Create additional groups.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>System Set Manager</guimenu></title>
<para>Perform various actions on sets of systems, including scheduling patch updates, package management, listing and creating new groups, managing channel entitlements, deploying configuration files, schedule audits, apply system states, and check status.
The availability of these actions depend on the system type.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Bootstrapping</guimenu></title>
<para>Bootstrap minion machines using SSH.
Input SSH credentials and the activation key the selected system will use for its software sources.
SUSE Manager will install required software (salt-minion packages on the client machine) and remotely perform the registration.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Visualization</guimenu></title>
<para>Graphically visualize the client topology.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Advanced Search</guimenu></title>
<para>Quickly search all your systems by specific criteria, such as name, hardware, devices, system info, networking, packages, and location.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Activation Keys</guimenu></title>
<para>Generate an activation key for a SUSE Manager-entitled system.
This activation key can be used to grant a specific level of entitlement or group membership to a newly registered system using the <literal role="command">rhnreg_ks</literal> command.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Stored Profiles</guimenu></title>
<para>View system profiles used to provision systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Custom System Info</guimenu></title>
<para>Create and edit system information keys with completely customizable values assigned while provisioning systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Autoinstallation</guimenu></title>
<para>Display and modify various aspects of autoinstallation profiles (Kickstart and AutoYaST) used in provisioning systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Software Crashes</guimenu></title>
<para>List software crashes grouped by UUID.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Virtual Host Managers</guimenu></title>
<para>Display and modify virtual host managers, file-based or VMware-based.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><guimenu>Salt</guimenu></title>
<para>View all minions.
Manage on-boarding, remote commands, and states catalogs.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Keys</guimenu></title>
<para>Manage minion keys.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Remote Commands</guimenu></title>
<para>Execute remote commands on targeted systems.
Select the preview button to ensure selected targets are available and click Run to execute.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>State Catalog</guimenu></title>
<para>Create, store, and manage states for your Salt minions from the State Catalog.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Images</guimenuitem></menuchoice></title>
<para>Image building and inspection.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Images</guimenu></title>
<para>View all built images.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Build</guimenu></title>
<para>Execute image build.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Profiles</guimenu></title>
<para>View and create image building profiles.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Stores</guimenu></title>
<para>View and create image stores.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice></title>
<para>View and manage patch (errata) alerts here.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Patches</guimenu></title>
<para>Lists patch alerts and downloads associated RPMs relevant to your systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Advanced Search</guimenu></title>
<para>Search patch alerts based on specific criteria, such as synopsis, advisory type, and package name.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Manage Patches</guimenu></title>
<para>Manage the patches for an organization&#8217;s channels.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Clone Patches</guimenu></title>
<para>Clone patches for an organization for ease of replication and distribution across an organization.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><guimenu>Software</guimenu></title>
<para>View and manage the available SUSE Manager channels and the files they contain.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Channels</guimenuitem></menuchoice></title>
<para>View a list of all software channels and those applicable to your systems.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Package Search</guimenu></title>
<para>Search packages using all or some portion of the package name, description, or summary, with support for limiting searches to supported platforms.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Manage Software Channels</guimenu></title>
<para>Create and edit channels used to deploy configuration files.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Distribution Channel Mapping</guimenu></title>
<para>Define default base channels for servers according to their operating system or architecture when registering.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Audit</guimenuitem></menuchoice></title>
<para>View and search CVE audits, system subscriptions, and OpenSCAP scans.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>CVE Audit</guimenu></title>
<para>View a list of systems with their patch status regarding a given CVE (Common Vulnerabilities and Exposures) number.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Subscription Matching</guimenu></title>
<para>List subscriptions.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>OpenSCAP</guimenu></title>
<para>View and search OpenSCAP (Security Content Automation Protocol) scans.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice></title>
<para>Keep track of and manage configuration channels, actions, individual configuration files, and systems with SUSE Manager-managed configuration files.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Overview</guimenu></title>
<para>A general dashboard view that shows a configuration summary.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Configuration Channels</guimenu></title>
<para>List and create configuration channels from which any subscribed system can receive configuration files.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Configuration Files</guimenu></title>
<para>List and create files from which systems receive configuration input.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Systems</guimenu></title>
<para>List the systems that have SUSE Manager-managed configuration files.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice></title>
<para>Keep track of your scheduled actions.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Pending Actions</guimenu></title>
<para>List scheduled actions that have not been completed.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Failed Actions</guimenu></title>
<para>List scheduled actions that have failed.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Completed Actions</guimenu></title>
<para>List scheduled actions that have been completed.
Completed actions can be archived at any time.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Archived Actions</guimenu></title>
<para>List completed actions that have been selected to archive.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Action Chains</guimenu></title>
<para>View and edit defined action chains.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Users</guimenuitem></menuchoice></title>
<para>View and manage users in your organization.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>User List</guimenu></title>
<para>List users in your organization.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>System Group Configuration</guimenu></title>
<para>Configure user group creation.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Admin</guimenuitem></menuchoice></title>
<para>Use the Setup Wizard to configure SUSE Manager.
List, create, and manage one or more SUSE Manager organizations.
The SUSE Manager administrator can assign channel entitlements, create and assign administrators for each organization, and other tasks.</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Setup Wizard</guimenu></title>
<para>Streamlined configuration of basic tasks.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Organizations</guimenu></title>
<para>List and create new organizations.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Users</guimenu></title>
<para>List all users known by SUSE Manager, across all organizations.
Click individual user names to change administrative privileges of the user.</para>
</formalpara>
<note>
<simpara>Users created for organization administration can only be configured by the organization administrator, <emphasis>not</emphasis> the SUSE Manager  administrator.</simpara>
</note>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Manager Configuration</guimenu></title>
<para>Make General configuration changes to the SUSE Manager server, including Proxy settings, Certificate configuration, Bootstrap Script configuration, Organization changes, and Restart the SUSE Manager server.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>ISS Configuration</guimenu></title>
<para>Configure master and slave servers for inter-server synchronization.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Task Schedules</guimenu></title>
<para>View and create schedules.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Task Engine Status</guimenu></title>
<para>View the status of the various tasks of the SUSE Manager task engine.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title><guimenu>Show Tomcat Logs</guimenu></title>
<para>Display the log entries of the Tomcat server, on which the SUSE Manager server is running.</para>
</formalpara>
</listitem>
</itemizedlist>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Help</guimenuitem></menuchoice></title>
<para>List references to available help resources such as the product documentation, release notes, and a general search for all of this.</para>
</formalpara>
<formalpara>
<title><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>External Links</guimenuitem></menuchoice></title>
<para>List external links to the knowledge base and the online documentation.</para>
</formalpara>
</section>
<section xml:id="ref.webui.intro.patch_alerts">
<title>Patch Alert Icons</title>
<simpara>Throughout SUSE Manager you will see three patch (errata) alert icons.</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-shield.svg"/>
</imageobject>
<textobject><phrase>Security Alert</phrase></textobject>
</inlinemediaobject>-represents a security alert.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-bug.svg"/>
</imageobject>
<textobject><phrase>Bug Fix Alert</phrase></textobject>
</inlinemediaobject>-represents a bug fix alert.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-enhancement.svg"/>
</imageobject>
<textobject><phrase>Enhancement Alert</phrase></textobject>
</inlinemediaobject>-represents an enhancement alert.</simpara>
</listitem>
</itemizedlist>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page, in the <literal role="guimenu">Relevant Security Patches</literal> section click the patch advisory to view details about the patch or click the number of affected systems to see which systems are affected by the patch alert.
Both links take you to tabs of the <literal role="guimenu">Patch Details</literal> page.
If all patches are installed, there is just a <literal role="guimenu">View All Patches</literal> link to open the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice> page.
Refer to
<xref linkend="s3-sm-errata-details"/>
for more information.</simpara>
</section>
<section xml:id="ref.webui.intro.quick_search">
<title>Search</title>
<simpara>In the top bar, SUSE Manager offers a search functionality for Packages, Patches (Errata), Documentation, and Systems.
To use the search, click the magnifier, then select the search item (choose from <literal role="guimenu">Systems</literal>, <literal role="guimenu">Packages</literal>, <literal role="guimenu">Documentation</literal>, and <literal role="guimenu">Patches</literal>) and type a string to look for a name match.
Click the <guibutton>Search</guibutton> button.
Your results appear at the bottom of the page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="top_search.png" width="40%"/>
</imageobject>
<textobject><phrase>top search</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If you misspell a word during your search query, the SUSE Manager search engine performs approximate string (or fuzzy string) matching, returning results that may be similar in spelling to your misspelled queries.
For example, if you want to search for a certain development system called <literal>test-1.example.com</literal> that is registered with SUSE Manager, but you misspell your query <literal>tset</literal>, the <literal>test-1.example.com</literal> system still appears in the search results.</simpara>
<note>
<simpara>If you add a distribution, newly synchronize channels, or register a system with a SUSE Manager server, it may take several minutes for it to be indexed and appear in search results.
To force the rebuild of the search index, enter <literal role="command">rhn-search cleanindex</literal> on the command line and wait until the rebuild is finished.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara>For advanced System searches, refer to
<xref linkend="ref.webui.systems.search"/>.</simpara>
</listitem>
<listitem>
<simpara>For advanced Patch or Errata searches, refer to
<xref linkend="ref.webui.patches.search"/>.</simpara>
</listitem>
<listitem>
<simpara>For advanced Package searches, refer to
<xref linkend="ref.webui.channels.search"/>.</simpara>
</listitem>
<listitem>
<simpara>For advanced Documentation searches, refer to
<xref linkend="s2-sm-your-rhn-help-docsearch"/>.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="ref.webui.intro.systems_selected">
<title>Systems Selected</title>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page, if you mark the check box next to a system, the <literal role="guimenu">system selected</literal> number on the right area of the top bar increases.
This number keeps track of the systems you have selected for use in the System Set Manager (SSM); for more information, see to
<xref linkend="ref.webui.systems.ssm"/>.</simpara>
<simpara>At any time, it identifies the number of selected systems and provides the means to work (simultaneously) with an entire selection.
Clicking the the rubber symbol (<literal role="guimenu">Clear</literal>) deselects all systems, while clicking the <literal role="guimenu">system selected</literal> string (<literal role="guimenu">Manage</literal>) launches the System Set Manager with your selected systems in place.</simpara>
<simpara>These systems can be selected in a number of ways.
Only systems with at least a Management system role are eligible for selection.
On all system and system group lists, a check boxes exist for this purpose.
Each time you select a check box next to the systems or groups the <literal role="guimenu">systems selected</literal> counter at the top of the page changes to reflect the new number of systems ready for use in the System Set Manager.</simpara>
</section>
<section xml:id="ref.webui.intro.list_nav">
<title>Lists</title>
<simpara>The information within most categories is presented in the form of lists.
These lists have some common features for navigation.
For instance, you can set the number of <literal role="guimenu">items per page</literal> and navigate through virtually all lists by clicking the back and next arrows above and below the right side of the table.
Some lists also offer the option to retrieve items alphabetically by clicking numbers or letters from the <literal role="guimenu">Alphabetical Index</literal> above the table.</simpara>
<note>
<title>Performing Large List Operations</title>
<simpara>Performing operations on large lists (such as removing RPM packages from the database with the SUSE Manager Web UI) may take some time and the system may become unresponsive or signal <quote>Internal Server Error 500</quote>.
Nevertheless, the command will succeed in the background if you wait long enough.</simpara>
</note>
<simpara>Login to the SUSE Manager Web UI to view the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.
The Overview page contains summary panes that provide important information about your systems.</simpara>
<simpara>[guimenu]``Overview is split into functional sections, with the most critical sections displayed first.
Users can control which of the following sections are displayed by making selections on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Your Preferences</guimenuitem></menuchoice> page.
Refer to <xref linkend="ref.webui.overview.prefs"/> for more information.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara>The <literal role="guimenu">Tasks</literal> pane lists the most common tasks an administrator performs via the Web interface.
Click any link to reach the page within SUSE Manager that allows you to accomplish that task.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_tasks_pane.png" width="40%"/>
</imageobject>
<textobject><phrase>home overview tasks pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Inactive Systems</literal> list provides a list of all systems that have stopped checking into SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_inactive_systems_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview inactive systems pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Most Critical Systems</literal> pane lists the most critical systems within your organization.
It provides a link to quickly view those systems and displays a summary of the patch updates that have yet to be applied to those systems.
Click the name of a system to see its <literal role="guimenu">System Details</literal> page and apply the patch updates.
Below the list is a link to <literal role="guimenu">View All Critical Systems</literal> on one page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_critical_systems_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview critical systems pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Recently Scheduled Actions</literal> pane lists all actions less than thirty days old and their status: failed, completed, or pending.
Click the label of any given action to view its details page.
Below the list is a link to <literal role="guimenu">View All Scheduled Actions</literal> on one page, which lists all actions that have not yet been carried out on your client systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_pending_actions_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview pending actions pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Relevant Security Patches</literal> pane lists all available security patches that have yet to be applied to some or all of your client systems.
It is critical that you apply these security patches to keep your systems secure.
Below this list find links to all available patches <literal role="guimenu">View All Patches</literal>.
You may also view patches that only apply to your systems <literal role="guimenu">View All Relevant Patches</literal>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_latest_errata_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview latest errata pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">System Group Name</literal> pane lists groups you may have created and indicates whether the systems in those groups are fully updated.
Click the link below this section to get to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>System Groups</guimenuitem></menuchoice> page, where you can choose a <literal role="guimenu">Group Name</literal> to use with the System Set Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_system_groups_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview system groups pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Recently Registered Systems</literal> pane lists all systems added to SUSE Manager in the past 30 days.
Select a system&#8217;s name to see its <literal role="guimenu">System Details</literal> page.
At the bottom of the <literal role="guimenu">Recently Registered Systems</literal> pane select the <literal role="guimenu">View All Recently Registered Systems</literal> link to view all recently registered systems on one page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_overview_recently_registered_pane.png" width="80%"/>
</imageobject>
<textobject><phrase>home overview recently registered pane</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</itemizedlist>
<simpara>To return to this page, select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> that is also known as <emphasis>The Menu</emphasis>.</simpara>
</section>
<section xml:id="ref.webui.overview.notifications">
<title>Notification Messages</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Notification Messages</guimenuitem></menuchoice> page allows you to manage your notification messages of the SUSE Manager server.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_notification_messages.png" width="80%"/>
</imageobject>
<textobject><phrase>home notification messages</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The default lifetime of notification messages is 30 days, after which messages are deleted from the database, regardless of read status.
You can configure the amount of time in <literal role="path">/etc/rhn/rhn.conf</literal>:</simpara>
<screen># Configure the lifetime of notification messages in days
java.notifications_lifetime = 30</screen>
<simpara>All notification types are enabled by default.
To disable a notification type, open the <literal role="path">/etc/rhn/rhn.conf</literal> configuration file and edit the <literal role="systemitem">java.notifications_type_disabled</literal> parameter:</simpara>
<screen># Configure the disablement of notification messages by type - example disabling all notification types
java.notifications_type_disabled = OnboardingFailed,ChannelSyncFailed,ChannelSyncFinished</screen>
<section xml:id="_notification_messages_tabs">
<title>Notification Messages Tabs</title>
<simpara>The <literal role="guimenu">Notification Messages</literal> page displays two tabs:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Unread Messages</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">All Messages</literal></simpara>
</listitem>
</itemizedlist>
<simpara>These tabs contain a list of collected messages filtered by tab name.</simpara>
</section>
<section xml:id="_notification_messages_buttons">
<title>Notification Messages Buttons</title>
<simpara>The following buttons are available for working with notification messages:</simpara>
<itemizedlist>
<listitem>
<simpara><guibutton>Refresh</guibutton>&#8201;&#8212;&#8201;Refreshes the message list</simpara>
</listitem>
<listitem>
<simpara><guibutton>Delete Selected Messages</guibutton>&#8201;&#8212;&#8201;Check any messages you would like removed and then mass delete them via this button.</simpara>
</listitem>
<listitem>
<simpara><guibutton>Mark all as Read</guibutton>&#8201;&#8212;&#8201;Mark all messages as read.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_notification_messages_legend">
<title>Notification Messages Legend</title>
<simpara>Several columns provide information for each message:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Severity</literal> : The following severity levels are available and for every failure a customized button (in line with the message) is available to react to that failure:</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="info-circle.svg" contentwidth="32" contentdepth="32"/>
</imageobject>
<textobject><phrase>Info</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;<emphasis role="strong">Info</emphasis></simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-warning.svg"/>
</imageobject>
<textobject><phrase>Warning</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;<emphasis role="strong">Warning</emphasis></simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="times-circle.svg"/>
</imageobject>
<textobject><phrase>Error</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;<emphasis role="strong">Error</emphasis></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal role="guimenu">Type</literal> : Available types are:</simpara>
<itemizedlist>
<listitem>
<simpara>Onboarding failed(<emphasis>Error</emphasis>)</simpara>
</listitem>
<listitem>
<simpara>Channel sync finished (<emphasis>Info</emphasis>)</simpara>
</listitem>
<listitem>
<simpara>Channel sync failed (<emphasis>Error</emphasis>)</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal role="guimenu">Description</literal> : The text of the message with a link to the channel.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Created</literal> : The date when the message was created.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Action Read|Delete</literal> :</simpara>
<itemizedlist>
<listitem>
<simpara>Click the letter icon to flag a message as <emphasis>Read</emphasis> or <emphasis>Unread</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the waste bin icon delete a message immediately.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<simpara>You can sort the messages by clicking a column label of the list header line.</simpara>
</section>
</section>
<section xml:id="ref.webui.overview.account">
<title>User Account</title>
<section xml:id="ref.webui.overview.account.your">
<title>Your Account</title>
<simpara>Modify your personal information, such as name, password, and title from the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>User Account</guisubmenu> <guimenuitem>Your Account</guimenuitem></menuchoice> page.
To modify this information, make the changes in the appropriate text fields and click the <guibutton>Update</guibutton> button at the bottom.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_user_account_user_details.png" width="80%"/>
</imageobject>
<textobject><phrase>home user account user details</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If you change your SUSE Manager password, for security reasons you will not see the new password while you enter it.
Replace the asterisks in the <literal role="guimenu">Password</literal> and <literal role="guimenu">Confirm Password</literal> text fields with the new password.</simpara>
<note>
<simpara>If you forget your password or username, proceed to the sign in screen and select the <literal role="guimenu">About</literal> link, then select the <literal role="guimenu">Lookup Login/Password</literal> page.
Here you can either specify your login and email address or only your email address if you are not sure about the username.
Then click <guibutton>Send Password</guibutton> or <guibutton>Send Login</guibutton> respectively.</simpara>
</note>
</section>
<section xml:id="ref.webui.overview.account.addresses">
<title>Addresses</title>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>User Account</guisubmenu> <guimenuitem>Addresses</guimenuitem></menuchoice> page you can manage your mailing, billing and shipping addresses, and associated phone numbers.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_user_account_addresses.png" width="80%"/>
</imageobject>
<textobject><phrase>home user account addresses</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click <guibutton>Fill in this address</guibutton> or <guibutton>Edit this address</guibutton> below the address to be modified or added, make your changes, and click <guibutton>Update</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_user_account_edit_address.png" width="80%"/>
</imageobject>
<textobject><phrase>home user account edit address</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.overview.account.email">
<title>Change Email</title>
<simpara>Set the email SUSE Manager sends notifications to on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>User Account</guisubmenu> <guimenuitem>Change Email</guimenuitem></menuchoice> page.
If you would like to receive email notifications about patch alerts or daily summaries for your systems, check the <guibutton>Receive email notifications</guibutton> checkbox located on the <literal role="guimenu">Your Preferences</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_user_account_change_email.png" width="80%"/>
</imageobject>
<textobject><phrase>home user account change email</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To change your preferred email address, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>User Account</guisubmenu> <guimenuitem>Change Email</guimenuitem></menuchoice>.
Enter your new email address and click the <guibutton>Update</guibutton> button.
Invalid email addresses like those ending in <literal>@localhost</literal> are filtered and rejected.</simpara>
</section>
<section xml:id="ref.webui.overview.account.deactivate">
<title>Account Deactivation</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>User Account</guisubmenu> <guimenuitem>Account Deactivation</guimenuitem></menuchoice> page provides a means to cancel your SUSE Manager service.
To do so, click the <guibutton>Deactivate Account</guibutton> button.
The Web interface returns you to the login screen.
If you attempt to log back in, an error message advises you to contact the SUSE Manager administrator for your organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_user_account_account_deactivation.png" width="80%"/>
</imageobject>
<textobject><phrase>home user account account deactivation</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<title>SUSE Manager Administrator Account</title>
<simpara>If you are the only SUSE Manager Administrator for your organization, you cannot deactivate your account.</simpara>
</note>
</section>
</section>
<section xml:id="ref.webui.overview.prefs">
<title>Your Preferences</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>YourPreferences</guimenuitem></menuchoice> page allows you to configure SUSE Manager options.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_your_preferences.png" width="80%"/>
</imageobject>
<textobject><phrase>home your preferences</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Email Notifications</literal>&#8201;&#8212;&#8201;Determine whether you want to receive email every time a patch alert is applicable to one or more systems in your account.</simpara>
<important>
<simpara>This setting enables Management and Provisioning customers to receive a daily summary of system events.
These include actions affecting packages, such as scheduled patches, system reboots, or failures to check in.
In addition to selecting this check box, you must identify each system to be included in this summary email.
By default, all Management and Provisioning systems are included in the summary.
Add more systems either individually on the <literal role="guimenu">System Details</literal> page or for multiple systems at once in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>System Set Manager</guimenuitem></menuchoice> interface.
Note that SUSE Manager sends these summaries only to verified email addresses.
To disable all messages, simply deselect this check box.</simpara>
</important>
</listitem>
<listitem>
<simpara><literal role="guimenu">SUSE Manager List Page Size</literal>&#8201;&#8212;&#8201;Maximum number of items that appear in a list on a single page.
If more items are in the list, clicking the <guibutton>Next</guibutton> button displays the next group of items.
This preference applies to system lists, patch lists, package lists, and so on.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">"Overview" Start Page</literal>&#8201;&#8212;&#8201;Select the information panes that are displayed on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.
Check the box to the left of each information pane that which be included.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Time Zone</literal> - Set the SUSE Manager interface to your local time by selecting the appropriate <literal role="guimenu">Time Zone</literal> from the drop-down box.
Click the <guibutton>Save Preferences</guibutton> button to apply the selection.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_locale_preferences.png" width="80%"/>
</imageobject>
<textobject><phrase>home locale preferences</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara><literal role="guimenu">CSV Files</literal>&#8201;&#8212;&#8201;Select the separator character to be used in downloadable CSV files.
<guibutton>Comma</guibutton> is the default; as an alternative use <guibutton>Semicolon</guibutton>, which provides better compatibility with Microsoft Excel.</simpara>
</listitem>
</itemizedlist>
<simpara>After making changes to any of these options, click the <guibutton>Save Preferences</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.overview.org">
<title>Your Organization</title>
<simpara>From the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Your Organization</guimenuitem></menuchoice> page you can modify the following pages:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Configuration</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Organization Trusts</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Configuration Channels</literal></simpara>
</listitem>
</itemizedlist>
<section xml:id="ref.webui.overview.org.config">
<title>Configuration</title>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>Your Organization</guisubmenu> <guimenuitem>Configuration</guimenuitem></menuchoice> page modify your personal information, such as name, password, and title.
To modify any of this information, make the changes in the appropriate text fields and click the <guibutton>Update</guibutton> button at the bottom.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_your_organization_configuration.png" width="80%"/>
</imageobject>
<textobject><phrase>home your organization configuration</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.overview.org.trust">
<title>Organization Trusts</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>Your Organization</guisubmenu> <guimenuitem>Organization Trusts</guimenuitem></menuchoice> page displays the trusts established with your organization (that is, the organization with which you, the logged-in user, are associated).
The page also lists <literal role="guimenu">Channels Shared</literal>, which refers to channels available to your organization via others in the established trusts.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_your_organization_trusts.png" width="80%"/>
</imageobject>
<textobject><phrase>home your organization trusts</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>You can filter the list of trusts by keyword using the <literal role="guimenu">Filter by Organization</literal> text box and clicking <guibutton>Go</guibutton>.</simpara>
</section>
<section xml:id="ref.webui.overview.org.cfgch">
<title>Configuration Channels</title>
<simpara>The <literal role="guimenu">Configuration Channels</literal> page displays the channels which have been created and added using <literal role="guimenu">Configuration Channels</literal>.</simpara>
<simpara>From <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>Your Organization</guisubmenu> <guimenuitem>Configuration Channels</guimenuitem></menuchoice> you can select which configuration channels should be applied across your organization.
If there is more than one configuration channel selected you can specify the order of the channels.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="home_your_organization_custom.png" width="80%"/>
</imageobject>
<textobject><phrase>home your organization custom</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Apply a Configuration Channel at the Organization Level</title>
<listitem>
<simpara>Create a channel using <literal role="guimenu">Configuration Channels</literal> or via the command line.</simpara>
</listitem>
<listitem>
<simpara>Browse to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>Your Organization</guisubmenu> <guimenuitem>Configuration Channels</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Use the search feature to locate a channel by name.</simpara>
</listitem>
<listitem>
<simpara>Select the check box for the channel to be applied and click the <guibutton>Save Changes</guibutton> button. The save button will save the change to the database but will not apply the channel.</simpara>
</listitem>
<listitem>
<simpara>Apply the channel by clicking the <guibutton>Apply</guibutton> button. The channel will be scheduled and applied to any systems included within the organization.</simpara>
</listitem>
</orderedlist>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.systems.systems">
<title>Systems</title>
<simpara>If you select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>, an overview of all Systems appears.
From this page you can select systems to perform actions on and may create system profiles.</simpara>
<section xml:id="ref.webui.systems.systems.intro">
<title>Overview Conventions</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page displays a list of all your registered systems.
Several columns provide information about each system:</simpara>
<variablelist>
<varlistentry>
<term>Select box</term>
<listitem>
<simpara>Systems without a system type cannot be selected. To select systems, mark the appropriate check boxes.
Selected systems are added to the <emphasis role="strong">System Set Manager</emphasis>, where actions can be carried out simultaneously on all systems in the set.
For more information, see <xref linkend="ref.webui.systems.ssm"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>System</term>
<listitem>
<simpara>The name of the system specified during registration.
The default name is the host name of the system.
Clicking the name of a system displays its <literal role="guimenu">System Details</literal> page.
For more information, see <xref linkend="s3-sm-system-details"/>.</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-virtual-host.svg"/>
</imageobject>
<textobject><phrase>Virtual Host</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Virtual Host.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-virtual-guest.svg"/>
</imageobject>
<textobject><phrase>Virtual Guest</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Virtual Guest.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-236-non-virtual-system.svg"/>
</imageobject>
<textobject><phrase>Non-Virtual System</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Non-Virtual System.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-unprov-system.svg"/>
</imageobject>
<textobject><phrase>Unprovisioned System</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Unprovisioned System.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Updates</term>
<listitem>
<simpara>Shows which type of update action is applicable to the system or confirms that the system is up-to-date.
Some icons are linked to related tasks.
For example, the standard Updates icon is linked to the <literal role="guimenu">Upgrade</literal> subtab of the packages list, while the Critical Updates icon links directly to the <literal role="guimenu">Software Patches</literal> page.</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-check-circle.svg"/>
</imageobject>
<textobject><phrase>Check Circle</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System is up-to-date.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-exclamation-circle.svg"/>
</imageobject>
<textobject><phrase>Exclamation Circle</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Critical patch (errata) available, update <emphasis>strongly</emphasis> recommended.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-warning.svg"/>
</imageobject>
<textobject><phrase>Warning</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Updates available and recommended.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-question-circle.svg"/>
</imageobject>
<textobject><phrase>Question</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System not checking in properly (for 24 hours or more).</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-lock.svg"/>
</imageobject>
<textobject><phrase>Lock</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System is locked; actions prohibited.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-rocket.svg"/>
</imageobject>
<textobject><phrase>Rocket</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System is being deployed using AutoYaST or Kickstart.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-clock-o.svg"/>
</imageobject>
<textobject><phrase>Clock</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Updates have been scheduled.</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-times-circle.svg"/>
</imageobject>
<textobject><phrase>Times</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System not entitled to any update service.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Patches</term>
<listitem>
<simpara>Total number of patch alerts applicable to the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Packages</term>
<listitem>
<simpara>Total number of package updates for the system, including packages related to patch alerts and newer versions of packages not related to patch alerts.
For example, if a client system that has an earlier version of a package installed gets subscribed to the appropriate base channel (such as SUSE Linux Enterprise 12 SP2), that channel may have an updated version of the package.
If so, the package appears in the list of available package updates.</simpara>
<important>
<title>Package Conflict</title>
<simpara>If SUSE Manager identifies package updates for the system, but the package updater (such as Red Hat Update Agent or YaST) responds with a message such as "Your system is fully updated", a conflict likely exists in the system&#8217;s package profile or in the <literal role="path">up2date</literal> configuration file.
To resolve the conflict, either schedule a package list update or remove the packages from the package exceptions list.
For more information, see <xref linkend="s3-sm-system-details"/>.</simpara>
</important>
</listitem>
</varlistentry>
<varlistentry>
<term>Configs</term>
<listitem>
<simpara>Total number of configuration files applicable to the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Base Channel</term>
<listitem>
<simpara>The primary channel for the system based on its operating system.
For more information, see <xref linkend="ref.webui.channels.software"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>System Type</term>
<listitem>
<simpara>Shows whether the system is managed and at what service level.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Links in the navigation bar below <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice> enable you to select and view predefined sets of your systems.
All of the options described above can be applied within these pages.</simpara>
</section>
<section xml:id="ref.webui.systems.overview">
<title>Systems &gt; Overview</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page provides a summary of your systems, including their status, number of associated patches (errata) and packages, and their so-called system type.
Clicking the name of a system takes you to its <literal role="guimenu">System Details</literal> page.
For more information, see <xref linkend="s3-sm-system-details"/>.</simpara>
<simpara>Clicking the <guibutton>View System Groups</guibutton> button at the top of the page takes you to a summary of your system groups.
It identifies group status and displays the number of systems contained.
Clicking the number of systems in a group takes you to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>Systems Groups</guisubmenu> <guimenuitem>Systems</guimenuitem></menuchoice> tab.
Selecting a group name takes you to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>System Groups</guisubmenu> <guimenuitem>Group Details</guimenuitem></menuchoice> tab for that system group.
For more information, see <xref linkend="ref.webui.systems.systemgroups.details"/>.</simpara>
<simpara>You can also click <guibutton>Use in SSM</guibutton> from the <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Overview</guisubmenu> <guimenuitem>View System Groups</guimenuitem></menuchoice> page to go directly to the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>System Set Manager</guimenuitem></menuchoice>.
For more information, see <xref linkend="ref.webui.systems.ssm"/>.</simpara>
<section xml:id="ref.webui.systems.systems.x">
<title>Systems &gt; Systems</title>
<simpara>Pages with various lists of system groupings.</simpara>
</section>
<section xml:id="ref.webui.systems.systems.all">
<title>Systems &gt; All</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>All</guimenuitem></menuchoice> page contains the default set of your systems.
It displays every system you have permission to manage.
You have permission if you are the only user in your organization, if you are a SUSE Manager Administrator, or if the system belongs to a group for which you have admin rights.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_all.png" width="80%"/>
</imageobject>
<textobject><phrase>systems all</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.physical">
<title>Systems &gt; Physical Systems</title>
<simpara>To reach this page, select <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Physical Systems</guimenuitem></menuchoice> from the left bar.
This page lists each physical system of which SUSE Manager is aware.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_physical_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems physical systems</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.virtual">
<title>Systems &gt; Virtual Systems</title>
<simpara>To reach this page, select <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Virtual Systems</guimenuitem></menuchoice> from the left bar.
This page lists each virtual host of which SUSE Manager is aware and the guest systems on those hosts.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_virtual_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems virtual systems</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term><guimenu>System</guimenu></term>
<listitem>
<simpara>This column displays the name of each guest system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Updates</guimenu></term>
<listitem>
<simpara>This column shows whether there are patches (errata updates) available for the guest systems that have not yet been applied.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Status</guimenu></term>
<listitem>
<simpara>This column indicates whether a guest is running, paused, or stopped.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Base Channel</guimenu></term>
<listitem>
<simpara>This column displays the base channel to which the guest is currently subscribed.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Only guests registered with SUSE Manager are displayed with blue text.
Clicking the host name of such a guest system displays its <literal role="guimenu">System Details</literal> page.</simpara>
</section>
<section xml:id="ref.webui.systems.systems.baremetal">
<title>Systems &gt; Unprovisioned Systems</title>
<simpara>Here, all unprovisioned (bare-metal) systems with hardware details are listed.
For more information, see
<xref linkend="s3-sattools-config-bare-metal"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_bare_metal.png" width="80%"/>
</imageobject>
<textobject><phrase>systems bare metal</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.ood">
<title>Systems &gt; Out of Date</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Out of Date</guimenuitem></menuchoice> page displays all systems where applicable patch alerts have not been applied.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_outofdate.png" width="80%"/>
</imageobject>
<textobject><phrase>systems outofdate</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.reboot">
<title>Systems &gt; Requiring Reboot</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Requiring Reboot</guimenuitem></menuchoice> page displays all systems that need to be rebooted.
Click a system name to go to the systems details page to schedule a reboot.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_requiringreboot.png" width="80%"/>
</imageobject>
<textobject><phrase>systems requiringreboot</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.non_compliant">
<title>Systems &gt; Non-compliant Systems</title>
<simpara>Non-compliant systems have packages installed which are not available from SUSE Manager.
The <literal role="guimenu">Packages</literal> column shows how many installed packages are not available in the channels assigned to the system.
A non-compliant system cannot be reinstalled.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_noncompliant.png" width="80%"/>
</imageobject>
<textobject><phrase>systems noncompliant</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.wst">
<title>Systems &gt; Without System Type</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Without System Type</guimenuitem></menuchoice> page displays systems without a System Type.
System types are:</simpara>
<itemizedlist>
<listitem>
<simpara>Salt</simpara>
</listitem>
<listitem>
<simpara>Management</simpara>
</listitem>
<listitem>
<simpara>Foreign Host</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_without_system_type.png" width="80%"/>
</imageobject>
<textobject><phrase>systems without system type</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.ungrp">
<title>Systems &gt; Ungrouped</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Ungrouped</guimenuitem></menuchoice> page displays systems that have not yet been assigned to a system group.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ungrouped.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ungrouped</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.inact">
<title>Systems &gt; Inactive</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Inactive Systems</guimenuitem></menuchoice> page displays systems that have not checked in with SUSE Manager for 24 hours or more.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_inactive.png" width="80%"/>
</imageobject>
<textobject><phrase>systems inactive</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>On traditional clients, checking in is performed periodically by client tools (specifically <literal>mgr_check</literal>) - client systems connect to SUSE Manager to see if there are any updates available or if any actions have been scheduled.
For Salt systems, a Taskomatic job checks on the minions periodically by pinging them when otherwise inactive.
If you see a message telling you that check-ins are not taking place, the system is not successfully connecting to SUSE Manager.</simpara>
<simpara>The reason may be one of the following:</simpara>
<itemizedlist>
<listitem>
<simpara>The system is not entitled to any SUSE Manager service.
System profiles that remain unentitled for 180 days (6 months) are removed.</simpara>
</listitem>
<listitem>
<simpara>The system is entitled, but the SUSE Manager daemon (<literal role="systemitem">rhnsd</literal>) has been disabled on the traditional client.
Refer to
<xref linkend="bp.contact.methods.rhnsd"/>
for instructions on restarting and troubleshooting.</simpara>
</listitem>
<listitem>
<simpara>The system is behind a firewall that does not allow connections over <literal role="systemitem">https</literal> (port 443).</simpara>
</listitem>
<listitem>
<simpara>The system is behind an HTTP proxy server that has not been properly configured.</simpara>
</listitem>
<listitem>
<simpara>The system is connected to a SUSE Manager Proxy Server or SUSE Manager that has not been properly configured.</simpara>
</listitem>
<listitem>
<simpara>The system itself has not been properly configured, perhaps pointing at the wrong SUSE Manager Server.</simpara>
</listitem>
<listitem>
<simpara>The system is not in the network.</simpara>
</listitem>
<listitem>
<simpara>Some other barrier exists between the system and the SUSE Manager Server.</simpara>
</listitem>
<listitem>
<simpara>For Salt minions, Taskomatic might not be operational.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="ref.webui.systems.systems.rregistered">
<title>Systems &gt; Recently Registered</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Recently Registered</guimenuitem></menuchoice> page displays any systems that have been registered in a given period.
Use the drop-down box to specify the period in days, weeks, 30- and 180-day increments, and years.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_recently_registered.png" width="80%"/>
</imageobject>
<textobject><phrase>systems recently registered</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.proxy">
<title>Systems &gt; Proxy</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Proxy</guimenuitem></menuchoice> page displays the SUSE Manager Proxy Server systems registered with your SUSE Manager server.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_proxy.png" width="80%"/>
</imageobject>
<textobject><phrase>systems proxy</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.dup">
<title>Systems &gt; Duplicate Systems</title>
<simpara>The <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Duplicate Systems</guimenuitem></menuchoice> page lists current systems and any active and inactive entitlements associated with them.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_duplicate_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems duplicate systems</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Active entitlements are in gray, while inactive entitlements are highlighted in yellow and their check boxes checked by default for you to delete them as needed by clicking the <guibutton>Delete Selected</guibutton> button.
Entitlements are inactive if the system has not checked in with SUSE Manager in a time specified via the drop-down box <guibutton>A system profile is inactive if its system has not checked in for:</guibutton>.</simpara>
<simpara>You can filter duplicate entitlements by clicking the respective tab:</simpara>
<itemizedlist>
<listitem>
<simpara><menuchoice><guimenu>Duplicate Systems</guimenu> <guimenuitem>IP Address</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Duplicate Systems</guimenu> <guimenuitem>IPv6 Address</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Duplicate Systems</guimenu> <guimenuitem>Hostname</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Duplicate Systems</guimenu> <guimenuitem>MAC address</guimenuitem></menuchoice></simpara>
</listitem>
</itemizedlist>
<simpara>You may filter further by inactive time or typing the system&#8217;s host name, IP address, IPv6 address, or MAC address in the corresponding <literal role="guimenu">Filter by</literal> text box.</simpara>
<simpara>To compare up to three duplicate entitlements at one time, click the  <literal role="guimenu">Compare Systems</literal> link in the <literal role="guimenu">Last Checked In</literal> column.
Inactive components of the systems are highlighted in yellow.</simpara>
<simpara>You can determine which systems are inactive or duplicate and delete them by clicking the <guibutton>Delete System Profile</guibutton> button.</simpara>
<simpara>Click the <guibutton>Confirm Deletion</guibutton> button to confirm your choice.</simpara>
</section>
<section xml:id="ref.webui.systems.systems.currency">
<title>Systems &gt; System Currency</title>
<simpara>The System Currency Report displays an overview of severity scores of patches relevant to the system.
The weighting is defined any systems, <literal role="guimenu">System Details</literal> page.
The default weight awards critical security patches with the heaviest weight and enhancements with the lowest.
The report can be used to prioritize maintenance actions on the systems registered to SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_currency_report.png" width="80%"/>
</imageobject>
<textobject><phrase>systems currency report</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.systems.types">
<title>Systems &gt; System Types</title>
<simpara>System Types define the set of functionalities available for each system in SUSE Manager such as the ability of installing software or creating guest virtual machines.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_system_types.png" width="80%"/>
</imageobject>
<textobject><phrase>systems system types</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>A list of profiled systems follows, with their base and add-on system types shown in the appropriate columns.
To change system types, select the systems you want to modify, and click either the <guibutton>Add System Type</guibutton> or <guibutton>Remove System Type</guibutton> button.</simpara>
</section>
</section>
<section xml:id="s3-sm-system-details">
<title>System Details</title>
<simpara>When systems are registered to SUSE Manager, they are displayed on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.
Here and on any other page, clicking the name of a system takes you to the <literal role="guimenu">System Details</literal> page of the client, where various types of administrative tasks can be performed.</simpara>
<note>
<simpara>The <guimenu>Delete System</guimenu> link in the upper right of this screen refers to the system profile only.
Deleting a host system profile will not destroy or remove the registration of guest systems.
Deleting a guest system profile does not remove it from the list of guests for its host, nor does it stop or pause the guest.
It does, however, remove your ability to manage it via SUSE Manager.</simpara>
<simpara>If you mistakenly deleted a system profile from SUSE Manager, you may re-register the system using the bootstrap script or <literal role="command">rhnreg_ks</literal> manually.</simpara>
</note>
<simpara>The Details page has numerous subtabs that provide specific system information and other identifiers unique to the system.
The following sections discuss these tabs and their subtabs in detail.</simpara>
<section xml:id="s4-sm-system-details-details">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>This page is not accessible from the left bar.
However, clicking the name of a system anywhere in the Web interface displays such a System Details page.
By default, the <menuchoice><guimenu>Systems Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> subtab is displayed.
Other tabs are available, depending on the system type and add-on system type.</simpara>
<simpara>For example, Traditional systems and Salt systems details  display different tabs.</simpara>
<figure>
<title>System Details (Traditional)</title>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional overview</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>System Details (Salt)</title>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_salt_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>system details salt overview</phrase></textobject>
</mediaobject>
</figure>
<section xml:id="s5-sm-system-details-overview">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice></title>
<simpara>This system summary page displays the system status message and the following key information about the system:</simpara>
<variablelist>
<varlistentry>
<term><guimenu>System Status</guimenu></term>
<listitem>
<simpara>This message indicates the current state of your system in relation to SUSE Manager.</simpara>
<note>
<simpara>If updates are available for any entitled system, the message <literal role="guimenu">Software Updates Available</literal> appears, displaying the number of critical and non-critical updates and the sum of affected packages.
To apply these updates, click <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Packages</guimenuitem></menuchoice> then select some or all packages to update, then click <guibutton>Upgrade Packages</guibutton>.</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>System Info</guimenu></term>
<listitem>
<variablelist>
<varlistentry>
<term>Hostname</term>
<listitem>
<simpara>The host name as defined by the client system.
A machine can have one and only one hostname.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>FQDN</term>
<listitem>
<simpara>The FQDN(Names) listed here represents the host.domain that the machine answers to.
A machine can have any number of FQDNs.
Keep in mind that FQDN is not equal to hostname.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>IP Address</term>
<listitem>
<simpara>The IP address of the client.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>IPv6 Address</term>
<listitem>
<simpara>The IPv6 address of the client.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Minion Id</term>
<listitem>
<simpara>On salt clients only, shows the minion identification value.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Virtualization</term>
<listitem>
<simpara>If the client is a virtual machine, the type of virtualization is listed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>UUID</term>
<listitem>
<simpara>Displays the universally unique identifier.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Kernel</term>
<listitem>
<simpara>The kernel installed and operating on the client system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SUSE Manager System ID</term>
<listitem>
<simpara>A unique identifier generated each time a system registers with SUSE Manager.</simpara>
<note>
<simpara>The system ID can be used to eliminate duplicate profiles from SUSE Manager.
Compare the system ID listed on this page with the information stored on the client system in the <literal role="path">/etc/sysconfig/rhn/systemid</literal> file.
In that file, the system&#8217;s current ID is listed under <literal>system_id</literal>.
The value starts after the characters <literal>ID-</literal>.
If the value stored in the file does not match the value listed in the profile, the profile is not the most recent one and may be removed.</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term>Activation Key</term>
<listitem>
<simpara>Displays the activation key used to register the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Installed Products</term>
<listitem>
<simpara>Lists the products installed on the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Lock Status</term>
<listitem>
<simpara>Indicates whether a system has been locked.</simpara>
<simpara>Actions cannot be scheduled for locked systems on the Web interface until the lock is removed manually.
This does not include preventing automated patch updates scheduled via the Web interface.
To prevent the application of automated patch updates, deselect <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Properties</guisubmenu> <guimenuitem>Auto Patch Update</guimenuitem></menuchoice>.
For more information, refer to <xref linkend="s5-sm-system-details-properties"/>.</simpara>
<simpara>Locking a system can prevent you from accidentally changing a system.
For example, the system may be a production system that should not receive updates or new packages until you decide to unlock it.</simpara>
<important>
<simpara>Locking a system in the Web interface <emphasis>will not</emphasis> prevent any actions that originate from the client system.
For example, if a user logs in to the client directly and runs YaST Online Update (on SUSE Linux Enterprise) or <literal role="command">pup</literal> (on RHEL), the update tool will install available patches even if the system is locked in the Web interface.</simpara>
<simpara>Locking a system <emphasis>does not</emphasis> restrict the number of users who can access the system via the Web interface.
If you want to restrict access to the system, associate that system with a System Group and assign a System Group Administrator to it.
Refer to <xref linkend="ref.webui.systems.systemgroups"/> for more information about System Groups.</simpara>
</important>
<simpara>It is also possible to lock multiple systems via the System Set Manager.
Refer to <xref linkend="s4-sm-ssm-misc-lock"/> for instructions.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Subscribed Channels</guimenu></term>
<listitem>
<simpara>List of subscribed channels.
Clicking a channel name takes you to the <literal role="guimenu">Basic Channel Details</literal> page.
To change subscriptions, click the <literal role="guimenu">Alter Channel Subscriptions</literal> link right beside the title to assign available base and child channels to this system.
When finished making selections, click the <guibutton>Change Subscriptions</guibutton> button to change subscriptions and the base software channel.
For more information, see
<xref linkend="s5-sm-system-details-channels-software"/>.</simpara>
<variablelist>
<varlistentry>
<term>Base Channel</term>
<listitem>
<simpara>The first line indicates the base channel to which this system is subscribed.
The base channel should match the operating system of the client.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Child Channels</term>
<listitem>
<simpara>The subsequent lines of text, which depend on the base channel, list child channels.
An example is the <literal>SUSE Manager Tools</literal> channel.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>System Events</guimenu></term>
<listitem>
<variablelist>
<varlistentry>
<term>Checked In</term>
<listitem>
<simpara>The date and time at which the system last checked in with SUSE Manager.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Registered</term>
<listitem>
<simpara>The date and time at which the system registered with SUSE Manager and created this profile.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Last Booted</term>
<listitem>
<simpara>The date and time at which the system was last started or restarted.</simpara>
<note>
<simpara>Systems with Salt or Management system type can be rebooted from this screen.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <literal role="guimenu">Schedule system reboot</literal>.</simpara>
</listitem>
<listitem>
<simpara>Provide the earliest date and time at which the reboot may take place.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Schedule Reboot</guibutton> button in the lower right.</simpara>
</listitem>
</orderedlist>
<simpara>When the client checks in after the scheduled start time, SUSE Manager will instruct the system to restart itself.</simpara>
</note>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>System Properties</guimenu></term>
<listitem>
<variablelist>
<varlistentry>
<term>System Types</term>
<listitem>
<simpara>Lists system types and add-on types currently applied to the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Notifications</term>
<listitem>
<simpara>Indicates the notification options for this system.
You can activate whether you want to receive e-mail notifying you of available updates for this system.
In addition, you may activate to include systems in the daily summary e-mail.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Contact Method</term>
<listitem>
<simpara>Available methods: Default (Pull), Push via SSH, and Push via SSH tunnel.</simpara>
<simpara>The so-called OSA status is also displayed for client systems registered with SUSE Manager that have the OSA dispatcher (osad) configured.</simpara>
<simpara>Push enables SUSE Manager customers to immediately initiate tasks rather than wait for those systems to check in with SUSE Manager.
Scheduling actions through push is identical to the process of scheduling any other action, except that the task can immediately be carried out instead of waiting the set interval for the system to check in.</simpara>
<simpara>In addition to the configuration of SUSE Manager, to receive pushed actions each client system must have the <literal role="systemitem">osad</literal> package installed and its service started.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Auto Patch Update</term>
<listitem>
<simpara>Indicates whether this system is configured to accept updates automatically.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>System Name</term>
<listitem>
<simpara>By default, the host name of the client is displayed, but a different system name can be assigned.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Description</term>
<listitem>
<simpara>This information is automatically generated at registration.
You can edit the description to include any information you want.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Location</term>
<listitem>
<simpara>This field displays the physical address of the system if specified.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
<simpara>Clicking the <literal role="guimenu">Edit These Properties</literal> link beside the <literal role="guimenu">System Properties</literal> title opens the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Properties</guimenuitem></menuchoice> subtab.
From this page you can edit any text fields you choose, then click the <guibutton>Update Properties</guibutton> button to confirm.</simpara>
</section>
<section xml:id="s5-sm-system-details-properties">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Properties</guimenuitem></menuchoice></title>
<simpara>This subtab allows you to alter basic properties of the selected system.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_edit.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional edit</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term>System Details</term>
<listitem>
<variablelist>
<varlistentry>
<term>System Name</term>
<listitem>
<simpara>By default, this is the host name of the system.
You can however alter the profile name to anything that allows you to distinguish this system from others.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Base System Type</term>
<listitem>
<simpara>For information only.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Add-on System Types</term>
<listitem>
<simpara>Select one of the available system types such as <literal>Container Build Host</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Notifications</term>
<listitem>
<simpara>Select whether notifications about this system should be sent and whether to include this system in the daily summary.
This setting keeps you aware of all advisories pertaining to the system.
Anytime an update is released for the system, you receive an e-mail notification.</simpara>
<simpara>The daily summary reports system events that affect packages, such as scheduled patch updates, system reboots, or failures to check in.
In addition to including the system here, you must activate to receive e-mail notification in <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guisubmenu>Overview</guisubmenu> <guimenuitem>Your Preferences</guimenuitem></menuchoice>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Contact Method</term>
<listitem>
<simpara>Select one of the following contact methods:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Pull (Default)</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Push via SSH</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Push via SSH tunnel</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
<variablelist xml:id="varentry-system-details-properties-auto">
<varlistentry>
<term>Auto Patch Update</term>
<listitem>
<simpara>If this box is checked, available patches are automatically applied to the system when it checks in (Pull) or immediately if you select either Push option.
This action takes place without user intervention.</simpara>
<note>
<title>Conflicts With Third Party Packages</title>
<simpara>Enabling auto-update might lead to failures because of conflicts between system updates and third party packages.
To avoid failures caused by those issues, it is better to leave this box unchecked.</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term>Description</term>
<listitem>
<simpara>By default, this text box records the operating system, release, and architecture of the system when it first registers.
Edit this information to include anything you like.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>The remaining fields record the physical address at which the system is stored.
To confirm any changes to these fields, click the <guibutton>Update Properties</guibutton> button.</simpara>
<note>
<title>Setting Properties for Multiple Systems</title>
<simpara>Many of these properties can be set for multiple systems in one go via the System Set Manager interface.
For details, see <xref linkend="ref.webui.systems.ssm"/>.</simpara>
</note>
</section>
<section xml:id="s5-sm-system-details-remote">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Remote Command</guimenuitem></menuchoice></title>
<simpara>This subtab allows you to run remote commands on the selected system. Before doing so, you must first configure the system to accept such commands.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_edit.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional edit</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>On SUSE Linux Enterprise clients, subscribe the system to the SUSE Manager Tools child channel.
Then use Zypper to install the <literal role="systemitem">rhncfg</literal>, <literal role="systemitem">rhncfg-client</literal>, and <literal role="systemitem">rhncfg-actions</literal> packages, if not already installed:</simpara>
<screen>zypper in rhncfg rhncfg-client rhncfg-actions</screen>
<simpara>On RHEL clients, subscribe the system to the Tools child channel.
Then use <literal role="command">up2date</literal> or <literal role="command">yum</literal> to install the <literal role="systemitem">rhncfg</literal>, <literal role="systemitem">rhncfg-client</literal>, and <literal role="systemitem">rhncfg-actions</literal> packages, if not already installed:</simpara>
<screen>yum install rhncfg rhncfg-client rhncfg-actions</screen>
</listitem>
<listitem>
<simpara>Log in to the system as root and add the following file to the local SUSE Manager configuration directory: <literal role="path">allowed-actions/scripts/run</literal>.</simpara>
<itemizedlist>
<listitem>
<simpara>Create the necessary directory on the target system:</simpara>
<screen>mkdir -p /etc/sysconfig/rhn/allowed-actions/script</screen>
</listitem>
<listitem>
<simpara>Create an empty <literal role="path">run</literal> file in that directory to act as a flag to SUSE Manager, signaling permission to allow remote commands:</simpara>
<screen>touch /etc/sysconfig/rhn/allowed-actions/script/run</screen>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>When the setup is complete, refresh the page to view the text boxes for remote commands.
Identify a specific user, group, and timeout period, and the script to run.
Select a date and time to execute the command, then click <guibutton>Schedule</guibutton> or add the remote command to an action chain.
For further information on action chains, see
<xref linkend="ref.webui.schedule.chains"/>.</simpara>
</section>
<section xml:id="s5-sm-system-details-react">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Reactivation</guimenuitem></menuchoice> [Management]</title>
<simpara>Reactivation keys include this system&#8217;s ID, history, groups, and channels.
This key can then be used only once with the <literal role="command">rhnreg_ks</literal> command line utility to re-register this system and regain all SUSE Manager settings.
Unlike typical activation keys, which are not associated with a specific system ID, keys created here do not show up within the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_reactivation.png" width="80%"/>
</imageobject>
<textobject><phrase>system details reactivation</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Reactivation keys can be combined with activation keys to aggregate the settings of multiple keys for a single system profile.
For example:</simpara>
<screen>rhnreg_ks --server=`server-url`\
  --activationkey=`reactivation-key`,`activationkey`--force</screen>
<warning>
<simpara>When autoinstalling a system with its existing SUSE Manager profile, the profile uses the system-specific activation key created here to re-register the system and return its other SUSE Manager settings.
For this reason, you should not regenerate, delete, or use this key (with <literal role="command">rhnreg_ks</literal>) while a profile-based autoinstallation is in progress.
If you do, the autoinstallation will fail.</simpara>
</warning>
</section>
<section xml:id="s5-sm-system-details-hardware">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Hardware</guimenuitem></menuchoice></title>
<simpara>This subtab provides information about the system, such as networking, BIOS, memory, and other devices.
This only works if you included the hardware profile during registration.
If the hardware profile looks incomplete or outdated, click the <guibutton>Schedule Hardware Refresh</guibutton> button.
The next time the system connects to SUSE Manager, it will update your system profile with the latest hardware information.</simpara>
</section>
<section xml:id="s5-sm-system-details-migrate">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Migrate</guimenuitem></menuchoice></title>
<simpara>This subtab provides the option to migrate systems between organizations.
Select an organization form the dropdown <literal role="guimenu">Migrate System Between Organizations</literal> and click <guibutton>Migrate System</guibutton> to initiate the migration.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_migrate.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional migrate</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<simpara>Defined system details such as channel assignments, system group membership, custom data value, configuration channels, reactivation keys, and snapshots will be dropped from the system configuration after the migration.</simpara>
</note>
</section>
<section xml:id="s5-sm-system-details-notes">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Notes</guimenuitem></menuchoice></title>
<simpara>This subtab provides a place to create notes about the system.</simpara>
<variablelist>
<varlistentry>
<term>Create Note</term>
<listitem>
<simpara>To add a new note, click the <literal role="guimenu">Create Note</literal> link, type a subject and write your note, then click the <guibutton>Create</guibutton> button.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Modify Note</term>
<listitem>
<simpara>To modify a note, click its subject in the list of notes, make your changes, and click the <guibutton>Update</guibutton> button.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Remove Note</term>
<listitem>
<simpara>To remove a note, click its subject in the list of notes then click the <literal role="guimenu">Delete Note</literal> link.</simpara>
</listitem>
</varlistentry>
</variablelist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_notes.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional notes</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s5-sm-system-details-info">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Custom Info</guimenuitem></menuchoice></title>
<simpara>This subtab provides completely customizable information about the system.
Unlike <literal role="guimenu">Notes</literal>, <literal role="guimenu">Custom Info</literal> is structured, formalized, and can be searched.
Before adding custom information about a system, you must create <emphasis>Custom Information Keys</emphasis> by selecting the <literal role="guimenu">Custom System Information</literal> link.
Then, on the <literal role="guimenu">Custom System Information</literal> page, select the <literal role="guimenu">Create Key</literal> link.
Provide <literal role="guimenu">Key Label</literal> and <literal role="guimenu">Description</literal> and confirm with <guibutton>Create Key</guibutton>.
For more information, see <xref linkend="ref.webui.systems.cust-info"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_custom_info.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional custom info</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Once you have created one or more keys, you may assign values for this system by selecting the <literal role="guimenu">Create Value link</literal>.
Click the name of the key in the resulting list and enter a value for it in the <literal role="guimenu">Value</literal> field, then click the <guibutton>Update Key</guibutton> button.</simpara>
</section>
<section xml:id="s5-sm-system-details-proxy">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Details</guisubmenu> <guimenuitem>Proxy</guimenuitem></menuchoice>  [Proxy]</title>
<simpara>This tab is only available for SUSE Manager Proxy systems.
The tab lists all clients registered with the selected SUSE Manager Proxy server.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-channels">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Software</guimenuitem></menuchoice></title>
<simpara>This tab and its subtabs allow you to manage the software on the system: patches (errata), packages and package profiles, software channel memberships, and migrations.</simpara>
<section xml:id="s4-sm-system-details-errata">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Patches</guimenuitem></menuchoice></title>
<simpara>This subtab contains a list of patch (errata) alerts applicable to the system.
Refer to
<xref linkend="ref.webui.intro.patch_alerts"/>
for meanings of the icons on this tab.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_software_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional software patches</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To apply updates, select them and click the <guibutton>Apply Patches</guibutton> button.
Double-check the updates to be applied on the confirmation page, then click the <guibutton>Confirm</guibutton> button.</simpara>
<simpara>The action is added to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Schedule</guisubmenu> <guimenuitem>Pending Actions</guimenuitem></menuchoice> list.
Patches that have been scheduled cannot be selected for update.
Instead of a check box there is a clock icon.
Click the clock to see the <literal role="guimenu">Action Details</literal> page.</simpara>
<simpara>The <literal role="guimenu">Status</literal> column in the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Patches</guimenuitem></menuchoice> table shows whether an update has been scheduled.
Possible values are:</simpara>
<itemizedlist>
<listitem>
<simpara>None</simpara>
</listitem>
<listitem>
<simpara>Pending</simpara>
</listitem>
<listitem>
<simpara>Picked Up</simpara>
</listitem>
<listitem>
<simpara>Completed</simpara>
</listitem>
<listitem>
<simpara>Failed</simpara>
</listitem>
</itemizedlist>
<simpara>This column displays only the latest action related to a patch.
For example, if an action fails and you reschedule it, this column shows the status of the patch as <literal>Pending</literal> with no mention of the previous failure.
Clicking a status other than <literal>None</literal> takes you to the <literal role="guimenu">Action Details</literal> page.</simpara>
</section>
<section xml:id="s4-sm-system-details-packages">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Packages</guimenuitem></menuchoice></title>
<simpara>Manage the software packages on the system.
Most of the following actions can also be performed via action chains.
For further information on action chains, see
<xref linkend="ref.webui.schedule.chains"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_software_packages.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional software packages</phrase></textobject>
</mediaobject>
</informalfigure>
<warning>
<simpara>When new packages or updates are installed on the client via SUSE Manager, any licenses (EULAs) requiring agreement before installation are automatically accepted.</simpara>
</warning>
<variablelist>
<varlistentry>
<term>Packages</term>
<listitem>
<simpara>The default display of the <literal role="guimenu">Packages</literal> tab describes the options available and provides the means to update your package list.
To update or complete a potentially outdated list, possibly because of the manual installation of packages, click the <guibutton>Update Package List</guibutton> button in the bottom right-hand corner of this page.
The next time the system connects to SUSE Manager, it updates your system profile with the latest list of installed packages.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>List / Remove</term>
<listitem>
<simpara>Lists installed packages and enables you to remove them.
View and sort packages by name or the date they were installed on the system.
Search for the desired packages by typing a name in the <literal role="guimenu">Filter by Package Name</literal> search field.
You may also select the letter or number corresponding to the first character of the package name from the drop down selection menu.
Click a package name to view its <literal role="guimenu">Package Details</literal> page.
To delete packages from the system, select their check boxes and click the <guibutton>Remove Packages</guibutton> button on the bottom right-hand corner of the page.
A confirmation page appears with the packages listed.
Click the <guibutton>Confirm</guibutton> button to remove the packages.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Upgrade</term>
<listitem>
<simpara>Displays a list of packages with newer versions available in the subscribed channels.
Click the latest package name to view its <literal role="guimenu">Package Details</literal> page.
To upgrade packages immediately, select them and click the <guibutton>Upgrade Packages</guibutton> button.
Any EULAs will be accepted automatically.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Install</term>
<listitem>
<simpara>Install new packages on the system from the available channels.
Click the package name to view its <literal role="guimenu">Package Details</literal> page.
To install packages, select them and click the <guibutton>Install Selected Packages</guibutton> button.
EULAs are automatically accepted.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Verify</term>
<listitem>
<simpara>Validates the packages installed on the system against its RPM database.
This is the equivalent of running <literal role="command">rpm -V</literal>.
The metadata of the system&#8217;s packages are compared with information from the database, such as file checksum, file size, permissions, owner, group and type.
To verify a package or packages, select them, click the <guibutton>Verify Selected Packages</guibutton> button, and confirm.
When the check is finished, select this action in the <literal role="guimenu">History</literal> subtab under <literal role="guimenu">Events</literal> to see the results.</simpara>
</listitem>
</varlistentry>
</variablelist>
<variablelist xml:id="s1-package-lock">
<varlistentry>
<term>Lock</term>
<listitem>
<simpara>Locking a package prevents modifications like removal or update of the package.
Since locking and unlocking happens via scheduling requests, locking might take effect with some delay.
If an update happens before then, the lock will have no effect.
Select the packages you want to lock.
If locking should happen later, select the date and time above the <guibutton>Request Lock</guibutton> button, then click it.
A small lock icon marks locked packages.
To unlock, select the package and click <guibutton>Request Unlock</guibutton>, optionally specifying the date and time for unlocking to take effect.</simpara>
<note>
<simpara>This feature only works if Zypper is used as the package manager.
On the target machine the <literal role="systemitem">zypp-plugin-spacewalk</literal> package must be installed (version 0.9.x or higher).</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term>Profiles</term>
<listitem>
<simpara>Compare installed packages with the package lists in stored profiles and other systems.</simpara>
<itemizedlist>
<listitem>
<simpara>Select a stored profile from the drop-down box and click the <guibutton>Compare</guibutton> button.
To compare with packages installed on a different system, select the system from the associated drop-down box and click the <guibutton>Compare</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>To create a stored profile based on the existing system, click the <guibutton>Create System Profile</guibutton> button, enter any additional information, and click the <guibutton>Create Profile</guibutton> button.
These profiles are kept within the <menuchoice><guimenu>Main menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Stored Profiles</guimenuitem></menuchoice> page.</simpara>
<simpara>When installed packages have been compared with a profile, customers have the option to synchronize the selected system with the profile.
All changes apply to the system not the profile.
Packages might get deleted and additional packages installed on the system.
To install only specific packages, click the respective check boxes in the profile.
To remove specific packages installed on the system, select the check boxes of these packages showing a difference of <literal role="guimenu">This System Only</literal>.</simpara>
<simpara>To completely synchronize the system&#8217;s packages with the compared profile, select the master check box at the top of the column.
Then click the <guibutton>Sync Packages to</guibutton> button.
On the confirmation screen, review the changes, select a time frame for the action, and click the <guibutton>Schedule Sync</guibutton> button.</simpara>
<simpara>You can use a stored profile as a template for the files to be installed on an autoinstalled system.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Non Compliant</term>
<listitem>
<simpara>Lists packages that are installed on this system and are not present in any of its channels.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="s5-sm-system-details-channels-software">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Software Channels</guimenuitem></menuchoice></title>
<simpara>Software channels provide a well-defined method to determine which packages should be available to a system for installation or upgrade based on its operating systems, installed packages, and functionality.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_software_system_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional software system channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the chain icon right to a channel name to view its <literal role="guimenu">Channel Details</literal> page.
To change the base software channel the system is subscribed to select a different base channel in the left selection box.</simpara>
<simpara>To modify the child channels associated with this system, in the right selection box use the check boxes left to the channel names.
If you enable <literal role="guimenu">include recommended</literal>, recommended child channels are automatically selected for subscription.
Starting with SUSE Linux Enterprise 15, child channels can depend on other channels—they are required.
In the channel subscription you can see the dependencies by hovering with a mouse on a child channel name.
Selecting a channel that depends on another channel will select this channel, too.
Unselecting a channel on which some other channels depend will also unselect those channels.</simpara>
<simpara>When done click <guibutton>Next</guibutton> to schedule the Software Channel Change action.
Then click <guibutton>Confirm</guibutton>.</simpara>
<note>
<title>Changing the Channels Is Now an Action</title>
<simpara>Since the 3.1 maintenance update (2018) changing the channels is an action that can be scheduled like any other action.
Earlier channel changes were applied immediately.</simpara>
</note>
<simpara>For more information about channel management, see
<xref linkend="ref.webui.channels.software"/>.</simpara>
</section>
<section xml:id="s5-sm-system-details-sp-migration">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>SP Migration</guimenuitem></menuchoice></title>
<simpara>Service Pack Migration (SP Migration) allows you to upgrade a system from one service pack to another.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_software_sp_migration.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional software sp migration</phrase></textobject>
</mediaobject>
</informalfigure>
<warning>
<simpara>During migration SUSE Manager automatically accepts any required licenses (EULAs) before installation.</simpara>
</warning>
<simpara>Beginning with SLE 12 SUSE supports service pack skipping, it is now possible to migrate from for example, SLE 12 SP2 to SLE 12 SP4.
Note that SLE 11 may only be migrated step by step and individual service packs should not be skipped.
Supported migrations include any of the following:</simpara>
<itemizedlist>
<listitem>
<simpara>SLE 11 &gt; SLE 11 SP1 &gt; SLE 11 SP2 &gt; SLE 11 SP3 &gt; SLE 11 SP4</simpara>
</listitem>
<listitem>
<simpara>SLE 12 &gt; SLE 12 SP1 &gt; SLE 12 SP2 &gt; SLE 12 SP3 &gt; SLE 12 SP4</simpara>
</listitem>
<listitem>
<simpara>SLE 12 SP2 &gt; SLE 12 SP4 (skipping SLE 12 SP3)</simpara>
</listitem>
</itemizedlist>
<warning>
<title>Migrating from an Earlier Version of SLES</title>
<simpara>It is not possible to migrate, for example, from SLE 11 to SLE 12 using this tool.
You must use AutoYaST to perform a migration on this level.</simpara>
</warning>
<warning>
<title>Rollback Not Possible</title>
<simpara>The migration feature does not cover any rollback functionality.
When the migration procedure is started, rolling back is not possible.
Therefore it is recommended to have a working system backup available for an emergency.</simpara>
</warning>
<orderedlist numeration="arabic">
<title>Procedure: Performing a Migration</title>
<listitem>
<simpara>From the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page, select a client.</simpara>
</listitem>
<listitem>
<simpara>Select the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>SP Migration</guimenuitem></menuchoice> tabs.</simpara>
</listitem>
<listitem>
<simpara>Select the target migration path and click <guibutton>Select Channels</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>SP Migration</guisubmenu> <guimenuitem>Service Pack Migration - Channels</guimenuitem></menuchoice> view select the correct base channel, including <literal>Mandatory Child Channels</literal> and any additional <literal>Optional Child Channels</literal>. Select <guibutton>Schedule Migration</guibutton> when your channels have been configured properly.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="s5-sm-system-details-channels-config">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice></title>
<simpara>This tab and its subtabs assist in managing the configuration files associated with the system.
On Salt based systems, these configuration files are distributed via a Configuration Channel.
On traditionally managed systems, these configuration files may be managed solely for the current system or distributed widely via a Configuration Channel.
The following sections describe these and other available options on the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice> subtabs.</simpara>
<note>
<title>Required Packages [Management]</title>
<simpara>To manage the configuration of a system, it must have the latest <phrase role="package">rhncfg*</phrase> packages installed.
Refer to
for instructions on enabling and disabling scheduled actions for a system.</simpara>
</note>
<simpara>This section is available to normal users with access to systems that have configuration management enabled.
Like software channels, configuration channels store files to be installed on systems.
While software updates are provided by SCC, configuration files are managed solely by you.
Also unlike with software packages, various versions of configuration files may prove useful to a system at any time.
Only the latest version can be deployed.</simpara>
<section xml:id="s5-sdc-configuration-overview">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice></title>
<simpara>This subtab provides access to the configuration files of your system and to the most common tasks used to manage configuration files.</simpara>
<variablelist>
<varlistentry>
<term>Configuration Overview</term>
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>, click the <literal role="guimenu">Add</literal> links to add files, directories, or symbolic links.
Here you also find shortcuts to perform any of the common configuration management tasks listed on the right of the screen by clicking one of the links under <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Overview</guisubmenu> <guimenuitem>Configuration Actions</guimenuitem></menuchoice>.</simpara>
</listitem>
</varlistentry>
</variablelist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration overview</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s5-sdc-configuration-mngfiles">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>View/Modify Files</guimenuitem></menuchoice></title>
<simpara>This subtab lists all configuration files currently associated with the system.
These are sorted via subtabs in centrally and locally managed files and a local sandbox for files under development.</simpara>
<simpara>Using the appropriate buttons on a subtab, you can copy from one to the other subtabs.</simpara>
<informalexample>
<simpara><literal role="guimenu">Modify Files</literal> is not available on Salt based systems.</simpara>
</informalexample>
<variablelist>
<varlistentry>
<term>Centrally-Managed Files</term>
<listitem>
<simpara>Centrally-managed configuration files are provided by global configuration channels.
Determine which channel provides which file by examining the <literal role="guimenu">Provided By</literal> column below.
Some of these centrally-managed files may be overridden by locally-managed files.
Check the <literal role="guimenu">Overridden By</literal> column to find out if any files are overridden, or click <guibutton>Override this file</guibutton> to provide such an overriding file.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_view_mod_central_paths.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration view mod central paths</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</varlistentry>
<varlistentry>
<term>Locally-Managed Files [Management]</term>
<listitem>
<simpara>Locally-managed configuration files are useful for overriding centrally-managed configuration profiles that cause problems on particular systems.
Also, locally-managed configuration files are a method by which system group administrators who do not have configuration administration privileges can manage configuration files on the machines they can manage.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_view_mod_local_paths.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration view mod local paths</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</varlistentry>
<varlistentry>
<term>Local Sandbox [Management]</term>
<listitem>
<simpara>In the sandbox you can store configuration files under development.
You can promote files from the sandbox to a centrally-managed configuration channel using <literal role="guimenu">Copy Latest to Central Channel</literal>.
After files in this sandbox have been promoted to a centrally-managed configuration channel, you can deploy them to other systems.</simpara>
<simpara>Use <literal role="guimenu">Copy Latest to System Channel</literal> to install a configuration on the local system only.
When done, the file will end up on the <literal role="guimenu">Locally-Managed Files</literal> subtab.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_view_mod_sandbox_paths.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration view mod sandbox paths</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="s5-sdc-configuration-add-files">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Add Files</guimenuitem></menuchoice> [Management]</title>
<simpara>To upload, import, or create new configuration files, open the <literal role="guimenu">Add Files</literal> subtab.</simpara>
<variablelist>
<varlistentry>
<term>Upload File</term>
<listitem>
<simpara>To upload a configuration file from your local machine, browse for the upload file, specify whether it is a text or binary file, enter <literal role="guimenu">Filename/Path</literal> and user and group ownership.
Specific file permissions can be set.
When done, click <guibutton>Upload Configuration File</guibutton>.</simpara>
</listitem>
</varlistentry>
</variablelist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_add_files_upload.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration add files upload</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term>Import Files</term>
<listitem>
<simpara>Via the <literal role="guimenu">Import Files</literal> tab, you can add files from the system you have selected before and add it to the sandbox of this system.
Files will be imported the next time <literal role="command">rhn_check</literal> runs on the system.
To deploy these files or override configuration files in global channels, copy this file into your local override channel after the import has occurred.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>In the text box under <literal role="guimenu">Import New Files</literal> enter the full path of any files you want import into SUSE Manager or select deployable configuration files from the <literal role="guimenu">Import Existing Files</literal> list.
When done, click <guibutton>Import Configuration Files</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_add_files_import.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration add files import</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term>Create File</term>
<listitem>
<simpara>Under <literal role="guimenu">Create File</literal>, you can directly create the configuration file from scratch.
Select the file type, specify the path and file name, where to store the file, plus the symbolic link target file name and path.
Ownership and permissions and macro delimiters need to be set.
For more information on using macros, see
<xref linkend="s3-sm-file-macros"/>.
In the <literal role="guimenu">File Contents</literal> text box, type the configuration file.
Select the type of file you are creating from the drop-down box.
Possible choices are Shell, Perl, Python, Ruby and XML.
When done, click <guibutton>Create Configuration File</guibutton>.</simpara>
</listitem>
</varlistentry>
</variablelist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_add_files_create.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration add files create</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s5-sdc-configuration-deploy-files">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Deploy Files</guimenuitem></menuchoice></title>
<simpara>Under <literal role="guimenu">Deploy Files</literal> you find all files that can be deployed on the selected system.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_deploy_file.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration deploy file</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Files from configuration channels with a higher priority take precedence over files from configuration channels with a lower priority.</simpara>
</section>
<section xml:id="s5-sdc-configuration-diff">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Compare Files</guimenuitem></menuchoice></title>
<simpara>This subtab compares a configuration file stored on the SUSE Manager with the file stored on the client.
It does not compare versions of the same file stored in different channels.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_diff_file.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration diff file</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Select the files to be compared, click the <guibutton>Compare Files</guibutton> button, select a time to perform the diff, and click the <guibutton>Schedule Compare</guibutton> button to confirm.</simpara>
<simpara>To watch progress, see <xref linkend="s4-sm-system-details-events"/>.
After the diff has been performed, go to <literal role="guimenu">Recent Events</literal> in <xref linkend="s5-sdc-configuration-overview"/> to see the results.</simpara>
</section>
<section xml:id="s5-sdc-configuration-channels">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Manage Configuration Channels</guimenuitem></menuchoice></title>
<simpara>This subtab allows you to subscribe to and rank configuration channels associated with the system, lowest first.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_configuration_config_channel_list.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional configuration config channel list</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The <literal role="guimenu">List/Unsubscribe from Channels</literal> subtab contains a list of the system&#8217;s configuration channel subscriptions.
Click the check box next to the Channel and click <literal role="guimenu">Unsubscribe</literal> to remove the subscription to the channel.</simpara>
<simpara>The <literal role="guimenu">Subscribe to Channels</literal> subtab lists all available configuration channels.
To subscribe to a channel, select the check box next to it and click <guibutton>Continue</guibutton>.
To subscribe to all configuration channels, click <literal role="guimenu">Select All</literal> and click <guibutton>Continue</guibutton>.
The <literal role="guimenu">View/Modify Rankings</literal> page automatically loads.</simpara>
<simpara>The <literal role="guimenu">View/Modify Rankings</literal> subtab allows users to set the priority with which files from a particular configuration channel are ranked.
The higher the channel is on the list, the more its files take precedence over files on lower-ranked channels.
For example, the higher-ranked channel may have an <literal role="path">httpd.conf</literal> file that will take precedence over the same file in a lower-ranked channel.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-kick">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Provisioning</guimenuitem></menuchoice>  [Management]</title>
<simpara>The <literal role="guimenu">Provisioning</literal> tab and its subtabs allow you to schedule and monitor AutoYaST or Kickstart installations and to restore a system to its previous state.</simpara>
<note>
<title>Available for Clients Using the <quote>Traditional</quote> Method</title>
<simpara>The note <literal role="guimenu">Provisioning</literal> tab will be available when adding a client using the <quote>traditional</quote> method (system type <literal>management</literal>). Using Salt the <literal role="guimenu">Provisioning</literal> tab will not be available (system type <literal>salt</literal>).</simpara>
</note>
<simpara>AutoYaST is a SUSE Linux Enterprise and Kickstart is a Red Hat utility-both allow you to automate the reinstallation of a system.
Snapshot rollbacks provide the ability to revert certain changes on the system.
You can roll back a set of RPM packages, but rolling back across multiple update levels is not supported.
Both features are described in the sections that follow.</simpara>
<section xml:id="s5-sdc-provisioning-kickstart">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Autoinstallation</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">Schedule</literal> subtab allows you to configure and schedule an autoinstallation for this system.
For background information about autoinstallation, see
<xref linkend="ref.webui.systems.autoinst"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_provisioning_schedule_wizard.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional provisioning schedule wizard</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>In the <literal role="guimenu">Schedule</literal> subtab, schedule the selected system for autoinstallation.
Choose from the list of available profiles.</simpara>
<note>
<simpara>You must first create a profile before it appears on this subtab.
If you have not created any profiles, refer to
<xref linkend="ref.webui.systems.autoinst.profiles.create"/>.
before scheduling an autoinstallation for a system.</simpara>
</note>
<simpara>To alter autoinstallation settings, click the <guibutton>Advanced Configuration</guibutton> button.
Configure the network connection and post-installation networking information.
You can aggregate multiple network interfaces into a single logical "bonded" interface.
In <literal role="guimenu">Kernel Options</literal> specify kernel options to be used during autoinstallation. <literal role="guimenu">Post Kernel Options</literal> are used after the installation is complete and the system is booting for the first time.
Configure package profile synchronization.</simpara>
<simpara>Select a time for the autoinstallation to begin and click <guibutton>Schedule Autoinstall and Finish</guibutton> for all changes to take effect and to schedule the autoinstallation.</simpara>
<simpara>Alternatively, click <literal role="guimenu">Create PXE Installation Configuration</literal> to create a Cobbler system record.
The selected autoinstallation profile will be used to automatically install the configured distribution next time that particular system boots from PXE.
In this case SUSE Manager and its network must be properly configured to allow boot using PXE.</simpara>
<note>
<simpara>Any settings changed on the <literal role="guimenu">Advanced Configuration</literal> page will be ignored when creating a PXE installation configuration for Cobbler.</simpara>
</note>
<simpara>The <literal role="guimenu">Variables</literal> subtab can be used to create Kickstart variables, which substitute values in Kickstart files.
To define a variable, create a name-value pair (<literal role="replaceable">name/value</literal>) in the text box.</simpara>
<simpara>For example, to {kickstart} a system that joins the network of a specific organization (for example the Engineering department) you can create a profile variable to set the IP address and the gateway server address to a variable that any system using that profile will use.
Add the following line to the <literal role="guimenu">Variables</literal> text box:</simpara>
<screen>IPADDR=192.168.0.28
GATEWAY=192.168.0.1</screen>
<simpara>To use the system variable, use the name of the variable in the profile instead of the value.
For example, the <literal role="option">network</literal> portion of a {kickstart} file could look like the following:</simpara>
<screen>network --bootproto=static --device=eth0 --onboot=on --ip=$IPADDR \
  --gateway=$GATEWAY</screen>
<simpara>The <literal role="option">$IPADDR</literal> will be <literal>192.168.0.28</literal>, and the <literal role="option">$GATEWAY</literal> will be <literal>192.168.0.1</literal>.</simpara>
<note>
<simpara>There is a hierarchy when creating and using variables in {kickstart} files.
System {kickstart} variables take precedence over profile variables, which in turn take precedence over distribution variables.
Understanding this hierarchy can alleviate confusion when using variables in {kickstart}.</simpara>
</note>
<simpara>Using variables are one part of the larger Cobbler infrastructure for creating templates that can be shared between multiple profiles and systems.
For more information about Cobbler and {kickstart} templates, refer to
<xref linkend="advanced.topics.cobbler"/>.</simpara>
</section>
<section xml:id="s5-sdc-provisioning-powermgnt">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Power Management</guimenuitem></menuchoice></title>
<simpara>SUSE Manager allows you to power on, off, and reboot systems via the IPMI protocol if the systems are IPMI-enabled.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_provisioning_power_management.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional provisioning power management</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>You need a fully patched SUSE Manager installation.
To use any power management functionality, IPMI configuration details must be added to SUSE Manager.
First select the target system on the systems list, then select <menuchoice><guimenu>Provisioning</guimenu> <guimenuitem>Power Management</guimenuitem></menuchoice>.
On the displayed configuration page, edit all required fields (marked with a red asterisk) and click <guibutton>Save only</guibutton>.</simpara>
<simpara>Systems can be powered on, off, or rebooted from the configuration page via corresponding buttons.
Note that any configuration change is also saved in the process.
The <guibutton>Get Status</guibutton> button can be used to query for the system&#8217;s power state.
If configuration details are correct, a row is displayed with the current power status ("on" or "off").
If a power management operation succeeds on a system, it will also be noted in its <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Events</guisubmenu> <guimenuitem>History</guimenuitem></menuchoice> subtab.</simpara>
<simpara>Power management functionalities can also be used from the system set manager to operate on multiple systems at the same time.
Specifically, you can change power management configuration parameters or apply operations (power on, off, reboot) to multiple systems at once:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Add the respective systems to the system set manager as described in <xref linkend="ref.webui.systems.ssm"/>.</simpara>
</listitem>
<listitem>
<simpara>Select systems on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>, then <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>System Set Manager</guisubmenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Power Management Configuration</guimenuitem></menuchoice> to change one or more configuration parameters for all systems in the set. Note that any field left blank will not alter the configuration parameter in selected systems.</simpara>
</listitem>
<listitem>
<simpara>When all configuration parameters are set correctly, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>System Set Manager</guisubmenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Power Management Operations</guimenuitem></menuchoice> to power on, off or reboot systems from the set.</simpara>
</listitem>
</orderedlist>
<simpara>To check that a power operation was executed correctly, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>System Set Manager</guisubmenu> <guimenuitem>Status</guimenuitem></menuchoice>, then click the proper line in the list.
This will display a new list with systems to which the operation was applied.
If errors prevent correct execution, a brief message with an explanation will be displayed in the <literal role="guimenu">Note</literal> column.</simpara>
<simpara>This feature uses Cobbler power management, thus a Cobbler system record is automatically created at first use if it does not exist already.
In that case, the automatically created system record will not be bootable from the network and will reference a dummy image.
This is needed because Cobbler does not currently support system records without profiles or images.
The current implementation of Cobbler power management uses the fence-agent tools to support multiple protocols besides IPMI.
Those are not supported by SUSE Manager but can be used by adding the fence agent names as a comma-separated list to the <literal role="option">java.power_management.types</literal> configuration parameter.</simpara>
</section>
<section xml:id="s4-sm-system-details-shots">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Snapshots</guimenuitem></menuchoice></title>
<simpara>Snapshots enable you to roll back the system&#8217;s package profile, configuration files, and SUSE Manager settings.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_provisioning_snapshot_index.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional provisioning snapshot index</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Snapshots are always captured automatically after an action takes place.
The <literal role="guimenu">Snapshots</literal> subtab lists all snapshots for the system, including the reason the snapshot was taken, the time it was taken, and the number of tags applied to each snapshot.</simpara>
<note>
<title>Technical Details</title>
<itemizedlist>
<listitem>
<simpara>A snapshot is always taken <emphasis>after</emphasis> a successful operation and not before, as you might expect. One consequence of taking snapshots after the action is that, to undo action number X, then you must roll back to the snapshot number X-1.</simpara>
</listitem>
<listitem>
<simpara>It is possible to disable snapshotting globally (in <literal role="path">rhn.conf</literal> set <literal>enable_snapshots = 0</literal>), but it is enabled by default. No further fine tuning is possible.</simpara>
</listitem>
</itemizedlist>
</note>
<simpara>To revert to a previous configuration, click the <literal role="guimenu">Reason</literal> for the snapshot and review the potential changes on the provided subtabs, starting with <literal role="guimenu">Rollback</literal>.</simpara>
<important>
<title>Unsupported Rollback Scenarios</title>
<simpara>Snapshot roll backs support the ability to revert <emphasis>certain</emphasis> changes to the system, but not in every scenario.
For example, you can roll back a set of RPM packages, but rolling back across multiple update levels is not supported.</simpara>
<simpara>Rolling back an SP migration is also not supported.</simpara>
</important>
<simpara>Each subtab provides the specific changes that will be made to the system during the rollback:</simpara>
<itemizedlist>
<listitem>
<simpara>group memberships,</simpara>
</listitem>
<listitem>
<simpara>channel subscriptions,</simpara>
</listitem>
<listitem>
<simpara>installed packages,</simpara>
</listitem>
<listitem>
<simpara>configuration channel subscriptions,</simpara>
</listitem>
<listitem>
<simpara>configuration files,</simpara>
</listitem>
<listitem>
<simpara>snapshot tags.</simpara>
</listitem>
</itemizedlist>
<simpara>When satisfied with the reversion, return to the <literal role="guimenu">Rollback</literal> subtab and click the <guibutton>Rollback to Snapshot</guibutton> button.
To see the list again, click <guibutton>Return to snapshot list</guibutton>.</simpara>
<note>
<title>Background Information About Snapshots</title>
<simpara>There is no maximum number of snapshots that SUSE Manager will keep, thus related database tables will grow with system count, package count, channel count, and the number of configuration changes over time.
Installations with more than a thousand systems should consider setting up a recurring cleanup script via the API or disabling this feature altogether.</simpara>
<simpara>There is currently no integrated support for <quote>rotated snapshots</quote>.</simpara>
<simpara>Snapshot rollback gets scheduled like any other action, this means the rollback usually does not happen immediately.</simpara>
</note>
</section>
<section xml:id="s5-sm-system-details-shots-tags">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Provisioning</guisubmenu> <guimenuitem>Snapshot Tags</guimenuitem></menuchoice></title>
<simpara>Snapshot tags provide a means to add meaningful descriptions to your most recent system snapshot.
This can be used to indicate milestones, such as a known working configuration or a successful upgrade.</simpara>
<simpara>To tag the most recent snapshot, click <literal role="guimenu">Create System Tag</literal>, enter a descriptive term in the <literal role="guimenu">Tag name</literal>, and click the <guibutton>Tag Current Snapshot</guibutton> button.
You may then revert using this tag directly by clicking its name in the Snapshot Tags list.
To delete tags, select their check boxes, click <literal role="guimenu">Remove Tags</literal>, and confirm the action.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-groups">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Groups</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">Groups</literal> tab and its subtabs allow you to manage the system&#8217;s group memberships.</simpara>
<section xml:id="s5-sm-system-details-groups-list">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Groups</guisubmenu> <guimenuitem>List/Leave</guimenuitem></menuchoice></title>
<simpara>This subtab lists groups to which the system belongs and enables you to cancel membership.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_list_groups.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional list groups</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Only System Group Administrators and SUSE Manager Administrators can remove systems from groups.
Non-admins see a <literal role="guimenu">Review this system&#8217;s group membership</literal> page.
To remove the system from one or more groups, select the respective check boxes of these groups and click the <guibutton>Leave Selected Groups</guibutton> button.
To see the <literal role="guimenu">System Group Details</literal> page, click the group&#8217;s name.
Refer to <xref linkend="ref.webui.systems.systemgroups.details"/> for more information.</simpara>
</section>
<section xml:id="s5-sm-system-details-groups-join">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Groups</guisubmenu> <guimenuitem>Join</guimenuitem></menuchoice></title>
<simpara>Lists groups that the system can be subscribed to.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_add_group.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional add group</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Only System Group Administrators and SUSE Manager Administrators can add a system to groups.
Non-admins see a <literal role="guimenu">Review this system&#8217;s group membership</literal> page.
To add the system to groups, select the groups' check boxes and click the <guibutton>Join Selected Groups</guibutton> button.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-virtualization">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Virtualization</guimenuitem></menuchoice> [Management]</title>
<simpara>This tab allows you to create new virtual guests, apply images on a
traditionally managed host system, or change the status of virtual guests.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_virtualization_details.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional virtualization details</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The <literal role="guimenu">Virtualization</literal> tab has three subtabs, <literal role="guimenu">Details</literal>,
 <literal role="guimenu">Provisioning</literal>, and <literal role="guimenu">Deployment</literal>.
These tabs appear the same for both virtual hosts and guests, but the functionality only makes sense for virtual hosts.
It is not possible to create a guest system that runs on another guest system.</simpara>
<bridgehead xml:id="sdc-virt-host-place" renderas="sect4">System Details &gt; Virtualization&gt; Details</bridgehead>
<simpara><literal role="guimenu">Details</literal> is the default tab.
For host systems, it presents a table of the host system&#8217;s virtual guests.
For each guest system, the following information is provided:</simpara>
<variablelist>
<varlistentry>
<term><literal role="guimenu">Status</literal></term>
<listitem>
<simpara>This field indicates whether the virtual system is running, paused, stopped, or has crashed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="guimenu">Updates</literal></term>
<listitem>
<simpara>This field indicates whether patches (errata) applicable to the guest have yet to be applied.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="guimenu">Base Software Channel</literal></term>
<listitem>
<simpara>This field indicates the Base Channel to which the guest is subscribed.</simpara>
</listitem>
</varlistentry>
</variablelist>
<note>
<simpara>If a guest system has not registered with SUSE Manager, this information appears as plain text in the table.</simpara>
</note>
<simpara>If you have System Group Administrator responsibilities assigned for your guest systems, a user might see the message <literal role="guimenu">You do not have permission to access this system</literal> in the table.
This is because it is possible to assign virtual guests on a single host to multiple System Group Administrators.
Only users that have System Group Administrator privileges on the host system may create new virtual guests.</simpara>
<section xml:id="s5-sm-system-details-virtualization-deployment">
<title>System Details &gt; Virtualization &gt; Deployment</title>
<simpara>In the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Virtualization</guimenuitem></menuchoice> tab of a traditionally registered bare-metal machine, there is a  <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Virtualization</guisubmenu> <guimenuitem>Deployment</guimenuitem></menuchoice> subtab. This form expects a URL to a <literal>qcow2</literal> type of image and some other parameters allowing the user to schedule the deployment of that image.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_virtualization_deployment.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional virtualization deployment</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>When the deploment scheduled it is listed as an action on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Schedule</guisubmenu> <guimenuitem>Pending Actions</guimenuitem></menuchoice>.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-audit">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Audit</guimenuitem></menuchoice> [Management]</title>
<simpara>Via the <literal role="guimenu">Audit</literal> tab, view OpenSCAP scan results or schedule scans.
For more information on auditing and OpenSCAP, refer to
<xref linkend="ref.webui.audit"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_list_audit.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional list audit</phrase></textobject>
</mediaobject>
</informalfigure>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_schedule_audit.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional schedule audit</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-system-details-states">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>States</guimenuitem></menuchoice> [Salt]</title>
<simpara>Overview of <literal role="guimenu">States</literal> subtabs.</simpara>
<note>
<simpara>The following subtabs are only available for Salt minions.</simpara>
</note>
<section xml:id="_system_details_states_packages">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Packages</guimenuitem></menuchoice></title>
<simpara><literal role="guimenu">Search and install</literal> packages then assign them with a pre-defined state for a selected machine.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_salt_states_packages.png" width="80%"/>
</imageobject>
<textobject><phrase>system details salt states packages</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Here you can search for a specific package, for example <phrase role="package">vim</phrase>.
Then with the drop-down box activate <literal role="guimenu">Unmanaged</literal>, <literal role="guimenu">Installed</literal>, or <literal role="guimenu">Removed</literal>.
Select <literal role="guimenu">Latest</literal> or <literal role="guimenu">Any</literal> from the drop-down box. <literal role="guimenu">Latest</literal> applies the latest package version available while <literal role="guimenu">Any</literal> applies the package version required to fulfil dependencies.
Click the <guibutton>Save</guibutton> button to save changes to the database, then click <guibutton>Apply</guibutton> to apply the new package state.</simpara>
</section>
<section xml:id="s5-sm-system-details-states-custom">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Custom</guimenuitem></menuchoice></title>
<simpara>States which have been created on the <literal role="guimenu">States Catalog</literal> page located under <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Salt</guimenuitem></menuchoice> may be assigned to a system on the <literal role="guimenu">Custom</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_salt_states_custom.png" width="80%"/>
</imageobject>
<textobject><phrase>system details salt states custom</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Search for the custom state you want to apply to the system then select the <literal role="guimenu">Assign</literal> check box.
Click <guibutton>Save</guibutton> to save the change to the database finally select <guibutton>Apply</guibutton> to apply the changes.
States applied at the system level will only be applied to the selected system.</simpara>
</section>
<section xml:id="s5-sm-system-details-states-highstate">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice></title>
<simpara>From the <literal role="guimenu">Highstate</literal> page you can view and apply the highstate for a selected system.</simpara>
<simpara>Select the <guibutton>Test mode</guibutton> toggle to test the highstate before applying it.</simpara>
<orderedlist numeration="arabic">
<title>Using Test mode</title>
<listitem>
<simpara>Select the toggle <guibutton>Test mode</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Select <guibutton>Apply Highstate</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>You will see the message:</simpara>
<screen>Applying the highstate has been scheduled.</screen>
</listitem>
<listitem>
<simpara>Select <literal role="guimenu">scheduled</literal> to see the results of the test.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_salt_states_highstate.png" width="80%"/>
</imageobject>
<textobject><phrase>system details salt states highstate</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Select a date and time to apply the highstate.
Then click <guibutton>Apply Highstate</guibutton>.</simpara>
</section>
</section>
<section xml:id="s4-sm-system-details-formualas">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Formulas</guimenuitem></menuchoice>  [Salt]</title>
<simpara>This is a feature preview.
On the <literal role="guimenu">Formualas</literal> page you can select Salt formulas for this system.
This allows you to automatically install and configure software.</simpara>
<simpara>Installed formulas are listed.
Select from the listing by clicking the check box to the left.
Then confirm with the <guibutton>Save</guibutton> button on the right.
When done, additional subtabs appear where you can configure the formulas.</simpara>
<simpara>For usage information, see <xref linkend="best.practice.salt.formulas.using"/>.</simpara>
</section>
<section xml:id="s4-sm-system-details-events">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Events</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">Events</literal> page displays past, current, and scheduled actions on the system.
You may cancel pending events here.
The following sections describe the <literal role="guimenu">Events</literal> subtabs and the features they offer.</simpara>
<section xml:id="s5-sm-system-details-events-pend">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Events</guisubmenu> <guimenuitem>Pending</guimenuitem></menuchoice></title>
<simpara>Lists events that are scheduled but have not started.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_events_pending.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional events pending</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>A prerequisite action must complete successfully before the given action is attempted.
If an action has a prerequisite, no check box is available to cancel that action.
Instead, a check box appears next to the prerequisite action; canceling the prerequisite action causes the action in question to fail.</simpara>
<simpara>Actions can be chained so that action 'a' requires action 'b' which requires action 'c'. Action 'c' is performed first and has a check box next to it until it is completed successfully.
If any action in the chain fails, the remaining actions also fail.
To unschedule a pending event, select the event and click the <guibutton>Cancel Selected Events</guibutton> button.
The following icons indicate the type of events:</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-packages.png"/>
</imageobject>
<textobject><phrase>spacewalk icon packages</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Package Event,</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-patches.png"/>
</imageobject>
<textobject><phrase>spacewalk icon patches</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Patch Event,</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-cog.png"/>
</imageobject>
<textobject><phrase>fa cog</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Preferences Event,</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-desktop.png"/>
</imageobject>
<textobject><phrase>fa desktop</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;System Event.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s5-sm-system-details-events-hist">
<title><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Events</guisubmenu> <guimenuitem>History</guimenuitem></menuchoice></title>
<simpara>The default display of the <literal role="guimenu">Events</literal> tab lists the type and status of events that have failed, occurred or are occurring.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="system_details_traditional_events_history.png" width="80%"/>
</imageobject>
<textobject><phrase>system details traditional events history</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To view details of an event, click its summary in the <literal role="guimenu">System History</literal> list.
To go back to the table again, click <guibutton>Return to history list</guibutton> at the bottom of the page.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.systems.systemgroups">
<title>Systems &gt; System Groups</title>
<simpara>The <literal role="guimenu">System Groups</literal> page allows SUSE Manager users to view the <literal role="guimenu">System Groups</literal> list.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_systemgroups.png" width="80%"/>
</imageobject>
<textobject><phrase>systems systemgroups</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Only System Group Administrators and SUSE Manager Administrators may perform the following additional tasks:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Create system groups. (Refer to <xref linkend="ref.webui.systems.systemgroups.create"/>.)</simpara>
</listitem>
<listitem>
<simpara>Add systems to system groups. (Refer to <xref linkend="ref.webui.systems.systemgroups.add"/>.)</simpara>
</listitem>
<listitem>
<simpara>Remove systems from system groups. (Refer to <xref linkend="s3-sm-system-details"/>.)</simpara>
</listitem>
<listitem>
<simpara>Assign system group permissions to users. (Refer to
<xref linkend="ref.webui.users"/>.)</simpara>
</listitem>
</orderedlist>
<simpara>The <literal role="guimenu">System Groups</literal> list displays all system groups.
The list contains several columns for each group:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Select</literal>&#8201;&#8212;&#8201;Via the check boxes add all systems in the selected groups to the <literal role="guimenu">System Set Manager</literal> by clicking the <guibutton>Update</guibutton> button. All systems in the selected groups are added to the <literal role="guimenu">System Set Manager</literal> . You can then use the <literal role="guimenu">System Set Manager</literal> to perform actions on them simultaneously. It is possible to select only those systems that are members of all of the selected groups, excluding those systems that belong only to one or some of the selected groups. To do so, select the relevant groups and click the <guibutton>Work with Intersection</guibutton> button. To add all systems of all selected groups, click the <guibutton>Work with Union</guibutton> button. Each system will show up once, regardless of the number of groups to which it belongs. Refer to <xref linkend="ref.webui.systems.ssm"/> for details.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Updates</literal>&#8201;&#8212;&#8201;Shows which type of patch alerts are applicable to the group or confirms that all systems are up-to-date. Clicking a group&#8217;s status icon takes you to the <literal role="guimenu">Patch</literal> tab of its <literal role="guimenu">System Group Details</literal> page. Refer to <xref linkend="ref.webui.systems.systemgroups.details"/> for more information.</simpara>
<simpara>The status icons call for differing degrees of attention:
<emphasis role="strong"> <inlinemediaobject>
<imageobject>
<imagedata fileref="fa-check-circle.svg"/>
</imageobject>
<textobject><phrase>Check Circle</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;All systems in the group are up-to-date.
</emphasis> <inlinemediaobject>
<imageobject>
<imagedata fileref="fa-exclamation-circle.svg"/>
</imageobject>
<textobject><phrase>Exclamation Circle</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Critical patches available, update <emphasis>strongly</emphasis> recommended.
** <inlinemediaobject>
<imageobject>
<imagedata fileref="fa-warning.svg"/>
</imageobject>
<textobject><phrase>Warning</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Updates available and recommended.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Health</literal> Status of the systems in the group, reported by probes.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Group Name</literal>&#8201;&#8212;&#8201;The name of the group as configured during its creation. The name should be explicit enough to distinguish from other groups. Clicking the name of a group takes you to the <literal role="guimenu">Details</literal> tab of its <literal role="guimenu">System Group Details</literal> page. Refer to <xref linkend="ref.webui.systems.systemgroups.details"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Systems</literal>&#8201;&#8212;&#8201;Total number of systems in the group. Clicking the number takes you to the <literal role="guimenu">Systems</literal> tab of the <literal role="guimenu">System Group Details</literal> page for the group. Refer to <xref linkend="ref.webui.systems.systemgroups.details"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Use in SSM</literal>&#8201;&#8212;&#8201;Clicking the <literal role="guimenu">Use in SSM</literal> link in this column loads all and only the systems in the selected group and launches the <literal role="guimenu">System Set Manager</literal> immediately. Refer to <xref linkend="ref.webui.systems.ssm"/> for more information.</simpara>
</listitem>
</itemizedlist>
<section xml:id="ref.webui.systems.systemgroups.create">
<title>Creating Groups</title>
<simpara>To add a new system group, click the <literal role="guimenu">Create Group</literal> link at the top-right corner of the page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_edit_group.png" width="80%"/>
</imageobject>
<textobject><phrase>systems edit group</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Type a name and description and click the <guibutton>Create Group</guibutton> button.
Make sure you use a name that clearly sets this group apart from others.
The new group will appear in the <literal role="guimenu">System Groups</literal> list.</simpara>
</section>
<section xml:id="ref.webui.systems.systemgroups.add">
<title>Adding and Removing Systems in Groups</title>
<simpara>Systems can be added and removed from system groups.
Clicking the group name takes you to the <literal role="guimenu">Details</literal> page.
The <literal role="guimenu">Systems</literal> tab shows all systems in the group and allows you to select some or all systems for deletion.
Click <guibutton>Remove Systems</guibutton> to remove the selected systems from the group.
The <literal role="guimenu">Target Systems</literal> page shows you all systems that can be added to the group.
Select the systems and click the <guibutton>Add Systems</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.systems.systemgroups.details">
<title>System Group Details</title>
<simpara>At the top of each <literal role="guimenu">System Group Details</literal> page are two links: <literal role="guimenu">Delete Group</literal> and <literal role="guimenu">Work With Group</literal>.
Clicking <literal role="guimenu">Delete Group</literal> deletes the System Group and should be used with caution.
Clicking <literal role="guimenu">Work With Group</literal> loads the group&#8217;s systems and launches the <literal role="guimenu">System Set Manager</literal> immediately like the <literal role="guimenu">Use Group</literal> button from the <literal role="guimenu">System Groups</literal> list.
Refer to <xref linkend="ref.webui.systems.ssm"/> for more information.</simpara>
<simpara>The <literal role="guimenu">System Group Details</literal> page is split into the following tabs:</simpara>
<section xml:id="s4-sm-system-group-details-details">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>Provides the group name and group description.
To change this information, click <literal role="guimenu">Edit These Properties</literal>, make your changes in the appropriate fields, and click the <guibutton>Update Group</guibutton> button.</simpara>
</section>
<section xml:id="s4-sm-system-group-details-systems">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice></title>
<simpara>Lists all members of the system group.
Clicking links within the table takes you to corresponding tabs within the <literal role="guimenu">System Details</literal> page for the associated system.
To remove systems from the group, select the appropriate check boxes and click the <guibutton>Remove Systems</guibutton> button on the bottom of the page.
Clicking it does not delete systems from SUSE Manager entirely.
This is done through the <literal role="guimenu">System Set Manager</literal> or <literal role="guimenu">System Details</literal> pages.
Refer to <xref linkend="ref.webui.systems.ssm"/> or <xref linkend="s3-sm-system-details"/>, respectively.</simpara>
</section>
<section xml:id="s4-sm-system-group-details-target">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>Target Systems</guimenuitem></menuchoice></title>
<simpara><literal role="guimenu">Target Systems</literal>&#8201;&#8212;&#8201;Lists all systems in your organization.
To add systems to the specified system group, click the check boxes to their left and click the <guibutton>Add Systems</guibutton> button on the bottom right-hand corner of the page.</simpara>
</section>
<section xml:id="s4-sm-system-group-details-errata">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice></title>
<simpara>List of relevant patches for systems in the system group.
Clicking the advisory takes you to the <literal role="guimenu">Details</literal> tab of the <literal role="guimenu">Patch Details</literal> page.
(Refer to
<xref linkend="s3-sm-errata-details"/>
for more information.)
Clicking the Affected Systems number lists all of the systems affected by the patch.
To apply the patch updates in this list, select the systems and click the <guibutton>Apply Patches</guibutton> button.</simpara>
</section>
<section xml:id="s4-sm-system-group-details-admins">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>Admins</guimenuitem></menuchoice></title>
<simpara>List of all organization users that have permission to manage the system group.
SUSE Manager Administrators are clearly identified.
System Group Administrators are marked with an asterisk ('*').
To change the system group&#8217;s users, select and deselect the appropriate check boxes and click the <guibutton>Update</guibutton> button.</simpara>
</section>
<section xml:id="s4-sm-system-group-details-states">
<title><menuchoice><guimenu>System Group Details</guimenu> <guimenuitem>States</guimenuitem></menuchoice> [Salt]</title>
<simpara>The <literal role="guimenu">States</literal> tab displays states which have been created and added using the <menuchoice><guimenu>Salt</guimenu> <guisubmenu>]</guisubmenu> <guimenuitem>menu:State Catalog[</guimenuitem></menuchoice>.
From this page you can select which states should be applied across a group of systems.
A state applied from this page will be applied to all minions within a group.</simpara>
<note>
<simpara>States are applied according to the following order of hierarchy within SUSE Manager:</simpara>
<screen>Organization &gt; Group &gt; Single System</screen>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Applying States at the Group Level</title>
<listitem>
<simpara>Create a state using the <menuchoice><guimenu>Salt</guimenu> <guimenuitem>State Catalog</guimenuitem></menuchoice> or via the command line.</simpara>
</listitem>
<listitem>
<simpara>Browse to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>System Groups</guimenuitem></menuchoice>. Select the group that a new state should be applied to. From a specific group page select the <literal role="guimenu">States</literal> tab.</simpara>
</listitem>
<listitem>
<simpara>Use the search feature to located a state by name or click the <guibutton>Search</guibutton> button to list all available states.</simpara>
</listitem>
<listitem>
<simpara>Select the check box for the state to be applied and click the <guibutton>Save</guibutton> button. The <guibutton>Save</guibutton> button will save the change to the database but will not apply the state.</simpara>
</listitem>
<listitem>
<simpara>Apply the state by clicking the <guibutton>Apply</guibutton> button. The state will be scheduled and applied to any systems included within a group.</simpara>
</listitem>
</orderedlist>
</section>
</section>
</section>
<section xml:id="ref.webui.systems.ssm">
<title>Systems &gt; System Set Manager</title>
<simpara>The following actions executed on individual systems from the System Details page may be performed for multiple systems via the System Set Manager.
The System Set Manager can be used to schedule actions on both Salt and Traditional systems.
The following table provides information on what actions may be performed across both Salt and Traditional systems.
These two methods have different actions which may be accessed with the System Set Manager:</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">System Set Manager: Overview</entry>
<entry align="left" valign="top">Traditional SSM</entry>
<entry align="left" valign="top">Salt SSM</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Systems:
* List Systems</simpara></entry>
<entry align="left" valign="top"><simpara>Supported * Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported * Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Install Patches:
* Schedule Patch Updates</simpara></entry>
<entry align="left" valign="top"><simpara>Supported * Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported * Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Install Packages:
* Upgrade
* Install
* Remove
* Verify</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported
* Supported
* Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Limited
* Supported
* Supported
* Supported
* Not Available</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Groups:
* Create
* Manage</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Channels:
* Channel Memberships
* Channel Subscriptions
* Deploy / Diff Channels</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported
* Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Limited
* Supported
* Not Available
* Not Available</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Provisioning:
* Autoinstall Systems
* Tag for Snapshot
* Remote Commands
* Power Management
* Power Management Operations</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported
* Supported
* Supported
* Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Not Available</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Misc:
* Update System Preferences
* Update Hardware Profiles
* Update Package Profiles
* Run Remote Commands
* Set and Remove Custom Values for Selected Systems
* Reboot Systems
* Migrate Systems to another Organization
* Delete Systems from SUSE Manager</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported</simpara></entry>
<entry align="left" valign="top"><simpara>Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported
* Supported</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<simpara>Before performing actions on multiple systems, select the systems to work with.
To select systems, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>All</guimenuitem></menuchoice> and check the boxes to the left of the systems you want to work with.</simpara>
<simpara>Additionally, you can access the System Set Manager in three different ways:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>System Set Manager</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Use in SSM</literal> link in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>System Groups</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Work with Group</literal> link on the <literal role="guimenu">System Group Details</literal> page.</simpara>
</listitem>
</orderedlist>
<section xml:id="ref.webui.systems.ssm.overview">
<title>System Set Manager &gt; Overview</title>
<simpara>This page contains links to most SSM option tabs with short explanations.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm overview</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.ssm.systems">
<title>System Set Manager &gt; Systems</title>
<simpara>List of selected systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_list_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm list systems</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.ssm.patches">
<title>System Set Manager &gt; Patches</title>
<simpara>List of patch updates applicable to the current system set.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm patches</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the number in the Systems column to see to which systems in the System Set Manager a patch applies.
To apply updates, select the patches and click the <guibutton>Apply Patches</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.packages">
<title>System Set Manager &gt; Packages</title>
<simpara>Click the number in the Systems column to see the systems in the System Set Manager to which a package applies.
Modify packages on the system via the following subtabs.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_packages_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm packages overview</phrase></textobject>
</mediaobject>
</informalfigure>
<section xml:id="s4-sm-ssm-packages-install">
<title>System Set Manager &gt; Packages &gt; Install</title>
<simpara>This list includes all channels to which systems in the set are subscribed.
A package is only installed on a system if the system is subscribed to the channel providing the package.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_install.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm install</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the channel name and select the packages from the list.
Then click the <guibutton>Install Packages</guibutton> button.</simpara>
</section>
<section xml:id="s4-sm-ssm-packages-remove">
<title>System Set Manager &gt;  Packages  &gt;  Remove</title>
<simpara>A list of all the packages installed on the selected systems that might be removed.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_remove.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm remove</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Multiple versions appear if systems in the System Set Manager have more than one version installed.
Select the packages to be deleted, then click the <guibutton>Remove Packages</guibutton> button.</simpara>
</section>
<section xml:id="s4-sm-ssm-packages-upgrade">
<title>System Set Manager &gt;  Packages  &gt;  Upgrade</title>
<simpara>A list of all the packages installed on the selected systems that might be upgraded.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_upgrade.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm upgrade</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Systems must be subscribed to a channel providing the packages to be upgraded.
If multiple versions of a package are available, note that your system will be upgraded to the latest version.
Select the packages to be upgraded, then click the <guibutton>Upgrade Packages</guibutton> button.</simpara>
</section>
<section xml:id="s3-sm-ssm-verify">
<title>System Set Manager &gt;  Packages  &gt;  Verify</title>
<simpara>A list of all installed packages whose contents, file checksum, and other details may be verified.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_verify.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm verify</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>At the next check in, the verify event issues the command <literal role="command">rpm --verify</literal> for the specified package.
If there are any discrepancies, they are displayed in the System Details page for each system.</simpara>
<simpara>Select the check box next to all packages to be verified, then click the <guibutton>Verify Packages</guibutton> button.
On the next page, select a date and time for the verification, then click the <guibutton>Schedule Verifications</guibutton> button.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.ssm.groups">
<title>System Set Manager &gt;  Groups</title>
<simpara>Tools to create groups and manage system memberships.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_groups.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm groups</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>These functions are limited to SUSE Manager Administrators and System Group Administrators.
To add a new group, click <literal role="guimenu">Create Group</literal> on the top-right corner.
In the next page, type the group name and description in the respective fields and click the <guibutton>Create Group</guibutton> button.
To add or remove selected systems in any of the system groups, toggle the appropriate radio buttons and click the <guibutton>Alter Membership</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.channels">
<title>System Set Manager &gt;  Channels</title>
<simpara>As a Channel Administrator, you may change the base channels your systems are subscribed to.</simpara>
<note>
<title>Changing the Channels Is Now an Action</title>
<simpara>Since the 3.1 maintenance update (2018) changing the channels is an action that can be scheduled like any other action.
Earlier channel changes were applied immediately.</simpara>
</note>
<simpara>Manage channel associations through the following wizard procedure:</simpara>
<variablelist>
<varlistentry>
<term><literal role="guimenu">Base Channel Alteration</literal> (Page 1)</term>
<listitem>
<simpara>Valid channels are either channels created by your organization, or the vendor&#8217;s default base channel for your operating system version and processor type.
Systems will be unsubscribed from all channels, and subscribed to their new base channels.</simpara>
<warning>
<title>Changing Base Channel</title>
<simpara>This operation can have a dramatic effect on the packages and patches available to the systems.
Use with caution.</simpara>
</warning>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_base_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm base channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To change the base channel, select the new one from the <literal role="guimenu">Desired base Channel</literal>
and confirm the action.</simpara>
<simpara>On the this wizard page you see the <literal role="guimenu">Current base Channel</literal> and how many <literal role="guimenu">Systems</literal> are subscribed to it.
Click the number link in the <literal role="guimenu">Systems</literal> column to see which systems are actually selected.</simpara>
<simpara>To change the base channel subscription select the <literal role="guimenu">Desired base Channel</literal> from the selection box.
Then click <guibutton>Next</guibutton> in the lower left corner.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="guimenu">Child Channels</literal> (Page 2)</term>
<listitem>
<simpara>The <literal role="guimenu">Child Channels</literal> page allows you to subscribe and unsubscribe individual child channels related to its parent or base channel.
Systems must subscribe to a base channel before subscribing to a child channel.
If you enable <guibutton>with recommended</guibutton>, recommended child channels are automatically selected for subscription.
The handling of required channels is currently not implemented for system set manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_child_subscriptions.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm child subscriptions</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Change the child channel subscription on this page.
Then click <guibutton>Next</guibutton> in the lower left corner.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="guimenu">Channel Changes Overview</literal> (Page 3)</term>
<listitem>
<simpara>Schedule when the channel changes should take place the earliest.
Then click <guibutton>Confirm</guibutton> in the lower left corner.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="guimenu">Channel Changes Actions</literal> (Page 4)</term>
<listitem>
<simpara>See the scheduled change actions.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="ref.webui.systems.ssm.config">
<title>System Set Manager &gt;  Configuration</title>
<simpara>Like in the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Channels</guisubmenu> <guimenuitem>Configuration</guimenuitem></menuchoice> tab, the subtabs here can be used to subscribe the selected systems to configuration channels and deploy and compare the configuration files on the systems.
The channels are created in the <literal role="guimenu">Manage Config Channels</literal> interface within the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Software</guimenuitem></menuchoice> category.
Refer to
<xref linkend="ref.webui.config.overview"/>
for channel creation instructions.</simpara>
<simpara>To manage the configuration of a system, install the latest <literal role="path">rhncfg*</literal> packages.
Refer to
<xref linkend="ref.webui.config.preparing"/>
for instructions on enabling and disabling scheduled actions for a system.</simpara>
<section xml:id="ref.webui.systems.ssm.config.deploy">
<title>System Set Manager  &gt;  Configuration  &gt;  Deploy Files</title>
<simpara>Use this subtab to distribute configuration files from your central repository on SUSE Manager to each of the selected systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_config_deploy_files.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm config deploy files</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The table lists the configuration files associated with any of the selected systems.
Clicking its system count displays the systems already subscribed to the file.</simpara>
<simpara>To subscribe the selected systems to the available configuration files, select the check box for each wanted file.
When done, click <guibutton>Deploy Configuration</guibutton> and schedule the action.
Note that the latest versions of the files, at the time of scheduling, are deployed.
Newer versions created after scheduling are disregarded.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.config.verify">
<title>System Set Manager &gt;  Configuration  &gt;  Compare Files</title>
<simpara>Use this subtab to validate configuration files on the selected systems against copies in your central repository on SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_config_compare_files.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm config compare files</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The table lists the configuration files associated with any of the selected systems.
Clicking a file&#8217;s system count displays the systems already subscribed to the file.</simpara>
<simpara>To compare the configuration files deployed on the systems with those in SUSE Manager, select the check box for each file to be validated.
Then click <menuchoice><guimenu>Analyze Differences</guimenu> <guimenuitem>Schedule File Comparison</guimenuitem></menuchoice>.
The comparisons for each system will not complete until each system checks in to SUSE Manager.
When each comparison is complete, any differences between the files will be accessible from each system&#8217;s events page.</simpara>
<simpara>Note that the latest versions of the files, at the time of scheduling, are compared.
Newer versions created after scheduling are disregarded.
Find the results in the main <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> category or within the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Events</guimenuitem></menuchoice> tab.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.config.subs">
<title>System Set Manager &gt;  Configuration  &gt;  Subscribe to Channels</title>
<simpara>Subscribe systems to configuration channels, and in a second step rank these channels according to the order of preference.
This tab is available only to SUSE Manager Administrators and Configuration Administrators.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_config_subscribe_to_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm config subscribe to channels</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select channels for subscription by activating the check box. When done, confirm with <guibutton>Continue</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>In the second step, rank the channels with the arrow-up or arrow-down symbols.</simpara>
<simpara>Then decide how the channels are applied to the selected systems.
The three buttons below the channels reflect your options.
Clicking <guibutton>Subscribe with Highest Priority</guibutton> places all the ranked channels before any other channels to which the selected systems are currently subscribed.
Clicking <guibutton>Subscribe With Lowest Priority</guibutton> places the ranked channels after those channels to which the selected systems are currently subscribed.
Clicking <guibutton>Replace Existing Subscriptions</guibutton> removes any existing association and creates new ones with the ranked channels, leaving every system with the same configuration channels in the same order.</simpara>
<note>
<title>Confliction Ranks</title>
<simpara>In the first two cases, if any of the newly ranked configuration channels are already in a system&#8217;s existing configuration channel list, the duplicate channel is removed and replaced according to the new rank, effectively reordering the system&#8217;s existing channels.
When such conflicts exist, you are presented with a confirmation page to ensure the intended action is correct.
When the change has taken place, a message appears at the top of the page indicating the update was successful.</simpara>
</note>
<simpara>Then, click <guibutton>Apply Subscriptions</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>Channels are accessed in the order of their rank.
Your local configuration channel always overrides all other channels.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.config.unsubs">
<title>System Set Manager &gt;  Configuration  &gt;  Unsubscribe from Channels</title>
<simpara>Administrators may unsubscribe systems from configuration channels by clicking the check box next to the channel name and clicking the <guibutton>Unsubscribe Systems</guibutton> button.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_config_unsubscribe_from_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm config unsubscribe from channels</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.ssm.config.enable">
<title>System Set Manager &gt;  Configuration  &gt;  Enable Configuration</title>
<simpara>Registered systems without configuration management preparation will appear here in a list.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_config_enable_config.png"/>
</imageobject>
<textobject><phrase>systems ssm config enable config</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Administrators may enable configuration management by clicking the <guibutton>Enable SUSE Manager Configuration Management</guibutton> button.
You can also schedule the action by adjusting the <literal role="guimenu">Schedule no sooner than</literal> date and time setting using the drop-down box, then clicking <guibutton>Enable SUSE Manager Configuration Management</guibutton>.</simpara>
<simpara>Then the systems will get subscribed to the required SUSE Manager tools channel and required <phrase role="package">rhncfg*</phrase> packages will get installed.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.ssm.provision">
<title>System Set Manager &gt; Provisioning</title>
<simpara>Set the options for provisioning systems via the following subtabs.</simpara>
<section xml:id="ref.webui.systems.ssm.provision_autoinst">
<title>System Set Manager  &gt;  Provisioning  &gt;  Autoinstallation</title>
<simpara>Use this subtab to reinstall clients.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_autoinstallation.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm autoinstallation</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To schedule autoinstallations for these systems, select a distribution.
The autoinstallation profile used for each system in the set is determined via the <literal role="guimenu">Autoinstallable Type</literal> radio buttons.</simpara>
<simpara>Choose <literal role="guimenu">Select autoinstallation profile</literal> to apply the same profile to all systems in the set.
This is the default option.
You will see a list of available profiles to select from when you click <guibutton>Continue</guibutton>.</simpara>
<simpara>Choose <literal role="guimenu">Autoinstall by IP Address</literal> to apply different autoinstallation profiles to different systems in the set, by IP address.
To do so, at least two autoinstallation profiles must be configured with associated IP ranges.</simpara>
<simpara>If you use <literal role="guimenu">Autoinstall by IP Address</literal>, SUSE Manager will automatically pick a profile for each system so that the system&#8217;s IP address will be in one of the IP ranges specified in the profile itself.
If such a profile cannot be found, SUSE Manager will look for an organization default profile and apply that instead.
If no matching IP ranges nor organization default profiles can be found, no autoinstallation will be performed on the system.
You will be notified on the next page if that happens.</simpara>
<simpara>To use Cobbler system records for autoinstallation, select <literal role="guimenu">Create PXE Installation Configuration</literal>.
With PXE boot, you cannot only reinstall clients, but automatically install machines that do not have an operating system installed yet.
SUSE Manager and its network must be properly configured to enable boot using PXE.
For more information on Cobbler and {kickstart} templates, refer to
<xref linkend="advanced.topics.cobbler"/>.</simpara>
<note>
<simpara>If a system set contains bare-metal systems and installed clients, only features working for systems without an operating system installed will be available.
Full features will be enabled again when all bare-metal systems are removed from the set.</simpara>
</note>
<simpara>If any of the systems connect to SUSE Manager via a proxy server, choose either the <literal role="guimenu">Preserve Existing Configuration</literal> radio button or the <literal role="guimenu">Use Proxy</literal> radio button.
If you choose to autoinstall through a proxy server, select from the available proxies listed in the drop-down box beside the <literal role="guimenu">Use Proxy</literal> radio button.
All of the selected systems will autoinstall via the selected proxy.
Click the <guibutton>Schedule Autoinstall</guibutton> button to confirm your selections.
When the autoinstallations for the selected systems are successfully scheduled, you will return to the <literal role="guimenu">System Set Manager</literal> page.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.provision.tag">
<title>System Set Manager &gt;  Provisioning  &gt;  Tag Systems</title>
<simpara>Use this subtab to add meaningful descriptions to the most recent snapshots of your selected systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_tag_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm tag systems</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To tag the most recent system snapshots, enter a descriptive term in the <literal role="guimenu">Tag name</literal> field and click the <guibutton>Tag Current Snapshots</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.provision.roll">
<title>System Set Manager &gt;  Provisioning  &gt;  Rollback</title>
<simpara>Use this subtab to rollback selected systems to previous snapshots marked with a tag.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_rollback.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm rollback</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the tag name, verify the systems to be reverted, and click the <guibutton>Rollback Systems</guibutton> button.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.provision.remote">
<title>System Set Manager &gt;  Provisioning  &gt;  Remote Command</title>
<simpara>Use this subtab to issue remote commands.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_remote_command.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm remote command</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>First create a <literal role="path">run</literal> file on the client systems to allow this function to operate.
Refer to <xref linkend="s5-sm-system-details-remote"/> for instructions.
Then identify a specific user, group, timeout period, and the script to run.
Select a date and time to execute the command and click <guibutton>Schedule</guibutton>.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.provision.pm_config">
<title>System Set Manager &gt;  Provisioning  &gt;  Power Management Configuration</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_power_management_config.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm power management config</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.ssm.provision.pm_op">
<title>System Set Manager &gt;  Provisioning  &gt;  Power Management Operation</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_power_management_operations.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm power management operations</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</section>
<section xml:id="ref.webui.systems.ssm.audit">
<title>System Set Manager &gt;  Audit</title>
<simpara>System sets can be scheduled for XCCDF scans; XCCDF stands for <quote>The Extensible Configuration Checklist Description Format</quote>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_audit.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm audit</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Enter the command and command line arguments, and the path to the XCCDF document.
Then schedule the scan.
All target systems are listed below with a flag whether they support OpenSCAP scans.
For more details on OpenSCAP and audits, refer to
<xref linkend="ref.webui.audit"/>.</simpara>
</section>
<section xml:id="ref.webui.systems.ssm.misc">
<title>System Set Manager &gt; Misc</title>
<simpara>On the <literal role="guimenu">Misc</literal> page, you can modify <literal role="guimenu">Custom System Information</literal>.
Click <literal role="guimenu">Set a custom value for selected systems</literal>, then the name of a key.
Enter values for all selected systems, then click the <guibutton>Set Values</guibutton> button.
To remove values for all selected systems, click <literal role="guimenu">Remove a custom value from selected systems</literal>, then the name of the key.
Click the <guibutton>Remove Values</guibutton> button to delete.</simpara>
<simpara>Set <literal role="guimenu">System Preferences</literal> via the respective radio buttons.</simpara>
<section xml:id="s4-sm-ssm-misc-updates-hw">
<title>System Set Manager  &gt;  Misc  &gt;  Hardware</title>
<simpara>Click the <literal role="guimenu">Hardware</literal> subtab to schedule a hardware profile refresh.
Click <guibutton>Confirm Refresh</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_misc_hardware_refresh.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm misc hardware refresh</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-ssm-misc-updates-sw">
<title>System Set Manager &gt;  Misc  &gt;  Software</title>
<simpara>Click the <literal role="guimenu">Software</literal> subtab, then the <guibutton>Confirm Refresh</guibutton> button to schedule a package profile update of the selected systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_misc_software_refresh.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm misc software refresh</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-ssm-misc-migrate">
<title>System Set Manager &gt;  Misc  &gt;  Migrate</title>
<simpara>Click the <literal role="guimenu">Migrate</literal> subtab to move selected systems to a selected organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_misc_migrate_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm misc migrate systems</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-ssm-misc-lock">
<title>System Set Manager &gt;  Misc  &gt;  Lock/Unlock</title>
<simpara>Select the <literal role="guimenu">Lock/Unlock</literal> subtab to select systems to be excluded from package updates.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_misc_lock_unlock.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm misc lock unlock</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Enter a <literal role="guimenu">Lock reason</literal> in the text box and click the <guibutton>Lock</guibutton> button.
Already locked systems can be unlocked on this page.
Select them and click <guibutton>Unlock</guibutton>.</simpara>
</section>
<section xml:id="s4-sm-ssm-misc-delete">
<title>System Set Manager &gt;  Misc  &gt;  Delete</title>
<simpara>Click the <literal role="guimenu">Delete</literal> subtab, to remove systems by deleting their system profiles.
Click the <guibutton>Confirm Deletion</guibutton> button to remove the selected profiles permanently.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_ssm_misc_delete_confirm.png" width="80%"/>
</imageobject>
<textobject><phrase>systems ssm misc delete confirm</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-ssm-misc-reboot">
<title>System Set Manager &gt;  Misc  &gt;  Reboot</title>
<simpara>Select the appropriate systems, then click the <literal role="guimenu">Reboot Systems</literal> link to select these systems for reboot.</simpara>
<simpara>To cancel a reboot action, see
<xref linkend="ref.webui.schedule.pending"/>.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.systems.bootstrapping">
<title>Bootstrapping (Salt)</title>
<simpara>The <literal role="guimenu">Bootstrapp Minions</literal> page allows you to bootstrap Salt minions from the Web UI.</simpara>
<figure>
<title>Bootstrapping</title>
<mediaobject>
<imageobject>
<imagedata fileref="bootstrapping.png" width="80%"/>
</imageobject>
<textobject><phrase>bootstrapping</phrase></textobject>
</mediaobject>
</figure>
<variablelist>
<title>Bootstrapping Parameters</title>
<varlistentry>
<term>Host</term>
<listitem>
<simpara>Place the FQDN of the minion to be bootstrapped within this field.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SSH Port</term>
<listitem>
<simpara>Place the SSH port that will be used to connect and bootstrap a machine.
The default is <literal>22</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>User</term>
<listitem>
<simpara>Input the minions user login.
The default is root.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Password</term>
<listitem>
<simpara>Input the minions login password.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Activation Key</term>
<listitem>
<simpara>Select the activation key (associated with a software source channel) that the minion should use to bootstrap with.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Disable SSH Strict Key Host Checking</term>
<listitem>
<simpara>This check box is selected by default.
This allows the script to auto-accept host keys without requiring a user to manually authenticate.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Manage System Completely via SSH (Will not Install an Agent)</term>
<listitem>
<simpara>If selected a system will automatically be configured to use SSH.
No other connection method will be configured.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Once your minion&#8217;s connection details have been filled in click the <guibutton>Bootstrap</guibutton> button.
When the minion has completed the bootstrap process, find your new minion listed on the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.</simpara>
</section>
<section xml:id="ref.webui.systems.visualization">
<title>Systems &gt; Visualization</title>
<simpara>You can visualize your virtualized, proxy, and systems group topologies.
Listed under <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Visualization</guimenuitem></menuchoice> you will find the <literal role="guimenu">Virtualization Hierarchy</literal>, <literal role="guimenu">Proxy Hierarchy</literal>, and <literal role="guimenu">Systems Grouping</literal> subpages.
This features allows you to search, filter, and partition systems by name, base channel, check-in date, group, etc.</simpara>
<simpara>To visualize your systems select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Visualization</guimenuitem></menuchoice>.</simpara>
<simpara>Click the <guibutton>Show Filters</guibutton> button in the upper right corner to open the filters panel.
On the <literal role="guimenu">Filtering</literal> tab, systems are filterable by name, base channel, installed products, or with special properties such as security, bug fix, and product enhancement advisories,
etc.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_visualization_filter_example.png" width="244%"/>
</imageobject>
<textobject><phrase>systems visualization filter example</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>On the <literal role="guimenu">Partitioning</literal> tab, systems may also be partitioned by check-in time.
Select the check-in date and time and click the <guibutton>Apply</guibutton> button.
The <guibutton>Clear</guibutton> button will revert current partition configuration.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_visualization_partition_example.png" width="244%"/>
</imageobject>
<textobject><phrase>systems visualization partition example</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>All elements of the network tree are selectable.
Clicking any element in the tree opens a box containing information about the selected systems and will be displayed in the top-right of the visualization area.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_visualization_selections_example.png" width="344%"/>
</imageobject>
<textobject><phrase>systems visualization selections example</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Systems shown in the visualization view may be added to System Set Manager (SSM) for futher management.
This can be performed in two ways:</simpara>
<itemizedlist>
<listitem>
<simpara>Select single systems and click the <guibutton>Add system to SSM</guibutton> button in the top-right detail box.</simpara>
</listitem>
<listitem>
<simpara>Add all visible child elements of any parent node in the view (visible means when filters have been applied) by clicking the <guibutton>Add Children to SSM</guibutton> button at the bottom of the selection details panel.</simpara>
</listitem>
</itemizedlist>
<section xml:id="ref.webui.systems.virtual.visualzation">
<title>Virtualization Hierarchy</title>
<simpara>The following is an example graphical representation tree of the virtual network hierarchy of virtual systems registered with SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_visualization_virtualization_hierarchy.png" width="80%"/>
</imageobject>
<textobject><phrase>systems visualization virtualization hierarchy</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.proxy.visualzation">
<title>Proxy Hierarchy</title>
<simpara>The following is an example graphical representation tree of the proxy network hierarchy of proxy systems and their clients registered with SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_proxy_heirarchy.png" width="80%"/>
</imageobject>
<textobject><phrase>systems proxy heirarchy</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.grouping.visualzation">
<title>Systems Grouping</title>
<simpara>The following is a graphical representation tree of the all systems registered with SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="visualization_system_grouping_all.png" width="80%"/>
</imageobject>
<textobject><phrase>visualization system grouping all</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Systems are grouped according to preconfigured systems groups, and they may also be grouped into various group compositions by using the multi-select box.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="visualization_system_grouping.png" width="80%"/>
</imageobject>
<textobject><phrase>visualization system grouping</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</section>
<section xml:id="ref.webui.systems.search">
<title>Systems &gt; Advanced Search</title>
<simpara>Carry out an <literal role="guimenu">Advanced Search</literal> on your systems according to the following criteria: network info, hardware devices, location, activity, packages, details, DMI info, and hardware.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_advanced_search.png" width="80%"/>
</imageobject>
<textobject><phrase>systems advanced search</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Refine searches using the <literal role="guimenu">Field to Search</literal> drop-down box, which is set to <literal role="guimenu">Name/Description</literal> by default.</simpara>
<simpara>The Activity selections (<literal role="guimenu">Days Since Last Check-in</literal>, for example) are useful in finding and removing outdated system profiles.</simpara>
<simpara>Type the keyword, select the criterion to search by, use the radio buttons to specify whether you want to query all systems or only those in the <literal role="guimenu">System Set Manager</literal>, and click the <guibutton>Search</guibutton> button.
To list all systems that do <emphasis>not</emphasis> match the criteria, select the <literal role="guimenu">Invert Result</literal> check box.</simpara>
<simpara>The results appear at the bottom of the page.
For details on how to use the resulting system list, refer to <xref linkend="ref.webui.systems.systems"/>.</simpara>
<note>
<simpara>If you add a distribution, newly synchronize channels, or register a system with a SUSE Manager server, it may take several minutes for it to be indexed and appear in search results.
To force the rebuild of the search index, enter <literal role="command">rhn-search cleanindex</literal> on the command line and wait until the rebuild is finished.</simpara>
</note>
</section>
<section xml:id="ref.webui.systems.activ-keys">
<title>Systems &gt; Activation Keys</title>
<simpara>Users with the Activation Key Administrator role (including SUSE Manager Administrators) can generate activation keys in the SUSE Manager Web UI.
With such an activation key, register a SUSE Linux Enterprise or Red Hat Enterprise Linux system, entitle the system to a SUSE Manager service level and subscribe the system to specific channels and system groups through the <literal role="command">rhnreg_ks</literal> command line utility.</simpara>
<note>
<simpara>System-specific activation keys created through the <literal role="guimenu">Reactivation</literal> subtab of the <literal role="guimenu">System Details</literal> page are not part of this list because they are not reusable across systems.</simpara>
</note>
<simpara>For more information about Activation Keys, see
<xref linkend="bp.key.managment"/>.</simpara>
<section xml:id="s3-sm-system-keys-manage">
<title>Managing Activation Keys</title>
<simpara>From the <literal role="guimenu">Activation Key</literal> page organize activation keys for channel management.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_activation_keys.png" width="80%"/>
</imageobject>
<textobject><phrase>systems activation keys</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To create an activation key:</simpara>
<orderedlist xml:id="pro.ref.manager.activationkey" numeration="arabic">
<title>Procedure: Creating Activation Keys</title>
<listitem>
<simpara>Select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice> from the left bar.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Create Key</literal> link at the upper right corner.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Description</literal>&#8201;&#8212;&#8201;Enter a <literal role="guimenu">Description</literal> to identify the generated activation key.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Key</literal>&#8201;&#8212;&#8201;Either choose automatic generation by leaving this field blank or enter the key you want to generate in the <literal role="guimenu">Key</literal> field. This string of characters can then be used with <literal role="command">rhnreg_ks</literal> to register client systems with SUSE Manager. Refer to <xref linkend="s3-sm-system-keys-multiple"/> for details.</simpara>
<warning>
<title>Allowed Characters</title>
<simpara>Do not insert commas or double quotes in the key.
All other characters are allowed, but <literal>&lt;&gt; (){}</literal> (this includes the space) will get removed automatically.
If the string is empty, a random one is generated.</simpara>
<simpara>Commas are problematic because they are used as separator when two or more activation keys are used at once.</simpara>
</warning>
</listitem>
<listitem>
<simpara><literal role="guimenu">Usage</literal>&#8201;&#8212;&#8201;The maximum number systems that can be registered with the activation key concurrently. Leave blank for unlimited use. Deleting a system profile reduces the usage count by one and registering a system profile with the key increases the usage count by one.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Base Channels</literal>&#8201;&#8212;&#8201;The primary channel for the key. This can be either the <literal>SUSE Manager Default</literal> channel, a SUSE provided channel, or a custom base channel.</simpara>
<simpara>Selecting <literal>SUSE Manager Default</literal> allows client systems to register with the SUSE-provided default channel that corresponds with their installed version of SUSE Linux Enterprise.
You can also associate the key with a custom base channel.
If a system using this key is not compatible with the selected channel, it will fall back to the SUSE Manager default channel.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Child Channels</literal>&#8201;&#8212;&#8201;When the base channel is selected the list of available child channels will get fetched and display in real time below the base channel.
Select the child channels you need (for example, the Tools child channel).</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Add-on System Types</literal>&#8201;&#8212;&#8201;The supplemental system types for the key, for example, Virtualization Host. All systems will receive these system types with the key.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Contact Method</literal> - Select how clients communicate with SUSE Manager. <literal role="guimenu">Default</literal> (Pull) waits for the client to check in. With <literal role="guimenu">Push via SSH</literal> and <literal role="guimenu">Push via SSH tunnel</literal> the server contacts the client via SSH (with or without tunnel) and pushes updates and actions, etc.</simpara>
<simpara>For more information about contact methods, see
<xref linkend="bp.systems.management"/>.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Universal Default</literal>&#8201;&#8212;&#8201;Select whether this key should be considered the primary activation key for your organization.</simpara>
<warning>
<title>Changing the Default Activation Key</title>
<simpara>Only one universal default activation key can be defined per organization.
If a universal key already exists for this organization, you will unset the currently used universal key by activating the check box.</simpara>
</warning>
</listitem>
<listitem>
<simpara>Click <guibutton>Create Activation Key</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>To create more activation keys, repeat the steps above.</simpara>
<simpara>After creating the unique key, it appears in the list of activation keys along with the number of times it has been used.
Only Activation Key Administrators can see this list.
At this point, you can configure the key further.
For example, associate the key with packages (for example, the <phrase role="package">rhncfg-actions</phrase>  package) and groups.
Systems registered with the key get automatically subscribed to them.</simpara>
<simpara>To change the settings of a key, click the key&#8217;s description in the list to display its <literal role="guimenu">Details</literal> page. Via additional tabs you can select packages, configuration channels, group membership, and view activated systems.
Modify the appropriate tab then click the <guibutton>Update Activation Key</guibutton> button.
To disassociate groups from a key, deselect them in the respective menus by <keycap>Ctrl</keycap>-clicking their highlighted names.
To remove a key entirely, click the <literal role="guimenu">Delete Key</literal> link in the upper right corner of the <literal role="guimenu">Details</literal> page.
In the upper right corner find also the <literal role="guimenu">Clone Key</literal> link.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_activation_key_details.png" width="80%"/>
</imageobject>
<textobject><phrase>systems activation key details</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Any (client tools) package installation requires that the Client Tools channel is available and the <literal role="guimenu">Provisioning</literal> check box is selected.
The Client Tools channel should be selected in the <literal role="guimenu">Child Channels</literal> listing below the selected base channel.</simpara>
<simpara>After creating the activation key, you can see in the <literal role="guimenu">Details</literal> tab a check box named <literal role="guimenu">Configuration File Deployment</literal>.
If you select it, all needed packages are automatically added to the <literal role="guimenu">Packages</literal> list.
In case of Salt clients the <literal role="guimenu">Configuration File Deployment</literal> option also ensures that highstate will get applied automatically.
By default, the following packages are added: <phrase role="package">rhncfg</phrase>, <phrase role="package">rhncfg-client</phrase>, and <phrase role="package">rhncfg-actions</phrase>.</simpara>
<simpara>If you select <literal role="guimenu">Virtualization Host</literal> you automatically get the following package: <phrase role="package">rhn-virtualization-host</phrase>.</simpara>
<simpara>Adding the <phrase role="package">osad</phrase> package makes sense to execute scheduled actions immediately after the schedule time.
When the activation key is created, you can add packages with selecting the key (<menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice>), then on the activation key details page, go for the <literal role="guimenu">Packages</literal> tab and add <phrase role="package">osad</phrase>.</simpara>
<simpara>To disable system activations with a key, uncheck the corresponding box in the <literal role="guimenu">Enabled</literal> column in the key list.
The key can be re-enabled by selecting the check box.
Click the <guibutton>Update Activation Keys</guibutton> button on the bottom right-hand corner of the page to apply your changes.</simpara>
</section>
<section xml:id="s3-sm-system-keys-multiple">
<title>Using Multiple Activation Keys at Once</title>
<simpara>Multiple activation keys can be specified at the command line or in a single autoinstallation profile.
This allows you to aggregate the aspects of various keys without re-creating a specific key for every system that you want to register, simplifying the registration and autoinstallation processes while slowing the growth of your key list.
Separate keys with a comma at the command line with <literal role="command">rhnreg_ks</literal> or in a {kickstart} profile in the <literal role="guimenu">Activation Keys</literal> tab of the <literal role="guimenu">Autoinstallation Details</literal> page.</simpara>
<simpara>Registering with multiple activation keys requires some caution.
Conflicts between some values cause registration to fail.
Conflicts in the following values do not cause registration to fail, a combination of values is applied: software packages, software child channels, and configuration channels.
Conflicts in the remaining properties are resolved in the following manner:</simpara>
<itemizedlist>
<listitem>
<simpara>Base software channels: registration fails.</simpara>
</listitem>
<listitem>
<simpara>System types: registration fails.</simpara>
</listitem>
<listitem>
<simpara>Enable configuration flag: configuration management is set.</simpara>
</listitem>
</itemizedlist>
<simpara>Do not use system-specific activation keys along with other activation keys; registration fails in this event.</simpara>
<simpara>You are now ready to use multiple activation keys at once.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.profiles">
<title>Systems &gt; Stored Profiles</title>
<simpara>SUSE Manager Provisioning customers can create package profiles via the <literal role="guimenu">System Details</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_stored_profiles.png" width="80%"/>
</imageobject>
<textobject><phrase>systems stored profiles</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Under <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice>, click <guibutton>Create System Profile</guibutton>.
Enter a <literal role="guimenu">Profile Name</literal> and <literal role="guimenu">Profile Description</literal>, then click <guibutton>Create Profile</guibutton>.
These profiles are displayed on the <literal role="guimenu">Stored Profiles</literal> page (left navigation bar), where they can be edited or deleted.</simpara>
<simpara>To edit a profile, click its name in the list, alter its name or description, and click the <guibutton>Update</guibutton> button.
To view software associated with the profile, click the <literal role="guimenu">Packages</literal> subtab.
To remove the profile entirely, click <literal role="guimenu">Delete Profile</literal> at the upper-right corner of the page.</simpara>
</section>
<section xml:id="ref.webui.systems.cust-info">
<title>Systems &gt; Custom System Info</title>
<simpara>SUSE Manager customers may include completely customizable information about their systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_custom_system_info.png" width="80%"/>
</imageobject>
<textobject><phrase>systems custom system info</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Unlike with notes, the information here is more formal and can be searched.
for example, you may decide to specify an asset tag for each system.
To do so, select <literal role="guimenu">Custom System Info</literal> from the left navigation bar and create an <literal>asset</literal> key.</simpara>
<simpara>Click <literal role="guimenu">Create Key</literal> in the upper-right corner of the page.
Enter a suitable label and description, such as <literal>Asset</literal> and <literal>Precise location of each system</literal>, then click <guibutton>Create Key</guibutton>.
The key will show up in the custom info keys list.</simpara>
<simpara>When the key exists, you may assign a value to it through the <literal role="guimenu">Custom Info</literal> tab of the <literal role="guimenu">System Details</literal> page.
Refer to <xref linkend="s5-sm-system-details-info"/> for instructions.</simpara>
</section>
<section xml:id="ref.webui.systems.autoinst">
<title>Autoinstallation</title>
<note>
<title>Autoinstallation Types: AutoYaST and Kickstart</title>
<simpara>In the following section, AutoYaST and AutoYaST features apply for SUSE Linux Enterprise client systems only.
For RHEL systems, use Kickstart and Kickstart features.</simpara>
</note>
<simpara>AutoYaST and Kickstart configuration files allow administrators to create an environment for automating otherwise time-consuming system installations, such as multiple servers or workstations. AutoYaST files have to be uploaded to be managed with SUSE Manager.
Kickstart files can be created, modified, and managed within the SUSE Manager Web interface.</simpara>
<simpara>SUSE Manager also features the Cobbler installation server.
For more information on Cobbler, see
<xref linkend="advanced.topics.cobbler"/>.</simpara>
<simpara>SUSE Manager provides an interface for developing Kickstart and AutoYaST profiles that can be used to install Red Hat Enterprise Linux or SUSE Linux Enterprise on either new or already-registered systems automatically according to certain specifications.</simpara>
<figure>
<title>Autoinstallation Overview</title>
<mediaobject>
<imageobject>
<imagedata fileref="systems_kickstart_overview.png" width="444%"/>
</imageobject>
<textobject><phrase>systems kickstart overview</phrase></textobject>
</mediaobject>
</figure>
<simpara>This overview page displays the status of automated installations (Kickstart and AutoYaST) on your client systems: the types and number of profiles you have created and the progress of systems that are scheduled to be installed using Kickstart or AutoYaST.
In the upper right area is the <guimenu>Autoinstallation Actions</guimenu> section, which contains a series of links to management actions for your Kickstart or AutoYaST  profiles.
Before explaining the various automated installation options on this page, the next two sections provide an introduction to AutoYaST  (<xref linkend="ref.webui.systems.autoinst.ay_intro"/>) and Kickstart (<xref linkend="ref.webui.systems.autoinst.kick_intro"/>).</simpara>
</section>
<section xml:id="ref.webui.systems.autoinst.ay_intro">
<title>Introduction to AutoYaST</title>
<simpara>Using AutoYaST, a system administrator can create a single file containing the answers to all the questions that would normally be asked during a typical installation of a SUSE Linux Enterprise system.</simpara>
<simpara>AutoYaST files can be kept on a single server system and read by individual computers during the installation.
This way the same AutoYaST file is used to install SUSE Linux Enterprise on multiple machines.</simpara>
<simpara>The <emphasis><phrase role="ref">SUSE Linux Enterprise Server AutoYaST Guide</phrase></emphasis> at (<link xl:href="https://www.suse.com/documentation/sles-15/">https://www.suse.com/documentation/sles-15/</link>) will contain an in-depth discussion of <quote>Automated Installation</quote> using AutoYaST.</simpara>
<section xml:id="s4-system-ay-intro-explain">
<title>AutoYaST Explained</title>
<simpara>When a machine is to receive a network-based AutoYaST installation, the following events must occur in this order:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>After being connected to the network and turned on, the machine&#8217;s PXE logic broadcasts its MAC address and requests to be discovered.</simpara>
</listitem>
<listitem>
<simpara>If no static IP address is used, the DHCP server recognizes the discovery request and offers network information needed for the new machine to boot. This includes an IP address, the default gateway to be used, the netmask of the network, the IP address of the TFTP or HTTP server holding the bootloader program, and the full path and file name to that program (relative to the server&#8217;s root).</simpara>
</listitem>
<listitem>
<simpara>The machine applies the networking information and initiates a session with the server to request the bootloader program.</simpara>
</listitem>
<listitem>
<simpara>The bootloader searches for its configuration file on the server from which it was loaded. This file dictates which Kernel and Kernel options, such as the initial RAM disk (initrd) image, should be executed on the booting machine. Assuming the bootloader program is SYSLINUX, this file is located in the <literal role="path">pxelinux.cfg</literal> directory on the server and named the hexadecimal equivalent of the new machine&#8217;s IP address. For example, a bootloader configuration file for SUSE Linux Enterprise Server should contain:</simpara>
<screen>port 0
prompt 0
timeout 1
default autoyast
label autoyast
  kernel vmlinuz
  append autoyast=http://`my_susemanager_server`/`path`\
    install=http://`my_susemanager_server`/`repo_tree`</screen>
</listitem>
<listitem>
<simpara>The machine accepts and uncompresses the initrd and kernel, boots the kernel, fetches the instsys from the install server and initiates the AutoYaST installation with the options supplied in the bootloader configuration file, including the server containing the AutoYaST configuration file.</simpara>
</listitem>
<listitem>
<simpara>The new machine is installed based on the parameters established within the AutoYaST configuration file.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="s4-system-ay-intro-prereq">
<title>AutoYaST Prerequisites</title>
<simpara>Some preparation is required for your infrastructure to handle AutoYaST installations.
For instance, before creating AutoYaST profiles, you may consider:</simpara>
<itemizedlist>
<listitem>
<simpara>A DHCP server is not required for AutoYaST, but it can make things easier. If you are using static IP addresses, you should select static IP while developing your AutoYaST profile.</simpara>
</listitem>
<listitem>
<simpara>Host the AutoYaST distribution trees via HTTP, properly provided by SUSE Manager.</simpara>
</listitem>
<listitem>
<simpara>If conducting a so-called bare-metal AutoYaST installation, provide the following settings:</simpara>
<itemizedlist>
<listitem>
<simpara>Configure DHCP to assign the required networking parameters and the bootloader program location.</simpara>
</listitem>
<listitem>
<simpara>In the bootloader configuration file, specify the kernel and appropriate kernel options to be used.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
<section xml:id="s4-system-ay-iso">
<title>Building Bootable AutoYaST ISOs</title>
<simpara>While you can schedule a registered system to be installed by AutoYaST with a new operating system and package profile, you can also automatically install a system that is not registered with SUSE Manager, or does not yet have an operating system installed.
One common method of doing this is to create a bootable CD-ROM that is inserted into the target system.
When the system is rebooted or switched on, it boots from the CD-ROM, loads the AutoYaST configuration from your SUSE Manager, and proceeds to install SUSE Linux Enterprise Server according to the AutoYaST profile you have created.</simpara>
<simpara>To use the CD-ROM, boot the system and type <literal>autoyast</literal> at the prompt (assuming you left the label for the AutoYaST  boot as <literal>autoyast</literal>). When you press <keycap>Enter</keycap>, the AutoYaST  installation begins.</simpara>
<simpara>For more information about image creation, refer to KIWI at <link xl:href="http://doc.opensuse.org/projects/kiwi/doc/">http://doc.opensuse.org/projects/kiwi/doc/</link>.</simpara>
</section>
<section xml:id="s4-system-ay-pxe">
<title>Integrating AutoYaST with PXE</title>
<simpara>In addition to CD-ROM-based installations, AutoYaST installation through a Pre-Boot Execution Environment (PXE) is supported.
This is less error-prone than CDs, enables AutoYaST installation from bare metal, and integrates with existing PXE/DHCP environments.</simpara>
<simpara>To use this method, make sure your systems have network interface cards (NIC) that support PXE, install and configure a PXE server, ensure DHCP is running, and place the installation repository on an HTTP server for deployment.
Finally upload the AutoYaST profile via the Web interface to the SUSE Manager server.
Once the AutoYaST profile has been created, use the URL from the <guimenu>Autoinstallation Overview</guimenu> page, as for CD-ROM-based installations.</simpara>
<simpara>To obtain specific instructions for conducting PXE AutoYaST installation, refer to the <emphasis>Using PXE Boot</emphasis> section of the <emphasis><phrase role="ref">SUSE Linux Enterprise Deployment Guide</phrase></emphasis>.</simpara>
<simpara>Starting with <xref linkend="ref.webui.systems.autoinst.profiles"/>, AutoYaST options available from <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Kickstart</guimenuitem></menuchoice> are described.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.autoinst.kick_intro">
<title>Introduction to Kickstart</title>
<simpara>Using Kickstart, a system administrator can create a single file containing the answers to all the questions that would normally be asked during a typical installation of Red Hat Enterprise Linux.</simpara>
<simpara>Kickstart files can be kept on a single server and read by individual computers during the installation.
This method allows you to use one Kickstart file to install Red Hat Enterprise Linux on multiple machines.</simpara>
<simpara>The <emphasis><phrase role="ref">Red Hat Enterprise Linux System Administration Guide</phrase></emphasis> contains an in-depth description of Kickstart (<link xl:href="https://access.redhat.com/documentation/en/red-hat-enterprise-linux/">https://access.redhat.com/documentation/en/red-hat-enterprise-linux/</link>).</simpara>
<section xml:id="s4-system-ks-intro-explain">
<title>Kickstart Explained</title>
<simpara>When a machine is to receive a network-based {kickstart}, the following events must occur in this order:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>After being connected to the network and turned on, the machine&#8217;s PXE logic broadcasts its MAC address and requests to be discovered.</simpara>
</listitem>
<listitem>
<simpara>If no static IP address is used, the DHCP server recognizes the discovery request and offers network information needed for the new machine to boot. This information includes an IP address, the default gateway to be used, the netmask of the network, the IP address of the TFTP or HTTP server holding the bootloader program, and the full path and file name of that program (relative to the server&#8217;s root).</simpara>
</listitem>
<listitem>
<simpara>The machine applies the networking information and initiates a session with the server to request the bootloader program.</simpara>
</listitem>
<listitem>
<simpara>The bootloader searches for its configuration file on the server from which it was loaded. This file dictates which kernel and kernel options, such as the initial RAM disk (initrd) image, should be executed on the booting machine. Assuming the bootloader program is SYSLINUX, this file is located in the <literal role="path">pxelinux.cfg</literal> directory on the server and named the hexadecimal equivalent of the new machine&#8217;s IP address. For example, a bootloader configuration file for Red Hat Enterprise Linux AS 2.1 should contain:</simpara>
<screen>port 0
prompt 0
timeout 1
default My_Label
label My_Label
      kernel vmlinuz
      append ks=http://`my_susemanager_server`/`path`\
          initrd=initrd.img network apic</screen>
</listitem>
<listitem>
<simpara>The machine accepts and uncompresses the init image and kernel, boots the kernel, and initiates a Kickstart installation with the options supplied in the bootloader configuration file, including the server containing the Kickstart configuration file.</simpara>
</listitem>
<listitem>
<simpara>This {kickstart} configuration file in turn directs the machine to the location of the installation files.</simpara>
</listitem>
<listitem>
<simpara>The new machine is built based on the parameters established within the Kickstart configuration file.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="s4-system-ks-intro-prereq">
<title>Kickstart Prerequisites</title>
<simpara>Some preparation is required for your infrastructure to handle {kickstart}s.
For instance, before creating Kickstart profiles, you may consider:</simpara>
<itemizedlist>
<listitem>
<simpara>A DHCP server is not required for kickstarting, but it can make things easier. If you are using static IP addresses, select static IP while developing your Kickstart profile.</simpara>
</listitem>
<listitem>
<simpara>An FTP server can be used instead of hosting the Kickstart distribution trees via HTTP.</simpara>
</listitem>
<listitem>
<simpara>If conducting a bare metal {kickstart}, you should configure DHCP to assign required networking parameters and the bootloader program location. Also, specify within the bootloader configuration file the kernel to be used and appropriate kernel options.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s4-system-ks-iso">
<title>Building Bootable Kickstart ISOs</title>
<simpara>While you can schedule a registered system to be kickstarted to a new operating system and package profile, you can also {kickstart} a system that is not registered with SUSE Manager or does not yet have an operating system installed.
One common method of doing this is to create a bootable CD-ROM that is inserted into the target system.
When the system is rebooted, it boots from the CD-ROM, loads the {kickstart} configuration from your SUSE Manager, and proceeds to install Red Hat Enterprise Linux according to the Kickstart profile you have created.</simpara>
<simpara>To do this, copy the contents of <literal role="path">/isolinux</literal> from the first CD-ROM of the target distribution.
Then edit the <literal role="path">isolinux.cfg</literal> file to default to 'ks'. Change the 'ks' section to the following template:</simpara>
<screen>label ks
kernel vmlinuz
  append text ks=`url`initrd=initrd.img lang= devfs=nomount \
    ramdisk_size=16438`ksdevice`</screen>
<simpara>IP address-based {kickstart} URLs will look like this:</simpara>
<screen>http://`my.manager.server`/kickstart/ks/mode/ip_range</screen>
<simpara>The {kickstart} distribution defined via the IP range should match the distribution from which you are building, or errors will occur. <literal role="replaceable">ksdevice</literal> is optional, but looks like:</simpara>
<screen>ksdevice=eth0</screen>
<simpara>It is possible to change the distribution for a Kickstart profile within a family, such as Red Hat Enterprise Linux AS 4 to Red Hat Enterprise Linux ES 4, by specifying the new distribution label.
Note that you cannot move between versions (4 to 5) or between updates (U1 to U2).</simpara>
<simpara>Next, customize <literal role="path">isolinux.cfg</literal> further for your needs by adding multiple Kickstart options, different boot messages, shorter timeout periods, etc.</simpara>
<simpara>Next, create the ISO as described in the <emphasis>Making an Installation Boot CD-ROM</emphasis> section of the <emphasis><phrase role="ref">Red Hat Enterprise Linux Installation Guide</phrase></emphasis>.
Alternatively, issue the command:</simpara>
<screen>mkisofs -o file.iso -b isolinux.bin -c boot.cat -no-emul-boot \
  -boot-load-size 4 -boot-info-table -R -J -v -T isolinux/</screen>
<simpara>Note that <literal role="path">isolinux/</literal> is the relative path to the directory containing the modified isolinux files copied from the distribution CD, while <literal role="path">file.iso</literal> is the output ISO file, which is placed into the current directory.</simpara>
<simpara>Burn the ISO to CD-ROM and insert the disc.
Boot the system and type "ks" at the prompt (assuming you left the label for the Kickstart boot as 'ks'). When you press <keycap>Enter</keycap>, Kickstart starts running.</simpara>
</section>
<section xml:id="s4-system-ks-pxe">
<title>Integrating Kickstart with PXE</title>
<simpara>In addition to CD-ROM-based installs, Kickstart supports a Pre-Boot Execution Environment (PXE). This is less error-prone than CDs, enables kickstarting from bare metal, and integrates with existing PXE/DHCP environments.</simpara>
<simpara>To use this method, make sure your systems have network interface cards (NIC) that support PXE.
Install and configure a PXE server and ensure DHCP is running.
Then place the appropriate files on an HTTP server for deployment.
Once the {kickstart} profile has been created, use the URL from the <guimenu>Kickstart Details</guimenu> page, as for CD-ROM-based installs.</simpara>
<simpara>To obtain specific instructions for conducting PXE {kickstart}s, refer to the <emphasis>PXE Network Installations</emphasis> chapter of the <emphasis><phrase role="ref">Red Hat Enterprise Linux 4 System Administration    Guide</phrase></emphasis>.</simpara>
<note>
<simpara>Running the Network Booting Tool, as described in the Red Hat Enterprise Linux 4: System Administration Guide, select "HTTP" as the protocol and include the domain name of the SUSE Manager in the Server field if you intend to use it to distribute the installation files.</simpara>
</note>
<simpara>The following sections describe the autoinstallation options available from the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Autoinstallation</guimenuitem></menuchoice> page.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.autoinst.profiles">
<title>Autoinstallation &gt; Profiles (Kickstart and AutoYaST)</title>
<simpara>This page lists all profiles for your organization, shows whether these profiles are active, and specifies the distribution tree with which each profile is associated.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_kickstart_overview.png" width="444%"/>
</imageobject>
<textobject><phrase>systems kickstart overview</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>You can either create a Kickstart profile by clicking the <literal role="guimenu">Create Kickstart Profile</literal> link, upload or paste the contents of a new profile clicking the <literal role="guimenu">Upload Kickstart/Autoyast File</literal>, or edit an existing Kickstart profile by clicking the name of the profile.
Note, you can only update AutoYaST profiles using the upload button.
You can also view AutoYaST profiles in the edit box or change the virtualization type using the selection list.</simpara>
<section xml:id="ref.webui.systems.autoinst.profiles.create">
<title>Create a Kickstart Profile</title>
<simpara>Click on the <literal role="guimenu">Create Kickstart Profile</literal> link from the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Autoinstallation</guimenuitem></menuchoice> page to start the wizard that populates the base values needed for a Kickstart profile.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="create_profile_wizard.png" width="444%"/>
</imageobject>
<textobject><phrase>create profile wizard</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Creating a Kickstart Profile</title>
<listitem>
<simpara>On the first line, enter a Kickstart profile label. This label cannot contain spaces, so use dashes (<literal>-</literal>) or underscores (<literal>\_</literal>) as separators.</simpara>
</listitem>
<listitem>
<simpara>Select a <literal role="guimenu">Base Channel</literal> for this profile, which consists of packages based on a specific architecture and Red Hat Enterprise Linux release.</simpara>
<note>
<title>Creating Base Channel</title>
<simpara>Base channels are only available if a suitable distribution is created first.
For creating distributions, see <xref linkend="ref.webui.systems.autoinst.distribution"/>.</simpara>
</note>
</listitem>
<listitem>
<simpara>Select an <literal role="guimenu">Kickstartable Tree</literal> for this profile. The <literal role="guimenu">Kickstartable Tree</literal> drop-down menu is only populated if one or more distributions have been created for the selected base channel (see <xref linkend="ref.webui.systems.autoinst.distribution"/>).</simpara>
</listitem>
<listitem>
<simpara>Instead of selecting a specific tree, you can also check the box <literal role="guimenu">Always use the newest Tree for this base channel</literal>. This setting lets SUSE Manager automatically pick the latest tree that is associated with the specified base channels. If you add new trees later, SUSE Manager will always keep the most recently created or modified.</simpara>
</listitem>
<listitem>
<simpara>Select the <literal role="guimenu">Virtualization Type</literal> from the drop-down menu.</simpara>
<note>
<simpara>If you do not intend to use the Kickstart profile to create virtual guest systems, you can leave the drop-down at the default <literal role="guimenu">None</literal> choice.</simpara>
</note>
</listitem>
<listitem>
<simpara>On the second page, select (or enter) the location of the Kickstart tree.</simpara>
</listitem>
<listitem>
<simpara>On the third page, select a root password for the system.</simpara>
</listitem>
</orderedlist>
<simpara>Depending on your base channel, your newly created Kickstart profile might be subscribed to a channel that is missing required packages.
For {kickstart} to work properly, the following packages should be present in its base channel: <literal role="package">pyOpenSSL</literal>, <literal role="package">rhnlib</literal>, <literal role="package">libxml2-python</literal>, and <literal role="package">spacewalk-koan</literal> and associated packages.</simpara>
<simpara>To resolve this issue:</simpara>
<itemizedlist>
<listitem>
<simpara>Make sure that the Tools software channel for the Kickstart profile&#8217;s base channel is available to your organization. If it is not, you must request entitlements for the Tools software channel from the SUSE Manager administrator.</simpara>
</listitem>
<listitem>
<simpara>Make sure that the Tools software channel for this Kickstart profile&#8217;s base channel is available to your SUSE Manager as a child channel.</simpara>
</listitem>
<listitem>
<simpara>Make sure that <literal role="package">rhn-kickstart</literal> and associated packages corresponding to this {kickstart} are available in the Tools child channel.</simpara>
</listitem>
</itemizedlist>
<simpara>The final stage of the wizard presents the <menuchoice><guimenu>Autoinstallation Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice> tab.
On this tab and the other subtabs, nearly every option for the new Kickstart profile can be customized.</simpara>
<simpara>Once created, you can access the Kickstart profile by downloading it from the <literal role="guimenu">Autoinstallation Details</literal> page by clicking the <literal role="guimenu">Autoinstallation File</literal> subtab and clicking the <literal role="guimenu">Download Autoinstallation File</literal> link.</simpara>
<simpara>If the Kickstart file is <emphasis>not</emphasis> managed by SUSE Manager, you can access it via the following URL:</simpara>
<screen>http://`my.manager.server`/ks/dist/ks-rhel-`ARCH`-`VARIANT`-`VERSION`</screen>
<simpara>In the above example, <literal role="replaceable">ARCH</literal> is the architecture of the Kickstart file, <literal role="replaceable">VARIANT</literal> is either <literal>client</literal> or <literal>server</literal>, and <literal role="replaceable">VERSION</literal> is the release of Red Hat Enterprise Linux associated with the Kickstart file.</simpara>
<simpara>The following sections describe the options available on each subtab.</simpara>
<section xml:id="s4-system-ks-details-details">
<title>Autoinstallation Details  &gt;  Details</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-3.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 3</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>On the <menuchoice><guimenu>Autoinstallation Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice> page, you have the following options:</simpara>
<itemizedlist>
<listitem>
<simpara>Change the profile <literal role="guimenu">Label</literal>.</simpara>
</listitem>
<listitem>
<simpara>Change the operating system by clicking <literal role="guimenu">(Change)</literal>.</simpara>
</listitem>
<listitem>
<simpara>Change the <literal role="guimenu">Virtualization Type</literal>.</simpara>
<note>
<simpara>Changing the <literal role="guimenu">Virtualization Type</literal> may require changes to the Kickstart profile bootloader and partition options, potentially overwriting user customizations.
Consult the <literal role="guimenu">Partitioning</literal> tab to verify any new or changed settings.</simpara>
</note>
</listitem>
<listitem>
<simpara>Change the amount of <literal role="guimenu">Virtual Memory</literal> (in Megabytes of RAM) allocated to virtual guests autoinstalled with this profile.</simpara>
</listitem>
<listitem>
<simpara>Change the number of <literal role="guimenu">Virtual CPUs</literal> for each virtual guest.</simpara>
</listitem>
<listitem>
<simpara>Change the <literal role="guimenu">Virtual Storage Path</literal> from the default in <literal role="path">/var/lib/xen/</literal> .</simpara>
</listitem>
<listitem>
<simpara>Change the amount of <literal role="guimenu">Virtual Disk Space</literal> (in GB) allotted to each virtual guest.</simpara>
</listitem>
<listitem>
<simpara>Change the <literal role="guimenu">Virtual Bridge</literal> for networking of the virtual guest.</simpara>
</listitem>
<listitem>
<simpara>Deactivate the profile so that it cannot be used to schedule a {kickstart} by removing the <literal role="guimenu">Active</literal> check mark.</simpara>
</listitem>
<listitem>
<simpara>Check whether to enable logging for custom <literal role="option">%post</literal> scripts to the <literal role="path">/root/ks-post.log</literal> file.</simpara>
</listitem>
<listitem>
<simpara>Decide whether to enable logging for custom <literal role="option">%pre</literal> scripts to the <literal role="path">/root/ks-pre.log</literal> file.</simpara>
</listitem>
<listitem>
<simpara>Choose whether to preserve the <literal role="path">ks.cfg</literal> file and all <literal>%include</literal> fragments to the <literal role="path">/root/</literal> directory of all systems autoinstalled with this profile.</simpara>
</listitem>
<listitem>
<simpara>Select whether this profile is the default for all of your organization&#8217;s {kickstart}s by checking or unchecking the box.</simpara>
</listitem>
<listitem>
<simpara>Add any <literal role="guimenu">Kernel Options</literal> in the corresponding text box.</simpara>
</listitem>
<listitem>
<simpara>Add any <literal role="guimenu">Post Kernel Options</literal> in the corresponding text box.</simpara>
</listitem>
<listitem>
<simpara>Enter comments that are useful to you in distinguishing this profile from others.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s4-system-ks-details-options">
<title>Autoinstallation Details &gt;  Operating System</title>
<simpara>On this page, you can make the following changes to the operating system that the Kickstart profile installs:</simpara>
<variablelist>
<varlistentry>
<term>Change the base channel</term>
<listitem>
<simpara>Select from the available base channels. SUSE Manager administrators see a list of all base channels that are currently synced to the SUSE Manager.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Child Channels</term>
<listitem>
<simpara>Subscribe to available child channels of the base channel, such as the Tools channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Available Trees</term>
<listitem>
<simpara>Use the drop-down menu to choose from available trees associated with the base channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Always use the newest Tree for this base channel.</term>
<listitem>
<simpara>Instead of selecting a specific tree, you can also check the box <guimenu>Always use the newest Tree for this base channel.</guimenu>
This setting lets SUSE Manager automatically pick the latest tree that is associated with the specified base channels.
If you add new trees later, SUSE Manager will always keep the most recently created or modified.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Software URL (File Location)</term>
<listitem>
<simpara>The exact location from which the Kickstart tree is mounted.
This value is determined when the profile is created.
You can view it on this page but you cannot change it.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="s4-sm-system-kick-details-variables">
<title>Autoinstallation Details &gt;  Variables</title>
<simpara>Autoinstallation variables can substitute values in Kickstart and AutoYaST profiles.
To define a variable, create a name-value pair (<literal role="replaceable">name/value</literal>) in the text box.</simpara>
<simpara>For example, if you want to autoinstall a system that joins the network of a specified organization (for example the Engineering department), you can create a profile variable to set the IP address and the gateway server address to a variable that any system using that profile will use.
Add the following line to the <literal role="guimenu">Variables</literal> text box.</simpara>
<screen>IPADDR=192.168.0.28
GATEWAY=192.168.0.1</screen>
<simpara>Now you can use the name of the variable in the profile instead of a specific value.
For example, the <literal role="option">network</literal> part of a Kickstart file looks like the following:</simpara>
<screen>network --bootproto=static --device=eth0 --onboot=on --ip=$IPADDR \
  --gateway=$GATEWAY</screen>
<simpara>The <literal role="option">$IPADDR</literal> will be resolved to <literal>192.168.0.28</literal>, and the <literal role="option">$GATEWAY</literal> to <literal>192.168.0.1</literal></simpara>
<note>
<simpara>There is a hierarchy when creating and using variables in Kickstart files.
System Kickstart variables take precedence over <literal role="guimenu">Profile</literal> variables, which in turn take precedence over <literal role="guimenu">Distribution</literal> variables.
Understanding this hierarchy can alleviate confusion when using variables in {kickstart}s.</simpara>
</note>
<simpara>Using variables are just one part of the larger Cobbler infrastructure for creating templates that can be shared between multiple profiles and systems.
For more information about Cobbler and templates, refer to
<xref linkend="advanced.topics.cobbler"/>.</simpara>
</section>
<section xml:id="s4-sm-system-kick-details-advanced">
<title>Autoinstallation Details &gt;  Advanced Options</title>
<simpara>From this page, you can toggle several installation options on and off by checking and unchecking the boxes to the left of the option.
For most installations, the default options are correct.
Refer to Red Hat Enterprise Linux documentation for details.</simpara>
</section>
<section xml:id="s4-sm-system-kick-details-defprofile">
<title>Assigning Default Profiles to an Organization</title>
<simpara>You can specify an Organization Default Profile by clicking <menuchoice><guimenu>Autoinstallation</guimenu> <guisubmenu>Profiles</guisubmenu> <guisubmenu>profile name</guisubmenu> <guimenuitem>Details</guimenuitem></menuchoice>, then checking the <literal role="guimenu">Organization Default Profile</literal> box and finally clicking <literal role="guimenu">Update</literal>.</simpara>
</section>
<section xml:id="s4-sm-system-kick-details-iprange">
<title>Assigning IP Ranges to Profiles</title>
<simpara>You can associate an IP range to an autoinstallation profile by clicking on <menuchoice><guimenu>Autoinstallation</guimenu> <guisubmenu>Profiles</guisubmenu> <guisubmenu>profile name</guisubmenu> <guimenuitem>Bare Metal Autoinstallation</guimenuitem></menuchoice>, adding an IPv4 range and finally clicking <guimenu>Add IP Range</guimenu>.</simpara>
</section>
<section xml:id="s4-sm-system-kick-details-packages">
<title>Autoinstallation Details &gt;  Bare Metal Autoinstallation</title>
<simpara>This subtab provides the information necessary to Kickstart systems that are not currently registered with SUSE Manager.
Using the on-screen instructions, you may either autoinstall systems using boot media (CD-ROM) or by IP address.</simpara>
</section>
<section xml:id="s4-sm-system-kick-details-pre">
<title><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>Displays subtabs that are available from the <literal role="guimenu">System Details</literal> tab.</simpara>
<simpara>On the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice> page, you have the following options:</simpara>
<itemizedlist>
<listitem>
<simpara>Select between DHCP and static IP, depending on your network.</simpara>
</listitem>
<listitem>
<simpara>Choose the level of SELinux that is configured on kickstarted systems.</simpara>
</listitem>
<listitem>
<simpara>Enable configuration management or remote command execution on kickstarted systems.</simpara>
</listitem>
<listitem>
<simpara>Change the root password associated with this profile.</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-4.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 4</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s4-sm-system-kick-details-post">
<title>System Details &gt;  Locale</title>
<simpara>Change the timezone for kickstarted systems.</simpara>
</section>
<section xml:id="s4-system-ks-sysd-partition">
<title>System Details &gt;  Partitioning</title>
<simpara>From this subtab, indicate the partitions that you wish to create during installation.
For example:</simpara>
<screen>partition /boot --fstype=ext3 --size=200
partition swap --size=2000
partition pv.01 --size=1000 --grow
volgroup myvg pv.01 logvol / --vgname=myvg --name=rootvol --size=1000 --grow</screen>
</section>
<section xml:id="s4-system-ks-sysd-file-pres">
<title>System Details &gt;  File Preservation</title>
<simpara>If you have previously created a file preservation list, include this list as part of the {kickstart}.
This will protect the listed files from being over-written during the installation process.
Refer to <xref linkend="ref.webui.systems.autoinst.preserve"/> for information on how to create a file preservation list.</simpara>
</section>
<section xml:id="s4-system-ks-sysd-gpg-ssl">
<title>System Details &gt;  GPG &amp; SSL</title>
<simpara>From this subtab, select the GPG keys and/or SSL certificates to be exported to the kickstarted system during the %post section of the {kickstart}.
For SUSE Manager customers, this list includes the SSL Certificate used during the installation of SUSE Manager.</simpara>
<note>
<simpara>Any GPG key you wish to export to the kickstarted system must be in ASCII rather than binary format.</simpara>
</note>
</section>
<section xml:id="s4-system-ks-sysd-trouble">
<title>System Details &gt;  Troubleshooting</title>
<simpara>From this subtab, change information that may help with troubleshooting hardware problems:</simpara>
<variablelist>
<varlistentry>
<term>Bootloader</term>
<listitem>
<simpara>For some headless systems, it is better to select the non-graphic LILO bootloader.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Kernel Parameters</term>
<listitem>
<simpara>Enter kernel parameters here that may help to narrow down the source of hardware issues.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="s4-system-ks-soft-pkg-group">
<title>Software &gt;  Package Groups</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-5.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 5</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The image above shows subtabs that are available from the <literal role="guimenu">Software</literal> tab.</simpara>
<simpara>Enter the package groups, such as <literal role="systemitem">@office</literal> or <literal role="systemitem">@admin-tools</literal> you would like to install on the kickstarted system in the large text box.
If you would like to know what package groups are available, and what packages they contain, refer to the <literal role="path">RedHat/base/</literal> file of your Kickstart tree.</simpara>
</section>
<section xml:id="s4-system-ks-soft-pkg-profile">
<title>Software &gt;  Package Profiles</title>
<simpara>If you have previously created a Package Profile from one of your registered systems, you can use that profile as a template for the files to be installed on a kickstarted system.
Refer to
<xref linkend="s4-sm-system-details-packages"/>
for more information about package profiles.</simpara>
</section>
<section xml:id="s4-system-ks-act-keys">
<title>Activation Keys</title>
<figure>
<title>Activation Keys</title>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-6.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 6</phrase></textobject>
</mediaobject>
</figure>
<simpara>The <literal role="guimenu">Activation Keys</literal> tab allows you to select Activation Keys to include as part of the Kickstart profile.
These keys, which must be created before the Kickstart profile, will be used when re-registering kickstarted systems.</simpara>
</section>
<section xml:id="s4-system-ks-scripts">
<title>Scripts</title>
<figure>
<title>Scripts</title>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-7.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 7</phrase></textobject>
</mediaobject>
</figure>
<simpara>The <literal role="guimenu">Scripts</literal> tab is where <literal role="option">%pre</literal> and <literal role="option">%post</literal> scripts are created.
This page lists any scripts that have already been created for this Kickstart profile.
To create a Kickstart script, perform the following procedure:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click the <literal role="guimenu">add new kickstart script</literal> link in the upper right corner.</simpara>
</listitem>
<listitem>
<simpara>Enter the path to the scripting language used to create the script, such as <literal>/usr/bin/perl</literal>.</simpara>
</listitem>
<listitem>
<simpara>Enter the full script in the large text box.</simpara>
</listitem>
<listitem>
<simpara>Indicate whether this script is to be executed in the <literal role="option">%pre</literal> or <literal role="option">%post</literal> section of the Kickstart process.</simpara>
</listitem>
<listitem>
<simpara>Indicate whether this script is to run outside of the chroot environment. Refer to the <emphasis><phrase role="ref">Post-installation Script</phrase></emphasis> section of the <emphasis><phrase role="ref">Red Hat Enterprise Linux System Administration Guide</phrase></emphasis> for further explanation of the <literal role="option">nochroot</literal> option.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>SUSE Manager supports the inclusion of separate files within the Partition Details section of the Kickstart profile.
For instance, you may dynamically generate a partition file based on the machine type and number of disks at {kickstart} time.
This file can be created via <literal role="option">%pre</literal> script and placed on the system, such as <literal role="path">/tmp/part-include</literal>.
Then you can call for that file by entering the following line in the Partition Details field of the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Partitioning</guimenuitem></menuchoice> tab:</simpara>
<screen>%include /tmp/part-include</screen>
</note>
</section>
<section xml:id="s4-system-ks-ks-file">
<title>Autoinstallation File</title>
<figure>
<title>Autoinstallation File</title>
<mediaobject>
<imageobject>
<imagedata fileref="details-ks-8.png" width="444%"/>
</imageobject>
<textobject><phrase>details ks 8</phrase></textobject>
</mediaobject>
</figure>
<simpara>The <literal role="guimenu">Autoinstallation File</literal> tab allows you to view or download the profile that has been generated from the options chosen in the previous tabs.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.autoinst.profiles.upload">
<title>Upload Kickstart/AutoYaST File</title>
<simpara>Click the <literal role="guimenu">Upload Kickstart/Autoyast File</literal> link from the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Autoinstallation</guimenuitem></menuchoice> page to upload an externally prepared AutoYaST or Kickstart profile.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>In the first line, enter a profile <literal role="guimenu">Label</literal> for the automated installation. This label[] drop-down menu is only populated if one or more distributions have been created for the selected base channel (see <xref linkend="ref.webui.systems.autoinst.distribution"/>).</simpara>
</listitem>
<listitem>
<simpara>Instead of selecting a specific tree, you can also check the box <literal role="guimenu">Always use the newest Tree</literal> for this base channel. This setting lets SUSE Manager automatically pick the latest tree that is associated with the specified base channels. If you add new trees later, SUSE Manager will always keep the most recently created or modified.</simpara>
</listitem>
<listitem>
<simpara>Select the <literal role="guimenu">Virtualization Type</literal> from the drop-down menu. For more information about virtualization, refer to
<xref linkend="advanced.topics.virtualization"/>.</simpara>
<note>
<simpara>If you do not intend to use the autoinstall profile to create virtual guest systems, you can leave the drop-down set to the default choice <literal role="guimenu">KVM Virtualized Guest</literal>.</simpara>
</note>
</listitem>
<listitem>
<simpara>Finally, either provide the file contents with cut-and-paste or update the file from the local storage medium:</simpara>
<itemizedlist>
<listitem>
<simpara>Paste it into the <literal role="guimenu">File Contents</literal> box and click <literal role="guimenu">Create</literal>, or</simpara>
</listitem>
<listitem>
<simpara>enter the file name in the <literal role="guimenu">File to Upload</literal> field and click <guibutton>Upload File</guibutton>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>Once done, four subtabs are available:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Details</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Bare Metal</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Variables</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Autoinstallable File</literal></simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="ref.webui.systems.autoinst.bare_metal">
<title>Autoinstallation &gt;  Bare Metal</title>
<simpara>Lists the IP addresses that have been associated with the profiles created by your organization.
Click either the range or the profile name to access different tabs of the <literal role="guimenu">Autoinstallation Details</literal> page.</simpara>
</section>
<section xml:id="ref.webui.systems.autoinst.keys">
<title>Autoinstallation &gt;  GPG and SSL Keys</title>
<simpara>Lists keys and certificates available for inclusion in {kickstart} profiles and provides a means to create new ones.
This is especially important for customers of SUSE Manager or the Proxy Server because systems kickstarted by them must have the server key imported into SUSE Manager and associated with the relevant {kickstart} profiles.
Import it by creating a new key here and then make the profile association in the <literal role="guimenu">GPG and SSL keys</literal> subtab of the <literal role="guimenu">Autoinstallation Details</literal> page.</simpara>
<simpara>To create a key or certificate, click the <literal role="guimenu">Create Stored Key/Cert</literal> link in the upper-right corner of the page.
Enter a description, select the type, upload the file, and click the <guibutton>Update Key</guibutton> button.
A unique description is required.</simpara>
<important>
<simpara>The GPG key you upload to SUSE Manager must be in ASCII format.
Using a GPG key in binary format causes anaconda, and therefore the {kickstart} process, to fail.</simpara>
</important>
</section>
<section xml:id="ref.webui.systems.autoinst.distribution">
<title>Autoinstallation &gt;  Distributions</title>
<simpara>The <literal role="guimenu">Distributions</literal> page enables you to find and create custom installation trees that may be used for automated installations.</simpara>
<note>
<simpara>The <literal role="guimenu">Distributions</literal> page does not display distributions already provided.
They can be found within the <literal role="guimenu">Distribution</literal> drop-down menu of the <literal role="guimenu">Autoinstallation Details</literal> page.</simpara>
<simpara>Before creating a distribution, you must make an installation data available, as described in the <emphasis><phrase role="ref">SUSE Linux Enterprise Deployment Guide</phrase></emphasis> (<link xl:href="https://www.suse.com/documentation/sles-12/singlehtml/book_sle_deployment/book_sle_deployment.html">https://www.suse.com/documentation/sles-12/singlehtml/book_sle_deployment/book_sle_deployment.html</link>) or, respectively, the <emphasis>Kickstart Installations</emphasis> chapter of the <emphasis><phrase role="ref">Red Hat Enterprise Linux System Administration Guide</phrase></emphasis>.
This tree must be located in a local directory on the SUSE Manager server.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure: Creating a Distribution for Autoinstallation</title>
<listitem>
<simpara>To create a distribution, on the <literal role="guimenu">Autoinstallable Distributions</literal> page click <literal role="guimenu">Create Distribution</literal> in the upper right corner.</simpara>
</listitem>
<listitem>
<simpara>On the <literal role="guimenu">Create Autoinstallable Distribution</literal> page, provide the following data:</simpara>
<itemizedlist>
<listitem>
<simpara>Enter a label (without spaces) in the <literal role="guimenu">Distribution Label</literal> field, such as <literal>my-orgs-sles-12-sp2</literal> or <literal>my-orgs-rhel-as-7</literal>.</simpara>
</listitem>
<listitem>
<simpara>In the <guimenu>Tree Path</guimenu> field, paste the path to the base of the installation tree.</simpara>
</listitem>
<listitem>
<simpara>Select the matching distribution from the <literal role="guimenu">Base Channel</literal> and <literal role="guimenu">Installer Generation</literal> drop-down menus, such as <literal>SUSE Linux</literal> for SUSE Linux Enterprise, or <literal>Red Hat Enterprise Linux 7</literal> for Red Hat Enterprise Linux 7 client systems.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>When finished, click the <guibutton>Create Autoinstallable Distribution</guibutton> button.</simpara>
</listitem>
</orderedlist>
<section xml:id="s4-sm-system-kick-dist-variables">
<title>Autoinstallation &gt;  Distributions  &gt;  Variables</title>
<simpara>Autoinstallation variables can be used to substitute values into Kickstart and AutoYaST profiles.
To define a variable, create a name-value pair (<literal role="replaceable">name/value</literal>) in the text box.</simpara>
<simpara>For example, if you want to autoinstall a system that joins the network of a specified organization (for example the Engineering department) you can create a profile variable to set the IP address and the gateway server address to a variable that any system using that profile will use.
Add the following line to the <literal role="guimenu">Variables</literal> text box.</simpara>
<screen>IPADDR=192.168.0.28
GATEWAY=192.168.0.1</screen>
<simpara>To use the distribution variable, use the name of the variable in the profile to substitute the value.
For example, the <literal role="option">network</literal> part of a {kickstart} file looks like the following:</simpara>
<screen>network --bootproto=static --device=eth0 --onboot=on --ip=$IPADDR \
  --gateway=$GATEWAY</screen>
<simpara>The <literal role="option">$IPADDR</literal> will be resolved to <literal>192.168.0.28</literal>, and the <literal role="option">$GATEWAY</literal> to <literal>192.168.0.1</literal>.</simpara>
<note>
<simpara>There is a hierarchy when creating and using variables in Kickstart files.
System Kickstart variables take precedence over Profile variables, which in turn take precedence over Distribution variables.
Understanding this hierarchy can alleviate confusion when using variables in {kickstart}s.</simpara>
</note>
<simpara>In AutoYaST profiles you can use such variables as well.</simpara>
<simpara>Using variables are just one part of the larger Cobbler infrastructure for creating templates that can be shared between multiple profiles and systems.
For more information about Cobbler and templates, refer to
<xref linkend="advanced.topics.cobbler"/>.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.autoinst.preserve">
<title>Autoinstallation &gt;  File Preservation</title>
<simpara>Collects lists of files to be protected and re-deployed on systems during {kickstart}.
For instance, if you have many custom configuration files located on a system to be kickstarted, enter them here as a list and associate that list with the Kickstart profile to be used.</simpara>
<simpara>To use this feature, click the <literal role="guimenu">Create File Preservation List</literal> link at the top.
Enter a suitable label and all files and directories to be preserved.
Enter absolute paths to all files and directories.
Then click <guibutton>Create List</guibutton>.</simpara>
<important>
<simpara>Although file preservation is useful, it does have limitations.
Each list is limited to a total size of 1 MB.
Special devices like <literal role="path">/dev/hda1</literal> and <literal role="path">/dev/sda1</literal> are not supported.
Only file and directory names may be entered.
No regular expression wildcards can be used.</simpara>
</important>
<simpara>When finished, you may include the file preservation list in the Kickstart profile to be used on systems containing those files.
Refer to <xref linkend="ref.webui.systems.autoinst.profiles.create"/> for precise steps.</simpara>
</section>
<section xml:id="ref.webui.systems.autoinst.snippet">
<title>Autoinstallation &gt;  Autoinstallation Snippets</title>
<simpara>Use snippets to store common blocks of code that can be shared across multiple Kickstart or AutoYaST profiles in SUSE Manager.</simpara>
<section xml:id="s4-sm-system-kick-snippet-default">
<title>Autoinstallation  &gt;  Autoinstallation Snippets  &gt;  Default Snippets</title>
<simpara>Default snippets coming with SUSE Manager are not editable.
You can use a snippet, if you add the <literal role="guimenu">Snippet Macro</literal> statement such as <literal>$SNIPPET('spacewalk/sles_register_script')</literal> to your autoinstallation profile.
This is an AutoYaST profile example:</simpara>
<screen>&lt;init-scripts config:type="list"&gt;
  $SNIPPET('spacewalk/sles_register_script')
&lt;/init-scripts&gt;</screen>
<simpara>When you create a snippet with the <literal role="guimenu">Create Snippet</literal> link, all profiles including that snippet will be updated accordingly.</simpara>
</section>
<section xml:id="s4-sm-system-kick-snippet-custom">
<title>Autoinstallation &gt;  Autoinstallation Snippets  &gt;  Custom Snippets</title>
<simpara>This is the tab with custom snippets.
Click a name of a snippet to view, edit, or delete it.</simpara>
</section>
<section xml:id="s4-sm-system-kick-snippet-all">
<title>Autoinstallation &gt;  Autoinstallation Snippets  &gt;  All Snippets</title>
<simpara>q
The <literal role="guimenu">All Snippets</literal> tab lists default and custom snippets together.</simpara>
</section>
</section>
<section xml:id="ref.webui.systems.virt-host-managers">
<title>Systems &gt; Virtual Host Managers</title>
<simpara>Third party hypervisors and hypervisor managers such as VMWare vCenter are called <quote>Virtual Host Managers</quote> (VHM) within SUSE Manager.
These managers can manage one or multiple virtual hosts, which in turn may contain virtual guests. SUSE Manager ships with a tool called <literal role="command">virtual-host-gatherer</literal> that can connect to VHMs using their API, and request information about virtual hosts.
This tool is automatically invoked via Taskomatic nightly, therefore you need to configure your VHMs via XMLRPC APIs. <literal role="command">virtual-host-gatherer</literal> maintains the concept of optional modules, where each module enables a specific Virtual Host Manager.</simpara>
<simpara>Proceed to <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> page in the Web UI to begin working with a Virtual Host Manager.
In the upper right click <guibutton>Create</guibutton> and select either <literal role="guimenu">VMware-based</literal> or <literal role="guimenu">File-based</literal>.</simpara>
<section xml:id="ref.webui.systems.virt-host-managers.vmware">
<title>VMware-Based</title>
<simpara>After selecting <menuchoice><guimenu>Create</guimenu> <guimenuitem>VMware-based</guimenuitem></menuchoice> enter the location of your VMware-based virtual host.
Enter a <literal role="guimenu">Label</literal>, <literal role="guimenu">Hostname</literal>, <literal role="guimenu">Port</literal>, <literal role="guimenu">Username</literal> and <literal role="guimenu">Password</literal>.
Finally click the <guibutton>Add Virtual Host Manager</guibutton> button.
For detailed information on working with a VMware-based Virtual Host Manager, see
<xref linkend="advanced.topics.adding.vmware.esxi.host"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_virtual_host_managers_vmware.png" width="80%"/>
</imageobject>
<textobject><phrase>systems virtual host managers vmware</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.systems.virt-host-managers.file">
<title>File-Based</title>
<simpara>In a VMWare environment where direct connection to the SUSE Manager Server is not possible, a JSON file can be exported from the ESXi or vSphere host and later imported into SUSE Manager via this option.</simpara>
<simpara>After selecting <menuchoice><guimenu>Create</guimenu> <guimenuitem>File-Based</guimenuitem></menuchoice> enter a label and URL leading to the location of this file.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_virtual_host_managers_file.png" width="80%"/>
</imageobject>
<textobject><phrase>systems virtual host managers file</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<title>VMWare vCenter Installations without Direct Access</title>
<simpara>The file-based is not meant to be used with manually crafted files.
It only meant to be used with the output of <literal role="command">virtual-host-gatherer</literal> against some other module.
File-based is suitable for VMWare vCenter installations for which no direct API access is possible from the SUSE Manager Server.</simpara>
<simpara>The solution is to run <literal role="command">virtual-host-gatherer</literal> from somewhere else in the network and save the produced JSON data for further processing.</simpara>
</note>
<simpara>The following JSON data is an example of the exported information in the file:</simpara>
<screen>{
    "examplevhost": {
        "10.11.12.13": {
            "cpuArch": "x86_64",
            "cpuDescription": "AMD Opteron(tm) Processor 4386",
            "cpuMhz": 3092.212727,
            "cpuVendor": "amd",
            "hostIdentifier": "'vim.HostSystem:host-182'",
            "name": "11.11.12.13",
            "os": "VMware ESXi",
            "osVersion": "5.5.0",
            "ramMb": 65512,
            "totalCpuCores": 16,
            "totalCpuSockets": 2,
            "totalCpuThreads": 16,
            "type": "vmware",
            "vms": {
                "vCenter": "564d6d90-459c-2256-8f39-3cb2bd24b7b0"
            }
        },
        "10.11.12.14": {
            "cpuArch": "x86_64",
            "cpuDescription": "AMD Opteron(tm) Processor 4386",
            "cpuMhz": 3092.212639,
            "cpuVendor": "amd",
            "hostIdentifier": "'vim.HostSystem:host-183'",
            "name": "10.11.12.14",
            "os": "VMware ESXi",
            "osVersion": "5.5.0",
            "ramMb": 65512,
            "totalCpuCores": 16,
            "totalCpuSockets": 2,
            "totalCpuThreads": 16,
            "type": "vmware",
            "vms": {
                "49737e0a-c9e6-4ceb-aef8-6a9452f67cb5": "4230c60f-3f98-2a65-f7c3-600b26b79c22",
                "5a2e4e63-a957-426b-bfa8-4169302e4fdb": "42307b15-1618-0595-01f2-427ffcddd88e",
                "NSX-gateway": "4230d43e-aafe-38ba-5a9e-3cb67c03a16a",
                "NSX-l3gateway": "4230b00f-0b21-0e9d-dfde-6c7b06909d5f",
                "NSX-service": "4230e924-b714-198b-348b-25de01482fd9"
            }
        }
    }
}</screen>
<simpara>For more information, see the man page on your SUSE Manager server for <literal role="command">virtual-host-gatherer</literal>:</simpara>
<screen>{prompt.user}man virtual-host-gatherer</screen>
<simpara>The <literal>README</literal> file coming with the package provides background information about the <literal>type</literal> of a hypervisor, etc.:</simpara>
<screen>/usr/share/doc/packages/virtual-host-gatherer/README.md</screen>
</section>
<section xml:id="_configuring_virtual_host_managers_via_xmlrpc_api">
<title>Configuring Virtual Host Managers via XMLRPC API</title>
<simpara>The following APIs allow you to get a list of available <literal role="command">virtual-host-manager</literal> modules and the parameters they require:</simpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.listAvailableVirtualHostGathererModules(session)</screen>
</listitem>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.getModuleParameters(session, moduleName)</screen>
</listitem>
</itemizedlist>
<simpara>The following APIs allow you to create and delete VHMs.
The module parameter map must match the map returned by <literal>virtualhostmanager.getModuleParameters</literal> to work correctly:</simpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.create(session, label, moduleName, parameters)</screen>
</listitem>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.delete(session, label)</screen>
</listitem>
</itemizedlist>
<simpara>The following APIs return information about configured VHMs:</simpara>
<itemizedlist>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.listVirtualHostManagers(session)</screen>
</listitem>
<listitem>
<simpara></simpara>
<screen>virtualhostmanager.getDetail(session, label)</screen>
</listitem>
</itemizedlist>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.salt">
<title>Salt</title>
<simpara>Open <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Salt</guimenuitem></menuchoice> from the left navigation sidebar.
<menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Salt</guisubmenu> <guimenuitem>Keys</guimenuitem></menuchoice> provides an overview of your Salt minions (clients).
Use <literal role="guimenu">Remote Commands</literal> to execute remote commands on your Salt minions.
You can also define a <literal role="guimenu">State Catalog</literal> for creating a collection of salt system states.</simpara>
<section xml:id="ref.webui.salt.onboarding">
<title>Keys</title>
<simpara>The <literal role="guimenu">Keys</literal> page provides a summary of your minions, including their names, fingerprints, state, and actions you may perform on them.</simpara>
<simpara>Once you have pointed a minion to the SUSE Manager server as its master within <literal role="replaceable">/etc/salt/minion</literal>, you can choose to accept or reject a minion from this page.
Toggle the check mark or cross in the <literal>actions</literal> column.</simpara>
<figure>
<title>Keys Overview</title>
<mediaobject>
<imageobject>
<imagedata fileref="onboarding.png" width="80%"/>
</imageobject>
<textobject><phrase>onboarding</phrase></textobject>
</mediaobject>
</figure>
<simpara>For more information about key handling and onboarding, see
<xref linkend="preparing.and.registering.clients.salt"/>.</simpara>
</section>
<section xml:id="ref.webui.salt.remote.commands">
<title>Remote Commands</title>
<simpara>The remote commands page allows you to execute and run commands from the SUSE Manager server on several minions.</simpara>
<figure>
<title>Remote Commands</title>
<mediaobject>
<imageobject>
<imagedata fileref="remote_commands.png" width="80%"/>
</imageobject>
<textobject><phrase>remote commands</phrase></textobject>
</mediaobject>
</figure>
<simpara>Salt runs remote commands from <literal role="filename">/tmp</literal> of the client&#8217;s filesystem.
Therefore you must not mount <literal role="filename">/tmp</literal> with the <literal role="option">noexec</literal> option.</simpara>
<warning>
<title>Remote Commands Security</title>
<simpara>All commands run from the <literal role="guimenu">Remote Commands</literal> page are executed as root on minions.
Wildcards can be used to run commands across any number of systems, so always take extra precaution as this may have drastic consequences for your systems.</simpara>
</warning>
<simpara>On the <menuchoice><guimenu>Salt</guimenu> <guimenuitem>Remote Commands</guimenuitem></menuchoice> page you will see two text boxes.
The first box is for entering commands.
The second box is for targeting minions by name, group, or by using wildcards.</simpara>
<simpara>Input a command you want to execute, add a target minion, group, or wildcard you want to execute the command on.
Select the <guibutton>Find Targets</guibutton> button to verify which machines will be targeted.
Select the <guibutton>Run Command</guibutton> button to execute a command on selected systems.</simpara>
</section>
<section xml:id="ref.webui.salt.formula_catalog">
<title>Formula Catalog</title>
<simpara>The <literal role="guimenu">Formula Catalog</literal> feature is a technology preview.</simpara>
</section>
</chapter>
<chapter xml:id="ref.webui.images">
<title>Images</title>
<section xml:id="ref.webui.images.images">
<title>Images</title>
<simpara>SUSE Manager enables system administrators to build system images, virtual images, containers and similar with the help of profiles and create image stores.</simpara>
<simpara>For background information, see
<xref linkend="at.images"/>.</simpara>
<simpara>If you click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Images</guimenuitem></menuchoice>, an overview listing of your images appears.
Several columns provide information about each image:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_list_images.png" width="80%"/>
</imageobject>
<textobject><phrase>images list images</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara>Select box: To select images, mark the appropriate check boxes. Selected images can be deleted simultaneously via the <guibutton>Delete</guibutton> button that appears in the upper right corner while selecting images.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Name</literal>:</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Version</literal> and <literal role="guimenu">Revision</literal>:</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Updates</literal>: Shows which type of update action is applicable to the image or confirms that the image is up-to-date. For more information about these icons, see
<xref linkend="ref.webui.systems.systems"/>.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Patches</literal> and <literal role="guimenu">Packages</literal>:</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Build</literal>:</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Last Modified</literal>: Time when the images was modified last.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Actions</literal>: <guibutton>Details</guibutton> and <guibutton>Delete</guibutton> button. <guibutton>Details</guibutton> opens a the Image Details page.</simpara>
</listitem>
</itemizedlist>
<simpara>In the upper right corner offers several action buttons: The <guibutton>Delete</guibutton> button appears when one or more images are selected. <guibutton>Import</guibutton> and <guibutton>Refresh</guibutton> are default buttons. <guibutton>Import</guibutton> allows to import pre-built images; for more information, see
<xref linkend="at.images.docker.importing"/>.</simpara>
<section xml:id="_image_details">
<title>Image Details</title>
<simpara>The Image Details page contains the <literal role="guimenu">Overview</literal>, <literal role="guimenu">Patches</literal>, and <literal role="guimenu">Packages</literal> tabs.</simpara>
</section>
</section>
<section xml:id="ref.webui.images.build">
<title>Build</title>
<simpara>If you click menu::Main Menu[Images &gt; Build], the dialog for building images appears:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_build.png" width="80%"/>
</imageobject>
<textobject><phrase>images image build</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Version</literal> : The version string that you would like to see in the Images listing, applicable only to containers.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Build Profile</literal> : Select an Image Profile created with the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice> page.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Build Host</literal> : Select a Build Host.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Earliest</literal> : Schedule build time.</simpara>
</listitem>
</itemizedlist>
<simpara>Confirm with <guibutton>Build</guibutton> to start image building.
When the image is done, find it listed in the <literal role="guimenu">Images</literal> overview described in <xref linkend="ref.webui.images.images"/>.</simpara>
</section>
<section xml:id="ref.webui.images.profiles">
<title>Profiles</title>
<simpara>If you click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice>, a listing of your <literal role="guimenu">Image Profiles</literal> appears.
Several columns provide information about each image:</simpara>
<itemizedlist>
<listitem>
<simpara>Select box: To select image profiles, mark the appropriate check boxes. Selected profiles can be deleted simultaneously via the <guibutton>Delete</guibutton> button that appears in the upper right corner while selecting profiles.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Label</literal> : The name of the profile.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Build Type</literal> : Dockerfile is available. Use Dockerfile to build containers.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Actions</literal> : <guibutton>Build</guibutton> , <guibutton>Edit</guibutton> and <guibutton>Delete</guibutton> button. <guibutton>Build</guibutton> creates the image according to this profile. <guibutton>Edit</guibutton> opens a the Profile Details page for editing.</simpara>
</listitem>
</itemizedlist>
<simpara><guibutton>Refresh</guibutton> and <guibutton>Create</guibutton> are default buttons in the upper right corner. <guibutton>Create</guibutton> opens the <literal role="guimenu">Create Image Profile</literal> dialog:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_create_profile.png" width="80%"/>
</imageobject>
<textobject><phrase>images image create profile</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.images.stores">
<title>Stores</title>
<simpara>If you click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Stores</guimenuitem></menuchoice>, a listing of your <literal role="guimenu">Image Stores</literal> appears.
Several columns provide information about each store:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_stores.png" width="80%"/>
</imageobject>
<textobject><phrase>images image stores</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara>Select box: To select image stores, mark the appropriate check boxes. Selected stores can be deleted simultaneously via the <guibutton>Delete</guibutton> button that appears in the upper right corner while selecting stores.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Label</literal> : Name of the store.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Type</literal> : Currently, only Registry is available.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Actions</literal> : <guibutton>Edit</guibutton> and <guibutton>Delete</guibutton> button. <guibutton>Edit</guibutton> opens a the Store Details page for editing.</simpara>
</listitem>
</itemizedlist>
<simpara>In the upper right corner offers several action buttons: The <guibutton>Delete</guibutton> button appears when one or more stores are selected. <guibutton>Refresh</guibutton> and <guibutton>Create</guibutton> are default buttons. <guibutton>Create</guibutton> opens the <literal role="guimenu">Create Image Store</literal> dialog:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="imeages_image_stores_create.png" width="80%"/>
</imageobject>
<textobject><phrase>imeages image stores create</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<title>Image stores for Kiwi build type</title>
<simpara>Image stores for Kiwi build type are not supported yet.  Kiwi build type is used to build system, virtual, and other images.</simpara>
<simpara>Images are always stored in <literal role="path">/srv/www/os-image/&lt;organization id&gt;</literal>.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="ref.webui.patches">
<title>Patches</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice> menu from the left bar helps tracking the availability and application of patches to your managed systems.</simpara>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Patches</guisubmenu> <guimenuitem>Patches</guimenuitem></menuchoice> page displays all or relevant patches for at least one of your managed systems that have not been applied yet.</simpara>
<note>
<title>Receiving Patches for Your System</title>
<simpara>To receive an e-mail when patches are issued for your system, go to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Home</guisubmenu> <guimenuitem>Your Preferences</guimenuitem></menuchoice> and select <literal role="guimenu">Receive email notifications</literal>.</simpara>
</note>
<simpara>SUSE distinguishes three types of patches: security updates, bug fix updates, and enhancement updates.
Each patch consists of a summary of the problem and solution, including the RPM packages fixing the problem.</simpara>
<simpara>Icons are used to identify the three types:</simpara>
<itemizedlist>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-shield.svg"/>
</imageobject>
<textobject><phrase>Security Alert</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Security Updates available, <emphasis>strongly</emphasis> recommended</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="fa-bug.svg"/>
</imageobject>
<textobject><phrase>Bug Fix Alert</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Bug Fix Updates available, recommended</simpara>
</listitem>
<listitem>
<simpara><inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-enhancement.svg"/>
</imageobject>
<textobject><phrase>Enhancement Alert</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Enhancement Updates available, optional</simpara>
</listitem>
</itemizedlist>
<simpara>A summary of each patch is provided in list form displaying its type, advisory ID, synopsis (with the severity as a textual prefix in case of security updates, such as <quote>critical</quote>, <quote>important</quote>, <quote>moderate</quote>, or <quote>low</quote>), number of affected systems in your network, and date updated.</simpara>
<simpara>In addition, you may view patches by product line at the following location: <link xl:href="http://download.suse.com/patch/psdb/">http://download.suse.com/patch/psdb/</link>.
For more information on security updates, see <link xl:href="https://www.suse.com/support/security/">https://www.suse.com/support/security/</link>.</simpara>
<section xml:id="ref.webui.patches.relevant">
<title>Relevant</title>
<simpara>The <literal role="guimenu">Relevant</literal> patches page displays a customized list of patches applying to your registered systems.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_relevant_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>patches relevant patches</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Clicking an <literal role="guimenu">Advisory</literal> ID of a patch takes you to the <literal role="guimenu">Details</literal> page of the <literal role="guimenu">Patch Details</literal> page.
Clicking the number of associated systems takes you to the <literal role="guimenu">Affected Systems</literal> page of the <literal role="guimenu">Patch Details</literal> page.
Refer to <xref linkend="s3-sm-errata-details"/> for more information.</simpara>
</section>
<section xml:id="ref.webui.patches.all">
<title>All</title>
<simpara>The <literal role="guimenu">All</literal> patches page displays a list of all patches released by SUSE, irrelevant of whether they apply to your registered systems or not.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_all_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>patches all patches</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Like in the <literal role="guimenu">Relevant Patches</literal> page, clicking either <literal role="guimenu">Advisory</literal> or the number of systems affected takes you to related tabs of the <literal role="guimenu">Patch Details</literal> page.
Refer to <xref linkend="s3-sm-errata-details"/> for more information.</simpara>
<section xml:id="s3-sm-apply-errata">
<title>Applying Patches</title>
<simpara>Patches include a list of updated packages.
To apply patches to a system, the system must be entitled.</simpara>
<simpara>Apply all applicable patches to a system by clicking <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Systems</guimenuitem></menuchoice>.
Click the name of an entitled system.
Then open the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Patches</guimenuitem></menuchoice> subtab.
When the relevant patch list appears, click <guibutton>Select All</guibutton> then <guibutton>Apply Patches</guibutton>.
Only patches not scheduled, scheduled but failed, or canceled patches are listed.
Pending updates are excluded.</simpara>
<simpara>In addition, users with appropriate roles can apply patches using two other methods:</simpara>
<itemizedlist>
<listitem>
<simpara>To apply a specific patch to one or more systems, locate it in the patch list and click the number of systems affected, which takes you to the <literal role="guimenu">Affected Systems</literal> page of the <literal role="guimenu">Patch Details</literal> page. Select the individual systems to be updated and click the <guibutton>Apply Patches</guibutton> button. Double-check the systems to be updated on the confirmation page, then click the <guibutton>Confirm</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>To apply more than one patch to one or more systems, select the systems from the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Systems</guimenuitem></menuchoice> list. Click the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>System Set Manager</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>, then click the <literal role="guimenu">Systems</literal> tab. After ensuring the appropriate systems are selected, click the <literal role="guimenu">Patches</literal> tab, select the patches to apply, and click the <guibutton>Apply Patches</guibutton> button. Schedule a date and time for the patch to be applied. Default is the current date. Click the <guibutton>Confirm</guibutton> button. You can follow the progress of the patch application via the <literal role="guimenu">Pending Actions</literal> list. Refer to <xref linkend="ref.webui.schedule"/> for more details.</simpara>
</listitem>
</itemizedlist>
<important>
<simpara>If you use scheduled package installation, the packages or patches are installed via the configured contact method.
For more information, see <xref linkend="bp.contact.methods.rhnsd"/>.</simpara>
</important>
<simpara>The following rules apply to patches:</simpara>
<itemizedlist>
<listitem>
<simpara>Each package is a member of one or more channels. If a selected system is not subscribed to a channel containing the package, the update will not be installed on that system.</simpara>
</listitem>
<listitem>
<simpara>If a newer version of the package is already installed on the system, the update will not be installed.</simpara>
</listitem>
<listitem>
<simpara>If an older version of the package is installed, the package will be upgraded.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s3-sm-errata-details">
<title>Patch Details</title>
<simpara>If you click the advisory of a patch in the <literal role="guimenu">Relevant</literal> or <literal role="guimenu">All</literal> pages, its <literal role="guimenu">Patch Details</literal> page appears.
This page is further divided into the following tabs:</simpara>
<section xml:id="s4-sm-errata-details-details">
<title><menuchoice><guimenu>Patch Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>This subtab displays the patch report issued by SUSE.
It provides a synopsis of the patch first (with the severity as a textual prefix in case of security updates, such as <quote>critical</quote>, <quote>important</quote>, <quote>moderate</quote>, or <quote>low</quote>), issue date, and any update dates.
This is followed by a description of the patch and the steps required to resolve the issue.</simpara>
<simpara>Below the <literal role="guimenu">Affected Channels</literal> label, all channels that contain the affected package are listed.
Clicking a channel name displays the <literal role="guimenu">Packages</literal> subtab of the <literal role="guimenu">Channel Details</literal> page for that channel.
Refer to <xref linkend="s3-sm-channel-details"/> for more information.</simpara>
<simpara>Security updates list the specific vulnerability as tracked by <link xl:href="http://cve.mitre.org">http://cve.mitre.org</link>.
This information is listed below the <literal role="guimenu">CVEs</literal> label.</simpara>
<simpara>OVAL is an open vulnerability and assessment language promoted by Mitre, <link xl:href="http://oval.mitre.org">http://oval.mitre.org</link>.
Clicking the link below the <literal role="guimenu">Oval</literal> label downloads this information to your system.
More useful are the SUSE Update Advisories at <link xl:href="https://www.suse.com/support/update/">https://www.suse.com/support/update/</link>.</simpara>
</section>
<section xml:id="s4-sm-errata-details-packages">
<title><menuchoice><guimenu>Patch Details</guimenu> <guimenuitem>Packages</guimenuitem></menuchoice></title>
<simpara>This page provides links to each of the updated RPMs by channel.
Clicking the name of a package displays its <literal role="guimenu">Package Details</literal> page.</simpara>
</section>
<section xml:id="s4-sm-errata-details-systems">
<title><menuchoice><guimenu>Patch Details</guimenu> <guimenuitem>Affected Systems</guimenuitem></menuchoice></title>
<simpara>This page lists systems affected by the patches.
You can apply updates here.
(See <xref linkend="s3-sm-apply-errata"/>.) Clicking the name of a system takes you to its <literal role="guimenu">System Details</literal> page.
Refer to <xref linkend="s3-sm-system-details"/> for more information.</simpara>
<simpara>To determine whether an update has been scheduled, refer to the <literal role="guimenu">Status</literal> column in the affected systems table.
Possible values are: N/A, Pending, Picked Up, Completed, and Failed.
This column identifies only the last action related to a patch.
For example, if an action fails and you reschedule it, this column shows the status of the patch as pending with no mention of the previous failure.
Clicking a status other than <literal role="guimenu">N/A</literal> takes you to the <literal role="guimenu">Action Details</literal> page.
This column corresponds to one on the <literal role="guimenu">Patch</literal> tab of the <literal role="guimenu">System Details</literal> page.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.patches.search">
<title>Advanced Search</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Patches</guisubmenu> <guimenuitem>Advanced Search</guimenuitem></menuchoice> page allows you to search through patches by specific criteria.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_advanced_search_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>patches advanced search patches</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">All Fields</literal>&#8201;&#8212;&#8201;Search patches by synopsis, description, topic, or solution.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Patch Advisory</literal>&#8201;&#8212;&#8201;The name or the label of the patch.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Package Name</literal>&#8201;&#8212;&#8201;Search particular packages by name:</simpara>
<screen>kernel</screen>
<simpara>Results will be grouped by advisory.
For example, searching for 'kernel' returns all package names containing the string <literal>kernel</literal>, grouped by advisory.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">CVE</literal>&#8201;&#8212;&#8201;The name assigned to the security advisory by the Common Vulnerabilities and Exposures (CVE) project at <link xl:href="http://cve.mitre.org">http://cve.mitre.org</link>. For example:</simpara>
<screen>CVE-2006-4535</screen>
</listitem>
</itemizedlist>
<simpara>To filter patch search results, check or uncheck the boxes next to the type of advisory:</simpara>
<itemizedlist>
<listitem>
<simpara>Bug Fix Advisory&#8201;&#8212;&#8201;Patches that fix issues reported by users or discovered during development or testing.</simpara>
</listitem>
<listitem>
<simpara>Security Advisory&#8201;&#8212;&#8201;Patches fixing a security issue found during development, testing, or reported by users or a software security clearing house. A security advisory usually has one or more CVE names associated with each vulnerability found in each package.</simpara>
</listitem>
<listitem>
<simpara>Product Enhancement Advisory&#8201;&#8212;&#8201;Patches providing new features, improving functionality, or enhancing performance of a package.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="ref.webui.patches.manage">
<title>Manage Patches</title>
<simpara>Custom patches enable organizations to issue patch alerts for the packages in their custom channels, schedule deployment and manage patches across organizations.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_published_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>patches published patches</phrase></textobject>
</mediaobject>
</informalfigure>
<warning>
<simpara>If the organization is using both SUSE Manager and SUSE Manager Proxy server, then manage patches only on the SUSE Manager server since the proxy servers receive updates directly from it.
Managing patches on a proxy in this combined configuration risks putting your servers out of synchronization.</simpara>
</warning>
<section xml:id="s3-sm-errata-create">
<title>Creating and Editing Patches</title>
<simpara>To create a custom patch alert, proceed as follows:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Patches</guisubmenu> <guisubmenu>Manage Patches</guisubmenu> <guimenuitem>Published</guimenuitem></menuchoice>. Then on the <literal role="guimenu">Patches Management</literal> page, click <literal role="guimenu">Create Patch</literal>.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_create_patch.png" width="80%"/>
</imageobject>
<textobject><phrase>patches create patch</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Enter a label for the patch in the <literal role="guimenu">Advisory</literal> field, ideally following a naming convention adopted by your organization.</simpara>
</listitem>
<listitem>
<simpara>Complete all remaining required fields, then click the <guibutton>Create Patch</guibutton> button. View standard SUSE Alerts for examples of properly completed fields.</simpara>
</listitem>
</orderedlist>
<simpara>Patch management distinguishes between published and unpublished patches.</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Published</literal> : this page displays the patch alerts the organization has created and disseminated. To edit an existing published patch, follow the steps described in <xref linkend="s3-sm-errata-create"/>. To distribute the patch, click <guibutton>Send Notification</guibutton> in the <literal role="guimenu">Send Patch Mail</literal> section on the top of the <literal role="guimenu">Patch Details</literal> page. The patch alert is sent to the administrators of all affected systems.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Unublished</literal> : this page displays the patch alerts your organization has created but not yet distributed. To edit an existing unpublished patch, follow the steps described in <xref linkend="s3-sm-errata-create"/>. To publish the patch, click <guibutton>Publish Patch</guibutton> on the top-right corner of the <literal role="guimenu">Patch Details</literal> page. Confirm the channels associated with the patch and click the <guibutton>Publish Patch</guibutton> button, now in the lower-right corner. The patch alert is moved to the <literal role="guimenu">Published</literal> page awaiting distribution.</simpara>
</listitem>
</itemizedlist>
<simpara>SUSE Manager administrators can also create patches by cloning an existing one.
Cloning preserves package associations and simplifies issuing patches.
See <xref linkend="ref.webui.patches.clone"/> for instructions.</simpara>
<simpara>To edit an existing patch alert&#8217;s details, click its advisory on the <literal role="guimenu">Patches Management</literal> page, make the changes in the appropriate fields of the <literal role="guimenu">Details</literal> tab, and click the <guibutton>Update Patch</guibutton> button.
Click the <literal role="guimenu">Channels</literal> tab to alter the patch&#8217;s channel association.
Click the <literal role="guimenu">Packages</literal> tab to view and modify its packages.</simpara>
<simpara>To delete patches, select their check boxes on the <literal role="guimenu">Patches Management</literal> page, click the <guibutton>Delete Patches</guibutton> button, and confirm the action.
Deleting published patches might take a few minutes.</simpara>
</section>
<section xml:id="s3-sm-errata-assign-packs">
<title>Assigning Packages to Patches</title>
<simpara>To assign packages to patches, proceed as follows:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select a patch, click the <literal role="guimenu">Packages</literal> tab, then the <literal role="guimenu">Add</literal> subtab.</simpara>
</listitem>
<listitem>
<simpara>To associate packages with the patch being edited, select the channel from the <literal role="guimenu">View</literal> drop-down box that contains the packages and click <guibutton>View</guibutton>. Packages already associated with the patch being edited are not displayed. Selecting <literal role="guimenu">All managed packages</literal> presents all available packages.</simpara>
</listitem>
<listitem>
<simpara>After clicking <guibutton>View</guibutton>, the package list for the selected option appears. Note that the page header still lists the patch being edited.</simpara>
</listitem>
<listitem>
<simpara>In the list, select the check boxes of the packages to be assigned to the edited patch and click <guibutton>Add Packages</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>A confirmation page appears with the packages listed. Click <guibutton>Confirm</guibutton> to associate the packages with the patch. The <literal role="guimenu">List/Remove</literal> subtab of the <literal role="guimenu">Managed Patch Details</literal> page appears with the new packages listed.</simpara>
</listitem>
</orderedlist>
<simpara>When packages are assigned to a patch, the patch cache is updated to reflect the changes.
This update is delayed briefly so that users may finish editing a patch before all the changes are made available.
To initiate the changes to the cache manually, follow the directions to <guibutton>commit the changes immediately</guibutton> at the top of the page.</simpara>
</section>
<section xml:id="s3-sm-errata-publish">
<title>Publishing Patches</title>
<simpara>After adding packages to the patch, the patch needs to be published to be disseminated to affected systems.
Follow this procedure to publish patches:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>On the top navigation bar, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Patches</guisubmenu> <guisubmenu>Manage Patches</guisubmenu> <guimenuitem>Unpublished</guimenuitem></menuchoice> to see all the unpublished patches listed.</simpara>
</listitem>
<listitem>
<simpara>Click the patch <literal role="guimenu">Advisory</literal> name to open the patch details pages.</simpara>
</listitem>
<listitem>
<simpara>On the patch details page, click <guibutton>Publish Patch</guibutton>. A confirmation page appears that will ask you to select which channels you want to make the patch available in. Choose the relevant channels.</simpara>
</listitem>
<listitem>
<simpara>At the bottom of the page, click <guibutton>Publish Patch</guibutton>. The patch published will now appear on the <literal role="guimenu">Published</literal> page of <literal role="guimenu">Manage Patches</literal>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="s3-sm-errata-published">
<title>Published</title>
<simpara>Here all published patches are listed.
It is possible to perform the following actions:</simpara>
<itemizedlist>
<listitem>
<simpara>To create a patch, click <guibutton>Create Patch</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>To delete patches, select them first and then click <guibutton>Delete Patches</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Click an Advisory name to open the patch details page.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s3-sm-errata-unpublished">
<title>Unpublished</title>
<simpara>Here all published patches are listed.
It is possible to perform the same actions as with published patches.
For more information, see <xref linkend="s3-sm-errata-published"/>.
Additionally, on a patch details page, you can click <guibutton>Publish Patch</guibutton> for publishing.</simpara>
</section>
</section>
<section xml:id="ref.webui.patches.clone">
<title>Cloning Patches</title>
<simpara>Patches can be cloned for easy replication and distribution as part of SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="patches_clone_patches.png" width="80%"/>
</imageobject>
<textobject><phrase>patches clone patches</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Only patches potentially applicable to one of your channels can be cloned.
Patches can be applicable to a channel if that channel was cloned from a channel to which the patch applies.
To access this functionality, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Patches</guisubmenu> <guimenuitem>Clone Patches</guimenuitem></menuchoice>.</simpara>
<simpara>On the <literal role="guimenu">Clone Patches</literal> page, select the channel containing the patch from the <literal role="guimenu">View</literal> drop-down box and click <guibutton>View</guibutton>.
When the patch list appears, select the check box of the patch to be cloned and click <guibutton>Clone Patch</guibutton>.
A confirmation page appears with the patch listed.
Click <guibutton>Confirm</guibutton> to finish cloning.</simpara>
<simpara>The cloned patch appears in the <literal role="guimenu">Unpublished</literal> patch list.
Verify the patch text and the packages associated with that patch, then publish the patch so it is available to users in your organization.</simpara>
</section>
</chapter>
<chapter xml:id="ref.webui.channels">
<title>Software</title>
<simpara>The pages in the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Software</guimenuitem></menuchoice> category enable you to view and manage software channels and packages associated with your systems.</simpara>
<section xml:id="ref.webui.channels.software">
<title>Channels</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Channels</guimenuitem></menuchoice> page is the first to appear.
A software channel provides packages grouped by products or applications to simplify the selection of packages to be installed on a system.</simpara>
<simpara>There are two types of software channels: base channels and child channels.</simpara>
<variablelist xml:id="s3-sm-channel-list-base">
<varlistentry>
<term>Base Channels</term>
<listitem>
<simpara>A base channel consists of packages built for a specific architecture and release.
For example, all of the packages in SUSE Linux Enterprise Server&#160;12 for the <literal>x86_64</literal> architecture make up a base channel.
The list of packages in SUSE Linux Enterprise Server&#160;12 for the <literal>s390x</literal> architecture make up a different base channel.</simpara>
<simpara>A system must be subscribed to only one base channel assigned automatically during registration based on the SUSE Linux Enterprise release and system architecture.
For paid base channels, an associated subscription must exist.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Child Channels</term>
<listitem>
<simpara>A child channel is associated with a base channel and provides extra packages.
For example, an organization can create a child channel associated with SUSE Linux Enterprise Server on <literal>x86_64</literal> architecture that contains extra packages for a custom application.</simpara>
<simpara>Especially important are the SUSE Manager Tools channels that are available for every base channel.
These tools channels provide the tools needed to connect the clients with the SUSE Manager server.</simpara>
<simpara>A system can be subscribed to multiple child channels of its base channel.
Only packages provided by a subscribed channel can be installed or updated.
SUSE Manager Administrators and Channel Administrators have channel management authority.
This authority gives them the ability to create and manage their own custom channels.</simpara>
<note>
<simpara>Do not create child channels containing packages that are not compatible with the client system.</simpara>
</note>
<simpara>Channels can be further distinguished by relevance: <literal role="guimenu">All</literal>, <literal role="guimenu">SUSE</literal>, <literal role="guimenu">Channels</literal>, <literal role="guimenu">My Channels</literal>, <literal role="guimenu">Shared</literal>, and <literal role="guimenu">Retired</literal>.</simpara>
</listitem>
</varlistentry>
</variablelist>
<section xml:id="s3-sm-channel-list-all">
<title>All</title>
<simpara>Under <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Channels</guimenuitem></menuchoice> select <literal role="guimenu">All</literal>.
All channels available to your organization are listed.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_all_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels all channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Links within this list go to different tabs of the <literal role="guimenu">Software Channel Details</literal> page.
Clicking a channel name takes you to the <literal role="guimenu">Details</literal> tab.
Clicking the number of packages takes you to the <literal role="guimenu">Packages</literal> tab.
Clicking the number of systems takes you to the <literal role="guimenu">Subscribed Systems</literal> tab.
Refer to <xref linkend="s3-sm-channel-details"/> for details.</simpara>
<important>
<title>Package Count Update Change</title>
<simpara>During a channel synchronization all package are now downloaded before they are incremented and displayed within the Web UI.
When packages have completed the initial download, packages will begin to increment in your channel as they are imported to the database.</simpara>
</important>
</section>
<section xml:id="s3-sm-channel-list-redhat">
<title>SUSE</title>
<simpara>The <literal role="guimenu">SUSE</literal> page displays all SUSE channels and any available child channels.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_vendor_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels vendor channels</phrase></textobject>
</mediaobject>
</informalfigure>
<warning>
<title>SUSEChannels Cannot be Deleted</title>
<simpara>When imported, SUSE channels cannot be deleted.
Only custom software channels can be deleted.</simpara>
</warning>
</section>
<section xml:id="s3-sm-channel-list-popular">
<title>Popular</title>
<simpara>The <literal role="guimenu">Popular</literal> page displays the software channels most subscribed by systems registered to your organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_popular_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels popular channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>You can refine the search by using the drop-down box to list only the channels with at least a certain number of systems subscribed.</simpara>
</section>
<section xml:id="s3-sm-channel-list-my">
<title>My Channels</title>
<simpara>The <literal role="guimenu">My Channels</literal> page displays all software channels that belong to your organization, including both SUSE and custom channels.
Use the text box to filter by channel name.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_custom_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels custom channels</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s3-sm-channel-list-shared">
<title>Shared</title>
<simpara>The <literal role="guimenu">Shared</literal> page displays the channels shared with others in the organizational trust.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_shared_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels shared channels</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s3-sm-channel-list-retired">
<title>Retired</title>
<simpara>The <literal role="guimenu">Retired</literal> page displays available channels that have reached their end-of-life dates and do not receive updates.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_retired_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels retired channels</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s3-sm-channel-details">
<title>Channel Details</title>
<simpara>If you click the name of a channel, the <literal role="guimenu">Channel Details</literal> page appears.</simpara>
<section xml:id="s4-sm-channel-details-details">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>General information about the channel and its parent if applicable.
This summary, description, and architecture is also displayed when clicking a channel.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_details_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels details channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>In addition, <literal role="guimenu">Per-User Subscription Restrictions</literal> can be set globally by SUSE Manager administrators and channel administrators.
By default, any user can subscribe channels to a system.
To manage user permissions, select <literal role="guimenu">Only selected users within your organization may subscribe to this channel</literal> and click <guibutton>Update</guibutton>.
The <literal role="guimenu">Subscribers</literal> tab appears.
Click it to grant specific users subscription permissions to a channel.
SUSE Manager administrators and channel administrators can always subscribe any channels to a system.</simpara>
<simpara>Only customers with custom base channels can change their systems' base channel assignments via the SUSE Manager Web interface in two ways:</simpara>
<itemizedlist>
<listitem>
<simpara>Assign the system to a custom base channel.</simpara>
</listitem>
<listitem>
<simpara>Revert subscriptions from a custom base channel to the appropriate distribution-based base channel.</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>The assigned base channel must match the installed system.
For example, a system running SUSE Linux Enterprise&#160;11 for <literal>x86_64</literal> cannot be registered to a SUSE Linux Enterprise&#160;12 for <literal>s390x</literal> base channel.
Use the files <literal role="path">/etc/os-release</literal> or <literal role="path">/etc/SuSE-release</literal> to check your product, architecture (try <literal role="command">uname -a</literal>), version, and patch level.</simpara>
</note>
</section>
<section xml:id="s4-sm-channel-details-managers">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Managers</guimenuitem></menuchoice></title>
<simpara>On the <literal role="guimenu">Managers</literal> page, you can check which users are authorized to manage the selected channel.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_details_managers_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels details managers channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Real name and e-mail address are listed with the user names.
Organization and Channel administrators can manage any channel.
As a SUSE Manager administrator you can change roles for specific users by clicking the name.
For more information on user management and the <literal role="guimenu">User Details</literal> page, see
<xref linkend="ref.webui.users"/>.</simpara>
</section>
<section xml:id="s4-sm-channel-details-errata">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">Patches</literal> page lists patches to be applied to packages provided in the channel.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_details_patches_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels details patches channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The list displays advisory types, names, summaries, and issue dates.
Clicking an advisory name takes you to its <literal role="guimenu">Patch Details</literal> page.
for more information, see
<xref linkend="s3-sm-errata-details"/>.</simpara>
</section>
<section xml:id="s4-sm-channel-details-packages">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Packages</guimenuitem></menuchoice></title>
<simpara>This page lists packages in the channel.
Clicking a package name takes you to the <literal role="guimenu">Package Details</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_details_packages_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels details packages channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>This page displays a set of tabs with information about the package, including architectures on which it runs, the package size, build date, package dependencies, change log, list of files in the package, newer versions, and which systems have the package installed.
Download the packages as RPMs.</simpara>
<simpara>To search for a specific package or a subset of packages, use the package filter at the top of the list.
Enter a substring to search for package names containing the string.
For example, typing <literal>dd</literal> in the filter might return: <literal role="systemitem">dd_rescue</literal>, <literal role="systemitem">ddclient</literal>, and <literal role="systemitem">uuidd</literal>.
The filter is case-insensitive.</simpara>
</section>
<section xml:id="s4-sm-channel-details-subsys">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Subscribed Systems</guimenuitem></menuchoice></title>
<simpara>The list displays system names and their system type.
Clicking a system name takes you to its <literal role="guimenu">System Details</literal> page.
For more information, see
<xref linkend="s3-sm-system-details"/>.</simpara>
</section>
<section xml:id="s4-sm-channel-details-tarsys">
<title><menuchoice><guimenu>Software Channel Details</guimenu> <guimenuitem>Target Systems</guimenuitem></menuchoice></title>
<simpara>List of systems eligible for subscription to the channel.
This tab appears only for child channels.
Use the check boxes to select the systems, then click the <literal role="guimenu">Confirm</literal> and <guibutton>Subscribe</guibutton> button on the bottom right-hand corner.
You will receive a success message or be notified of any errors.
This can also be accomplished through the <literal role="guimenu">Channels</literal> tab of the <literal role="guimenu">System Details</literal> page.
For more information, see
<xref linkend="s3-sm-system-details"/>.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.channels.search">
<title>Package Search</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="channels_search_channels.png" width="80%"/>
</imageobject>
<textobject><phrase>channels search channels</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The <literal role="guimenu">Package Search</literal> page allows you to search through packages using various criteria provided by the <literal role="guimenu">What to search for</literal> selection list:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Free Form</literal>&#8201;&#8212;&#8201;a general keyword search useful when the details of a particular package and its contents are unknown.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Name Only</literal>&#8201;&#8212;&#8201;Targeted search to find a specific package known by name.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Name and Summary</literal>&#8201;&#8212;&#8201;Search for a package or program which might not show up in the respective package name but in its one-line summary.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Name and Description</literal>&#8201;&#8212;&#8201;Search package names and their descriptions.</simpara>
</listitem>
</itemizedlist>
<simpara>The <literal role="guimenu">Free Form</literal> field additionally allows you to search using field names that you prepend to search queries and filter results by that field keyword.</simpara>
<simpara>For example, if you wanted to search all of the SUSE Linux Enterprise packages for the word <literal>java</literal> in the description and summary, type the following in the <literal role="guimenu">Free Form</literal> field:</simpara>
<screen>summary:java and description:java</screen>
<simpara>Other supported field names include:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>name</literal>: search package names for a particular keyword,</simpara>
</listitem>
<listitem>
<simpara><literal>version</literal>: search for a particular package version,</simpara>
</listitem>
<listitem>
<simpara><literal>filename</literal>: search the package file names for a particular keyword,</simpara>
</listitem>
<listitem>
<simpara><literal>description</literal>: search the packages' detailed descriptions for a particular keyword,</simpara>
</listitem>
<listitem>
<simpara><literal>summary</literal>: search the packages' brief summary for a particular keyword,</simpara>
</listitem>
<listitem>
<simpara><literal>arch</literal>: search the packages by their architecture (such as <literal>x86_64</literal>, <literal>ppc64le</literal>, or <literal>s390</literal>).</simpara>
</listitem>
</itemizedlist>
<simpara>You can also limit searches to <literal role="guimenu">Channels relevant to your systems</literal> by clicking the check box.
Additionally, you can restrict your search by platform (<literal role="guimenu">Specific channel you have access to</literal>) or architecture (<literal role="guimenu">Packages of a specific architecture</literal>).</simpara>
</section>
<section xml:id="ref.webui.channels.manage">
<title>Manage Software Channels</title>
<simpara>This menu allows administrators to create, clone, and delete custom channels.
These channels may contain altered versions of distribution-based channels or custom packages.</simpara>
<section xml:id="ref.webui.channels.manage.overview">
<title>Manage Software Channels &gt; Overview</title>
<simpara>The <literal role="guimenu">Overview</literal> page of the <literal role="guimenu">Manage Software Channels</literal> menu lists all available channels including custom, distribution-based, and child channels.</simpara>
<simpara>To clone an existing channel, click the <literal role="guimenu">Clone Channel</literal> link.
Select the channel to be cloned from the drop-down box, select whether to clone the current state (including patches) or the original state (without patches).
You can also select specific patches to use for cloning.
Then click the <guibutton>Create Channel</guibutton> button.
In the next screen select options for the new channel, including base architecture and GPG, then click <literal role="guimenu">Create Channel</literal>.</simpara>
<note>
<title>GPG Key URL</title>
<simpara>The GPG key URL may be either an internal file location such as <literal><link xl:href="file:///">file:///</link></literal> or you may use an external URL.</simpara>
</note>
<simpara>To create a new channel, click the <literal role="guimenu">Create Channel</literal> link.
Select the appropriate options for the new channel, including base architecture and GPG options, then click <guibutton>Create Channel</guibutton>.
Note that a channel created in this manner is blank, containing no packages.
You must either upload software packages or add packages from other repositories.
You may also choose to include patches in your custom channel.</simpara>
<important>
<title>Enable GPG Check</title>
<simpara><literal>Enable GPG Check</literal> is automatically selected when creating a new channel.
If you would like to add custom packages and applications to your channel, make sure you deselect this box or you cannot install/add unsigned packages.
Keep in mind this is a security risk for packages from an untrusted source.</simpara>
</important>
</section>
<section xml:id="s3-chnl-mgmt-channel-details">
<title><literal role="guimenu">`Channel Details</literal></title>
<section xml:id="s4-chnlmgmt-cdetails-cdetails">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>This page lists the settings made during channel creation.</simpara>
</section>
<section xml:id="s4-chnlmgmt-cdetails-manage">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Managers</guimenuitem></menuchoice></title>
<simpara>SUSE Manager administrators and channel administrators may alter or delete any channel.
To grant other users rights to alter or delete this channel, check the box next to the user&#8217;s name and click <guibutton>Update</guibutton>.</simpara>
<simpara>To allow all users to manage the channel, click the <guibutton>Select All</guibutton> button at the bottom of the list then click <guibutton>Update</guibutton>.
To remove a user&#8217;s right to manage the channel, uncheck the box next to their name and click <guibutton>Update</guibutton>.</simpara>
</section>
<section xml:id="s4-chnlmgmt-cdetails-errata">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Patches</guimenuitem></menuchoice></title>
<simpara>Channel managers can list, remove, clone, and add patches to their custom channel.
Custom channels not cloned from a distribution may not contain patches until packages are available.
Only patches that match the base architecture and apply to a package in that channel may be added.
Finally, only cloned or custom patches may be added to custom channels.
Patches may be included in a cloned channel if they are selected during channel creation.</simpara>
<simpara>The <literal role="guimenu">Sync</literal> tab lists patches that were updated since they were originally cloned in the selected cloned channel.
More specifically, a patch is listed here if and only if:</simpara>
<itemizedlist>
<listitem>
<simpara>it is a cloned patch,</simpara>
</listitem>
<listitem>
<simpara>it belongs to the selected cloned channel,</simpara>
</listitem>
<listitem>
<simpara>it has already been published in the selected cloned channel,</simpara>
</listitem>
<listitem>
<simpara>it does not contain a package that the original patch has, or it has at least one package with a different version with regard to the corresponding one in the original patch, or both.</simpara>
</listitem>
<listitem>
<simpara>Clicking the <guibutton>Sync Patches</guibutton> button opens a confirmation page in which a subset of those patches can be selected for synchronization.</simpara>
</listitem>
<listitem>
<simpara>Clicking the <guibutton>Confirm</guibutton> button in the confirmation page results in such patches being copied over from the original channel to the cloned channel, thus updating corresponding packages.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s4-cnlmgmt-cdetails-pkgs">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Packages</guimenuitem></menuchoice></title>
<simpara>As with patches, administrators can list, remove, compare, and add packages to a custom channel.</simpara>
<simpara>To list all packages in the channel, click the <literal role="guimenu">List / Remove Packages</literal> link.
Check the box to the left of any package you want to remove, then click <guibutton>Remove Packages</guibutton>.</simpara>
<simpara>To add packages, click the <literal role="guimenu">Add Packages</literal> link.
From the drop-down box activate a channel from which to add packages and click <guibutton>View</guibutton> to continue.
Check the box to the left of any package you want to add to the custom channel, then click <guibutton>Add Packages</guibutton>.</simpara>
<simpara>To compare packages in the current channel with those in another, select a channel from the drop-down box and click <guibutton>Compare</guibutton>.
Packages in both channels are compared, including architecture and the latest version of packages.
The results are displayed on the next screen.</simpara>
<simpara>To make the two channels identical, click the <guibutton>Merge Differences</guibutton> button.
In the next dialog, resolve any conflicts. <guibutton>Preview Merge</guibutton> allows you to review the changes before applying them to the channels.
Select those packages that you want to merge.
Click <guibutton>Merge Packages</guibutton> then <guibutton>Confirm</guibutton> to perform the merge.</simpara>
</section>
<section xml:id="s4-chnlmgmt-cdetails-repos">
<title><menuchoice><guimenu>Channel Details</guimenu> <guimenuitem>Repositories</guimenuitem></menuchoice></title>
<simpara>On the <literal role="guimenu">Repositories</literal> page, assign software repositories to the channel and synchronize repository content:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Add/Remove</literal> lists configured repositories, which can be added and removed by selecting the check box next to the repository name and clicking <guibutton>Update Repositories</guibutton>.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Sync</literal> lists configured repositories. The synchronization schedule can be set using the drop-down boxes, or an immediate synchronization can be performed by clicking <guibutton>Sync Now</guibutton>.</simpara>
</listitem>
</itemizedlist>
<simpara>The <literal role="guimenu">Manage Repositories</literal> tab to the left shows all assigned repositories.
Click a name to see details and possibly delete a repository.</simpara>
</section>
</section>
<section xml:id="s3-chnl-mgmt-mng-pkgs">
<title>Manage Software Channels &gt; Manage Software Packages</title>
<simpara>This page allows managing custom software packages, listing all software or viewing only packages in a custom channel.
Select the respective channel from the drop-down box and click <guibutton>View Packages</guibutton>.</simpara>
</section>
<section xml:id="s3-chnl-mgmt-mng-repos">
<title>Manage Software Channels &gt; Manage Repositories</title>
<simpara>Add or manage custom or third-party package repositories and link the repositories to an existing channel.
The repositories feature currently supports repomd repositories.</simpara>
<simpara>To create a new repository click the <literal role="guimenu">Create Repository</literal> link at the top right of the <literal role="guimenu">Manage Repositories</literal> page.
The <literal role="guimenu">Create Repository</literal> screen prompts you to enter a <literal role="guimenu">Repository Label</literal> such as <literal>sles-12-x86_64</literal> and a <literal role="guimenu">Repository URL</literal>.
You may enter URLs pointing to mirror lists or direct download repositories, then click <guibutton>Create Repository</guibutton>.
Select the desired SSL certificate of authority, client certificate and key from the drop down list.
SSL keys should be placed in <literal><link xl:href="http://EXAMPLE-MANAGER-FQDN.com/pub">http://EXAMPLE-MANAGER-FQDN.com/pub</link></literal>.</simpara>
<simpara>To link the new repository to an existing software channel, select <literal role="guimenu">Manage Software Channels</literal> from the left menu, then click the channel you want to link.
In the channel&#8217;s detail page, click the <literal role="guimenu">Repositories</literal> subtab, then check the box next to the repository you want to link to the channel.
Click <guibutton>Update Repositories</guibutton>.</simpara>
<simpara>To synchronize packages from a custom repository to your channel, click the <literal role="guimenu">Sync</literal> link from the channel&#8217;s <literal role="guimenu">Repositories</literal> subtab, and confirm by clicking the <guibutton>Sync</guibutton> button.</simpara>
<simpara>You can also perform a synchronization via command line by using the <literal role="command">spacewalk-repo-sync</literal> command, which additionally allows you to accept keys.</simpara>
<simpara><literal role="command">spacewalk-repo-sync</literal> creates log files in the <literal role="path">/var/log/rhn/reposync</literal> directory. SUSE Manager uses one log file per channel and reuses it with the next synchronization run.</simpara>
</section>
</section>
<section xml:id="ref.webui.channels.mapping">
<title>Distribution Channel Mapping</title>
<simpara>The <literal role="guimenu">Distribution Channel Mapping</literal> page displays a list of all your defined default base channels that clients will pick up according to their operating system and architecture at registration time.
These mappings can be overriden, but cannot be deleted.
To create such a mapping click <literal role="guimenu">Create Distribution Channel Mapping</literal> in the upper-right corner.
Several columns provide information for each mapping.</simpara>
<note>
<title>Using Distribution Channel Mapping</title>
<simpara>For SUSE Linux Enterprise or Red Hat Enterprise Linux SUSE does not use the <literal role="guimenu">Distribution Channel Mapping</literal> feature.
It can be used for other products (for example, for free products such as openSUSE, Fedora, Oracle Linux, etc.).
It can help when letting clients pick up base channels automatically.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="ref.webui.audit">
<title>Audit</title>
<simpara>Select <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Audit</guimenuitem></menuchoice> to audit your managed systems.</simpara>
<section xml:id="ref.webui.audit.cve">
<title>CVE Audit</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>CVE Audit</guimenuitem></menuchoice> page will display a list of client systems with their patch status regarding a given CVE (Common Vulnerabilities and Exposures) number.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="audit_cve_audit.png" width="80%"/>
</imageobject>
<textobject><phrase>audit cve audit</phrase></textobject>
</mediaobject>
</informalfigure>
<section xml:id="s1-cve-usage">
<title>Normal Usage</title>
<simpara>Proceed as follows if you want to verify that a client system has received a given CVE patch:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Make sure that the CVE data is up-to-date. For more information, see <xref linkend="sec-cve-maint"/>.</simpara>
</listitem>
<listitem>
<simpara>Click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>CVE Audit</guimenuitem></menuchoice> to open the <literal role="guimenu">CVE Audit</literal> page.</simpara>
</listitem>
<listitem>
<simpara>Input a 13-char CVE identifier in the <literal role="guimenu">CVE Number</literal> field. The year setting will be automatically adjusted. Alternatively, set the year manually and add the last four digits.</simpara>
</listitem>
<listitem>
<simpara>Optionally, uncheck the patch statuses you are not interested in.</simpara>
</listitem>
<listitem>
<simpara>Click <literal role="guimenu">Audit systems</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>Performing this procedure will result in a list of client systems, where each system comes with a <literal role="guimenu">Patch Status</literal> belonging to the given CVE identifier.
Possible statuses are:</simpara>
<variablelist>
<varlistentry>
<term><inlinemediaobject>
<imageobject>
<imagedata fileref="patch-status-affected-patch-inapplicable.png"/>
</imageobject>
<textobject><phrase>patch status affected patch inapplicable</phrase></textobject>
</inlinemediaobject> Red - Affected, patches are available in channels that are not assigned</term>
<listitem>
<simpara>The system is affected by the vulnerability and SUSE Manager has one or more patches for it, but at this moment, the channels offering the patches are not assigned to the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><inlinemediaobject>
<imageobject>
<imagedata fileref="patch-status-affected-patch-applicable.png"/>
</imageobject>
<textobject><phrase>patch status affected patch applicable</phrase></textobject>
</inlinemediaobject> Orange - Affected, at least one patch available in an assigned channel</term>
<listitem>
<simpara>The system is affected by the vulnerability, SUSE Manager has at least one patch for it in a channel that is directly assigned to the system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><inlinemediaobject>
<imageobject>
<imagedata fileref="patch-status-not-affected.png"/>
</imageobject>
<textobject><phrase>patch status not affected</phrase></textobject>
</inlinemediaobject> Grey - Not affected</term>
<listitem>
<simpara>The system does not have any packages installed that are patchable.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><inlinemediaobject>
<imageobject>
<imagedata fileref="patch-status-patched.png"/>
</imageobject>
<textobject><phrase>patch status patched</phrase></textobject>
</inlinemediaobject> Green - Patched</term>
<listitem>
<simpara>A patch has already been installed.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>In other words, it can mean the following:</simpara>
<itemizedlist>
<listitem>
<simpara>More than one patch might be needed to fix a certain vulnerability.</simpara>
</listitem>
<listitem>
<simpara>The <inlinemediaobject>
<imageobject>
<imagedata fileref="patch-status-affected-patch-applicable.png"/>
</imageobject>
<textobject><phrase>patch status affected patch applicable</phrase></textobject>
</inlinemediaobject> Orange - state is displayed when SUSE Manager has at least one patch in an assigned channel.
This might mean that, after installing such a patch, others might be needed—users should double check the CVE Audit page after applying a patch to be sure that their systems are not affected anymore.</simpara>
</listitem>
</itemizedlist>
<simpara>For a more precise definitions of these states, see <xref linkend="sec-cve-tips"/>.</simpara>
<note>
<title>Unknown CVE Number</title>
<simpara>If the CVE number is not known to SUSE Manager, an error message is displayed because SUSE Manager cannot collect and display any audit data.</simpara>
</note>
<simpara>For each system, the <literal role="guimenu">Next Action</literal> column contains suggestions on the steps to take to address the vulnerabilities.
Under these circumstances it is either sensible to install a certain patch or assign a new channel.
If applicable, a list of <quote>candidate</quote> channels or patches is displayed for your convenience.</simpara>
<simpara>You can also assign systems to a <literal role="guimenu">System Set</literal> for further batch processing.</simpara>
</section>
<section xml:id="ref-api-usage">
<title>API Usage</title>
<simpara>An API method called <literal>audit.listSystemsByPatchStatus</literal> is available to run CVE audits from custom scripts.
Details on how to use it are available in the API guide.</simpara>
</section>
<section xml:id="sec-cve-maint">
<title>Maintaining CVE Data</title>
<simpara>To produce correct results, CVE Audit must periodically refresh the data needed for the search in the background.
By default, the refresh is scheduled at 11:00 PM every night.
It is recommended to run such a refresh right after the SUSE Manager installation to get proper results immediately instead of waiting until the next day.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>In the Web interface, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal>cve-server-channels-default</literal> schedule link.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal>cve-server-channels-bunch</literal> link.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Single Run Schedule</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>After some minutes, refresh the page and check that the scheduled run status is <literal>FINISHED</literal>.</simpara>
</listitem>
</orderedlist>
<simpara>A direct link is also available on the <menuchoice><guimenu>Main Main</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>CVE Audit</guimenuitem></menuchoice> page (<literal role="guimenu">extra CVE data update</literal>).</simpara>
</section>
<section xml:id="sec-cve-tips">
<title>Tips and Background Information</title>
<simpara>Audit results are only correct if the assignment of channels to systems did not change since the last scheduled refresh (normally at 11:00 PM every night).
If a CVE audit is needed and channels were assigned or unassigned to any system during the day, a manual run is recommended.
For more information, see <xref linkend="sec-cve-maint"/>.</simpara>
<simpara>Systems are called <quote>affected</quote>, <quote>not affected</quote> or <quote>patched</quote> not in an absolute sense, but based on information available to SUSE Manager.
This implies that concepts such as <quote>being affected by a vulnerability</quote> have particular meanings in this context.
The following definitions apply:</simpara>
<variablelist>
<varlistentry>
<term>System affected by a certain vulnerability</term>
<listitem>
<simpara>A system which has an installed package with version lower than the version of the same package in a relevant patch marked for the vulnerability.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>System not affected by a certain vulnerability</term>
<listitem>
<simpara>A system which has no installed package that is also in a relevant patch marked for the vulnerability.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>System patched for a certain vulnerability</term>
<listitem>
<simpara>A system which has an installed package with version equal to or greater than the version of the same package in a relevant patch marked for the vulnerability.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Relevant patch</term>
<listitem>
<simpara>A patch known by SUSE Manager in a relevant channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Relevant channel</term>
<listitem>
<simpara>A channel managed by SUSE Manager, which is either assigned to the system, the original of a cloned channel which is assigned to the system, a channel linked to a product which is installed on the system or a past or future service pack channel for the system.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>A notable consequence of the above definitions is that results can be incorrect in cases of unmanaged channels, unmanaged packages, or non-compliant systems.</simpara>
</section>
</section>
<section xml:id="ref.webui.audit.subscription">
<title><literal role="guimenu">Subscription Matching</literal></title>
<simpara>To match subscriptions with your systems use the Subscription Matcher tool.</simpara>
<simpara>The <literal role="guimenu">Edit Virtual Host Managers</literal> link in the upper right corner will take you to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> overview.
For more information about Virtual Host Managers, see <xref linkend="ref.webui.systems.virt-host-managers"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="audit_subscription_matching.png" width="80%"/>
</imageobject>
<textobject><phrase>audit subscription matching</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>It gathers information about systems, subscriptions and pinned matches (fixed customer defined subscriptions to systems mapping) as input and returns the best possible match according to the SUSE Terms and Conditions.
The Subscription Matcher (<literal role="command">subscription-matcher</literal>) is also able to write CSV Reports.</simpara>
<itemizedlist>
<listitem>
<simpara>The <literal role="guimenu">Subscriptions Report</literal> provides subscriptions report data when used</simpara>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Unmatched Products Report</literal> provides information on products and their systems when a match to a subscription cannot be found</simpara>
</listitem>
<listitem>
<simpara>The <literal role="guimenu">Error Report</literal> provides a list of errors raised during the matching process</simpara>
</listitem>
</itemizedlist>
<simpara>Selecting <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>Subscription Matching</guimenuitem></menuchoice> from the left navigation menu will provide you with an overview of all results generated by the Subscription Matcher.</simpara>
<important>
<title>Subscription Matcher Accuracy</title>
<simpara>This tool&#8217;s goal is to help provide visual coverage on current subscription use and support reporting.
The Subscription Matcher is excellent at matching systems and products registered with SUSE Manager, however any systems, products or environments which are not found in the database will remain unmatched.
This tool is not intended to act as a replacement for auditing.
Auditing should always take precedence over subscription matching.</simpara>
</important>
<section xml:id="_main_menu_audit_subscription_matching_subscriptions">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Subscriptions</guimenuitem></menuchoice></title>
<simpara>The Subscription Matching overview provides subscription part numbers, product descriptions, policies, matched total subscriptions used and remaining, and the start and end dates of subscriptions.</simpara>
<figure>
<title>Subscription Matching Overview</title>
<mediaobject>
<imageobject>
<imagedata fileref="smatching-overview.png" width="80%"/>
</imageobject>
<textobject><phrase>smatching overview</phrase></textobject>
</mediaobject>
</figure>
<variablelist>
<varlistentry>
<term>Part Number</term>
<listitem>
<simpara>Identifier of a particular product</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Description</term>
<listitem>
<simpara>Name of a particular product</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Policy</term>
<listitem>
<simpara>Kind of the subscription of this product</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Matched/Total</term>
<listitem>
<itemizedlist>
<listitem>
<simpara></simpara>
<formalpara>
<title>Fully Matched</title>
<para>If the total amounts of a subscription are fully matched, the quantity column value is highlighted with a yellow warning triangle: <inlinemediaobject>
<imageobject>
<imagedata fileref="fa-warning.svg"/>
</imageobject>
<textobject><phrase>Warning</phrase></textobject>
</inlinemediaobject></para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title>Susbscritions about to Expire</title>
<para>When a subscription will expire within less than 3 months, the record is highlighted.</para>
</formalpara>
</listitem>
<listitem>
<simpara></simpara>
<formalpara>
<title>Expired Subscriptions</title>
<para>If a subscription is expired, the record for it is faded.</para>
</formalpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Start Date</term>
<listitem>
<simpara>Start date of the subscription</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>End Date</term>
<listitem>
<simpara>End date of the subscription</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="_subscription_matcher_reports">
<title>Subscription Matcher Reports</title>
<simpara>SUSE Manager automatically generates up-to-date nightly status reports by matching your SUSE subscriptions with all your registered systems.
These reports are stored in <literal role="path">/var/lib/spacewalk/subscription-matcher</literal> and provided in CSV format.
These CSV files may be opened with a spreadsheet application such as LibreOffice Calc.</simpara>
<simpara>If you want to schedule these reports to be produced at different times, or at a certain frequency or schedule a one time completion you can perform this task by editing the Taskomatic settings for the gatherer-matcher located in the Web UI at <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guisubmenu>Task Schedules</guisubmenu> <guimenuitem>gatherer-matcher-default</guimenuitem></menuchoice>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="audit_subscription_matching_gatherer_matcher_default.png" width="80%"/>
</imageobject>
<textobject><phrase>audit subscription matching gatherer matcher default</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.audit.submatch.unmatched.systems">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Unmatched Products</guimenuitem></menuchoice></title>
<simpara>Selecting the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Unmatched Products</guimenuitem></menuchoice> tab provides an overview of all systems the matcher could not find in the database or which were not registered with SUSE Manager.
The <literal role="guimenu">Unmatched Products</literal> overview contains product names and the number of systems which remain unmatched with known installed products.</simpara>
<figure>
<title>Unmatched Products</title>
<mediaobject>
<imageobject>
<imagedata fileref="audit_subscription_matching_unmatched_products.png" width="80%"/>
</imageobject>
<textobject><phrase>audit subscription matching unmatched products</phrase></textobject>
</mediaobject>
</figure>
<variablelist>
<varlistentry>
<term>Show System List</term>
<listitem>
<simpara>Select to open and display a list of all systems which were detected with an installed product but remain unmatched with a subscription.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="ref.webui.audit.submatch.sub.pinning">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Pins</guimenuitem></menuchoice></title>
<simpara>The subscription pinning feature allows a user to instruct the subscription matcher to favor matching a specific subscription with a given system or group of systems.
This is achieved by creating pins.
Each pin contains information about the preferred subscription-system match.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="audit_subscription_matching_pins.png" width="80%"/>
</imageobject>
<textobject><phrase>audit subscription matching pins</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<title>Respecting Pins</title>
<simpara>In some cases the algorithm may determine that a specific pin cannot be respected, depending on the subscription&#8217;s availability and applicability rules, in this case it will be shown as not satisfied.</simpara>
</note>
<simpara>The pins table displays a list of all pins.
Items in the list contain the status of pins, which can be <literal>satisfied</literal>, <literal>not    satisfied</literal> and <literal>pending next run</literal>.</simpara>
<itemizedlist>
<listitem>
<simpara>A pin is <literal>satisfied</literal> if its system and subscription was matched in the last matcher run.</simpara>
</listitem>
<listitem>
<simpara>A pin is <literal>not satisfied</literal> if its system and subscription was <emphasis>not</emphasis> matched in the last matcher run.
This can happen, for example, if the pin violates terms and conditions for subscriptions.</simpara>
</listitem>
<listitem>
<simpara>A pin is in the <literal>pending next run</literal> state when it needs a new matcher run to be taken into account.
After the new run, the pin will become either <literal>satisfied</literal> or <literal>not satisfied</literal>.</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="sm-pins.png" width="80%"/>
</imageobject>
<textobject><phrase>sm pins</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the <guibutton>Add a Pin</guibutton> button to open the <literal role="guimenu">Available Systems</literal> window.
You may filter systems by name and select a system for the matcher to pin manually.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="add-pin.png" width="80%"/>
</imageobject>
<textobject><phrase>add pin</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Within the <menuchoice><guimenu>Subscriptions Available for Selected System</guimenu> <guimenuitem>] window click the menu:Save Pin[</guimenuitem></menuchoice> button to raise priority for subscription use on the selected system.</simpara>
</section>
<section xml:id="ref.webui.audit.submatch.submatch.messages">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Messages</guimenuitem></menuchoice></title>
<simpara>You can review all messages related to <literal role="guimenu">Subscription Matching</literal> from the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>Subscription Matching</guisubmenu> <guimenuitem>Messages</guimenuitem></menuchoice> overview.</simpara>
<simpara>The following status messages can be displayed.</simpara>
<variablelist>
<varlistentry>
<term>Unknown Part Number</term>
<listitem>
<simpara>Unsupported part number detected</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Physical Guest</term>
<listitem>
<simpara>Physical system is reported as virtual guest, check hardware data</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Guest with Unknown Host</term>
<listitem>
<simpara>Virtual guest has unknown host, assuming it is a physical system</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Unknown CPU Count</term>
<listitem>
<simpara>System has an unknown number of sockets, assuming 16.
You can try fixing this by scheduling hardware refresh for affected system.</simpara>
</listitem>
</varlistentry>
</variablelist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="audit_subscription_matching_messages.png" width="80%"/>
</imageobject>
<textobject><phrase>audit subscription matching messages</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</section>
<section xml:id="ref.webui.audit.openscap">
<title>OpenSCAP</title>
<simpara>If you click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guisubmenu>OpenSCAP</guisubmenu> <guimenuitem>All Scans</guimenuitem></menuchoice>, an overview of the OpenSCAP Scans appears.
SCAP (Security Content Automation Protocol) is a framework to maintain the security of enterprise systems.
It mainly performs the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>Automatically verifying the availability of patches</simpara>
</listitem>
<listitem>
<simpara>Checking system security configuration settings</simpara>
</listitem>
<listitem>
<simpara>Examining systems for signs of compromise</simpara>
</listitem>
</itemizedlist>
<simpara>For a description of the Web UI dialogs, see <xref linkend="s2-openscap-suma-pages"/>.</simpara>
<simpara>For instructions and tips on how to best use OpenSCAP with SUSE Manager, refer to <xref linkend="ch-openscap"/>.
To learn more about OpenSCAP, see the project home page at <link xl:href="http://open-scap.org">http://open-scap.org</link>.</simpara>
</section>
</chapter>
<chapter xml:id="ch-openscap">
<title>System Security via OpenSCAP</title>
<simpara>The Security Certification and Authorization Package (SCAP) is a standardized compliance checking solution for enterprise-level Linux infrastructures.
It is a line of specifications maintained by the National Institute of Standards and Technology (NIST) for maintaining system security for enterprise systems.</simpara>
<simpara>SUSE Manager uses OpenSCAP to implement the SCAP specifications.
OpenSCAP is an auditing tool that utilizes the Extensible Configuration Checklist Description Format (XCCDF). XCCDF is a standard way of expressing checklist content and defines security checklists.
It also combines with other specifications such as Common Platform Enumeration (CPE), Common Configuration Enumeration (CCE), and Open Vulnerability and Assessment Language (OVAL), to create a SCAP-expressed checklist that can be processed by SCAP-validated products.</simpara>
<section xml:id="s1-openscap-features">
<title>OpenSCAP Features</title>
<simpara>OpenSCAP verifies the presence of patches by using content produced by the SUSE Security Team (<link xl:href="https://www.suse.com/support/security/">https://www.suse.com/support/security/</link>), checks system security configuration settings and examines systems for signs of compromise by using rules based on standards and specifications.</simpara>
<simpara>To effectively use OpenSCAP, the following must be available:</simpara>
<variablelist>
<varlistentry>
<term>A tool to verify a system confirms to a standard</term>
<listitem>
<simpara>SUSE Manager uses OpenSCAP as an auditing feature.
It allows you to schedule and view compliance scans for any system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SCAP content</term>
<listitem>
<simpara>SCAP content files defining the test rules can be created from scratch if you understand at least XCCDF or OVAL.
XCCDF content is also frequently published online under open source licenses and this content can be customized to suit your needs.</simpara>
<simpara>The <literal role="systemitem">openscap-content</literal>
package provides default content guidance for systems via a template.</simpara>
</listitem>
</varlistentry>
</variablelist>
<note>
<simpara>SUSE
supports the use of templates to evaluate your systems.
However, you are creating custom content at your own risk.</simpara>
</note>
<simpara>SCAP was created to provide a standardized approach to maintaining system security, and the standards that are used will therefore continually change to meet the needs of the community and enterprise businesses.
New specifications are governed by NIST&#8217;s SCAP Release cycle in order to provide a consistent and repeatable revision work flow.
For more information, see <link xl:href="http://scap.nist.gov/timeline.html">http://scap.nist.gov/timeline.html</link>.</simpara>
</section>
<section xml:id="s1-openscap-suma-prerq">
<title>Prerequisites for Using OpenSCAP in SUSE Manager</title>
<simpara>The following sections describe the server and client prerequisites for using OpenSCAP.</simpara>
<variablelist>
<varlistentry>
<term>Package Requirements</term>
<listitem>
<simpara>As Server: SUSE Manager
1.7 or later.</simpara>
<simpara>For the Client: <literal role="systemitem">spacewalk-oscap</literal> package (available from the SUSE Manager Tools Child Channel).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Other Requirements</term>
<listitem>
<simpara>Client: Distribution of the XCCDF content to all client machines.</simpara>
</listitem>
</varlistentry>
</variablelist>
<note>
<title>OpenSCAP Auditing Availability</title>
<simpara>OpenSCAP auditing is not available on Salt SSH minions.</simpara>
</note>
<simpara>You can distribute XCCDF content to client machines using any of the following methods:</simpara>
<itemizedlist>
<listitem>
<simpara>Traditional Methods (CD, USB, NFS, scp, ftp)</simpara>
</listitem>
<listitem>
<simpara>SUSE Manager Scripts</simpara>
</listitem>
<listitem>
<simpara>RPMs</simpara>
</listitem>
</itemizedlist>
<simpara>Custom RPMs are the recommended way to distribute SCAP content to other machines.
RPM packages can be signed and verified to ensure their integrity.
Installation, removal, and verification of RPM packages can be managed from the user interface.</simpara>
</section>
<section xml:id="s2-openscap-suma-audit-scans">
<title>Performing Audit Scans</title>
<simpara>OpenSCAP integration in SUSE Manager provides the ability to perform audit scans on client systems.
This section describes the available scanning methods.</simpara>
<important>
<title>OpenSCAP Scans via Salt ssh-push Minions</title>
<simpara>Currently performing an OpenSCAP scan is disabled in the WebUI for Salt ssh-push minions.
This functionality will be adapted and enabled in a future release.</simpara>
</important>
<orderedlist xml:id="pro-os-suma-audit-scans-webui" numeration="arabic">
<title>Procedure: Scans via the Web Interface</title>
<listitem>
<simpara>To perform a scan via the Web interface, log in to SUSE Manager .</simpara>
</listitem>
<listitem>
<simpara>Click on <guimenu>Systems</guimenu> and select the target system.</simpara>
</listitem>
<listitem>
<simpara>Click on <menuchoice><guimenu>Audit</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>Fill in the Schedule New XCCDF Scan form. See <xref linkend="sm-audit-schedule"/> for more information about the fields on this page.</simpara>
<warning>
<simpara>The XCCDF content is validated before it is run on the remote system.
Specifying invalid arguments can make spacewalk-oscap fail to validate or run.
Due to security concerns the <literal role="command">oscap xccdf eval</literal> command only accepts a limited set of parameters.</simpara>
</warning>
<simpara>Run the <literal role="command">mgr_check</literal> command to ensure the action is being picked up by the client system.</simpara>
<screen>mgr_check -vv</screen>
</listitem>
</orderedlist>
<note>
<simpara>If <literal role="command">rhnsd</literal> or <literal role="command">osad</literal> are running on the client system, the action will be picked up by these services.
On systemd-based systems, you can check if they are running with:</simpara>
</note>
<simpara>+</simpara>
<screen>service rhnsd start
service osad start</screen>
<simpara>To view the results of the scan, refer to <xref linkend="s2-openscap-suma-audit-scans_view"/>.</simpara>
<figure>
<title>Scheduling a Scan via the Web Interface</title>
<mediaobject>
<imageobject>
<imagedata fileref="audit_openscap_schedule_scan.png" width="333%"/>
</imageobject>
<textobject><phrase>audit openscap schedule scan</phrase></textobject>
</mediaobject>
</figure>
<orderedlist numeration="arabic">
<title>Procedure: Scans via API</title>
<listitem>
<simpara>To perform an audit scan via API, choose an existing script or create a script for scheduling a system scan through <literal>system.scap.scheduleXccdfScan</literal>, the front end API, for example:</simpara>
<screen>#!/usr/bin/python
client = xmlrpclib.Server('https://spacewalk.example.com/rpc/api')
key = client.auth.login('username', 'password')
client.system.scap.scheduleXccdfScan(key, 1000010001,
    '/usr/local/share/scap/usgcb-sled11desktop-xccdf.xml',
    '--profile united_states_government_configuration_baseline')</screen>
<simpara>Where:
<emphasis role="strong"> <literal>1000010001</literal> is the system ID (sid).
</emphasis> <literal role="path">/usr/local/share/scap/usgcb-sled11desktop-xccdf.xml</literal> is the path to the content location on the client system. In this case, it assumes USGCB content in the <literal role="path">/usr/local/share/scap</literal> directory.
** <literal role="option">--profile united_states_government_configuration_baseline</literal> is an additional argument for the <literal role="command">oscap</literal> command. In this case, it is using the USGCB.</simpara>
</listitem>
<listitem>
<simpara>Run the script on the command-line interface of any system. The system needs the appropriate Python and XML-RPC libraries installed.</simpara>
</listitem>
<listitem>
<simpara>Run the <literal role="command">mgr_check</literal> command to ensure that the action is being picked up by the client system.</simpara>
<screen>mgr_check -vv</screen>
<simpara>If the SUSE Manager daemon (<literal role="command">rhnsd</literal>) or <literal role="command">osad</literal> are running on the client system, the action will be picked up by these services.
To check if they are running, use:</simpara>
<screen>service rhnsd start</screen>
<simpara>or</simpara>
<screen>service osad start</screen>
</listitem>
</orderedlist>
<note>
<title>Enabling Upload of Detailed SCAP Files</title>
<simpara>To make sure detailed information about the scan will be available, activate the upload of detailed SCAP files on the clients to be evaluated.
On the <menuchoice><guimenu>Admin</guimenu> <guisubmenu>]
 page</guisubmenu> <guimenuitem>click on menu:Organization[</guimenuitem></menuchoice>
 and select one.
Click on the <menuchoice><guimenu>Configuration</guimenu> <guimenuitem>]
 tab and check menu:Enable Upload Of Detailed SCAP Files[</guimenuitem></menuchoice>
.
This feature generates an additional HTML version when you run a scan.
The results will show an extra line like: <literal>Detailed Results: xccdf-report.html xccdf-results.xml
     scap-yast2sec-oval.xml.result.xml</literal>.</simpara>
</note>
</section>
<section xml:id="s2-openscap-suma-audit-scans_view">
<title>Viewing SCAP Results</title>
<simpara>There are three methods of viewing the results of finished scans:</simpara>
<itemizedlist>
<listitem>
<simpara>Via the Web interface. Once the scan has finished, the results should show up on the <guimenu>Audit</guimenu> tab of a specific system. This page is discussed in <xref linkend="s2-openscap-suma-pages"/>.</simpara>
</listitem>
<listitem>
<simpara>Via the API functions in handler <literal>system.scap</literal>.</simpara>
</listitem>
<listitem>
<simpara>Via the <literal role="command">spacewalk-report</literal> command as follows:</simpara>
<screen>spacewalk-report system-history-scap
spacewalk-report scap-scan
spacewalk-report scap-scan-results</screen>
</listitem>
</itemizedlist>
</section>
<section xml:id="s2-openscap-suma-pages">
<title>OpenSCAP SUSE Manager Web Interface</title>
<simpara>The following sections describe the tabs in the SUSE Manager Web UI that provide access to OpenSCAP and its features.</simpara>
<section xml:id="_openscap_scans_page">
<title>OpenSCAP Scans Page</title>
<simpara>Click the <guimenu>Audit</guimenu>
 tab on the top navigation bar, then OpenSCAP on the left.
Here you can view, search for, and compare completed OpenSCAP scans.</simpara>
<section xml:id="_openscap_menuall_scans">
<title><menuchoice><guimenu>OpenSCAP</guimenu> <guisubmenu>]</guisubmenu> <guimenuitem>menu:All Scans[</guimenuitem></menuchoice></title>
<simpara><menuchoice><guimenu>All Scans</guimenu> <guimenuitem>]
 is the default page that appears on the menu:Audit[OpenSCAP</guimenuitem></menuchoice>
 page.
Here you see all the completed OpenSCAP scans you have permission to view.
Permissions for scans are derived from system permissions.</simpara>
<simpara>For each scan, the following information is displayed:</simpara>
<variablelist>
<varlistentry>
<term>System</term>
<listitem>
<simpara>the scanned system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>XCCDF Profile</term>
<listitem>
<simpara>the evaluated profile.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Completed</term>
<listitem>
<simpara>time of completion.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Satisfied</term>
<listitem>
<simpara>number of rules satisfied.
A rule is considered to be satisfied if the result of the evaluation is either Pass or Fixed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Dissatisfied</term>
<listitem>
<simpara>number of rules that were not satisfied.
A rule is considered Dissatisfied if the result of the evaluation is a Fail.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Unknown</term>
<listitem>
<simpara>number of rules which failed to evaluate.
A rule is considered to be Unknown if the result of the evaluation is an Error, Unknown or Not Checked.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>The evaluation of XCCDF rules may also return status results like <literal>Informational</literal>, <literal>Not Applicable</literal>, or not <literal>Selected</literal>.
In such cases, the given rule is not included in the statistics on this page.
See <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Audit</guimenuitem></menuchoice>
 for information on these types of results.</simpara>
</section>
<section xml:id="_openscap_menuxccdf_diff">
<title><menuchoice><guimenu>OpenSCAP</guimenu> <guisubmenu>]</guisubmenu> <guimenuitem>menu:XCCDF Diff[</guimenuitem></menuchoice></title>
<simpara>XCCDF Diff is an application that visualizes the comparison of two XCCDF scans.
It shows metadata for two scans as well as the lists of results.</simpara>
<simpara>Click the appropriate icon on the Scans page to access the diff output of similar scans.
Alternatively, specify the ID of scans you want to compare.</simpara>
<simpara>Items that show up in only one of the compared scans are considered to be "varying". Varying items are always highlighted in beige.
There are three possible comparison modes:</simpara>
<variablelist>
<varlistentry>
<term>Full Comparison</term>
<listitem>
<simpara>all the scanned items.</simpara>
<variablelist>
<varlistentry>
<term>Only Changed Items</term>
<listitem>
<simpara>items that have changed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Only Invariant</term>
<listitem>
<simpara>unchanged or similar items.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="_openscap_menuadvanced_search">
<title><menuchoice><guimenu>OpenSCAP</guimenu> <guisubmenu>]</guisubmenu> <guimenuitem>menu:Advanced Search[</guimenuitem></menuchoice></title>
<simpara>Use the Advanced Search page to search through your scans according to specified criteria including:</simpara>
<itemizedlist>
<listitem>
<simpara>rule results,</simpara>
</listitem>
<listitem>
<simpara>targeted machine,</simpara>
</listitem>
<listitem>
<simpara>time frame of the scan.</simpara>
</listitem>
</itemizedlist>
<figure>
<title>OpenSCAP Advanced Search</title>
<mediaobject>
<imageobject>
<imagedata fileref="audit_openscap_advanced_search.png" width="333%"/>
</imageobject>
<textobject><phrase>audit openscap advanced search</phrase></textobject>
</mediaobject>
</figure>
<simpara>The search either returns a list of results or a list of scans, which are included in the results.</simpara>
</section>
</section>
<section xml:id="sm-audit-page">
<title>Systems Audit Page</title>
<simpara>To display a system&#8217;s audit page, click <menuchoice><guimenu>Systems</guimenu> <guisubmenu>system_name</guisubmenu> <guimenuitem>Audit</guimenuitem></menuchoice>
.
Use this page to schedule and view compliance scans for a particular system.
Scans are performed by the OpenSCAP tool, which implements NIST&#8217;s standard Security Content Automation Protocol (SCAP). Before you scan a system, make sure that the SCAP content is prepared and all prerequisites in <xref linkend="s1-openscap-suma-prerq"/> are met.</simpara>
<section xml:id="_list_scans">
<title>List Scans</title>
<simpara>This subtab lists a summary of all scans completed on the system.
The following columns are displayed:</simpara>
<variablelist>
<varlistentry>
<term>XCCDF Test Result</term>
<listitem>
<simpara>The scan test result name, which provides a link to the detailed results of the scan.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Completed</term>
<listitem>
<simpara>The exact time the scan finished.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Compliance</term>
<listitem>
<simpara>The unweighted pass/fail ratio of compliance based on the Standard used.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>P</term>
<listitem>
<simpara>Number of checks that passed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>F</term>
<listitem>
<simpara>Number of checks that failed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>E</term>
<listitem>
<simpara>Number of errors that occurred during the scan.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>U</term>
<listitem>
<simpara>Unknown.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>N</term>
<listitem>
<simpara>Not applicable to the machine.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>K</term>
<listitem>
<simpara>Not checked.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>S</term>
<listitem>
<simpara>Not Selected.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>I</term>
<listitem>
<simpara>Informational.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>X</term>
<listitem>
<simpara>Fixed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Total</term>
<listitem>
<simpara>Total number of checks.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Each entry starts with an icon indicating the results of a comparison to a previous similar scan.
The icons indicate the following:</simpara>
<itemizedlist>
<listitem>
<simpara>"RHN List Checked" Icon&#8201;&#8212;&#8201;no difference between the compared scans.</simpara>
</listitem>
<listitem>
<simpara>"RHN List Alert" Icon&#8201;&#8212;&#8201;arbitrary differences between the compared scans.</simpara>
</listitem>
<listitem>
<simpara>"RHN List Error" Icon&#8201;&#8212;&#8201;major differences between the compared scans. Either there are more failures than the previous scan or less passes</simpara>
</listitem>
<listitem>
<simpara>"RHN List Check In" Icon&#8201;&#8212;&#8201;no comparable scan was found, therefore, no comparison was made.</simpara>
</listitem>
</itemizedlist>
<simpara>To find out what has changed between two scans in more detail, select the ones you are interested in and click <menuchoice><guimenu>Compare Selected Scans</guimenu> <guisubmenu>]
.
To delete scans that are no longer relevant</guisubmenu> <guimenuitem>select those and click on menu:Remove Selected Scans[</guimenuitem></menuchoice>
.
Scan results can also be downloaded in CSV format.</simpara>
</section>
<section xml:id="_scan_details">
<title>Scan Details</title>
<simpara>The Scan Details page contains the results of a single scan.
The page is divided into two sections:</simpara>
<variablelist>
<varlistentry>
<term>Details of the XCCDF Scan</term>
<listitem>
<simpara>This section displays various details about the scan, including:</simpara>
<itemizedlist>
<listitem>
<simpara>File System Path: the path to the XCCDF file used for the scan.</simpara>
</listitem>
<listitem>
<simpara>Command-line Arguments: any additional command-line arguments that were used.</simpara>
</listitem>
<listitem>
<simpara>Profile Identifier: the profile identifier used for the scan.</simpara>
</listitem>
<listitem>
<simpara>Profile Title: the title of the profile used for the scan.</simpara>
</listitem>
<listitem>
<simpara>Scan&#8217;s Error output: any errors encountered during the scan.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>XCCDF Rule Results</term>
<listitem>
<simpara>The rule results provide the full list of XCCDF rule identifiers, identifying tags, and the result for each of these rule checks.
This list can be filtered by a specific result.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="sm-audit-schedule">
<title>Schedule Page</title>
<simpara>Use the Schedule New XCCDF Scan page to schedule new scans for specific machines.
Scans occur at the system&#8217;s next scheduled check-in that occurs after the date and time specified.
The following fields can be configured:</simpara>
<variablelist>
<varlistentry>
<term>Command-line Arguments</term>
<listitem>
<simpara>Optional arguments to the <literal role="command">oscap</literal> command, either:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>--profile PROFILE</literal>: Specifies a particular profile from the XCCDF document.</simpara>
<simpara>Profiles are determined by the Profile tag in the XCCDF XML file.
Use the <literal role="command">oscap</literal> command to see a list of profiles within a given XCCDF file, for example:</simpara>
<screen># oscap info /usr/local/share/scap/dist_sles12_scap-sles12-oval.xml
Document type: XCCDF Checklist
Checklist version: 1.1
Status: draft
Generated: 2015-12-12
Imported: 2016-02-15T22:09:33
Resolved: false
Profiles: SLES12-Default</screen>
<simpara>If not specified, the default profile is used.
Some early versions of OpenSCAP in require that you use the <literal>--profile</literal> option or the scan will fail.</simpara>
</listitem>
<listitem>
<simpara><literal>--skip-valid</literal>: Do not validate input and output files. You can use this option to bypass the file validation process if you do not have well-formed XCCDF content.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Path to XCCDF Document</term>
<listitem>
<simpara>This is a required field.
The path parameter points to the XCCDF content location on the client system.
For example: <literal role="path">/usr/local/share/scap/dist_sles12_scap-sles12-oval.xml</literal></simpara>
<warning>
<simpara>The XCCDF content is validated before it is run on the remote system.
Specifying invalid arguments can cause <literal role="command">spacewalk-oscap</literal> to fail to validate or run.
Due to security concerns, the <literal role="command">oscap xccdf eval</literal> command only accepts a limited set of parameters.</simpara>
</warning>
</listitem>
</varlistentry>
</variablelist>
<simpara>For information about how to schedule scans using the Web UI
, refer to <xref linkend="pro-os-suma-audit-scans-webui"/>.</simpara>
</section>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.config">
<title>Configuration</title>
<simpara>Only Configuration Administrators or SUSE Manager Administrators see the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice> pages.</simpara>
<simpara>On this configuration pages, manage systems with configuration files, channels offering configuration files, and configartion files themselves.
Centrally-managed files are available to multiple systems; locally-managed files are available to individual systems only.</simpara>
<note>
<title>Differences of System Types</title>
<simpara>Configuration Managment is available for both client system types, traditionally managed clients ([Management]) and Salt minions ([Salt]).
Some traditional features are not suitable for Salt minions, and thus not available and excluded from the Web UI.</simpara>
</note>
<section xml:id="_configuration_management_for_salt">
<title>Configuration Management for Salt</title>
<simpara>Configuration Management is now enabled for Salt.
The following matrix provides both supported and unsupported configuration management features.</simpara>
<important>
<title>Missing Web UI Options</title>
<simpara>Several Web UI tabs will be missing for Salt Configuration Management.
These features are not suitable for Salt minions.</simpara>
</important>
<table frame="all" rowsep="1" colsep="1">
<title>Salt Configuration Management</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Configuration Management Features</entry>
<entry align="left" valign="top">Salt Support Status</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Global Configuration Channels</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Deploying Files</simpara></entry>
<entry align="left" valign="top"><simpara>Supported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Comparing Files</simpara></entry>
<entry align="left" valign="top"><simpara>Supported (but the logic is currently inverted)</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Locally Managed Files</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Sandbox Files</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Applying the Highstate</simpara></entry>
<entry align="left" valign="top"><simpara>Apply the highstate and configuration channels will be deployed to all subscribed systems.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>File Import from a Client</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Configuration Macros</simpara></entry>
<entry align="left" valign="top"><simpara>Unsupported</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="ref.webui.config.preparing">
<title>Preparing Systems for Configuration Management [Management]</title>
<simpara>To manage a traditional client&#8217;s configuration with SUSE Manager, it must have the appropriate tools and the <literal role="path">config-enable</literal> file installed.
These tools will be available if you installed the system with the configuration management functionality using AutoYaST or Kickstart.
If not, they can be found in the Tools child channel for your distribution.
Download and install the latest <literal role="path">rhncfg*</literal> packages:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="path">rhncfg</literal>&#8201;&#8212;&#8201;the base libraries and functions needed by all <literal role="path">rhncfg-*</literal> packages,</simpara>
</listitem>
<listitem>
<simpara><literal role="path">rhncfg-actions</literal>&#8201;&#8212;&#8201;the RPM package required to run configuration actions scheduled via SUSE Manager,</simpara>
</listitem>
<listitem>
<simpara><literal role="path">rhncfg-client</literal>&#8201;&#8212;&#8201;the RPM package with a command line interface to the client features of the Configuration Management system,</simpara>
</listitem>
<listitem>
<simpara><literal role="path">rhncfg-management</literal>&#8201;&#8212;&#8201;the RPM package with a command line interface used to manage SUSE Manager configuration.</simpara>
</listitem>
</itemizedlist>
<simpara>Installation of these packages can also be accomplished during bootstrapping if you enable <literal role="guimenu">Configuration File Deployment</literal> on the <literal role="guimenu">Details</literal> page of the activation key after creating that activation key.
For more information about activation keys, see
<xref linkend="s3-sm-system-keys-manage"/>.</simpara>
</section>
<section xml:id="ref.webui.config.overview">
<title>Overview</title>
<simpara>The <literal role="guimenu">Configuration Overview</literal> page shows all of the configuration files that are managed by your organization in SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="configuration_overview.png" width="80%"/>
</imageobject>
<textobject><phrase>configuration overview</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>This list includes files that are managed centrally in configuration channels and files that are managed locally via individual system profiles.</simpara>
<variablelist>
<varlistentry>
<term>Configuration Summary</term>
<listitem>
<simpara>The panel provides quick information about your configuration files.
Click the blue text to the right to display relevant systems, channel details, or configuration files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Configuration Actions</term>
<listitem>
<simpara><literal role="guimenu">Configuration Actions</literal> offers direct access to the most common configuration management tasks.
Deploy, compare, or create files on your systems.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Recently Modified Configuration Files</term>
<listitem>
<simpara>The list shows which files have changed when and to which channel they belong.
If no files have been changed, no list appears.
Click the name of a file to see its <literal role="guimenu">Details</literal> page.
Click the channel name to see its <literal role="guimenu">Channel Details</literal> page.</simpara>
<simpara>File types that can appear here:
* <inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-software-channels.svg"/>
</imageobject>
<textobject><phrase>Spacewalk Icon Software Channels</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;Centrally-managed configuration file provided by a global configuration channel.
* <inlinemediaobject>
<imageobject>
<imagedata fileref="fa-desktop.svg"/>
</imageobject>
<textobject><phrase>FA Desktop</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;[Management] Locally-managed configuration file, maybe overriding a centrally-managed file.
* <inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-sandbox.svg"/>
</imageobject>
<textobject><phrase>Spacewalk Icon Sandbox</phrase></textobject>
</inlinemediaobject>&#8201;&#8212;&#8201;[Management] Sandbox configuration file.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Recently Scheduled Configuration File Deployments</term>
<listitem>
<simpara>Each scheduled action is listed along with the status of the action.
Any scheduled configuration task, from enabling configuration management on a system to deploying a specific configuration file, is displayed.
Here you can quickly assess if all tasks have been successfully carried out or fix any problems.
Clicking the blue text displays the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> page for the specified system.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="ref.webui.config.channels">
<title>Configuration Channels</title>
<simpara>As mentioned above, SUSE Manager manages both central and local configuration channels and files.
Central configuration management allows you to deploy configuration files to multiple systems (both traditional clients ([Management]) and Salt minions ([Salt])).
Local configuration management is available for traditional clients ([Management]) only and allows you to specify overrides or configuration files that are not changed by subscribing the system to a central channel.</simpara>
<simpara>A <quote>state channel</quote> is a type of a configuration channel but for Salt minion only.
For a state channel, the <literal role="path">init.sls</literal> file is not auto-generated, the user creates and edits it.
Additionally, state channels can contain arbitrary configuration files that could be referenced from within the <literal role="path">init.sls</literal> file.
Therefore, state channels effectively replace custom states.</simpara>
<note>
<title>Referencing Configuration Files with Organization ID</title>
<simpara>You must reference configuration files with the <literal>salt://</literal> prefix, the organization ID, and the channel name.
For example, to reference <literal role="path">/etc/motd</literal> use:</simpara>
<screen>file.managed:  - source: salt://manager_org_1/`channel_name`/etc/motd</screen>
</note>
<simpara>Central configuration or state channels must be created via the links on this page.</simpara>
<simpara>Click the name of the configuration channel to see the details page for that channel.
If you click the number of files in the channel, you are taken to the <literal role="guimenu">List/Remove Files</literal> page of that channel.
If you click the number of systems subscribed to the configuration channel, you are taken to the <menuchoice><guimenu>Configuration Channel Details</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Subscribed   Systems</guimenuitem></menuchoice> page for that channel.</simpara>
<simpara>To create a new central configuration channel:</simpara>
<orderedlist xml:id="proc.config.channels.create.cfgch" numeration="arabic">
<title>Procedure: Creating Central Configuration Channel</title>
<listitem>
<simpara>Click the <literal role="guimenu">Create Config Channel</literal> link in the upper right corner of this screen.</simpara>
</listitem>
<listitem>
<simpara>Enter a name for the channel.</simpara>
</listitem>
<listitem>
<simpara>Enter a label for the channel. This field must contain only letters, numbers, hyphens (<literal>-</literal>) and underscores (<literal>_</literal>).</simpara>
</listitem>
<listitem>
<simpara>Enter a mandatory description for the channel that allows you to distinguish it from other channels. No character restrictions apply.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Create Config Channel</guibutton> button to create the new channel.</simpara>
</listitem>
<listitem>
<simpara>The following page is a subset of the <literal role="guimenu">Channel Details</literal> page and has three tabs: <literal role="guimenu">Overview</literal> , <literal role="guimenu">Add Files</literal> , and <literal role="guimenu">Systems</literal> . The <literal role="guimenu">Channel Details</literal> page is discussed in <xref linkend="config-config-channels-channel-details"/>.</simpara>
</listitem>
</orderedlist>
<simpara>To create a new state channel with an <literal role="path">init.sls</literal> file:</simpara>
<orderedlist xml:id="proc.config.channels.create.statech" numeration="arabic">
<title>Procedure: Creating State Channel [Salt]</title>
<listitem>
<simpara>Click the <literal role="guimenu">Create State Channel</literal> link in the upper right corner of this screen.</simpara>
</listitem>
<listitem>
<simpara>Enter a name for the channel.</simpara>
</listitem>
<listitem>
<simpara>Enter a label for the channel. This field must contain only letters, numbers, hyphens (<literal>-</literal>) and underscores (<literal>_</literal>).</simpara>
</listitem>
<listitem>
<simpara>Enter a mandatory description for the channel that allows you to distinguish it from other channels. No character restrictions apply.</simpara>
</listitem>
<listitem>
<simpara>Enter the <literal role="guimenu">SLS Contents</literal> for the <literal role="path">init.sls</literal> file.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Create Config Channel</guibutton> button to create the new channel.</simpara>
</listitem>
<listitem>
<simpara>The following page is a subset of the <literal role="guimenu">Channel Details</literal> page and has four tabs: <literal role="guimenu">Overview</literal>, <literal role="guimenu">List/Remove Files</literal>, <literal role="guimenu">Add Files</literal>, and <literal role="guimenu">Systems</literal>. The <literal role="guimenu">Channel Details</literal> page is discussed in <xref linkend="config-config-channels-channel-details"/>.</simpara>
</listitem>
</orderedlist>
<section xml:id="config-config-channels-channel-details">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Configuration Channels</guisubmenu> <guimenuitem>Configuration Channel Details</guimenuitem></menuchoice></title>
<variablelist>
<varlistentry>
<term>Overview</term>
<listitem>
<simpara>The <literal role="guimenu">Overview</literal> page of the <literal role="guimenu">Configuration Channel Details</literal>
page is divided into several panels.</simpara>
<variablelist>
<varlistentry>
<term>Channel Information</term>
<listitem>
<simpara>The panel provides status information for the contents of the channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Configuration Actions</term>
<listitem>
<simpara>The panel provides access to the most common configuration tasks.
For Salt minions, there is a link to edit the <literal role="path">init.sls</literal> file.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Channel Properties [Management]</term>
<listitem>
<simpara>By clicking the <literal role="guimenu">Edit Properties</literal> link, you can edit the name, label, and description of the channel.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry>
<term>List/Remove Files</term>
<listitem>
<simpara>This page only appears if there are files in the configuration channel.
You can remove files or copy the latest versions into a set of local overrides or into other central configuration channels.
Check the box next to files you want to manipulate and click the respective action button.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Add Files</term>
<listitem>
<simpara>The <literal role="guimenu">Add Files</literal> page has three subtabs of its own, which allow you to <literal role="guimenu">Upload</literal>, <literal role="guimenu">Import</literal>, or <literal role="guimenu">Create</literal> configuration files to be included in the channel.</simpara>
<variablelist>
<varlistentry>
<term>Upload File</term>
<listitem>
<simpara>To upload a file into the configuration channel, browse for the file on your local system, populate all fields, and click the <guibutton>Upload Configuration File</guibutton> button.
The <literal role="guimenu">Filename/Path</literal> field is the absolute path where the file will be deployed.</simpara>
<simpara>You can set the <literal role="guimenu">Ownership</literal> via the <literal role="guimenu">user name</literal> and <literal role="guimenu">group name</literal> and the <literal role="guimenu">Permissions</literal> of the file when it is deployed.</simpara>
<simpara>If the client has SELinux enabled, you can configure <literal role="guimenu">SELinux contexts</literal> to enable the required file attributes (such as user, role, and file type).</simpara>
<simpara>If the configuration file includes a macro (a variable in a configuration file), enter the symbol that marks the beginning and end of the macro.
For more information on using macros, see <xref linkend="s3-sm-file-macros"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Import Files</term>
<listitem>
<simpara>To import files from other configuration channels, including any locally-managed channels, check the box to the left of any file you want to import.
Then click the <guibutton>Import Configuration File(s)</guibutton> button.</simpara>
<note>
<simpara>A sandbox icon (<inlinemediaobject>
<imageobject>
<imagedata fileref="spacewalk-icon-sandbox.svg"/>
</imageobject>
<textobject><phrase>Spacewalk Icon Sandbox</phrase></textobject>
</inlinemediaobject>) indicates that the listed file is currently located in a local sandbox.
Files in a system&#8217;s sandbox are considered experimental and could be unstable.
Use caution when selecting them for a central configuration channel.</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term>Create File</term>
<listitem>
<simpara>Create a configuration file, directory, or symbolic link from scratch to be included in the configuration channel.</simpara>
</listitem>
</varlistentry>
</variablelist>
<orderedlist numeration="lowerroman">
<title>Procedure: Creating a Configuration File, Directory, or Symbolic Link From Scratch</title>
<listitem>
<simpara>Choose whether you want to create a text file, directory, or symbolic link in the <literal role="guimenu">File Type</literal> section.</simpara>
</listitem>
<listitem>
<simpara>In the <literal role="path">Filename/Path</literal> text box, set the absolute path to where the file should be deployed.</simpara>
</listitem>
<listitem>
<simpara>If you are creating a symbolic link, indicate the target file and path in the <literal role="guimenu">Symbolic Link Target Filename/Path</literal> text box.</simpara>
</listitem>
<listitem>
<simpara>Enter the <literal role="guimenu">User name</literal> and <literal role="guimenu">Group name</literal> for the file in the <literal role="guimenu">Ownership</literal> section, and the <literal role="guimenu">File Permissions Mode</literal>.</simpara>
</listitem>
<listitem>
<simpara>If the client has SELinux enabled, you can configure <literal role="guimenu">SELinux contexts</literal> to enable the required file attributes (such as user, role, and file type).</simpara>
</listitem>
<listitem>
<simpara>If the configuration file includes a macro, enter the symbol that marks the beginning and end of the macro.</simpara>
</listitem>
<listitem>
<simpara>Then enter the configuration file content in the <literal role="guimenu">File Contents</literal> field, using the script drop-down box to choose the appropriate scripting language.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Create Configuration File</guibutton> button to create the new file.</simpara>
</listitem>
</orderedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Deploy Files</term>
<listitem>
<simpara>This page only appears when there are files in the channel and a system is subscribed to the channel.
Deploy all files by clicking the <guibutton>Deploy All Files</guibutton> button or check selected files and click the <guibutton>Deploy Selected Files</guibutton> button.
Select to which systems the file(s) should be applied.
All systems subscribed to this channel are listed.
If you want to apply the file to a different system, subscribe it to the channel first.
To deploy the files, click <guibutton>Confirm &amp; Deploy to Selected Systems</guibutton>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Systems</term>
<listitem>
<simpara>Manage systems subscribed to the configuration channel via two subtabs:</simpara>
<variablelist>
<varlistentry>
<term>Subscribed Systems</term>
<listitem>
<simpara>All systems subscribed to the current channel are displayed.
Click the name of a system to see the <literal role="guimenu">System Details</literal> page.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Target Systems</term>
<listitem>
<simpara>This subtab displays a list of systems enabled for configuration management but not yet subscribed to the channel.
To add a system to the configuration channel, check the box to the left of the system&#8217;s name and click the <guibutton>Subscribe System</guibutton> button.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section xml:id="ref.webui.config.files">
<title>Configuration Files</title>
<simpara>This page allows you to manage your configuration files independently.
Both centrally-managed and locally-managed files can be reached from sub-pages.</simpara>
<note>
<title>Maximum Size for Configuration Files</title>
<simpara>By default, the maximum file size for configuration files is 128 KB (131072 bytes). SUSE supports a configuration file size up to 1 MB; larger values are not guaranteed to work.</simpara>
</note>
<simpara>To change the file size limit, edit all the following files on the SUSE Manager server and edit or add the following variables:</simpara>
<screen># /usr/share/rhn/config-defaults/rhn_web.conf
web.maximum_config_file_size = 262144

# /usr/share/rhn/config-defaults/rhn_server.conf
maximum_config_file_size = 262144

# /etc/rhn/rhn.conf
web.maximum_config_file_size=262144
server.maximum_config_file_size=262144</screen>
<simpara>Then restart <literal role="systemitem">spacewalk</literal>:</simpara>
<screen># spacewalk-service restart</screen>
<section xml:id="configuration-files-central">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Configuration Files</guisubmenu> <guimenuitem>Centrally-Managed Files</guimenuitem></menuchoice></title>
<simpara>Centrally-managed files are available to multiple systems.
Changing a file within a centrally-managed channel may result in changes to several systems.
Locally-managed files supersede centrally-managed files.
For more information about locally-managed files, see
<xref linkend="configuration-files-local"/>.</simpara>
<simpara>This page lists all files currently stored in your central configuration channel.
Click the <literal role="guimenu">Path</literal> of a file to see its <literal role="guimenu">Details</literal> tab.
Click the name of the <literal role="guimenu">Configuration Channel</literal> to see the channel&#8217;s <literal role="guimenu">Overview</literal> tab.
Clicking <literal role="guimenu">Systems Subscribed</literal> shows you all systems currently subscribed to the channel containing that file.
Click <literal role="guimenu">Systems Overriding</literal> to see all systems that have a local (or override) version of the configuration file.
The centrally-managed file will not be deployed to those systems.</simpara>
</section>
<section xml:id="configuration-files-local">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Configuration Files</guisubmenu> <guimenuitem>Locally-Managed Files</guimenuitem></menuchoice> [Management]</title>
<simpara>Locally-managed configuration files apply to only one system.
They may be files in the system&#8217;s sandbox or files that can be deployed to the system at any time.
Local files have higher priority than centrally-managed files.
If a system is subscribed to a configuration channel with a given file and additionally has a locally-managed version of that file, the locally-managed version will be deployed.</simpara>
<simpara>The list of all local (override) configuration files for your systems includes the local configuration channels and the sandbox channel for each Provisioning-entitled system.</simpara>
<simpara>Click the <literal role="guimenu">Path</literal> of the file to see its <literal role="guimenu">Config File Details</literal>.
Click the name of the system to which it belongs to see its <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.</simpara>
<section xml:id="s3-sm-file-macros">
<title>Including Macros in your Configuration Files</title>
<simpara>Being able to store one file and share identical configurations is useful, but what if you have many variations of the same configuration file? What do you do if you have configuration files that differ only in system-specific details, such as host name and MAC address?</simpara>
<simpara>Traditional file management would require to upload and distribute each file separately, even if the distinction is nominal and the number of variations is in the hundreds or thousands. SUSE Manager addresses this by allowing the inclusion of macros, or variables, within the configuration files it manages.
In addition to variables for custom system information, the following standard macros are supported:</simpara>
<screen>rhn.system.sid
rhn.system.profile_name
rhn.system.description
rhn.system.hostname
rhn.system.ip_address
rhn.system.custom_info(key_name)
rhn.system.net_interface.ip_address(eth_device)
rhn.system.net_interface.netmask(eth_device)
rhn.system.net_interface.broadcast(eth_device)
rhn.system.net_interface.hardware_address(eth_device)
rhn.system.net_interface.driver_module(eth_device)</screen>
<simpara>To use this powerful feature, either upload or create a configuration file via the <literal role="guimenu">Configuration Channel Details</literal> page.
Then open its <literal role="guimenu">Configuration File Details</literal> page and include the supported macros of your choice.
Ensure that the delimiters used to offset your variables match those set in the <literal role="guimenu">Macro Start Delimiter</literal> and <literal role="guimenu">Macro End Delimiter</literal> fields and do not conflict with other characters in the file.
We recommend that the delimiters be two characters in length and must not contain the percent (<literal>%</literal>) symbol.</simpara>
<simpara>For example, you may have a file applicable to all of your servers that differs only in IP address and host name.
Rather than manage a separate configuration file for each server, you may create a single file, such as <literal role="path">server.conf</literal>, with the IP address and host name macros included.</simpara>
<screen>hostname={| rhn.system.hostname |}
ip_address={| rhn.system.net_interface.ip_address(eth0) |}</screen>
<simpara>Upon delivery of the file to individual systems, whether through a scheduled action in the SUSE Manager Web interface or at the command line with the SUSE Manager Configuration Client (<literal role="command">mgrcfg-client</literal>), the variables will be replaced with the host name and IP address of the system as recorded in SUSE Manager&#8217;s system profile.
In the above example configuration file the deployed version resembles the following:</simpara>
<screen>hostname=test.example.domain.com
ip_address=177.18.54.7</screen>
<simpara>To capture custom system information, insert the key label into the custom information macro (<literal>rhn.system.custom_info</literal>). For example, if you developed a key labeled <quote><literal>asset</literal></quote> you can add it to the custom information macro in a configuration file to have the value substituted on any system containing it.
The macro would look like this:</simpara>
<screen>asset={@ rhn.system.custom_info(asset) @}</screen>
<simpara>When the file is deployed to a system containing a value for that key, the macro gets translated, resulting in a string similar to the following:</simpara>
<screen>asset=Example#456</screen>
<simpara>To include a default value, for example, if one is required to prevent errors, you can append it to the custom information macro, like this:</simpara>
<screen>asset={@ rhn.system.custom_info(asset) = 'Asset #' @}</screen>
<simpara>This default is overridden by the value on any system containing it.</simpara>
<simpara>Using the SUSE Manager Configuration Manager (<literal role="command">mgrcfg-manager</literal>) will not translate or alter files, as this tool is system agnostic. <literal role="command">mgrcfg-manager</literal> does not depend on system settings.
Binary files cannot be interpolated.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.config.systems">
<title>Systems</title>
<simpara>This page displays status information about your system in relation to configuration.
There are two sub-pages: <literal role="guimenu">Managed Systems</literal> and <literal role="guimenu">Target Systems</literal>.</simpara>
<section xml:id="config-systems-managed">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Managed Systems</guimenuitem></menuchoice></title>
<simpara>By default the <literal role="guimenu">Managed Systems</literal> page is displayed.
The listed systems have been fully prepared for configuration file deployment.
The number of locally- and centrally-managed files is displayed.
Clicking the name of a system shows its <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.
Clicking the number of local files takes you to the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>View/Modify Files</guisubmenu> <guimenuitem>Locally-Managed Files</guimenuitem></menuchoice> page, where you manage which local (override) files apply to the system.
Clicking the number of centrally-managed files takes you to the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Manage Configuration Channels</guisubmenu> <guimenuitem>List/Unsubscribe    from Channels</guimenuitem></menuchoice> page.
Here you unsubscribe from any channels you want.</simpara>
</section>
<section xml:id="config-systems-target">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Configuration</guisubmenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Target Systems</guimenuitem></menuchoice></title>
<simpara>Here you see the systems either not prepared for configuration file deployment or not yet subscribed to a configuration channel.
The table has three columns.
The first identifies the system name, the second shows whether the system is prepared for configuration file deployment, and the third lists the steps necessary to prepare the system.
To prepare a system, check the box to the left of the profile name then click the <guibutton>Enable SUSE Manager Configuration Management</guibutton> button.
All of the preparatory steps that can be automatically performed are scheduled by SUSE Manager.</simpara>
<note>
<simpara>You will need to perform some manual tasks to enable configuration file deployment.
Follow the on-screen instructions provided to assist with each step.</simpara>
</note>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.schedule">
<title>Schedule</title>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> helps with managing actions and combining actions to action chains.</simpara>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> features pages that enable you to manage the actions carried out on your systems.
An action is a scheduled task to be performed on one or more client systems.
For example, an action can be scheduled to apply all patches to a system.
Actions can also be grouped into action chains to schedule them at the same time in a particular order, for example to reboot a system after deploying patches.</simpara>
<simpara>SUSE Manager keeps track of the following action types:</simpara>
<itemizedlist>
<listitem>
<simpara>package alteration (installation, upgrade, and removal),</simpara>
</listitem>
<listitem>
<simpara>rollback package actions,</simpara>
</listitem>
<listitem>
<simpara>system reboots,</simpara>
</listitem>
<listitem>
<simpara>patch application,</simpara>
</listitem>
<listitem>
<simpara>configuration file alteration (deploy, upload, and diff),</simpara>
</listitem>
<listitem>
<simpara>hardware profile updates,</simpara>
</listitem>
<listitem>
<simpara>package list profile updates,</simpara>
</listitem>
<listitem>
<simpara>automated installation initiation,</simpara>
</listitem>
<listitem>
<simpara>service pack migrations,</simpara>
</listitem>
<listitem>
<simpara>remote commands.</simpara>
</listitem>
</itemizedlist>
<simpara>Each page in the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Schedule</guimenuitem></menuchoice> category represents an action status.</simpara>
<section xml:id="ref.webui.schedule.pending">
<title>Pending Actions</title>
<simpara>The <menuchoice><guimenu>Pending Actions</guimenu> <guisubmenu>] page appears when clicking menu:Main Menu[Schedule</guisubmenu> <guimenuitem>Pending Actions</guimenuitem></menuchoice>.
It displays actions not yet started or still in progress.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="schedule_pending_actions.png" width="80%"/>
</imageobject>
<textobject><phrase>schedule pending actions</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To cancel an action, select the action, and click <literal role="guimenu">Cancel Actions</literal>, then <guibutton>Confirm</guibutton>.</simpara>
</section>
<section xml:id="ref.webui.schedule.fail">
<title>Failed Actions</title>
<simpara>Sometimes actions cannot be completed.
If the action returns an error, it is displayed here.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="schedule_failed_actions.png" width="80%"/>
</imageobject>
<textobject><phrase>schedule failed actions</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.schedule.compl">
<title>Completed Actions</title>
<simpara>List of actions successfully carried out.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="schedule_completed_actions.png" width="80%"/>
</imageobject>
<textobject><phrase>schedule completed actions</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s2-sm-action-arch">
<title>Archived Actions</title>
<simpara>If you selected actions to store for review, they are displayed here and can be deleted.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="schedule_archived_actions.png" width="80%"/>
</imageobject>
<textobject><phrase>schedule archived actions</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.schedule.chains">
<title>Action Chains</title>
<simpara>You can create action chains-or grouped actions-for example, in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Packages</guimenuitem></menuchoice> or <menuchoice><guimenu>Software</guimenu> <guimenuitem>Packages</guimenuitem></menuchoice> subtabs on a system details page (see
<xref linkend="s4-sm-system-details-errata"/>
or
<xref linkend="s4-sm-system-details-packages"/>)
or in the <menuchoice><guimenu>Configuration</guimenu> <guimenuitem>Deploy Files</guimenuitem></menuchoice> subtab on a system details page (see
<xref linkend="s5-sdc-configuration-deploy-files"/>).</simpara>
<simpara>The following list of actions may be added to an action chain.
These actions are supported on both traditional clients and Salt minions.
Schedulable actions are located under a systems, <literal role="guimenu">System Details</literal> page on the following subtabs.</simpara>
<itemizedlist>
<title>Chainable Actions</title>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Remote Command</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Schedule System Reboot</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>States</guisubmenu> <guimenuitem>Highstate</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>List/Remove</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>Install</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guisubmenu>Packages</guisubmenu> <guimenuitem>Upgrade</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Patches</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Software Channels</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>System Details</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Build</guimenuitem></menuchoice></simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="schedule_action_chains.png" width="80%"/>
</imageobject>
<textobject><phrase>schedule action chains</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>In the <literal role="guimenu">Action Chain List</literal> you can click the label to view or edit an <literal role="guimenu">Action Chain</literal>.
In the top right corner is the <literal role="guimenu">delete action chain</literal> link.
To add actions to an existing chain, pick up a <quote>chainable</quote> action (such as running a remote command) from a system details page (see
<xref linkend="s3-sm-system-details"/>).
Then check <literal role="guimenu">Add to Action Chain</literal> and select an action chain from the drop-down box.
Confirm with <guibutton>Schedule</guibutton>.</simpara>
<simpara>To create a new action chain, configure the first action, then select <literal role="guimenu">Add to Action Chain</literal> instead of <literal role="guimenu">Schedule no sooner than</literal>.
Click the drop-down box, enter a name, and click <guibutton>Schedule</guibutton> to save the chain.
Then proceed to the next action and add it to the new chain.</simpara>
<simpara>Action chains can be edited via the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Schedule</guisubmenu> <guimenuitem>Action Chains</guimenuitem></menuchoice> page.
Click a chain name to see the actions in the order they will be performed.
The following tasks can be carried out here:</simpara>
<itemizedlist>
<listitem>
<simpara>Change the order of actions by dragging the respective action to the right position and dropping it.</simpara>
</listitem>
<listitem>
<simpara>Delete actions from the chain by clicking the <literal role="guimenu">delete action</literal> link.</simpara>
</listitem>
<listitem>
<simpara>Inspect the list of systems on which an action is run by clicking the <literal role="guimenu">+</literal> sign.</simpara>
</listitem>
<listitem>
<simpara>Delete a single system from an action chain by clicking the <literal role="guimenu">delete system</literal> link.</simpara>
</listitem>
<listitem>
<simpara>Delete the complete action chain with the <literal role="guimenu">delete action chain</literal> link in the top-left corner.</simpara>
</listitem>
<listitem>
<simpara>Change an action chain label by clicking it.</simpara>
</listitem>
<listitem>
<simpara>Schedule an action chain for execution on a certain date by clicking the <guibutton>Save and Schedule</guibutton> button.</simpara>
</listitem>
</itemizedlist>
<note>
<title>Unsaved Changes</title>
<simpara>If you leave the page without clicking either <guibutton>Save</guibutton> or <guibutton>Save and Schedule</guibutton> all unsaved changes will be discarded.
In this case, a confirmation dialog will pop up.</simpara>
</note>
<simpara>Currently you cannot add an action to an action chain from the <literal role="guimenu">Edit</literal> section of the action chain details page.
When a Chain is scheduled, the actions it contains will be displayed under <literal role="guimenu">Schedule</literal> on the appropriate pages: <literal role="guimenu">Pending Actions</literal>, <literal role="guimenu">Failed Actions</literal>, or <literal role="guimenu">Completed Actions</literal> depending on the status.
If one action fails on a system no other actions from the same chain will be executed on that systems.
Because of technical limitations it is not possible to reuse Action Chains.</simpara>
</section>
<section xml:id="ref.webui.schedule.list">
<title>Actions List</title>
<simpara>On each action page, each row in the list represents a single scheduled event or action that might affect multiple systems and involve various packages.
The list contains several columns of information:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Filter by Action</literal>&#8201;&#8212;&#8201;Enter a term to filter the listed actions or use the check boxes in this column to select actions. Then either add them to your selection list or archive them by clicking <guimenu>Archive Actions</guimenu> . If you archive a pending action, it is not canceled, but the action item moves from the <literal role="guimenu">Pending Actions</literal> list to the <literal role="guimenu">Archived Actions</literal> list.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Action</literal>&#8201;&#8212;&#8201;Type of action to perform such as Patches or Package Install. Clicking an action name shows its <literal role="guimenu">Action Details</literal> page. Refer to <xref linkend="s3-sm-action-details"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Scheduled Time</literal>&#8201;&#8212;&#8201;The earliest day and time the action will be performed.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Succeeded</literal>&#8201;&#8212;&#8201;Number of systems on which this action was successfully carried out.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Failed</literal>&#8201;&#8212;&#8201;Number of systems on which this action has been tried and failed.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">In Progress</literal>&#8201;&#8212;&#8201;Number of systems on which this action is taking place.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Total</literal>&#8201;&#8212;&#8201;Total number of systems on which this action has been scheduled.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s3-sm-action-details">
<title>Action Details</title>
<simpara>If you click the name of an action, the <literal role="guimenu">Action Details</literal> page appears.
This page is split into the following tabs.</simpara>
<section xml:id="s4-sm-action-details-details">
<title><menuchoice><guimenu>Action Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>General information about the action.
This is the first tab you see when you click an action.
It displays the action type, scheduling administrator, earliest execution, and notes.</simpara>
<note>
<title>Patch Advisory</title>
<simpara>Clicking the Patch Advisory takes you to the <literal role="guimenu">Patch Details</literal> page.
The Patch Advisory appears only if the action is a patch.
Refer to
<xref linkend="s3-sm-errata-details"/>.
for more information.</simpara>
</note>
</section>
<section xml:id="s4-sm-action-details-completed">
<title><menuchoice><guimenu>Action Details</guimenu> <guimenuitem>Completed Systems</guimenuitem></menuchoice></title>
<simpara>List of systems on which the action has been successfully performed.
Clicking a system name displays its <literal role="guimenu">System Details</literal> page.
Refer to
<xref linkend="s3-sm-system-details"/>.
for more information.</simpara>
</section>
<section xml:id="s4-sm-action-details-progress">
<title><menuchoice><guimenu>Action Details</guimenu> <guimenuitem>In Progress Systems</guimenuitem></menuchoice></title>
<simpara>List of systems on which the action is now being carried out.
To cancel an action, select the system by marking the appropriate check box and click the <guibutton>Unschedule Action</guibutton> button.
Clicking a system name shows its <literal role="guimenu">System Details</literal> page.
Refer to
<xref linkend="s3-sm-system-details"/>.
for more information.</simpara>
</section>
<section xml:id="s4-sm-action-details-failed">
<title><menuchoice><guimenu>Action Details</guimenu> <guimenuitem>Failed Systems</guimenuitem></menuchoice></title>
<simpara>List of systems on which the action has failed.
It can be rescheduled here.
Clicking a system name takes you to its <literal role="guimenu">System Details</literal> page.
Refer to
<xref linkend="s3-sm-system-details"/>.
for more information.</simpara>
</section>
<section xml:id="s4-sm-action-details-packagelist">
<title><menuchoice><guimenu>Action Details</guimenu> <guimenuitem>Package List</guimenuitem></menuchoice></title>
<simpara>List of packages are associated with this action.
The tab appears only if the action is package related (installation, removal, etc.).</simpara>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.users">
<title>Users</title>
<simpara>Only SUSE Manager administrators can see <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Users</guimenuitem></menuchoice>.
With <literal role="guimenu">Users</literal> you can grant and edit permissions for those who administer your system groups.
Click a user name in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>User List</guisubmenu> <guimenuitem>Active</guimenuitem></menuchoice> to modify the user.</simpara>
<simpara>To add new users to your organization, click the <literal role="guimenu">Create User</literal> link on the top right corner of the page.
On the <literal role="guimenu">Create User</literal> page, fill in the required values for the new user.</simpara>
<simpara>Once all fields are completed, click the <guibutton>Create Login</guibutton> button.
SUSE Manager now sends an e-mail to the specified address and takes you back to the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>User List</guisubmenu> <guimenuitem>Active</guimenuitem></menuchoice> page.
If you want to set permissions and options for the new user, click the name in the list.
The <literal role="guimenu">User Details</literal> page for this user provides several tabs of options.</simpara>
<simpara>Refer to <xref linkend="s3-sm-user-active-details"/> for detailed descriptions of each tab.</simpara>
<section xml:id="ref.webui.users.list">
<title><literal role="guimenu">User List</literal></title>
<simpara>The <literal role="guimenu">User List</literal> provides three views:</simpara>
<itemizedlist>
<listitem>
<simpara>Active user list</simpara>
</listitem>
<listitem>
<simpara>Deactivated user list</simpara>
</listitem>
<listitem>
<simpara>List all users</simpara>
</listitem>
</itemizedlist>
<section xml:id="ref.webui.users.list.active">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>User List</guisubmenu> <guimenuitem>Active</guimenuitem></menuchoice></title>
<simpara>The active user list shows all active users on your SUSE Manager and displays basic information about each user: user name, real name, roles, and date of their last sign in.</simpara>
<simpara>The active user list shows all active users on your SUSE Manager and displays basic information about each user: user name, real name, roles, and date of their last sign in.</simpara>
<simpara>Each row in the <literal role="guimenu">User List</literal> represents a user within your organization.
There are four columns of information for each user:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Username</literal>&#8201;&#8212;&#8201;The login name of the user.
Clicking a user name displays the <literal role="guimenu">User Details</literal> page for the user.
Refer to <xref linkend="s3-sm-user-active-details"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Real Name</literal>&#8201;&#8212;&#8201;The full name of the user (last name, first name).</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Roles</literal>&#8201;&#8212;&#8201;List of the user&#8217;s privileges, such as organization administrator, channel administrator and normal user.
Users can have multiple roles.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Last Sign In</literal>&#8201;&#8212;&#8201;Shows when the user last logged in to SUSE Manager.</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_user_list.png" width="80%"/>
</imageobject>
<textobject><phrase>users user list</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.users.list.deact">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>User List</guisubmenu> <guimenuitem>Deactivated</guimenuitem></menuchoice></title>
<simpara>The deactivated user list shows all deactivated users.
You may also reactivate any user listed here.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_deactivated_user_list.png" width="80%"/>
</imageobject>
<textobject><phrase>users deactivated user list</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the check box to the left of their name and click the <guibutton>Reactivate</guibutton> button then the <guibutton>Confirm</guibutton> button.
Reactivated users retain the permissions and system group associations they had when they were deactivated.
Clicking a user name shows the <literal role="guimenu">User Details</literal> page.</simpara>
</section>
<section xml:id="ref.webui.users.list.all">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>User List</guisubmenu> <guimenuitem>All</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">All</literal> page lists all users that belong to your organization.</simpara>
<simpara>The <guimenu>All</guimenu> page lists all users that belong to your organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_all_users.png" width="80%"/>
</imageobject>
<textobject><phrase>users all users</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>In addition to the fields listed in the previous two screens, the table of users includes a <literal role="guimenu">Status</literal> field.
This field indicates whether the user is <literal role="guimenu">Active</literal> or <literal role="guimenu">Deactivated</literal>.
Click a user name to see the <literal role="guimenu">User Details</literal> page.</simpara>
</section>
<section xml:id="s3-sm-user-active-details">
<title><literal role="guimenu">User Details</literal></title>
<simpara>Clicking a user name on a <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guimenuitem>User List</guimenuitem></menuchoice> listing displays the <literal role="guimenu">User Details</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_user_list.png" width="80%"/>
</imageobject>
<textobject><phrase>users user list</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Here SUSE Manager administrators manage the permissions and activity of all the users.
Here you can also delete or deactivate users.</simpara>
<simpara>Users can be deactivated directly in the SUSE Manager Web interface.
SUSE Manager administrators can deactivate or delete users of their organization.
Users can deactivate their own accounts.</simpara>
<note>
<title>Users with SUSE Manager Administrator Role</title>
<simpara>Users with the SUSE Manager administrator role cannot be deactivated until that role is removed from their account.</simpara>
</note>
<simpara>Deactivated users cannot log in to the SUSE Manager Web UI or schedule any actions.
Actions scheduled by a user prior to their deactivation remain in the action queue.
Deactivated users can be reactivated by SUSE Manager administrators.</simpara>
<warning>
<title>Irreversible Deletion</title>
<simpara>User deletion is irreversible; exercise it with caution.
Consider deactivating the user first to assess the effect deletion will have on your infrastructure.</simpara>
</warning>
<simpara>To deactivate a user:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click a user name to navigate to the <literal role="guimenu">User Details</literal> tab.</simpara>
</listitem>
<listitem>
<simpara>Verify that the user is not a SUSE Manager administrator.
If they are, uncheck the box to the left of that role and click the <guibutton>Submit</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Deactivate User</literal> link in the upper right corner of the dialog.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Deactivate User</guibutton> button to confirm.</simpara>
</listitem>
</orderedlist>
<simpara>To delete a user:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click a user name to navigate to the <literal role="guimenu">User Details</literal> tab.</simpara>
</listitem>
<listitem>
<simpara>Verify that the user is not a SUSE Manager administrator. Uncheck the box to remove the role if necessary.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal role="guimenu">Delete User</literal> link in the upper right corner of the dialog.</simpara>
</listitem>
<listitem>
<simpara>Click the <guibutton>Delete User</guibutton> button to permanently delete the user.</simpara>
</listitem>
</orderedlist>
<simpara>For instructions to deactivate your own account, refer to
<xref linkend="ref.webui.overview.account.deactivate"/>.</simpara>
<section xml:id="s4-usr-active-details-details">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>Details</guimenuitem></menuchoice></title>
<simpara>The <literal role="guimenu">Details</literal> tab, displays the user name, first name, last name, e-mail address, roles of a user, and other details about the user.
The <guimenu>Details</guimenu> tab, displays the user name, first name, last name, e-mail address, roles of a user, and other details about the user.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_user_details.png" width="80%"/>
</imageobject>
<textobject><phrase>users user details</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Edit this information as needed and then confirm with <guibutton>Update</guibutton>.
When changing a user&#8217;s password, you will only see asterisks as you type.</simpara>
<simpara>To delegate responsibilities within your organization, SUSE Manager provides several roles with varying degrees of access.
This list describes the permissions of each role and the differences between them:</simpara>
<itemizedlist>
<listitem>
<simpara>[guimenu]``User (normal user)&#8201;&#8212;&#8201;Also known as a <emphasis>System Group User</emphasis>, this is the standard role associated with any newly created user.
This person may be granted access to manage system groups and software channels, if the SUSE Manager administrator sets the roles accordingly.
The systems must be in system groups for which the user has permissions to manage them. However, all globally subscribable channels may be used by anyone.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">SUSE Manager Administrator</literal>&#8201;&#8212;&#8201;This role allows a user to perform any function available in SUSE Manager.</simpara>
</listitem>
</itemizedlist>
<simpara>As the master account for your organization, the person holding this role can alter the privileges of all other accounts of this organization, and conduct any of the tasks available to the other roles.
Like with other roles, multiple SUSE Manager administrators may exist. Go to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Users</guimenuitem></menuchoice> and click the check box in the <literal role="guimenu">SUSE Manager Admin</literal> row. For more information, see
<xref linkend="ref.webui.admin.users"/>.</simpara>
<simpara>+
A <literal role="guimenu">SUSE Manager Administrator</literal> can create foreign organizations; but a <literal role="guimenu">SUSE Manager Administrator</literal> can only create users for an organization if he is entitled with organization administrator privileges for this organization.
* <literal role="guimenu">Organization Administrator</literal>&#8201;&#8212;&#8201;This role provides a user with all the permissions other administrators have, namely the activation key, configuration, channel, and system group administrator. A <literal role="guimenu">Organization Administrator</literal> is not entitled to perform actions that belong to the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Admin</guimenuitem></menuchoice> features
(see <xref linkend="ref.webui.admin"/>).
* <literal role="guimenu">Activation Key Administrator</literal>&#8201;&#8212;&#8201;This role is designed to manage your collection of activation keys. A user assigned to this role can modify and delete any key within your organization.
* <literal role="guimenu">Image Administrator</literal>&#8201;&#8212;&#8201;This role is designed to manage Image building. Modifiable content includes Image Profiles, Image Builds and Image Stores. A user assigned with this role can modify and delete all content located under the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Images</guimenuitem></menuchoice>. These changes will be applied across the organization.
* <literal role="guimenu">Configuration Administrator</literal>&#8201;&#8212;&#8201;This role enables a user to manage the configuration of systems within the organization, using either the SUSE Manager Web UI or tool from the <phrase role="package">rhncfg-management</phrase> package.
* <literal role="guimenu">Channel Administrator</literal>&#8201;&#8212;&#8201;This role provides a user with full access to all software channels within your organization. This requires the SUSE Manager synchronization tool (<literal role="command">mgr-sync</literal> from the <phrase role="package">susemanager-tools</phrase> package). The channel administrator may change the base channels of systems, make channels globally subscribable, and create entirely new channels.
* <literal role="guimenu">System Group Administrator</literal>&#8201;&#8212;&#8201;This role limits authority to systems or system groups to which access is granted. The System Group Administrator can create new system groups, delete any assigned systems from groups, add systems to groups, and manage user access to groups.</simpara>
<simpara>Being a SUSE Manager administrator enables you to remove administrator rights from other users.
It is possible to remove your own privileges as long as you are not the only SUSE Manager administrator.</simpara>
<simpara>To assign a new role to a user, check the respective box.
SUSE Manager administrators are automatically granted administration access to all other roles, signified by grayed-out check boxes.
Click <guibutton>Update</guibutton> to submit your changes.</simpara>
</section>
<section xml:id="s4-usr-active-details-sysg">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>System Groups</guimenuitem></menuchoice></title>
<simpara>This tab displays a list of system groups the user may administer; for more information about system groups, see
<xref linkend="ref.webui.systems.systemgroups"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_details_system_groups.png" width="80%"/>
</imageobject>
<textobject><phrase>users details system groups</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>SUSE Manager administrators can set this user&#8217;s access permissions to each system group.
Check or uncheck the box to the left of the system group and click the <guibutton>Update Permissions</guibutton> button to save the changes.</simpara>
<simpara>SUSE Manager administrators may select one or more default system groups for a user.
When the user registers a system, it gets assigned to the selected group or groups.
This allows the user to access the newly-registered system immediately.
System groups to which this user has access are preceded by an (*).</simpara>
</section>
<section xml:id="s4-usr-active-details-systems">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice></title>
<simpara>This tab lists all systems a user can access according to the system groups assigned to the user.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_details_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>users details systems</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To carry out tasks on some of these systems, select the set of systems by checking the boxes to the left and click the <guibutton>Update List</guibutton> button.
Use the <literal role="guimenu">System Set Manager</literal> page to execute actions on those systems.
Clicking the name of a system takes you to its <literal role="guimenu">System Details</literal> page.
Refer to
<xref linkend="s3-sm-system-details"/>.</simpara>
</section>
<section xml:id="s4-usr-active-details-chans">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>Channel Permissions</guimenuitem></menuchoice></title>
<simpara>This tab lists all channels available to your organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_details_channel_permissions.png" width="80%"/>
</imageobject>
<textobject><phrase>users details channel permissions</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Grant explicit channel subscription permission to a user for each of the channels listed by checking the box to the left of the channel, then click the <guibutton>Update Permissions</guibutton> button.
Permissions granted by a SUSE Manager administrator or channel administrator have no check box but a check icon like globally subscribable channels.</simpara>
<section xml:id="s5-sm-user-details-chanperms-subs">
<title><menuchoice><guimenu>User Details</guimenu> <guisubmenu>Channel Permissions</guisubmenu> <guimenuitem>Subscription</guimenuitem></menuchoice></title>
<simpara>Identifies channels to which the user may subscribe systems.</simpara>
<simpara>To change these, select or deselect the appropriate check boxes and click the <guibutton>Update Permissions</guibutton> button.
Note that channels subscribable because of the user&#8217;s administrator status or the channel&#8217;s global settings cannot be altered.
They are identified with a check icon.</simpara>
</section>
<section xml:id="s5-sm-user-details-chanperms-mgmt">
<title><menuchoice><guimenu>User Details</guimenu> <guisubmenu>Channel Permissions</guisubmenu> <guimenuitem>Management</guimenuitem></menuchoice></title>
<simpara>Identifies channels the user may manage.
To change these, select or deselect the appropriate check boxes and click the <guibutton>Update Permissions</guibutton> button.
The permission to manage channels does not enable the user to create new channels.
Note that channels automatically manageable through the user&#8217;s admin status cannot be altered.
These channels are identified with a check icon.
Remember, SUSE Manager administrators and channel administrators can subscribe to or manage any channel.</simpara>
</section>
</section>
<section xml:id="s4-usr-active-details-prefs">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>Preferences</guimenuitem></menuchoice></title>
<simpara>Configure the following preference settings for a user.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_details_preferences.png" width="80%"/>
</imageobject>
<textobject><phrase>users details preferences</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Email Notifications</literal> : Determine whether this user should receive e-mail every time a patch alert is applicable to one or more systems in his or her SUSE Manager account, and daily summaries of system events.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">SUSE Manager List Page Size</literal> : Maximum number of items that appear in a list on a single page.
If the list contains more items than can be displayed on one page, click the <guibutton>Next</guibutton> button to see the next page.
This preference applies to the user&#8217;s view of system lists, patch lists, package lists, and so on.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Overview Start Page</literal> : Configure which information to be displayed on the <quote>Overview</quote> page at login.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Time Zone</literal> : Select the time zone from the drop-down box.
Dates and times, like system check-in times, will be displayed according to the selected time zone.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">CSV Files</literal> : Select whether to use the default comma or a semicolon as separator in downloadable CSV files.</simpara>
</listitem>
</itemizedlist>
<simpara>Change these options to fit your needs, then click the <guibutton>Save Preferences</guibutton> button.</simpara>
</section>
<section xml:id="s4-usr-active-details-addresses">
<title><menuchoice><guimenu>User Details</guimenu> <guimenuitem>Addresses</guimenuitem></menuchoice></title>
<simpara>This tab lists mailing addresses associated with the user&#8217;s account.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_details_addresses.png" width="80%"/>
</imageobject>
<textobject><phrase>users details addresses</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If there is no address specified yet, click <guibutton>Fill in this address</guibutton> and fill out the form.
When finished, click <guibutton>Update</guibutton>.
To modify this information, click the <guibutton>Edit this address</guibutton> button, change the relevant information, and click the <guibutton>Update</guibutton> button.</simpara>
</section>
</section>
</section>
<section xml:id="ref.webui.users.sgc">
<title><literal role="guimenu">System Group Configuration</literal></title>
<simpara>System Groups help when diferrent users shall administer different groups of systems within one organization.</simpara>
<section xml:id="ref.webui.users.sgc.cfg">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>System Group Configuration</guisubmenu> <guimenuitem>Configuration</guimenuitem></menuchoice></title>
<simpara>Enable <literal role="guimenu">Create a user default System Group</literal> and confirm with <guibutton>Update</guibutton>.</simpara>
<simpara>Assign such a group to systems via the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Groups</guisubmenu> <guimenuitem>Join</guimenuitem></menuchoice> subtab.
For more information, see
<xref linkend="s5-sm-system-details-groups-join"/>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_system_group_config.png" width="80%"/>
</imageobject>
<textobject><phrase>users system group config</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="ref.webui.users.sgc.extauth">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Users</guisubmenu> <guisubmenu>System Group Configuration</guisubmenu> <guimenuitem>External Authentication</guimenuitem></menuchoice></title>
<simpara>Allows to create an external group with the <literal role="guimenu">Create External Group</literal> link.</simpara>
<simpara>Users can join such groups via the <literal role="guimenu">System Groups</literal> of the user details page, then check the wanted <literal role="guimenu">Group</literal>, and confirm with <guibutton>Update Permissions</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="users_system_group_config_external_auth.png" width="80%"/>
</imageobject>
<textobject><phrase>users system group config external auth</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>For more information, see <xref linkend="s4-usr-active-details-sysg"/>.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="ref.webui.admin">
<title>Admin</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Admin</guimenuitem></menuchoice> pages allows SUSE Manager customers to manage the basic configuration, including creating and managing multiple organizations.
Only the SUSE Manager administrator can access the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Admin</guimenuitem></menuchoice> pages.</simpara>
<section xml:id="ref.webui.admin.wizard">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice></title>
<simpara>Setting up SUSE Manager typically requires some extra steps after installation for common configuration tasks.</simpara>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice> link is displayed when the SUSE Manager Web UI is used for the fist time and can be accessed later at any time by clicking <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Setup Wizard</guimenuitem></menuchoice>.
On the three tabs configure the HTTP proxy server, organization credentials, and SUSE products.</simpara>
<variablelist>
<varlistentry>
<term><guimenu>HTTP Proxy:</guimenu></term>
<listitem>
<simpara>If needed configure a proxy server that SUSE Manager will use to access SCC (SUSE Customer Center) and other remote servers here.
Use <literal>hostname:port</literal> syntax in the <menuchoice><guimenu>HTTP Proxy</guimenu> <guimenuitem>HTTP Proxy Hostname:</guimenuitem></menuchoice> field if the proxy port is not 8080.
Clearing the fields disables proxy.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_proxy_settings.png" width="80%"/>
</imageobject>
<textobject><phrase>admin proxy settings</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Organization Credentials:</guimenu></term>
<listitem>
<simpara>Select <menuchoice><guimenu>Admin</guimenu> <guisubmenu>Setup Wizard</guisubmenu> <guisubmenu>Organization Credentials</guisubmenu> <guimenuitem>Add a new credential</guimenuitem></menuchoice> then enter user name and password to give another organization/user access to SUSE Customer Center.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_credentials.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization credentials</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>After saving, a new credential card will be displayed.
Buttons below the credential card allow you to:</simpara>
<itemizedlist>
<listitem>
<simpara>Check credential validation status (green tick or red cross icon).
To re-check the credential with SCC, click the icon.</simpara>
</listitem>
<listitem>
<simpara>Set the primary credentials for inter-server synchronization (yellow star icon).</simpara>
</listitem>
<listitem>
<simpara>List the subscriptions related to a certain credential (list icon).</simpara>
</listitem>
<listitem>
<simpara>Edit the credential (pencil icon).</simpara>
</listitem>
<listitem>
<simpara>Delete the credential (trash can icon).</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<variablelist xml:id="vle.webui.admin.wizard.products">
<varlistentry>
<term><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>SUSE Products</guimenuitem></menuchoice></term>
<listitem>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>SUSE Products</guimenuitem></menuchoice> page, select product-specific channels you are entitled to.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_suse_products.png" width="80%"/>
</imageobject>
<textobject><phrase>admin suse products</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The products displayed are directly linked to your organization credentials and your SUSE subscriptions.
Product extension and module lists are shown when you click the <guibutton>arrow</guibutton> to the left of the product description.
This is a cascading mechanism and allows to unfold several levels according to the integration of the extensions and modules in the base product.</simpara>
<simpara>Products based on SUSE Linux Enterprise 15 or higher have a toggle button named <guibutton>include recommended</guibutton>.
When the toogle button is enabled on a base product, recommended extensions and modules are automatically selected for synchronization.
Once the <guibutton>include recommended</guibutton> button is enabled, you may uncheck product child channels you are not interested in syncing.
Recommended channels are labeled accordingly.
You cannot disable required channels.</simpara>
<simpara>If you click the <guimenu>Channels</guimenu> icon in a row of a product, a popup lists the underlying channels (repositories) that build the product.</simpara>
<simpara>In the row above the product listing two filter options are available:</simpara>
<itemizedlist>
<listitem>
<simpara>Search by the product description. The filter limits the search to base products.</simpara>
</listitem>
<listitem>
<simpara>Filter by architecture.
Click in the search field (or press <keycap>Enter</keycap> ) and then select from drop-down menu.
You can repeat this as often as necessary.
To remove an architecture either click the <quote>x</quote> symbol (or press <keycap>Backspace</keycap> ).</simpara>
<simpara>Once you have made your selection(s), click <guibutton>Add products</guibutton> in the upper right area.
This is equivalent to running <literal role="command">mgr-sync add products</literal> or <literal role="command">mgr-sync</literal> without any arguments.</simpara>
<simpara>View the synchronization progress in the status bar field to the right.</simpara>
<note>
<title>Synchronization Time</title>
<simpara>Channel synchronization will start and might take several hours.
When finished the corresponding channels can be used in SUSE Manager.</simpara>
</note>
<important>
<title>If Synchronization Fails</title>
<simpara>SUSE does not automatically trust 3rd party GPG keys.
If a reposync fails check if an untrusted GPG key is the cause by viewing the log files located in:</simpara>
<screen>/var/log/rhn/reposync</screen>
<simpara>Look for lines similar to the following:</simpara>
<screen>['/usr/bin/spacewalk-repo-sync', '--channel', 'sle-12-sp1-ga-desktop-
nvidia-driver-x86_64', '--type', 'yum', '--non-interactive']
ChannelException: The GPG key for this repository is not part of the keyring.
Please run spacewalk-repo-sync in interactive mode to import it.</screen>
</important>
<simpara>Alternatively, you can add listed channels immediately by clicking the <guibutton>Add this product</guibutton> button in the status column.
A progress bar will be displayed.
The main product will expand, and then you may select add-on products belonging to the product that is currently added.
To overview required channels, select the list icon in the <menuchoice><guimenu>SUSE Products</guimenu> <guimenuitem>Channels</guimenuitem></menuchoice> column.
Once a product has finished downloading, the status bar state will change from a filled percentage value to <menuchoice><guimenu>SUSE Products</guimenu> <guimenuitem>Finished</guimenuitem></menuchoice>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="ref.webui.admin.org">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Organizations</guimenuitem></menuchoice></title>
<simpara>The organizations feature allows SUSE Manager administrators to create and manage multiple organizations across SUSE Manager.
Administrators can control an organization&#8217;s access to system management tasks.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_list_organizations.png" width="80%"/>
</imageobject>
<textobject><phrase>admin list organizations</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>If you click the name of an organization, the Organization Details page appears.</simpara>
<section xml:id="s2-sattools-org-details-details">
<title><menuchoice><guimenu>Organizations</guimenu> <guimenuitem>Organization Details</guimenuitem></menuchoice></title>
<simpara>The <menuchoice><guimenu>Organization</guimenu> <guimenuitem>Organization Details</guimenuitem></menuchoice> page lists the details of the selected organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_details.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization details</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The following details are available:</simpara>
<itemizedlist>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Organization Name</guimenuitem></menuchoice> : String (between 3 and 128 characters).
This is the only value that you can change here.
When done, confirm with clicking the <guibutton>Update Organization</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Organization ID</guimenuitem></menuchoice> : Number</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Active Users</guimenuitem></menuchoice> : Number.
Clicking this number will open the <menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Users</guimenuitem></menuchoice> tab.</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice> : Number</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>System Groups</guimenuitem></menuchoice> : Number</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice> : Number</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Autoinstallation Profiles</guimenuitem></menuchoice> : Number</simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Configuration Channels</guimenuitem></menuchoice> : Number</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="s2-sattools-org-details-users">
<title><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Users</guimenuitem></menuchoice></title>
<simpara>List of all the users of an organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_users.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization users</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>You can modify the user details if you belong to that organization and have organization administrator privileges.</simpara>
</section>
<section xml:id="s2-sattools-org-details-trust">
<title><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Trust</guimenuitem></menuchoice></title>
<simpara>Here establish trust between organizations.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_trusts.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization trusts</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Such a trust allows sharing contents and migrate systems between these two organizations.
You may add a trust by checking the box next to an organization (or remove a trust by unchecking it) and clicking the <guibutton>Modify Trusts</guibutton> button.</simpara>
</section>
<section xml:id="s2-sattools-org-details-conf">
<title><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>Configuration</guimenuitem></menuchoice></title>
<simpara>Allow the Organization Administrator to manage Organization configuration, configure the organization to use staged contents (<quote>pre-fetching</quote> packages, etc.), set up software crash reporting, and upload of SCAP files.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_configuration.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization configuration</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term>SUSE Manager Configuration</term>
<listitem>
<simpara>Enable <menuchoice><guimenu>SUSE Manager Configuration</guimenu> <guimenuitem>Allow Organization Admin to manage Organization Configuration</guimenuitem></menuchoice> if desired.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Organization Configuration</term>
<listitem>
<itemizedlist>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Enable Staging Contents</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Enable Errata E-mail Notifications (for users belonging to this organization)</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Enable Software Crash Reporting</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Enable Upload Of Crash Files</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Crash File Upload Size Limit</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Enable Upload Of Detailed SCAP Files</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>SCAP File Upload Size Limit</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Allow Deletion of SCAP Results</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Organization Configuration</guimenu> <guimenuitem>Allow Deletion After (period in days)</guimenuitem></menuchoice></simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<simpara>When settings are done, confirm with clicking the <guibutton>Update Organization</guibutton> button.</simpara>
<variablelist>
<varlistentry>
<term>Enable Staging Contents</term>
<listitem>
<simpara>The clients will download packages in advance and stage them.
This has the advantage that the package installation action will take place immediately, when the schedule is actually executed.
This <quote>pre-fetching</quote> saves maintenance window time, which is good for service uptime.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>For staging contents (<quote>pre-fetching</quote>), edit on the client <literal role="path">/etc/sysconfig/rhn/up2date</literal>:</simpara>
<screen>stagingContent=1
stagingContentWindow=24</screen>
<simpara><literal>stagingContentWindow</literal> is a time value expressed in hours and determines when downloading will start.
It is the number of hours before the scheduled installation or update time.
In this case, it means <literal>24</literal> hours before the installation time.
The start time for download depends on the selected contact method for a system.
The assigned contact method sets the time for when the next <literal role="command">rhn_check</literal> will be executed.</simpara>
<simpara>Next time an action is scheduled, packages will automatically be downloaded but not installed yet.
When the scheduled time comes, the action will use the staged version.</simpara>
<variablelist>
<varlistentry>
<term>Minion Content Staging</term>
<listitem>
<simpara>Every Organization administrator can enable Content Staging from the Organization configuration page <menuchoice><guimenu>Admin</guimenu> <guisubmenu>Organization</guisubmenu> <guisubmenu>OrgName</guisubmenu> <guisubmenu>Configuration</guisubmenu> <guimenuitem>Enable Staging Contents</guimenuitem></menuchoice>.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Staging content for minions is affected by two parameters.</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="path">salt_content_staging_advance:</literal> expresses the advance time, in hours, for the content staging window to open with regard to the scheduled installation/upgrade time.</simpara>
</listitem>
<listitem>
<simpara><literal role="path">salt_content_staging_window:</literal> expresses the duration, in hours, of the time window for Salt minions to stage packages in advance of scheduled installations or upgrades.</simpara>
</listitem>
</itemizedlist>
<simpara>A value of <emphasis role="strong">salt_content_staging_advance</emphasis> equal to <emphasis role="strong">salt_content_staging_window</emphasis> results in the content staging window closing exactly when the installation/upgrade is scheduled to be executed.
A larger value allows separating download time from the installation time.</simpara>
<simpara>These options are configured in <literal role="path">/usr/share/rhn/config-defaults/rhn_java.conf</literal>
 and by default assume the following values:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="path">salt_content_staging_advance: 8 hours</literal></simpara>
</listitem>
<listitem>
<simpara><literal role="path">salt_content_staging_window: 8 hours</literal></simpara>
</listitem>
</itemizedlist>
<note>
<simpara>These parameters will only have an effect when Content Staging is enabled for the targeted Organization.</simpara>
</note>
</section>
<section xml:id="s2-sattools-org-details-states">
<title><menuchoice><guimenu>Organization Details</guimenu> <guimenuitem>States</guimenuitem></menuchoice></title>
<simpara>From the <menuchoice><guimenu>Admin</guimenu> <guisubmenu>Organizations</guisubmenu> <guimenuitem>States</guimenuitem></menuchoice> page you can assign State to all systems in an organization.
For example, this way it is possible to define a few global security policies or add a common admin user to all machines.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_organization_states.png" width="80%"/>
</imageobject>
<textobject><phrase>admin organization states</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</section>
<section xml:id="ref.webui.admin.users">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Users</guimenuitem></menuchoice></title>
<simpara>To view and manage all users of the organization you are currently logged in to, click <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Users</guimenuitem></menuchoice> in the left navigation bar.
The table lists user name, real name, organization and whether the user is organization or SUSE Manager administrator.
To modify administrator privileges, click any user name with administrator privileges to get to the <menuchoice><guimenu>Users</guimenu> <guimenuitem>Users Details</guimenuitem></menuchoice> page.
For more information, see:
 <xref linkend="s3-sm-user-active-details"/>.</simpara>
</section>
<section xml:id="ref.webui.admin.config">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Manager Configuration</guimenuitem></menuchoice></title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Manager Configuration</guimenuitem></menuchoice> page is split into tabs which allow you to configure many aspects of SUSE Manager.</simpara>
<section xml:id="s3-sattools-config-gen">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>General</guimenuitem></menuchoice></title>
<simpara>This page allows you to adjust basic SUSE Manager administration settings.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_general_configuration.png" width="80%"/>
</imageobject>
<textobject><phrase>admin general configuration</phrase></textobject>
</mediaobject>
</informalfigure>
<variablelist>
<varlistentry>
<term><guimenu>Administrator Email Address</guimenu></term>
<listitem>
<simpara>E-mail address of the SUSE Manager administrator.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>SUSE Manager Hostname</guimenu></term>
<listitem>
<simpara>Host name of the SUSE Manager server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SUSE Manager Proxy Configuration</term>
<listitem>
<simpara>Configure proxy data via the following fields:</simpara>
<itemizedlist>
<listitem>
<simpara><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>HTTP proxy</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>HTTP proxy username</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>HTTP proxy password</guimenuitem></menuchoice></simpara>
</listitem>
<listitem>
<simpara><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Confirm HTTP proxy password</guimenuitem></menuchoice></simpara>
<simpara>The HTTP proxy settings are for the communication with a SUSE Manager parent server, if there is any.
The HTTP proxy should be of the form: <literal>hostname:port</literal>; the default port <literal>8080</literal> will be used if none is explicitly provided.
HTTP proxy settings for client systems to connect to this SUSE Manager can be different, and will be configured separately, for example via:
<xref linkend="s3-sattools-config-bootstrap"/>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>RPM repository mount point</guimenu></term>
<listitem>
<simpara>The directory where RPM packages are mirrored.
By default: <literal role="path">/var/spacewalk</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Default To SSL</guimenu></term>
<listitem>
<simpara>For secure communication, use SSL.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>When done, confirm with <guibutton>Update</guibutton>.</simpara>
</section>
<section xml:id="s3-sattools-config-bootstrap">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Bootstrap Script</guimenuitem></menuchoice></title>
<simpara>The <menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Bootstrap Script</guimenuitem></menuchoice> page allows you to generate a bootstrap script that registers the client systems with SUSE Manager and disconnects them from the remote SUSE Customer Center.</simpara>
<important>
<title>SLES 15 and Python 3</title>
<simpara>SLES 15 utilizes Python 3 as its default system version. Due to this change any older
bootstrap scripts(based on python 2) must be re-created for SLES 15 systems. Attempting to
register SLES 15 systems with SUSE Manager using Python 2 versions of the bootstrap script will
fail.</simpara>
</important>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_configuration_bootstrap.png" width="80%"/>
</imageobject>
<textobject><phrase>admin configuration bootstrap</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>This generated script will be placed within the <literal role="path">/srv/www/htdocs/pub/bootstrap/</literal> directory on your SUSE Manager server.
The bootstrap script will significantly reduce the effort involved in reconfiguring all systems, which by default obtain packages from the SUSE Customer Center.
The required fields are pre-populated with values derived from previous installation steps.
Ensure this information is accurate.</simpara>
<variablelist>
<varlistentry>
<term>SUSE Manager server hostname</term>
<listitem>
<simpara>The name of the SUSE Manager server where you want to register the client (pre-populated).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SSL cert location</term>
<listitem>
<simpara>Location and name of the SSL certificate (pre-populated).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Bootstrap using Salt</term>
<listitem>
<simpara>To bootstrap traditional clients, uncheck <menuchoice><guimenu>Client Bootstrap Script Configuration</guimenu> <guimenuitem>Bootstrap using Salt</guimenuitem></menuchoice>.
For more information, see:
<xref linkend="registering.clients.traditional"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Enable SSL</term>
<listitem>
<simpara>It is advised keeping SSL enabled.
If enabled the corporate public CA certificate will be installed on the client.
If disabled the user must manage CA certificates to be able to run the registration (<literal role="command">rhnreg_ks</literal>).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Enable Client GPG checking</term>
<listitem>
<simpara>GNU Privacy Guard (GPG)</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Enable Remote Configuration</term>
<listitem>
<simpara>Enable remote configuration management and remote command acceptance of the systems to be bootstrapped to the SUSE Manager.
Both features are useful for completing client configuration.
For more information, see:
<xref linkend="ref.webui.config"/> and <xref linkend="s5-sm-system-details-remote"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Client HTTP Proxy</term>
<listitem>
<simpara>Client HTTP proxy settings if you are using an HTTP proxy server.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>When finished, click <guibutton>Update</guibutton>.</simpara>
</section>
<section xml:id="s3-sattools-config-orgs">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Organizations</guimenuitem></menuchoice></title>
<simpara>The <menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Organizations</guimenuitem></menuchoice> page contains details about the organizations feature of SUSE Manager, and links for creating and configuring organizations.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_configuration_organization.png" width="80%"/>
</imageobject>
<textobject><phrase>admin configuration organization</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="s3-sattools-config-restart">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Restart</guimenuitem></menuchoice></title>
<simpara>The <menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Restart</guimenuitem></menuchoice> page comprises the final step in configuring SUSE Manager.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_configuration_restart.png" width="80%"/>
</imageobject>
<textobject><phrase>admin configuration restart</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click the <guibutton>Restart</guibutton> button to restart SUSE Manager and incorporate all of the configuration options added on the previous screens.
It will take between four and five minutes for a restart to finish.</simpara>
</section>
<section xml:id="s3-sattools-config-cobbler">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Cobbler</guimenuitem></menuchoice></title>
<simpara>On the <menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Cobbler</guimenuitem></menuchoice> page you can run the Cobbler synchronization by clicking <guibutton>Update</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_configuration_cobbler.png" width="80%"/>
</imageobject>
<textobject><phrase>admin configuration cobbler</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Cobbler synchronization is used to repair or rebuild the contents of <literal role="path">/srv/tftpboot</literal> or <literal role="path">/srv/www/cobbler</literal> when a manual modification of the cobbler setup has occurred.</simpara>
</section>
<section xml:id="s3-sattools-config-bare-metal">
<title><menuchoice><guimenu>Manager Configuration</guimenu> <guimenuitem>Bare-metal systems</guimenuitem></menuchoice></title>
<simpara>Here you can add unprovisioned ("bare-metal") systems capable of booting using PXE to an organization.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_configuration_bare_metal_systems.png" width="80%"/>
</imageobject>
<textobject><phrase>admin configuration bare metal systems</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>First click <guibutton>Enable adding to this organization</guibutton>.
Those systems then will appear in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>All Systems</guimenuitem></menuchoice> list, where regular provisioning via autoinstallation is possible in a completely unattended fashion.</simpara>
<simpara>Only AMD64/Intel 64 systems with at least 1 GB of RAM are supported.
SUSE Manager server will use its integrated Cobbler instance and will act as TFTP server for this feature to work, so the network segment that connects it to target systems must be properly configured.
In particular, a DHCP server must exist and have a next-server configuration parameter set to the SUSE Manager server IP address or hostname.</simpara>
<simpara>When enabled, any bare-metal system connected to the SUSE Manager server network will be automatically added to the organization when it powers on.
The process typically takes a few minutes; when it finishes, the system will automatically shut down and then appear in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>All Systems</guimenuitem></menuchoice> list.</simpara>
<note>
<simpara>New systems will be added to the organization of the administrator who enabled this feature.
To change the organization, disable the feature, log in as an administrator of a different organization and enable it again.</simpara>
</note>
<simpara>Provisioning can be initiated by clicking the <guibutton>Provisioning</guibutton> tab.
In case of bare-metal systems, though, provisioning cannot be scheduled, it will happen automatically when it is completely configured and the system is powered on.</simpara>
<simpara>It is possible to use <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>System Set Manager</guimenuitem></menuchoice> with bare-metal systems, although in that case some features will not be available as those systems do not have an operating system installed.
This limitation also applies to mixed sets with regular and bare-metal systems: full features will be enabled again when all bare-metal systems are removed from the set.</simpara>
</section>
</section>
<section xml:id="ref.webui.admin.iss">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>ISS Configuration</guimenuitem></menuchoice></title>
<simpara>Inter-Server Synchronization (ISS) allows SUSE Manager synchronizing content and permissions from another SUSE Manager instance in a peer-to-peer relationship.</simpara>
<section xml:id="s3-sattools-iss-master">
<title>Configuring the Master SUSE Manager Server</title>
<simpara>The following will help you set up a master ISS server.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_iss_configuration_master.png" width="80%"/>
</imageobject>
<textobject><phrase>admin iss configuration master</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click <menuchoice><guimenu>Admin</guimenu> <guisubmenu>ISS Configuration</guisubmenu> <guimenuitem>Master Setup</guimenuitem></menuchoice>.
In the top right-hand corner of this page, click <guibutton>Add New Slave</guibutton>:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_iss_configuration_edit_slave.png" width="80%"/>
</imageobject>
<textobject><phrase>admin iss configuration edit slave</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Fill in the following information:</simpara>
<itemizedlist>
<listitem>
<simpara>Slave Fully Qualified Domain Name (FQDN)</simpara>
</listitem>
<listitem>
<simpara>Allow Slave to Sync? Selecting this checkbox will allow the slave SUSE Manager to access this master SUSE Manager.
Otherwise, contact with this slave will be denied.</simpara>
</listitem>
<listitem>
<simpara>Sync All Orgs to Slave? Checking this checkbox will synchronize all organizations to the slave SUSE Manager.</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>Marking the <menuchoice><guimenu>ISS Configuration</guimenu> <guimenuitem>Sync All Orgs to Slave?</guimenuitem></menuchoice> checkbox on the <menuchoice><guimenu>ISS Configuration</guimenu> <guimenuitem>Master Setup</guimenuitem></menuchoice> page will override any specifically selected organizations in the local organization table.</simpara>
</note>
<simpara>Click <guibutton>Create</guibutton>.
Optionally, click any local organization to be exported to the slave SUSE Manager then click <guibutton>Allow Orgs</guibutton>.</simpara>
<note>
<title>Enabling Inter-server Synchronization in SUSE Manager 2.1</title>
<simpara>ISS is enabled by default in SUSE Manager 3.1 and later.</simpara>
<simpara>To enable the inter-server synchronization (ISS) feature in SUSE Manager 2.1, edit the <literal role="path">/etc/rhn/rhn.conf</literal> file and set: <literal role="command">disable_iss=0</literal>.
Save the file and restart the httpd service with <literal role="command">service httpd restart</literal>.</simpara>
</note>
<simpara>For synchronization timeout settings, see:
<xref linkend="bp.troubleshooting.timeouts"/>.</simpara>
</section>
<section xml:id="s3-sattools-iss-slave">
<title>Configuring Slave Servers</title>
<simpara>Slave servers receive content synchronized from the master server.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_iss_configuration_slave.png" width="80%"/>
</imageobject>
<textobject><phrase>admin iss configuration slave</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>To securely transfer content to the slave servers, the ORG-SSL certificate from the master server is needed.
Click <menuchoice><guimenu>Admin</guimenu> <guisubmenu>ISS Configuration</guisubmenu> <guimenuitem>Slave Setup</guimenuitem></menuchoice>.
In the top right-hand corner, click <guibutton>Add New Master</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_iss_configuration_edit_master.png" width="80%"/>
</imageobject>
<textobject><phrase>admin iss configuration edit master</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara><menuchoice><guimenu>ISS Configuration</guimenu> <guisubmenu>Update Master</guisubmenu> <guimenuitem>Master Setup</guimenuitem></menuchoice> and fill in the following information:</simpara>
<itemizedlist>
<listitem>
<simpara>Master Fully Qualified Domain Name (FQDN)</simpara>
</listitem>
<listitem>
<simpara>Filename of this Master&#8217;s CA Certificate: use the full path to the CA Certificate. For example:</simpara>
<screen>/etc/pki/trust/anchors</screen>
</listitem>
<listitem>
<simpara>Default Master?</simpara>
</listitem>
</itemizedlist>
<simpara>Click <guibutton>Add New Master</guibutton>.
When the master and slave servers are configured, start the synchronization on the slave server by executing <literal role="command">mgr-inter-sync</literal>:</simpara>
<screen>mgr-inter-sync -c`YOUR-CHANNEL`</screen>
</section>
<section xml:id="s3-sattools-iss-map-orgs">
<title>Mapping SUSE Manager Master Server Organizations to Slave Organizations</title>
<simpara>A mapping between organizational names on the master SUSE Manager allows for channel access permissions being set on the master server and propagated when content is synchronized to a slave SUSE Manager.
Not all organization and channel details need to be mapped for all slaves.
SUSE Manager administrators can select which permissions and organizations can be synchronized by allowing or omitting mappings.</simpara>
<simpara>To complete the mapping, log in to the Slave SUSE Manager as administrator.
Click <menuchoice><guimenu>Admin</guimenu> <guisubmenu>ISS Configuration</guisubmenu> <guimenuitem>Slave Setup</guimenuitem></menuchoice> and select a master SUSE Manager by clicking its name.
Use the drop-down box to map the exported master organization name to a matching local organization in the slave SUSE Manager, then click <guibutton>Update Mapping</guibutton>.</simpara>
<simpara>On the command line, issue the synchronization command on each of the custom channels to obtain the correct trust structure and channel permissions:</simpara>
<screen>mgr-inter-sync -c`YOUR-CHANNEL`</screen>
</section>
</section>
<section xml:id="ref.webui.admin.schedules">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice></title>
<simpara>Under <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice> all predefined task bunches are listed.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_task_schedules.png" width="80%"/>
</imageobject>
<textobject><phrase>admin task schedules</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Click a <menuchoice><guimenu>SUSE Manager Schedules</guimenu> <guimenuitem>Schedule name</guimenuitem></menuchoice> to open its <menuchoice><guimenu>Schedule Name</guimenu> <guimenuitem>Basic Schedule Details</guimenuitem></menuchoice> where you can disable it or change the frequency.
Click <guibutton>Edit Schedule</guibutton> to update the schedule with your settings.
To delete a schedule, click <guibutton>delete schedule</guibutton> in the upper right-hand corner.</simpara>
<warning>
<simpara>Only disable or delete a schedule if you are absolutely certain this is necessary as they are essential for SUSE Manager to work properly.</simpara>
</warning>
<simpara>If you click a bunch name, a list of runs of that bunch type and their status will be displayed.
Clicking the start time links takes you back to the <menuchoice><guimenu>Schedule Name</guimenu> <guimenuitem>Basic Schedule Details</guimenuitem></menuchoice>.</simpara>
<simpara>For example, the following predefined task bunches are scheduled by default and can be configured:</simpara>
<variablelist>
<varlistentry>
<term><guimenu>channel-repodata-default:</guimenu></term>
<listitem>
<simpara>(Re)generates repository metadata files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>cleanup-data-default:</guimenu></term>
<listitem>
<simpara>Cleans up stale package change log and monitoring time series data from the database.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>clear-taskologs-default:</guimenu></term>
<listitem>
<simpara>Clears task engine (taskomatic) history data older than a specified number of days, depending on the job type, from the database.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>cobbler-sync-default:</guimenu></term>
<listitem>
<simpara>Synchronizes distribution and profile data from SUSE Manager to Cobbler.
For more information on Cobbler, see
<xref linkend="advanced.topics.cobbler"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>compare-configs-default:</guimenu></term>
<listitem>
<simpara>Compares configuration files as stored in configuration channels with the files stored on all configuration-enabled servers.
To review comparisons, click the <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Systems</guimenuitem></menuchoice> tab and click the system of interest.
Go to <menuchoice><guimenu>Configuration</guimenu> <guimenuitem>Compare Files</guimenuitem></menuchoice>.
For more information, refer to:
<xref linkend="s5-sdc-configuration-diff"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>cve-server-channels-default:</guimenu></term>
<listitem>
<simpara>Updates internal pre-computed CVE data that is used to display results on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>CVE Audit</guimenuitem></menuchoice> page.
Search results in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Audit</guisubmenu> <guimenuitem>CVE Audit</guimenuitem></menuchoice> page are updated to the last run of this schedule).
For more information, see:
<xref linkend="ref.webui.audit.cve"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>daily-status-default:</guimenu></term>
<listitem>
<simpara>Sends daily report e-mails to relevant addresses.
To learn more about how to configure notifications for specific users, see:
<xref linkend="s4-usr-active-details-prefs"/></simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>errata-cache-default:</guimenu></term>
<listitem>
<simpara>Updates internal patch cache database tables, which are used to look up packages that need updates for each server.
Also, this sends notification emails to users that might be interested in certain patches.
For more information on patches, see:
<xref linkend="ref.webui.patches"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>errata-queue-default:</guimenu></term>
<listitem>
<simpara>Queues automatic updates (patches) for servers that are configured to receive them.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>kickstart-cleanup-default:</guimenu></term>
<listitem>
<simpara>Cleans up stale kickstart session data.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>kickstartfile-sync-default:</guimenu></term>
<listitem>
<simpara>Generates Cobbler files corresponding to Kickstart profiles created by the configuration wizard.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>mgr-register-default:</guimenu></term>
<listitem>
<simpara>Calls the <literal role="command">mgr-register</literal> command, which synchronizes client registration data with NCC (new, changed or deleted clients' data are forwarded).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>mgr-sync-refresh-default:</guimenu></term>
<listitem>
<simpara>the default time at which the start of synchronization with SUSE Customer Center (SCC) takes place (<literal>mgr-sync-refresh</literal>).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>package-cleanup-default:</guimenu></term>
<listitem>
<simpara>deletes stale package files from the file system.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>reboot-action-cleanup-default:</guimenu></term>
<listitem>
<simpara>any reboot actions pending for more than six hours are marked as failed and associated data is cleaned up in the database.
For more information on scheduling reboot actions, see:
<xref linkend="s5-sdc-provisioning-powermgnt"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>sandbox-cleanup-default:</guimenu></term>
<listitem>
<simpara>cleans up <menuchoice><guimenu>sandbox</guimenu> <guimenuitem>] configuration files and channels that are older than the menu:sandbox_lifetime[</guimenuitem></menuchoice> configuration parameter (3 days by default).
Sandbox files are those imported from systems or files under development.
For more information, see:
<xref linkend="s5-sdc-configuration-add-files"/></simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>session-cleanup-default:</guimenu></term>
<listitem>
<simpara>cleans up stale Web interface sessions, typically data that is temporarily stored when a user logs in and then closes the browser before logging out.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>ssh-push-default:</guimenu></term>
<listitem>
<simpara>prompts clients to check in with SUSE Manager via SSH if they are configured with a <menuchoice><guimenu>Contact Method</guimenu> <guimenuitem>SSH Push</guimenuitem></menuchoice>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>token-cleanup-default:</guimenu></term>
<listitem>
<simpara>deletes expired repository tokens that are used by Salt minions to download packages and metadata.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="ref.webui.admin.status">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Task Engine Status</guimenuitem></menuchoice></title>
<simpara>This is a status report of the various tasks running by the SUSE Manager task engine.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_task_status_last_execution.png" width="80%"/>
</imageobject>
<textobject><phrase>admin task status last execution</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Next to the task name you find the date and time of the last execution and the status.</simpara>
</section>
<section xml:id="ref.webui.admin.logs">
<title><menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guimenuitem>Show Tomcat Logs</guimenuitem></menuchoice></title>
<simpara>Here the SUSE Manager admin user has access to the Tomcat log file located at <literal role="path">/var/log/rhn/rhn_web_ui.log</literal>.
No root privileges are required.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="admin_show_tomcat_logs.png" width="80%"/>
</imageobject>
<textobject><phrase>admin show tomcat logs</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
</chapter>
<chapter xml:id="s1-sm-help">
<title>Help</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guimenuitem>Help</guimenuitem></menuchoice> pages provide access to the full suite of documentation and support available to SUSE Manager users.</simpara>
<section xml:id="s2-sm-your-rhn-help-sat">
<title>SUSE Manager Getting Started Guide</title>
<simpara>In
<xref linkend="book.suma.getting-started"/>
find information regarding SUSE Manager server and its installation and initial configuration.
Implementing a fully functional SUSE Manager requires more than installing software and a database.
Client systems must be configured to use SUSE Manager.
Custom packages and channels should be created for optimal use.
Since these tasks extend beyond the basic installation, they are covered in detail in the other guides.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-rg">
<title>SUSE Manager Reference Guide</title>
<simpara><xref linkend="book.suma.reference.manual"/>
explains the Web interface and its features in detail.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-bp">
<title>SUSE Manager Best Practices Guide</title>
<simpara><xref linkend="book.suma.best.practices"/>
describes SUSE recommended best practices for SUSE Manager.
This information has been collected from many successful SUSE Manager real world implementations and includes feedback provided by product management, sales, and engineering.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-at">
<title>SUSE Manager Advanced Topics Guide</title>
<simpara><xref linkend="book.suma.advanced.topics"/>
contains a collection of advanced topics not covered under the best practices guide.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-rn">
<title>Release Notes</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Help</guisubmenu> <guimenuitem>Release Notes</guimenuitem></menuchoice> page lists the notes accompanying every recent release of SUSE Manager.
All significant changes in a given release cycle, from major enhancements to the user interface to changes in the related documentation are documented here.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-api">
<title>API</title>
<simpara>Documentation for using the Application Programming Interface (API) for creating tools and programs to automate common tasks via SUSE Manager.</simpara>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Help</guisubmenu> <guimenuitem>API</guimenuitem></menuchoice> page contains an overview of the API, with links to detailed descriptions of various API calls available to administrators and developers.
There is also an <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Help</guisubmenu> <guisubmenu>API</guisubmenu> <guimenuitem>FAQ</guimenuitem></menuchoice> page for answers to common questions about the SUSE Manager API.
A <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Help</guisubmenu> <guisubmenu>API</guisubmenu> <guimenuitem>Sample Scripts</guimenuitem></menuchoice> page shows example code using API calls.</simpara>
</section>
<section xml:id="s2-sm-your-rhn-help-docsearch">
<title>Search</title>
<simpara>The <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Help</guisubmenu> <guimenuitem>Search</guimenuitem></menuchoice> page features a robust search engine that indexes and searches SUSE Manager documentation.</simpara>
<figure>
<title>Document Search</title>
<mediaobject>
<imageobject>
<imagedata fileref="help_search.png" width="80%"/>
</imageobject>
<textobject><phrase>help search</phrase></textobject>
</mediaobject>
</figure>
<simpara>Users can search the available online documentation and filter them according to the following choices in the <literal role="guimenu">What to Search</literal> drop-down box:</simpara>
<itemizedlist>
<listitem>
<simpara><literal role="guimenu">Content &amp; Title</literal>&#8201;&#8212;&#8201;Search both the title heading or body content of all available documents.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Free Form</literal>&#8201;&#8212;&#8201;Search documents for any keyword matches, which broadens search results.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Content</literal>&#8201;&#8212;&#8201;Search only the body content of documentation for more specific matches.</simpara>
</listitem>
<listitem>
<simpara><literal role="guimenu">Title</literal>&#8201;&#8212;&#8201;Search only the title headings of the documentation for targeted, specific search results.</simpara>
</listitem>
</itemizedlist>
<simpara>The <literal role="guimenu">Free Form</literal> field additionally allows you to search using field names that you prepend to search queries and filter results in that field.</simpara>
<simpara>For example, if you wanted to search all of the SUSE Manager manuals for the word <literal>Virtualization</literal> in the title and <literal>install</literal> in the content, type the following in the <literal role="guimenu">Free Form</literal> field:</simpara>
<screen>title:Virtualization and content:install</screen>
<simpara>Other supported field names for documentation search include:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>url</literal>&#8201;&#8212;&#8201;Search the URL for a particular keyword.</simpara>
</listitem>
<listitem>
<simpara><literal>title</literal>&#8201;&#8212;&#8201;Search titles for a particular keyword.</simpara>
</listitem>
<listitem>
<simpara><literal>content</literal>&#8201;&#8212;&#8201;Search the body of the documentation for a particular keyword.</simpara>
</listitem>
</itemizedlist>
<simpara>If there are several pages of search results, you can limit the amount of visible results shown on one page by clicking the <literal role="guimenu">Display quantity items per page</literal> drop-down box, which offers between 10 and 500 results per page.</simpara>
<simpara>To move between pages, click the right or left angle brackets (<literal role="guimenu">&gt;</literal> to go forward or <literal role="guimenu">&lt;</literal> to go backward).</simpara>
</section>
</chapter>
</part>
<part xml:id="book.suma.advanced.topics">
<title>Advanced Topics</title>
<preface xml:id="preface.susemanager.at">
<title>About This Guide</title>
<note>
<title>SUSE Manager Version Information</title>
<simpara>In this manual if not other specified, SUSE Manager version 3.2 is assumed and this version is required if a feature is discussed.
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy were originally released as a SLES 12 SP3 extension.
With the next maintenance update (December 2018),
SUSE Manager 3.2 and SUSE Manager 3.2 Proxy will be based on SLES 12 SP4 and support SLE 12 SP4 clients officially.
In the following sections and chapters, it is highly recommended to use SLE 12 SP4 instead of SP3.
Whenever features of the SUSE Manager 3.2 host operating system are documented and not other specified version 12 SP4 is assumed.</simpara>
</note>
</preface>
<chapter xml:id="art.suma.install.zsystems">
<title>SUSE Manager on IBM z Systems</title>
<section xml:id="_introduction_2">
<title>Introduction</title>
<simpara>This best practice guide is intended for z/VM administrators responsible for operating the IBM z Systems
Mainframe.
The goal of this guide is to lead an z/VM administrator trained on normal z Systems
operating protocols through the installation of SUSE Manager
onto an existing mainframe system.
The intent of this article is not to cover the variety of hardware configuration profiles available on z Systems
but instead to provide a foundational overview of the procedure and requirements necessary for a successful SUSE Manager
server deployment.</simpara>
</section>
<section xml:id="_base_system_requirements">
<title>Base System Requirements</title>
<simpara>The z/VM administrator should acquire and prepare the following resources for a successful SUSE Manager
installation. SUSE Manager3.2
is delivered as an extension.
These sections will provide you with the minimum and recommended system requirements for SUSE Manager
.
The base system for SUSE Manager
 3.2
is SLES 12SP4
.</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Recommended Hardware</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>IBM Systems</simpara></entry>
<entry align="left" valign="top"><simpara>* IBM zEnterprise System z196 <emphasis>(z196)</emphasis>
* IBM zEnterprise System z114 <emphasis>(z114)</emphasis>
* IBM zEnterprise EC12 <emphasis>(zEC12)</emphasis>
* IBM zEnterprise EC12 <emphasis>(zEC12)</emphasis>
* IBM zEnterprise BC12 <emphasis>(zBC12)</emphasis>
* IBM z13 <emphasis>(z13)</emphasis>
* LinuxOne Rockhopper
* LinuxOne Emperor</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>RAM</simpara></entry>
<entry align="left" valign="top"><simpara><emphasis>Split memory requirements across available RAM, VDISK and
        swap to suit your environment. On a production system the ratio of
        physical memory to VDISK will need to be re-evaluated based on the
        number of clients which will be supported.</emphasis></simpara><simpara>Minimum 5&#160;
 GB+ for test server <emphasis>(3 GB RAM + 2 GB VDISK
        Swap)</emphasis></simpara><simpara>Minimum 16&#160;
GB+ for base installation</simpara><simpara>Minimum 32&#160;
GB+ for a production server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Free Disk Space</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 100&#160;
GB for root partition</simpara><simpara>Minimum 50&#160;
GB for <literal role="replaceable">/var/lib/pgsql</literal></simpara><simpara>Minimum 50&#160;
GB per SUSE
product + 100 GB per Red Hat product <literal role="replaceable">/var/spacewalk</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Network Connection</simpara></entry>
<entry align="left" valign="top"><simpara>* OSA Express Ethernet <emphasis>(including Fast and Gigabit Ethernet) _
* HiperSockets or Guest LAN
* 10 GBE, VSWITCH
* RoCE _(RDMA over Converged Ethernet)</emphasis></simpara><simpara>The following interfaces are still included but no longer supported:</simpara><simpara>* CTC <emphasis>(or virtual CTC)</emphasis>
* IP network interface for IUCV</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<itemizedlist>
<title>Media Requirements</title>
<listitem>
<simpara>SUSE Linux Enterprise 12SP4 Installation Media for IBM z Systems :</simpara>
<simpara><link xl:href="https://www.suse.com/products/server/download/">https://www.suse.com/products/server/download/</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_additional_requirements">
<title>Additional Requirements</title>
<simpara>There are a few additional resource requirements you will need to prepare before installing the SUSE Manager extension on your system.
This section overviews these requirements.</simpara>
<simpara>The guest z/VM should be provided with a static IP address and hostname as these cannot be easily changed after initial setup.
The hostname should contain less than 8 characters.</simpara>
<simpara>For more information on SUSE Manager additional requirements, see <link xl:href="https://www.suse.com/documentation/suse-manager-3/book_suma_best_practices/data/mgr_conceptual_overview.html">https://www.suse.com/documentation/suse-manager-3/book_suma_best_practices/data/mgr_conceptual_overview.html</link>.</simpara>
<simpara>You will need to ensure you have sufficient disk storage for SUSE Manager
before running <literal role="command">yast2 susemanagersetup</literal>.</simpara>
<simpara>This section explains these requirements in more detail.</simpara>
<warning>
<title>SUSE ManagerDefault Volume Groups and Disk Space</title>
<simpara>By default the file system of SUSE Manager, including the embedded database and patch directories, reside within the root volume.
While adjustments are possible once installation is complete, it is the administrator&#8217;s responsibility to specify and monitor these adjustments.</simpara>
<simpara>If your SUSE Manager runs out of disk space, this can have a severe impact on its database and file structure.
Preparing storage requirements in accordance with this section will aid in preventing these harmful effects.
SUSE technical services will not be able to provide support for systems suffering from low disk space conditions as this can have an effect on an entire system and therefore becomes unresolvable.
A full recovery is only possible with a previous backup or a new SUSE Manager installation.</simpara>
</warning>
<formalpara>
<title>Required Storage Devices</title>
<para>An additional disk is required for database storage.
This should be an <literal role="systemitem">zFCP</literal> or <literal role="systemitem">DASD</literal> device as these are preferred for use with <literal role="systemitem">HYPERPAV</literal>.
The disk should fulfill the following requirements:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>At least 50&#160;GB for <literal role="path">/var/lib/pgsql</literal></simpara>
</listitem>
<listitem>
<simpara>At least 50&#160;GB for each SUSE product in <literal role="path">/var/spacewalk</literal></simpara>
</listitem>
<listitem>
<simpara>At least 100&#160;GB for each Red Hat product in <literal role="path">/var/spacewalk</literal></simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>Reclaiming Disk Space</title>
<para>If you need to reclaim more disk space, try these suggestions:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>Remove custom channels (you cannot remove official SUSE channels)</simpara>
</listitem>
<listitem>
<simpara>Use the <literal role="command">spacewalk-data-fsck --help</literal> command to compare the spacewalk database to the filesystem and remove entries if either is missing.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_sles12sp4_installation_and_the_suse_manager_extension">
<title>SLES 12SP4 Installation and the SUSE Manager Extension</title>
<simpara>This section covers the installation of SUSE Manager3.2
as an extension to SLES 12SP4
.</simpara>
<simpara>For more information on deploying SLES 12SP4
on your hardware, see <link xl:href="https://www.suse.com/documentation/sles-12/book_sle_deployment/data/cha_zseries.html">https://www.suse.com/documentation/sles-12/book_sle_deployment/data/cha_zseries.html</link>.</simpara>
<simpara>During installation of SLES 12SP4
select SUSE Manager
as an extension.</simpara>
<simpara>After rebooting you will need to set up the additional storage required for <literal role="path">/var/spacewalk</literal> and <literal role="path">/var/lib/pgsql</literal> and swap space using the yast partitioner tool.
This step is <emphasis>required</emphasis> before running <literal role="command">yast2 susemanagersetup</literal>.</simpara>
<simpara>After configuring the storage requirements, having executed a YaST
online update and completed a full system reboot, run SUSE Manager
setup to finalize the SUSE Manager
installation on your z Systems
mainframe:</simpara>
<screen>{prompt.root}yast2 susemanagersetup</screen>
<simpara>This completes the installation of SUSE Manager
on your z Systems
.
For more information on beginning management with SUSE Manager
, see <link xl:href="suma-setup-with-yast-sumasetup.xml#suma-setup-with-yast-sumasetup">Setup SUSE Manager with YaST</link>.</simpara>
</section>
</chapter>
<chapter xml:id="advanced.topics.proxy.quickstart">
<title>SUSE Manager 3.2 Proxy</title>
<simpara>This chapter explains how to install and set up SUSE Manager 3.2 Proxy.
It also provides notes about migrating a previous proxy to version 3.2.</simpara>
<section xml:id="at.manager.proxy.concepts">
<title>Overview</title>
<simpara>SUSE Manager 3.2 Proxy is a SUSE Manager add-on that caches software packages on an internal, central server.
The proxy caches patch updates from SUSE or custom RPMs generated by third-party organizations.
A proxy allows you to use bandwidth more effectively because client systems connect to the proxy for updates, and the SUSE Manager server is no longer required to handle all client requests.
A SUSE Manager Proxy can serve both Traditional and Salt clients.
The proxy also supports transparent custom package deployment.</simpara>
<simpara>SUSE Manager Proxy is an open source (GPLv2) solution that provides the following features:</simpara>
<itemizedlist>
<listitem>
<simpara>Cache software packages within a Squid proxy.</simpara>
</listitem>
<listitem>
<simpara>Client systems see the SUSE Manager Proxy as a SUSE Manager server instance.</simpara>
</listitem>
<listitem>
<simpara>The SUSE Manager Proxy is registered as a client system with the SUSE Manager server.</simpara>
</listitem>
</itemizedlist>
<simpara>The primary goal of a SUSE Manager Proxy is to improve SUSE Manager performance by reducing bandwidth requirements and accelerating response time.</simpara>
</section>
<section xml:id="at.manager.proxy.inst-and-clients">
<title>Proxy Installation and Connecting Clients</title>
<section xml:id="at.manager.proxy.requirements">
<title>Requirements</title>
<simpara>The following section provides SUSE Manager Proxy requirements.</simpara>
<formalpara>
<title>Supported Client Systems</title>
<para>For supported clients and their requirements, see <xref linkend="quickstart.sect.prereq.clientos"/>.</para>
</formalpara>
<formalpara>
<title>Hardware Requirements</title>
<para>Hardware requirements highly depend on your usage scenario.
When planning proxy environments, consider the amount of data you want to cache on your proxy.
If your proxy should be a 1:1 mirror of your SUSE Manager, the same amount of disk space is required.
For specific hardware requirements, see the following table.</para>
</formalpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Hardware</entry>
<entry align="left" valign="top">Required</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>CPU</simpara></entry>
<entry align="left" valign="top"><simpara>Multi-core 64-bit CPU (x86_64).</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>RAM</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 4&#160; GB for a non-production server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"></entry>
<entry align="left" valign="top"><simpara>Minimum 16&#160; GB for a production server</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Free Disk Space</simpara></entry>
<entry align="left" valign="top"><simpara>Minimum 100&#160; GB for base installation and at least 50 GB for caching per SUSE product and +100 GB per Red Hat product; a resizeable partition strongly recommended.</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<tip>
<title>Storage for Proxy Data</title>
<simpara>SUSE recommends storing the squid proxy caching data on a separate disk formatted with the XFS file system.</simpara>
</tip>
<formalpara>
<title>SSL Certificate Password</title>
<para>For installing the proxy, you need the SSL certificate password entered during the initial installation of SUSE Manager.</para>
</formalpara>
<formalpara>
<title>Network Requirements</title>
<para>For additional network requirements, see <xref linkend="quickstart.sect.prereq.network"/>.</para>
</formalpara>
<formalpara>
<title>SUSE Customer Center</title>
<para>For using SUSE Manager Proxy, you need an account at SUSE Customer Center (SCC) where your purchased products and product subscriptions are registered.
Make sure you have the following subscriptions:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara>One or more subscriptions for SUSE Manager Proxy .</simpara>
</listitem>
<listitem>
<simpara>One or more subscriptions for SUSE Manager .</simpara>
</listitem>
<listitem>
<simpara>Subscriptions for the products on the client systems you want to register with SUSE Manager via SUSE Manager Proxy .</simpara>
</listitem>
<listitem>
<simpara>Subscriptions to client entitlements for the client system you want to register with SUSE Manager via SUSE Manager Proxy .</simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>Network Time Protocol (NTP)</title>
<para>The connection to the Web server via Secure Sockets Layer (SSL) requires correct time settings on the server, proxy and clients.
For this reason, all systems must use NTP.
For more information, see <link xl:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html">https://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html</link>.</para>
</formalpara>
<formalpara>
<title>Virtual Environments</title>
<para>The following virtual environments are supported:</para>
</formalpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="http://www.linux-kvm.org/page/Main_Page">http://www.linux-kvm.org/page/Main_Page</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="http://www.vmware.com/">http://www.vmware.com/</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="http://www.microsoft.com/en-us/server-cloud/solutions/virtualization.aspx">http://www.microsoft.com/en-us/server-cloud/solutions/virtualization.aspx</link></simpara>
</listitem>
</itemizedlist>
<simpara>For running SUSE Manager Proxy in virtual environments, use the following settings for the virtual machine (VM):</simpara>
<itemizedlist>
<listitem>
<simpara>At least 1 GB of RAM</simpara>
</listitem>
<listitem>
<simpara>Bridged network</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.manager.proxy.inst">
<title>Installation and Setup</title>
<simpara>The following section will guide you through the installation and setup procedure.</simpara>
<simpara>SUSE Manager Proxy systems are registered as traditional clients or as Salt clients using a bootstrap script.
Migrating a traditionally registered Proxy system to a Salt Proxy system is not possible.
Re-install the Proxy if you want to switch to Salt.</simpara>
<important>
<title>Downloading Channels</title>
<simpara>Before you can select the correct child channels while creating the activation key, ensure you have completely downloaded the channels for SUSE Linux Enterprise 12 SP4.</simpara>
</important>
<orderedlist xml:id="at.manager.proxy.install.prep" numeration="arabic">
<title>Procedure: Registering the Proxy</title>
<listitem>
<simpara>Create an activation key based on the SUSE Linux Enterprise 12 SP4 base channel.
For more information about activation keys, see <xref linkend="create.act.keys"/>.</simpara>
<figure>
<title>Proxy Activation Key</title>
<mediaobject>
<imageobject>
<imagedata fileref="proxy-key.png"/>
</imageobject>
<textobject><phrase>proxy key</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>From the <literal role="guimenu">Child Channels</literal> listing select the SUSE Manager 3.2 Proxy child channel with the matching update channel (<literal role="systemitem">SUSE Manager Proxy-3.2-Pool</literal> and <literal role="systemitem">SUSE-Manager-Proxy-3.2-Updates</literal>).
These child channels are required for providing the proxy packages and updates.
For normal SLES clients, <literal role="systemitem">SLES12-SP4-Updates</literal> plus <literal role="systemitem">SLE-Manager-Tools12-Pool</literal> and <literal role="systemitem">SLE-Manager-Tools12-Updates</literal> are mandatory.</simpara>
<figure>
<title>Base and Child Proxy Channel</title>
<mediaobject>
<imageobject>
<imagedata fileref="sles12-proxy-child.png"/>
</imageobject>
<textobject><phrase>sles12 proxy child</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>Navigate to <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Admin</guisubmenu> <guisubmenu>Manager Configuration</guisubmenu> <guimenuitem>Bootstrap Script</guimenuitem></menuchoice>, and create or modify a bootstrap script for the proxy if needed.
If you want to run the proxy on a traditional client (system type <literal>Management</literal>) uncheck <literal role="guimenu">Bootstrap using Salt</literal>.
Using Salt is supported since version 3.2.
For more information about bootstrap scripts, see <xref linkend="modify.bootstrap.script"/>.</simpara>
<figure>
<title>Modifying Bootstrap Script</title>
<mediaobject>
<imageobject>
<imagedata fileref="sles12-proxy-bootstrap.png"/>
</imageobject>
<textobject><phrase>sles12 proxy bootstrap</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>Create the SUSE Manager Tools Repository for bootstrapping, see <xref linkend="create.tools.repository"/>.</simpara>
</listitem>
<listitem>
<simpara>Bootstrap the client with the bootstrap script.  For more information, see <xref linkend="connect.first.client"/>.</simpara>
</listitem>
<listitem>
<simpara>In case of a Salt client, accept the key on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Salt</guisubmenu> <guimenuitem>Keys</guimenuitem></menuchoice> page by clicking the check mark and it will appear in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Check via <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Software Channels</guimenuitem></menuchoice> that the two proxy channels <literal role="systemitem">SUSE Manager Proxy-3.2-Pool</literal> and <literal role="systemitem">SUSE-Manager-Proxy-3.2-Updates</literal> are selected.</simpara>
</listitem>
</orderedlist>
<figure>
<title>Proxy Channels</title>
<mediaobject>
<imageobject>
<imagedata fileref="sles12-proxy-channels.png"/>
</imageobject>
<textobject><phrase>sles12 proxy channels</phrase></textobject>
</mediaobject>
</figure>
<simpara>A few more steps are still needed:</simpara>
<itemizedlist>
<listitem>
<simpara>Install the <literal role="path">patterns-suma_proxy</literal> pattern (see <xref linkend="at.manager.proxy.run.pattern"/>)</simpara>
</listitem>
<listitem>
<simpara>Copy the SSL certificate and key from the server (see <xref linkend="at.manager.proxy.run.copycert"/>)</simpara>
</listitem>
<listitem>
<simpara>Run <literal role="command">configure-proxy.sh</literal> (see <xref linkend="at.manager.proxy.run.confproxy"/>)</simpara>
</listitem>
</itemizedlist>
<simpara>You will then be able to register your clients against the proxy using the Web UI or a bootstrap script as if it were a SUSE Manager server.
For more information, see <xref linkend="at.manager.proxy.register.saltclients"/>.</simpara>
</section>
<section xml:id="at.manager.proxy.run.pattern">
<title>Install the <literal role="path">suma_proxy</literal> pattern</title>
<simpara>On the server select the <literal role="package">patterns-suma_proxy</literal> package for installation, or make sure the <literal role="path">suma_proxy</literal> pattern is installed using the following command on the proxy as root:</simpara>
<screen>zypper in -t pattern suma_proxy</screen>
<simpara>The new salt-broker service will be automatically started at the end of the package installation.
This service forwards the Salt interactions to the SUSE Manager server.</simpara>
<note>
<title>Proxy Chains</title>
<simpara>It is possible to arrange Salt proxies in a chain.
In such a case, the upstream proxy is named <quote>parent</quote>.</simpara>
</note>
<simpara>Make sure the proxie&#8217;s TCP ports <literal>4505</literal> and <literal>4506</literal> are open and that the proxy can reach the SUSE Manager server (or another upstream proxy) on these ports.</simpara>
</section>
<section xml:id="at.manager.proxy.run.copycert">
<title>Copy Server Certificate and Key</title>
<simpara>The proxy will share some SSL information with the SUSE Manager server, so the next step is to copy the certificate and its key from the SUSE Manager server or the upstream proxy.</simpara>
<simpara>As root, enter the following commands on the proxy using your SUSE Manager server or chained proxy named <literal role="replaceable">PARENT</literal>:</simpara>
<screen>mkdir /root/ssl-build
cd /root/ssl-build
scp root@PARENT:/root/ssl-build/RHN-ORG-PRIVATE-SSL-KEY .
scp root@PARENT:/root/ssl-build/RHN-ORG-TRUSTED-SSL-CERT .
scp root@PARENT:/root/ssl-build/rhn-ca-openssl.cnf .</screen>
<note>
<title>Known Limitation</title>
<simpara>The SUSE Manager Proxy functionality is only supported if the SSL certificate was signed by the same CA as the SUSE Manager Server certificate.
Using certificates signed by different CAs for Proxies and Server is not supported.</simpara>
</note>
</section>
<section xml:id="at.manager.proxy.run.confproxy">
<title>Running <literal role="command">configure-proxy.sh</literal></title>
<simpara>The <literal role="command">configure-proxy.sh</literal> script will finalize the setup of your SUSE Manager Proxy.</simpara>
<simpara>Now execute the interactive <literal role="command">configure-proxy.sh</literal> script.
Pressing <keycap>Enter</keycap> without further input will make the script use the default values provided between brackets <literal>[]</literal>.
Here is some information about the requested settings:</simpara>
<variablelist>
<varlistentry>
<term>SUSE Manager Parent</term>
<listitem>
<simpara>A SUSE Manager parent can be either another proxy server or a SUSE Manager server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>HTTP Proxy</term>
<listitem>
<simpara>A HTTP proxy enables your SUSE Manager proxy to access the Web.
This is needed if direct access to the Web is prohibited by a firewall.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Proxy Version to Activate</term>
<listitem>
<simpara>Normally, the correct value (3.0, 3.1, or 3.2) should be offered as a default.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Traceback Email</term>
<listitem>
<simpara>An email address where to report problems.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Use SSL</term>
<listitem>
<simpara>For safety reasons, press <literal>Y</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Do You Want to Import Existing Certificates?</term>
<listitem>
<simpara>Answer <literal>N</literal>.
This ensures using the new certificates that were copied previously from the SUSE Manager server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Organization</term>
<listitem>
<simpara>The next questions are about the characteristics to use for the SSL certificate of the proxy.
The organization might be the same organization that was used on the server, unless of course your proxy is not in the same organization as your main server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Organization Unit</term>
<listitem>
<simpara>The default value here is the proxy&#8217;s hostname.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Common Name</term>
<listitem>
<simpara>The default value here is also the proxy&#8217;s hostname.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>City</term>
<listitem>
<simpara>Further information attached to the proxy&#8217;s certificate.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Country Code</term>
<listitem>
<simpara>As the country code enter the country code set during the SUSE Manager installation.
For example, if your proxy is in US and your SUSE Manager in DE, you must enter <literal>DE</literal> for the proxy.</simpara>
<note>
<simpara>The country code must be two upper case letters.
For a complete list of country codes, see <link xl:href="https://www.iso.org/obp/ui/#search">https://www.iso.org/obp/ui/#search</link>.</simpara>
</note>
</listitem>
</varlistentry>
<varlistentry>
<term>Cname Aliases (Separated by Space)</term>
<listitem>
<simpara>Use this if your proxy server can be accessed through various DNS CNAME aliases.
Otherwise it can be left empty.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>CA Password</term>
<listitem>
<simpara>Enter the password that was used for the certificate of your SUSE Manager server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Do You Want to Use an Existing SSH Key for Proxying SSH-Push Salt Minions?</term>
<listitem>
<simpara>Use this option if you want to reuse a SSH key that was used for SSH-Push Salt minions on the server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Create and Populate Configuration Channel rhn_proxy_config_1000010001?</term>
<listitem>
<simpara>Accept default <literal>Y</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>SUSE Manager Username</term>
<listitem>
<simpara>Use same user name and password as on the SUSE Manager server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Activate advertising proxy via SLP?</term>
<listitem>
<simpara>SLP stands for Service Location Protocol.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>If parts are missing, such as CA key and public certificate, the script prints commands that you must execute to integrate the needed files.
When the mandatory files are copied, re-run <literal role="command">configure-proxy.sh</literal>.
Also restart the script if a HTTP error was met during script execution.</simpara>
<simpara><literal role="command">configure-proxy.sh</literal> activates services required by SUSE Manager Proxy, such as <literal role="systemitem">squid</literal>, <literal role="systemitem">apache2</literal>, <literal role="systemitem">salt-broker</literal>, and <literal role="systemitem">jabberd</literal>.</simpara>
<simpara>To check the status of the proxy system and its clients, click the proxy system&#8217;s details page on the Web UI (<menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Proxy</guimenuitem></menuchoice>, then the system name). <literal role="guimenu">Connection</literal> and <literal role="guimenu">Proxy</literal> subtabs display the respective status information.</simpara>
</section>
<section xml:id="at.manager.proxy.register.saltclients">
<title>Registering Salt Clients via SUSE Manager Proxy</title>
<simpara>Proxy servers may now act as a broker and package cache for Salt minions.
These minions can be registered with a bootstrap script like the traditional clients, or from the Web UI, or the command line.</simpara>
<simpara>Registering Salt clients via SUSE Manager Proxy from the Web UI
is done almost the same way as registering clients directly with the SUSE Manager server.
The difference is that you specify the name of the proxy in the <literal role="guimenu">Proxy</literal> drop-box on the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Bootstrapping</guimenuitem></menuchoice> page.</simpara>
<figure>
<title>Bootstrapping a Salt Client With a Proxy</title>
<mediaobject>
<imageobject>
<imagedata fileref="proxy-saltbootstrap.png" width="80%"/>
</imageobject>
<textobject><phrase>proxy saltbootstrap</phrase></textobject>
</mediaobject>
</figure>
<orderedlist numeration="arabic">
<title>Procedure: Register a Salt client through a proxy from command line</title>
<listitem>
<simpara>Instead of the Web UI , you may use the command line to register a minion through a proxy.
To do so, add the proxy FQDN as the master in the minions configuration file located at:</simpara>
<screen>/etc/salt/minion</screen>
<simpara>or alternatively:</simpara>
<screen>/etc/salt/minion.d/NAME.conf</screen>
</listitem>
<listitem>
<simpara>Add the FQDN to the minion file:</simpara>
<screen>master: proxy123.example.com</screen>
<simpara>Save and restart the salt-minion service with:</simpara>
<screen>systemctl restart salt-minion</screen>
</listitem>
<listitem>
<simpara>On the proxy, accept the new minion key with:</simpara>
<screen>salt-key -a 'minion'</screen>
<simpara>The minion will now connect to the proxy exclusively for Salt operations and normal HTTP package downloads.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.manager.proxy.register.clients">
<title>Registering Clients via SUSE Manager Proxy with a Script</title>
<simpara>Registering clients (either traditional or Salt) via SUSE Manager Proxy with a script is done almost the same way as registering clients directly with the SUSE Manager server.
The difference is that you create the bootstrap script on the SUSE Manager Proxy with a command-line tool.
The bootstrap script then deploys all necessary information to the clients.
The bootstrap script refers some parameters (such as activation keys or GPG keys) that depend on your specific setup.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Create a client activation key on the SUSE Manager server using the Web UI.
See <xref linkend="create.act.keys"/>.</simpara>
</listitem>
<listitem>
<simpara>On the proxy, execute the <literal role="command">mgr-bootstrap</literal> command-line tool as root.
If needed, use the additional command-line switches to tune your bootstrap script. An important option is <literal role="command">--traditional</literal> that enables to opt for a traditional client instead of a salt minion.</simpara>
<simpara>To view available options type <literal role="command">mgr-bootstrap --help</literal> from the command line:</simpara>
<screen># mgr-bootstrap --activation-keys=key-string</screen>
</listitem>
<listitem>
<simpara>Optionally edit the resulting bootstrap script.
Execute the bootstrap script on the clients as described in <xref linkend="connect.first.client"/>.</simpara>
</listitem>
</orderedlist>
<simpara>The clients are registered with the SUSE Manager Proxy specified in the bootstrap script.</simpara>
</section>
<section xml:id="at.additional.info.about.client.registration.on.proxies">
<title>Additional Information about Client Registration on Proxies</title>
<simpara>Within the Web UI, standard proxy pages will show information about client, no matter whether minions or traditional clients.</simpara>
<simpara>A list of clients connected to a proxy can be located under <menuchoice><guimenu>Systems</guimenu> <guisubmenu>] &lt;proxy name</guisubmenu> <guimenuitem>menu:Details[</guimenuitem></menuchoice><guimenu>Proxy</guimenu>.</simpara>
<simpara>A list of chained proxies for a minion can be located under <menuchoice><guimenu>Systems</guimenu> <guisubmenu>] &lt;minion name</guisubmenu> <guimenuitem>menu:Details[</guimenuitem></menuchoice><guimenu>Connection</guimenu></simpara>
<simpara>If you decide to move any of your clients between proxies or the server you will need to repeat the registration process from scratch.</simpara>
</section>
</section>
<section xml:id="advanced.topics.proxy.pxe">
<title>Enabling PXE Boot via SUSE Manager Proxy</title>
<section xml:id="advanced.topics.proxy.pxe.sync">
<title>Synchronizing Profiles and System Information</title>
<simpara>To enable PXE boot via a proxy server, additional software must be installed and configured on both the SUSE Manager server and the SUSE Manager Proxy server.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>On the SUSE Manager server install <phrase role="package">susemanager-tftpsync</phrase> :</simpara>
<screen>zypper in susemanager-tftpsync</screen>
</listitem>
<listitem>
<simpara>On the SUSE Manager Proxy server install <phrase role="package">susemanager-tftpsync-recv</phrase> :</simpara>
<screen>zypper in susemanager-tftpsync-recv</screen>
</listitem>
<listitem>
<simpara>Run the <literal role="command">configure-tftpsync.sh</literal> setup script and enter the requested information:</simpara>
<screen>configure-tftpsync.sh</screen>
<simpara>It asks for hostname and IP address of the SUSE Manager server and of the proxy itself.
Additionally, it asks for the tftpboot directory on the proxy.</simpara>
</listitem>
<listitem>
<simpara>On the SUSE Manager server, run <literal role="command">configure-tftpsync.sh</literal> to configure the upload to the SUSE Manager Proxy server:</simpara>
<screen>configure-tftpsync.sh FQDN_of_Proxy_Server</screen>
</listitem>
<listitem>
<simpara>To initiate an initial synchronization on the SUSE Manager Server run:</simpara>
<screen>cobbler sync</screen>
<simpara>Also can also be done after each a change within Cobbler that needs to be synchronized immediately.
Otherwise Cobbler synchronization will also run automatically when needed.
For more information about Cobbler, see <xref linkend="advanced.topics.cobbler"/>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="advanced.topics.proxy.pxe.dhcp">
<title>Configuring DHCP for PXE via SUSE Manager Proxy</title>
<simpara>SUSE Manager is using Cobbler to provide provisioning.
PXE (tftp) is installed and activated by default.
To enable systems to find the PXE boot on the SUSE Manager Proxy server add the following to the DHCP configuration for the zone containing the systems to be provisioned:</simpara>
<screen>next-server: &lt;IP_Address_of_SUSE_Manager_Proxy_Server&gt;
filename: "pxelinux.0"</screen>
</section>
</section>
<section xml:id="advanced.topics.proxy.migration3">
<title>Migrating SUSE Manager 3.1 Proxy to Version 3.2 [Management]</title>
<simpara>The recommended order for migrations is to first migrate the server and then the proxies.</simpara>
<simpara>For the migration of traditionally managed proxies there are two possible approaches:</simpara>
<itemizedlist>
<listitem>
<simpara>Existing SUSE Manager proxies may be upgraded to version 3.2 with YaST or <literal role="command">zypper</literal> migration.</simpara>
</listitem>
<listitem>
<simpara>Alternatively, the proxies may be replaced by new ones.</simpara>
</listitem>
</itemizedlist>
<simpara>This section documents both approaches.</simpara>
<note>
<title>Migrating SUSE Manager 3 Proxy and Earlier</title>
<simpara>For migrating SUSE Manager 3 Proxy and earlier, see <link xl:href="https://www.suse.com/documentation/suse-manager-3/book_suma_advanced_topics_31/data/sect1_chapter_book_suma_advanced_topics_31.html">https://www.suse.com/documentation/suse-manager-3/book_suma_advanced_topics_31/data/sect1_chapter_book_suma_advanced_topics_31.html</link>, Chapter "SUSE Manager 3.1 Proxy".</simpara>
</note>
<section xml:id="at.replacing.a.susemgrproxy">
<title>Replacing a SUSE Manager Proxy</title>
<simpara>A SUSE Manager Proxy is <literal>dumb</literal> in the sense that it does not contain any information about the clients which are connected to it.
A SUSE Manager Proxy can therefore be replaced by a new one.
Naturally, the replacement proxy must have the same name and IP address as its predecessor.</simpara>
<simpara>In order to replace a SUSE Manager Proxy and keeping the clients registered to the proxy leave the old proxy in SUSE Manager.
Create a reactivation key for this system and then register the new proxy using the reactivation key.
If you do not use the reactivation key, you will need to re-registered all the clients against the new proxy.</simpara>
<orderedlist xml:id="proc.advanced.topics.proxy.migration3.replace" numeration="arabic">
<title>Procedure: Replacing a SUSE Manager Proxyand Keeping the ClientsRegistered</title>
<listitem>
<simpara>Before starting the actual migration procedure, save the data from the old proxy, if needed.
Consider copying important data to a central place that can also be accessed by the new server:</simpara>
<itemizedlist>
<listitem>
<simpara>Copy the scripts that are still needed.</simpara>
</listitem>
<listitem>
<simpara>Copy the activation keys from the previous server.
Of course, it is always better to re-create the keys.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Shutdown the server.</simpara>
</listitem>
<listitem>
<simpara>Install a new SUSE Manager 3.2 Proxy, see <xref linkend="at.manager.proxy.inst-and-clients"/>.</simpara>
</listitem>
<listitem>
<simpara>In the SUSE Manager Web UI select the newly installed SUSE Manager Proxy and delete it from the systems list.</simpara>
</listitem>
<listitem>
<simpara>In the Web UI, create a reactivation key for the old proxy system: On the System Details tab of the old proxy click <literal role="guimenu">Reactivation</literal>.
Then click <literal role="guimenu">Generate New Key</literal>, and remember it (write it on a piece of paper or copy it to the clipboard).
For more information about reactivation keys, see <xref linkend="s5-sm-system-details-react"/>.</simpara>
</listitem>
<listitem>
<simpara>After the installation of the new proxy, perform the following actions (if needed):</simpara>
<itemizedlist>
<listitem>
<simpara>Copy the centrally saved data to the new proxy system.</simpara>
</listitem>
<listitem>
<simpara>Install any other needed software.</simpara>
</listitem>
<listitem>
<simpara>If the proxy is also used for autoinstallation, do not forget to setup TFTP synchronization.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<important>
<title>Proxy Installation and Client Connections</title>
<simpara>During the installation of the proxy, clients will not be able to reach the SUSE Manager server.
After a SUSE Manager Proxy system has been deleted from the systems list, all clients connected to this proxy will be (incorrectly) listed as <literal>directly connected</literal> to the SUSE Manager server.
After the first successful operation on a client <emphasis>such as execution of a remote command or installation of a package or patch</emphasis> this information will automatically be corrected.
This may take a few hours.</simpara>
</important>
</section>
<section xml:id="at.upgrade.a.susemgrproxy">
<title>Upgrading a SUSE Manager Proxy from 3.1 to 3.2</title>
<simpara>In most situations upgrading the proxy will be your preferred solution as this retains all cached packages.
Selecting this route saves time especially regarding proxies connected to SUSE Manager server via low-bandwith links.
This upgrade is similar to a standard client migration.</simpara>
<warning>
<title>Synchronizing Target Channels</title>
<simpara>Before successfully initializing the product migration, you first must make sure that the migration target channels are completely mirrored.
To upgrade to SUSE Manager 3.2 Proxy, you will require at least the <literal role="systemitem">SUSE Linux Enterprise Server 12 SP4</literal> base channel with the <literal role="systemitem">SUSE Manager Proxy 3.2</literal> child channel for your architecture.</simpara>
</warning>
<orderedlist numeration="arabic">
<title>Procedure: Migrating Proxy to 3.2</title>
<listitem>
<simpara>Direct your browser to the SUSE Manager Web UI where your proxy is registered, and login.</simpara>
</listitem>
<listitem>
<simpara>On the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Proxy</guimenuitem></menuchoice> page select your proxy server from the table.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_old_details_page.png"/>
</imageobject>
<textobject><phrase>suma proxy old details page</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>On the system&#8217;s detail page select the <menuchoice><guimenu>Software</guimenu> <guimenuitem>SP Migration</guimenuitem></menuchoice> tab.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_old_details_spmigration.png"/>
</imageobject>
<textobject><phrase>suma proxy old details spmigration</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>From this page you will see installed products listed on your proxy client, and the available target products.
Select the required <literal role="guimenu">Target Products</literal>.  In this case, you will require <literal role="systemitem">SUSE Linux Enterprise Server 12 SP4</literal> with <literal role="systemitem">SUSE Manager Proxy 3.2</literal>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_migration_target.png"/>
</imageobject>
<textobject><phrase>suma proxy migration target</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Then confirm with <guibutton>Select Channels</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_migration_channels.png"/>
</imageobject>
<textobject><phrase>suma proxy migration channels</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>From the <literal role="guimenu">Schedule Migration</literal> menu, select the time and click <guibutton>Confirm</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_migration_schedule.png"/>
</imageobject>
<textobject><phrase>suma proxy migration schedule</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</orderedlist>
<simpara>Check the <literal role="guimenu">System Status</literal> on the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Overview</guimenuitem></menuchoice> when the migration is done.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="suma_proxy_migrated.png"/>
</imageobject>
<textobject><phrase>suma proxy migrated</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Finally consider scheduling a reboot.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="advanced.topics.security">
<title>Security</title>
<section xml:id="at.security">
<title>Setup a Minion to Master Validation Fingerprint</title>
<simpara>In highly secure network configurations you may wish to ensure your minions are connecting a specific master.
To setup validation from minion to master enter the masters fingerprint within the <literal role="path">/etc/salt/minion</literal> configuration file.
See the following procedure:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>On the master enter the following command as root and note the fingerprint:</simpara>
<screen>salt-key -F master</screen>
<simpara>On your minion, open the minion configuration file located in <literal role="path">/etc/salt/minion</literal>.
Uncomment the following line and enter the masters fingerprint replacing the example fingerprint:</simpara>
<screen>master_finger: 'ba:30:65:2a:d6:9e:20:4f:d8:b2:f3:a7:d4:65:11:13'</screen>
</listitem>
<listitem>
<simpara>Restart the salt-minion service:</simpara>
<screen># systemctl restart salt-minion</screen>
</listitem>
</orderedlist>
<simpara>For more information on configuring security from a minion see: <link xl:href="https://docs.saltstack.com/en/latest/ref/configuration/minion.html">https://docs.saltstack.com/en/latest/ref/configuration/minion.html</link></simpara>
</section>
<section xml:id="_signing_repository_metadata">
<title>Signing Repository Metadata</title>
<section xml:id="_generate_a_custom_gpg_key">
<title>Generate a Custom GPG key</title>
<simpara>To sign repository metadata a custom GPG key is required. Create a new GPG key as <emphasis role="strong">root</emphasis> via the following steps.</simpara>
<screen>$&gt; gpg --gen-key

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 1
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)
Key does not expire at all
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: company sign key
Email address: company@example.com
Comment:
You selected this USER-ID:
    "company sign key &lt;company@example.com&gt;"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

gpg: key 607FABDB marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048R/607FABDB 2018-07-09
      Key fingerprint = ACF5 4698 EC70 FD6A F8C9  942B A7A1 9301 607F ABDB
uid       [ultimate] company sign key &lt;company@example.com&gt;
sub   2048R/A812FA62 2018-07-09</screen>
</section>
<section xml:id="_configure_signing_metadata">
<title>Configure signing metadata</title>
<simpara>There are two configuration files which needs to be changed to enable signing of metadata.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara><literal role="filename">/etc/rhn/signing.conf</literal> to specify KEYID and PASSPHRASE</simpara>
</listitem>
<listitem>
<simpara><literal role="filename">/etc/rhn/rhn.conf</literal> to enable signing metadata</simpara>
</listitem>
</orderedlist>
<simpara>Example for <literal role="filename">/etc/rhn/signing.conf</literal>:</simpara>
<screen>KEYID="607FABDB"

GPGPASS="MySecretPassword"</screen>
<simpara>To enable signing of metadata please add the following in <literal role="filename">/etc/rhn/rhn.conf</literal>:</simpara>
<screen>sign_metadata = 1</screen>
<simpara>All spacewalk services must be restarted after modifying 'rhn.conf'.</simpara>
</section>
<section xml:id="_regenerate_all_metadata">
<title>Regenerate all metadata</title>
<simpara>After enabling signing metadata, all metadata needs to be re-generated.
This can be done with a small SQL script:</simpara>
<screen>$&gt; spacewalk-sql -i
psql (9.6.9)
Type "help" for help.

susemanager=# insert into rhnRepoRegenQueue (id, CHANNEL_LABEL, REASON, FORCE)
susemanager-# (select sequence_nextval('rhn_repo_regen_queue_id_seq'), C.label, 'changed signing of metadata', 'Y' from rhnChannel C);
INSERT 0 40
susemanager=# \q
$&gt;</screen>
</section>
<section xml:id="_trust_the_gpg_key_on_all_clients">
<title>Trust the GPG key on all clients</title>
<simpara>When this feature is enabled, all clients have to trust the new GPG key.
If the new GPG key is not imported on the client, installation or updating of packages is not possible.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Export the GPG key and make it availabel in the 'pub/' directory.</simpara>
<screen># gpg --batch --export -a -o &lt;output filename&gt; &lt;KEYID&gt;
$&gt; gpg --batch --export -a -o /srv/www/htdocs/pub/company.key 607FABDB</screen>
</listitem>
<listitem>
<simpara>Import the GPG key on all clients</simpara>
<simpara>This can be done using a remote command on all clients</simpara>
<screen># rpm --import http://&lt;server.domain.top/pub/keyname.key
$&gt; rpm --import http://suma-refhead-srv.mgr.suse.de/pub/company.key</screen>
<tip>
<title>Tip</title>
<simpara>For salt managed systems it might make sense to use a state to trust GPG keys.</simpara>
</tip>
</listitem>
</orderedlist>
</section>
</section>
</chapter>
<chapter xml:id="_suse_manager_in_the_public_cloud_suse_manager_server_and_suse_manager_proxy_in_the_public_cloud">
<title>SUSE Manager in the Public Cloud: SUSE Manager Server and SUSE Manager Proxy in the Public Cloud</title>
<simpara>SUSE Manager delivers best-in-class Linux server management capabilities.
For detailed information about the product please refer to the <link xl:href="https://www.suse.com/documentation/suse_manager">SUSEManager</link> documentation.</simpara>
<simpara>The SUSE Manager Server and SUSE Manager Proxy images published by SUSE in selected Public Cloud environments are provided as Bring Your Own Subscription (BYOS) images.
SUSE Manager Server instances need to be registered with the SUSE Customer Center (SCC).
Subscriptions of SUSE Manager Proxy instances are handled through their parent SUSE Manager Server.
After an instance is launched, SUSE Manager needs to be set up and configured following the procedure in the SUSE Manager documentation.</simpara>
<section xml:id="instance-requirements">
<title>Instance Requirements</title>
<simpara>Select an instance size that meets the system requirements as documented in the SUSE Manager documentation.</simpara>
<itemizedlist>
<listitem>
<simpara>Minimal main memory: &gt;12G</simpara>
</listitem>
<listitem>
<simpara>The SUSE Manager setup procedure performs a Forward-confirmed reverse DNS lookup. This must succeed in order for the setup procedure to complete successfully and for SUSE Manager to operate as expected. Therefore it is important that the hostname and IP configuration be performed prior to running the SUSE Manager setup procedure.</simpara>
</listitem>
<listitem>
<simpara>SUSE Manager Server and SUSE Manager Proxy instances are expected to run in a network configuration that provides you control over DNS entries and that is shielded from the Internet at large. Within this network configuration DNS (Domain Name Service) resolution must be provided, such that <literal>hostname -f</literal> returns the FQDN (Full Qualified Domain Name). The DNS resolution is not only important for the SUSE Manager Server procedure but is also important when clients are configured to be managed via SUSE Manager. Configuring DNS is Cloud Framework dependent, please refer to the cloud service provider documentation for detailed instructions.</simpara>
</listitem>
<listitem>
<simpara>Minimal free disk space for SUSE Manager 15G.</simpara>
<simpara>For Public Cloud instances we recommend that the repositories and the SUSE Manager Server database, and respectively the SUSE Manager Proxy squid cache, be located on an external virtual disk.
The details for this setup are provided in <xref linkend="using-separate-storage-volume"/>.</simpara>
<simpara>Storing the database and the repositories on an external virtual disk ensures that the data is not lost should the instance need to be terminated for some reason.</simpara>
</listitem>
</itemizedlist>
<simpara>Please ensure that the selected instance type matches the requirements listed above.
Although we recommend that the database and the repositories are stored on a separate device it is still recommended to set the root volume size of the instance to 20G.</simpara>
</section>
<section xml:id="setup">
<title>Setup</title>
<simpara>Run an instance of the SUSE Manager Server or SUSE Manager Proxy image as published by SUSE.
The images are identifiable by the suse, manager, server or proxy, and byos keywords in each public cloud environment.
The SUSE Manager instance must run in a network access restricted environment such as the private subnet of a VPC or with an appropriate firewall setting such that it can only be accessed by machines in the IP ranges you use.
A generally accessible SUSE Manager instance violates the terms of the SUSE Manager EULA.
Access to the web interface of SUSE Manager requires https.</simpara>
<simpara>SUSE Manager requires a stable and reliable hostname, changing the hostname can create errors.
In this procedure, all commands need to be executed as the root user.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Setting the Hostname</title>
<listitem>
<simpara>Disable hostname setup by editing the DHCP configuration file at <literal role="path">/etc/sysconfig/network/dhcp</literal>, and adding this line:</simpara>
<screen>DHCLIENT_SET_HOSTNAME="no"</screen>
</listitem>
<listitem>
<simpara>Set the hostname locally using the <literal role="command">hostnamectl</literal> command.
Ensure you use the system name, not the fully qualified domain name (FQDN).
The FQDN is set by the cloud framework; for example if  <emphasis role="strong">cloud_instance.cloud.net</emphasis> is the FQDN, <emphasis role="strong">cloud_instance</emphasis> is the system name and <emphasis role="strong">cloud.net</emphasis> is the domain name:</simpara>
<screen>hostnamectl set-hostname system_name</screen>
</listitem>
<listitem>
<simpara>Create a DNS entry in your network environment for domain name resolution, or force correct resolution by editing the <literal role="path">/etc/hosts</literal> file:</simpara>
<screen>$ echo "${local_address} suma.cloud.net suma" &gt;&gt; /etc/hosts</screen>
<simpara>You can locate the local address by checking your public cloud web console, or from the command line using these commands:</simpara>
<itemizedlist>
<listitem>
<simpara>Amazon EC2 instance:</simpara>
<screen>$ ec2metadata --local-ipv4</screen>
</listitem>
<listitem>
<simpara>Google Compute Engine:</simpara>
<screen>$ gcemetadata --query instance --network-interfaces --ip</screen>
</listitem>
<listitem>
<simpara>Microsoft Azure:</simpara>
<screen>$ azuremetadata --internal-ip</screen>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>Forcing DNS resolution by modifying the <literal role="path">/etc/hosts</literal> file will work correctly in most environments.
However, you will have to perform the same modification for any client that is to be managed with this SUSE Manager instance.
In most cases, it will be easier to manage the DNS resolution by creating a DNS entry in your network environment.</simpara>
<simpara>One other method for managing hostname resolution is by editing the <literal role="path">/etc/resolv.conf</literal> file.
Depending on the order of your setup, for example if you started the SUSE Manager instance prior to setting up DNS services the file may not contain the appropriate <emphasis role="strong">search</emphasis> directive.
Double check that the proper search directive exists in <literal role="path">/etc/resolv.conf</literal>.
In our example the directive would be <emphasis role="strong">search cloud.net</emphasis>.
If the directive is missing add it to the file.</simpara>
<simpara>For an update of the DNS records for the instance within the DNS service of your network environment, refer to the cloud service provider documentation for detailed instructions:
<emphasis role="strong">* <link xl:href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-dns.html"> DNS setup on Amazon EC2</link>
</emphasis>* <link xl:href="https://cloud.google.com/compute/docs/networking"> DNS setup on Google Compute Engine</link>
<emphasis role="strong">*</emphasis> <link xl:href="https://azure.microsoft.com/en-us/documentation/articles/dns-operations-recordsets"> DNS setup on Microsoft Azure</link></simpara>
<simpara>If you run a SUSE Manager Server instance, you can run YaST after the instance is launched to ensure the external storage is attached and prepared according to <xref linkend="using-separate-storage-volume"/>, and the DNS resolution is set up as described:</simpara>
<screen>$ /sbin/yast2 susemanager_setup</screen>
<simpara>Note that the setup of SUSE Manager from this point forward does not differ from the documentation in the <link xl:href="https://www.suse.com/documentation/suse_manager">SUSE Manager Guide</link>.</simpara>
<simpara>The SUSE Manager setup procedure in YaST is designed as a one pass process with no rollback or cleanup capability.
Therefore, if the setup procedure is interrupted or ends with an error, it is not recommended that you repeat the setup process or attempts to manually fix the configuration.
These methods are likely to result in a faulty SUSE Manager installation.
If you experience errors during setup, start a new instance, and begin the setup procedure again on a clean system.</simpara>
<simpara>If you receive a message that there is not enough space available for setup, ensure that your root volume is at least 20GB and double check that the instructions in <xref linkend="using-separate-storage-volume"/> have been completed correctly.</simpara>
<simpara>SUSE Manager Server for the Public Cloud comes with a bootstrap data module pre-installed.
The bootstrap module contains optimized package lists for bootstrapping instances started from SUSE Linux Enterprise images published by SUSE.
If you intend to register such an instance, when you creatr the bootstrap repository run the <literal role="command">mgr-create-bootstrap-repo</literal> script using this command, to create a bootstrap repository suitable for SUSE Linux Enterprise 12 SP1 instances.</simpara>
<screen>$ mgr-create-bootstrap-repo --datamodule=mgr_pubcloud_bootstrap_data -c SLE-12-SP1-x86_64</screen>
<simpara>See <link xl:href="https://www.suse.com/documentation/suse-manager-3/book.suma.getting-started/data/create_tools_repository.html">Creating the SUSE Manager Tools Repository</link> for more information on bootstrapping.</simpara>
<simpara>Prior to registering instances started from on demand images remove the following packages from the instance to be registered:
&#8230;&#8203; cloud-regionsrv-client
&#8230;&#8203; <emphasis role="strong">For Amazon EC2</emphasis></simpara>
<simpara>+
regionServiceClientConfigEC2</simpara>
<simpara>+
regionServiceCertsEC2
&#8230;&#8203; <emphasis role="strong">For Google Compute Engine</emphasis></simpara>
<simpara>+
cloud-regionsrv-client-plugin-gce</simpara>
<simpara>+
regionServiceClientConfigGCE</simpara>
<simpara>+
regionServiceCertsGCE
&#8230;&#8203; <emphasis role="strong">For Microsoft Azure</emphasis></simpara>
<simpara>+
regionServiceClientConfigAzure</simpara>
<simpara>+
regionServiceCertsAzure</simpara>
<simpara>+
If these packages are not removed it is possible to create interference between the repositories provided by SUSE Manager and the repositories provided by the SUSE operated update infrastructure.</simpara>
<simpara>+
Additionally remove the line from the <literal role="path">/etc/hosts</literal>
file that contains the <emphasis role="strong">susecloud.net</emphasis> reference.
** If you run a SUSE Manager Proxy instance</simpara>
<simpara>+
Launch the instance, optionally with external storage configured.
If you use external storage (recommended), prepare it according to <xref linkend="using-separate-storage-volume"/>.
It is recommended but not required to prepare the storage before configuring SUSE Manager proxy, as the suma-storage script will migrate any existing cached data to the external storage.
After preparing the instance, register the system with the parent SUSE Manager, which could be a SUSE Manager Server or another SUSE Manager Proxy.
See the <link xl:href="https://www.suse.com/documentation/suse-manager-3/singlehtml/suse_manager21/book_susemanager_proxyquick/book_susemanager_proxyquick.html"> SUSE Manager Proxy Setup guide</link> for details.
Once registered, run</simpara>
<simpara>+</simpara>
<screen>$ /usr/sbin/configure-proxy.sh</screen>
<simpara>+
to configure your SUSE Manager Proxy instance.
. After the completion of the configuration step, SUSE Manager should be functional and running. For SUSE Manager Server, the setup process created an administrator user with following user name:</simpara>
<simpara>+
* User name: <literal>admin</literal></simpara>
<simpara>+</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Account credentials for admin user</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33.3333*"/>
<colspec colname="col_2" colwidth="33.3333*"/>
<colspec colname="col_3" colwidth="33.3334*"/>
<thead>
<row>
<entry align="left" valign="top">Amazon EC2</entry>
<entry align="left" valign="top">Google Compute Engine</entry>
<entry align="left" valign="top">Microsoft Azure</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal role="replaceable">Instance-ID</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal role="replaceable">Instance-ID</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal role="replaceable">Instance-Name</literal><emphasis role="strong">-suma</emphasis></simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>+
The current value for the <literal role="replaceable">Instance-ID</literal> or <literal role="replaceable">Instance-Name</literal> in case of the Azure Cloud, can be obtained from the public cloud Web console or from within a terminal session as follows:
** Obtain instance id from within Amazon EC2 instance</simpara>
<simpara>+</simpara>
<screen>$ ec2metadata --instance-id</screen>
<itemizedlist>
<listitem>
<simpara>Obtain instance id from within Google Compute Engine instance</simpara>
<screen>$ gcemetadata --query instance --id</screen>
</listitem>
<listitem>
<simpara>Obtain instance name from within Microsoft Azure instance</simpara>
<screen>$ azuremetadata --instance-name</screen>
<simpara>After logging in through the SUSE Manager Server Web UI, <emphasis role="strong">change</emphasis> the default password.</simpara>
<simpara>SUSE Manager Proxy does not have administration access to the Web UI.
It can be managed through its parent SUSE Manager Server.</simpara>
</listitem>
</itemizedlist>
<section xml:id="using-separate-storage-volume">
<title>Using Separate Storage Volume</title>
<simpara>We recommend that the repositories and the database for SUSE Manager be stored on a virtual storage device.
This best practice will avoid data loss in cases where the SUSE Manager instance may need to be terminated.
These steps <emphasis role="strong">must</emphasis> be performed <emphasis role="strong">prior</emphasis> to running the YaST SUSE Manager  setup procedure.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Provision a disk device in the public cloud environment, refer to the cloud service provider documentation for detailed instructions. The size of the disk is dependent on the number of distributions and channels you intend to manage with SUSE Manager.
For sizing information refer to <link xl:href="https://www.suse.com/support/kb/doc.php?id=7015050">SUSE Manager sizing examples</link>. A rule of thumb is 25 GB per distribution per channel.</simpara>
</listitem>
<listitem>
<simpara>Once attached the device appears as Unix device node in your instance. For the following command to work this device node name is required. In many cases the attached storage appears as <emphasis role="strong">/dev/sdb</emphasis>. In order to check which disk devices exists on your system, call the following command:</simpara>
<screen>$ hwinfo --disk | grep -E "Device File:"</screen>
</listitem>
<listitem>
<simpara>With the device name at hand the process of re-linking the directories in the filesystem SUSE Manager uses to store data is handled by the suma-storage script. In the following example we use <literal role="path">/dev/sdb</literal> as the device name.</simpara>
<screen>$ /usr/bin/suma-storage /dev/sdb</screen>
<simpara>After the call all database and repository files used by SUSE Manager Server are moved to the newly created xfs based storage.
In case your instance is a SUSE Manager Proxy, the script will move the Squid cache, which caches the software packages, to the newly created storage.
The xfs partition is mounted below the path <literal role="path">/manager_storage</literal>.
.</simpara>
</listitem>
<listitem>
<simpara>Create an entry in /etc/fstab (optional)</simpara>
<simpara>Different cloud frameworks treat the attachment of external storage devices differently at instance boot time.
Please refer to the cloud environment documentation for guidance about the fstab entry.</simpara>
<simpara>If your cloud framework recommends to add an fstab entry, add the following line to the <emphasis role="strong">/etc/fstab</emphasis> file.</simpara>
<screen>/dev/sdb1 /manager_storage xfs defaults,nofail 1 1</screen>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="registration-of-cloned-systems">
<title>Registration of Cloned Systems</title>
<simpara>SUSE Manager cannot distinguish between different instances that use the same system ID.
If you register a second instance with the same system ID as a previous instance, SUSE Manager will overwrite the original system data with the new system data.
This can occur when you launch multiple instances from the same image, or when an image is created from a running instance.
However, it is possible to clone systems and register them successfully by deleting the cloned system&#8217;s ID, and generating a new ID.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Registering Cloned Systems</title>
<listitem>
<simpara>Clone the system using your preferred hypervisor&#8217;s cloning mechanism.</simpara>
</listitem>
<listitem>
<simpara>On the cloned system, change the hostname and IP addresses, and check the <literal role="path">/etc/hosts</literal> file to ensure you have the right host entries.</simpara>
</listitem>
<listitem>
<simpara>On traditional clients, stop the <literal role="command">rhnsd</literal> daemon with <literal role="command">/etc/init.d/rhnsd stop</literal> or, on newer systemd-based systems, with <literal role="command">service rhnsd stop</literal>.</simpara>
</listitem>
<listitem>
<simpara>For SLES 11 or Red Hat Enterprise Linux 5 or 6 clients, run these commands:</simpara>
<screen># rm /var/lib/dbus/machine-id
# dbus-uuidgen --ensure</screen>
</listitem>
<listitem>
<simpara>For SLES 12 or Red Hat Enterprise Linux 7 clients, run these commands:</simpara>
<screen># rm /etc/machine-id
# rm /var/lib/dbus/machine-id
# dbus-uuidgen --ensure
# systemd-machine-id-setup</screen>
</listitem>
<listitem>
<simpara>If you are using Salt, then you will also need to run these commands:</simpara>
<screen># service salt-minion stop
# rm -rf /var/cache/salt</screen>
</listitem>
<listitem>
<simpara>If you are using a traditional client, clean up the working files with:</simpara>
<screen># rm -f /etc/sysconfig/rhn/{osad-auth.conf,systemid}</screen>
</listitem>
</orderedlist>
<simpara>The bootstrap should now run with a new system ID, rather than a duplicate.</simpara>
<simpara>If you are onboarding Salt minion clones, then you will also need to check if they have the same Salt minion ID.
You will need to delete the minion ID on each cloned minion, using the <literal role="command">rm</literal> command.
Each operating system type stores this file in a slightly different location, check the table for the appropriate command.</simpara>
<formalpara>
<title>Minion ID File Location</title>
<para>Each operating system stores the minion ID file in a slightly different location, check the table for the appropriate command.</para>
</formalpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Operating System</entry>
<entry align="left" valign="top">Commands</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>SLES 12</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">rm /etc/salt/minion_id</literal></simpara><simpara>                     <literal role="command">rm  -f /etc/zypp/credentials.d/{SCCcredentials,NCCcredentials}</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SLES 11</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">rm /etc/salt/minion_id</literal></simpara><simpara>                     <literal role="command">suse_register -E</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>SLES 10</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command">rm -rf /etc/{zmd,zypp}</literal></simpara><simpara>                     <literal role="command">rm -rf /var/lib/zypp/</literal>
                     Do not delete <literal role="path">/var/lib/zypp/db/products/</literal></simpara><simpara>                     <literal role="command">rm -rf /var/lib/zmd/</literal></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Red Hat Enterprise Linux 5, 6, 7</simpara></entry>
<entry align="left" valign="top"><simpara><literal role="command"> rm  -f /etc/NCCcredentials</literal></simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<simpara>Once you have deleted the minion ID file, re-run the bootstrap script, and restart the minion to see the cloned system in SUSE Manager with the new ID.</simpara>
</section>
</chapter>
<chapter xml:id="advanced.topics.optimizing.scalability">
<title>Optimization and Scalability</title>
<section xml:id="optimizing.apache-tomcat">
<title>Optimizing Apache and Tomcat</title>
<warning>
<title>Altering Apache and Tomcat Parameters</title>
<simpara>Apache and Tomcat Parameters should only be modified with support or consulting as these parameters can have severe and catastrophic performance impacts on your server when improperly adjusted.
SUSE will not be able to provide support for catastrophic failure when these advanced parameters are modified without consultation.
Tuning values for Apache httpd and Tomcat requires that you align these parameters with your server hardware.
Furthermore testing of these altered values should be performed within a test environment.</simpara>
</warning>
<section xml:id="at.apache.httpd.maxclient.parameter">
<title>Apache&#8217;s httpd MaxClients Parameter</title>
<simpara>The <literal role="parameter">MaxClients</literal> setting determines the number of Apache httpd processes, and thus limits the number of client connections that can be made at the same time (SUSE Manager uses the pre-fork MultiProcessing Modules).
The default value for <literal role="parameter">MaxClients</literal> in SUSE Manager is 150.
If you need to set the <literal role="parameter">MaxClients</literal> value greater than 150, Apache httpd&#8217;s ServerLimit setting and Tomcat&#8217;s <literal role="parameter">maxThreads</literal> must also be increased accordingly (see below).</simpara>
<warning>
<simpara>The Apache httpd <literal role="parameter">MaxClients</literal> parameter must always be less or equal than Tomcat&#8217;s <literal role="parameter">maxThreads</literal> parameter!</simpara>
</warning>
<simpara>If the <literal role="parameter">MaxClients</literal> value is reached while the software is running, new client connections will be queued and forced to wait, this may result in timeouts.
You can check the Apache httpd&#8217;s <literal role="path">error.log</literal> for details:</simpara>
<screen>[error] Server reached MaxClients setting, consider increasing the MaxClients setting</screen>
<simpara>The default <literal role="parameter">MaxClients</literal> parameter can be overridden on SUSE Manager by editing the <literal role="path">server-tuning.conf</literal> file located at <literal role="systemitem">/etc/apache2/</literal>.
For example <literal role="path">server-tuning.conf</literal> file:</simpara>
<screen># prefork MPM
   &lt;IfModule prefork.c&gt;
           # number of server processes to start
           # http://httpd.apache.org/docs/2.2/mod/mpm_common.html#startservers
           StartServers         5
           # minimum number of server processes which are kept spare
           # http://httpd.apache.org/docs/2.2/mod/prefork.html#minspareservers
           MinSpareServers      5
           # maximum number of server processes which are kept spare
           # http://httpd.apache.org/docs/2.2/mod/prefork.html#maxspareservers
           MaxSpareServers     10
           # highest possible MaxClients setting for the lifetime of the Apache process.
           # http://httpd.apache.org/docs/2.2/mod/mpm_common.html#serverlimit
           ServerLimit        150
           # maximum number of server processes allowed to start
           # http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxclients
           MaxClients         150
           # maximum number of requests a server process serves
           # http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxrequestsperchild
           MaxRequestsPerChild  10000
   &lt;/IfModule&gt;</screen>
<warning>
<simpara>Whenever the Apache httpd <literal role="parameter">MaxClients</literal> parameter is changed, the <literal role="parameter">ServerLimit</literal> must also be updated to the same value, or the change will have no effect.</simpara>
</warning>
</section>
<section xml:id="at.tomcat.maxthreads.parameter">
<title>Tomcat&#8217;s maxThreads Parameter</title>
<simpara>Tomcat&#8217;s <literal role="parameter">maxThreads</literal> represents the maximum number of request processing threads that it will create.
This value determines the maximum number of simultaneous requests that it is able to handle.
All HTTP requests to the SUSE Manager server (from clients, browsers, XMLRPC API scripts, etc.) are handled by Apache httpd, and some of them are routed to Tomcat for further processing.
It is thus important that Tomcat is able to serve the same amount of simultaneous requests that Apache httpd is able to serve in the worst case.
The default value for SUSE Manager is 200 and should always be equal or greater than Apache httpd&#8217;s <literal role="parameter">MaxClients</literal>.
The <literal role="parameter">maxThreads</literal> value is located within the <literal role="path">server.xml</literal> file located at <literal role="systemitem">/etc/tomcat/</literal>.</simpara>
<simpara>Example relevant lines in <literal role="path">server.xml</literal>:</simpara>
<screen>&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" URIEncoding="UTF-8" address="127.0.0.1" maxThreads="200" connectionTimeout="20000"/&gt;
&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" URIEncoding="UTF-8" address="::1" maxThreads="200" connectionTimeout="20000"/&gt;</screen>
<note>
<title>Tuning Notes</title>
<simpara>When configuring Apache httpd&#8217;s <literal role="parameter">MaxClients</literal> and Tomcat&#8217;s <literal role="parameter">maxThreads</literal> parameters you should also take into consideration that each HTTP connection will need one or more database connections.
If the RDBMS is not able to serve an adequate amount of connections, issues will arise.
See the following equation for a rough calculation of the needed amount of database connections:</simpara>
<screen>((3 * java_max) +  apache_max + 60)</screen>
<simpara>Where:</simpara>
<itemizedlist>
<listitem>
<simpara>3 is the number of Java processes the server runs with pooled connections (Tomcat, Taskomatic and Search)</simpara>
</listitem>
<listitem>
<simpara>java_max is the maximum number of connections per Java pool (20 by default, changeable in <literal role="path">/etc/rhn/rhn.conf</literal> via the hibernate.c3p0.max_size parameter)</simpara>
</listitem>
<listitem>
<simpara>apache_max is Apache httpd&#8217;s <literal role="parameter">MaxClients</literal></simpara>
</listitem>
<listitem>
<simpara>60 is the maximum expected number of extra connections for local processes and other uses</simpara>
</listitem>
</itemizedlist>
</note>
</section>
</section>
<section xml:id="optimizing.big">
<title>Big Scale Deployment (1000 Minions or More)</title>
<simpara>In the following sections find considerations about a big scale deployment.
In this context, a big scale compromises 1000 minions or more.</simpara>
<section xml:id="optimizing.big.general">
<title>General Recommendations</title>
<simpara>SUSE recommends the following in a big scale SUSE Manager deployment:</simpara>
<itemizedlist>
<listitem>
<simpara>SUSE Manager servers should have at least 8 recent x86 cores, 32 GiB of RAM, and, most important, fast I/O devices such as at least an SSD (2 SSDs in RAID-0 are strongly recommended).</simpara>
</listitem>
<listitem>
<simpara>Proxies with many minions (hundreds) should have at least 2 recent x86 cores and 16 GiB of RAM.</simpara>
</listitem>
<listitem>
<simpara>Use one SUSE Manager Proxy per 500-1000 clients.
Keep into account that download time depends on network capacity.
Here is a rough example calculation with physical link speed of 1 GB/s:</simpara>
<screen>400 Megabytes  *        3000       /      119 Megabyte/s        / 60
= 169 Minutes</screen>
<simpara>This is:</simpara>
<screen>Size of updates * Number of minions / Theoretical download speed / 60</screen>
</listitem>
<listitem>
<simpara>Depending on hardware you can accept hundreds of minion keys.</simpara>
</listitem>
<listitem>
<simpara>Plan time for onboarding minions- at least one hour per 1000 minions.</simpara>
</listitem>
<listitem>
<simpara>It is not recommended onboarding more than approx.
1000 minions directly to the SUSE Manager server- proxies should be used instead.
This is because every minion can use up to 3 TCP connections simultaneously, and too many TCP connections can cause performance issues.</simpara>
</listitem>
<listitem>
<simpara>If the following error appears in output of <literal role="command">dmesg</literal>, you probably have an excessive number of minions attached to a single SUSE Manager server or proxy for the ARP cache to contain all of their addresses:</simpara>
<screen>kernel: neighbour table overflow</screen>
<simpara>In that case, increase the ARP cache values via <literal role="systemitem">sysctl</literal>, for example, by adding the following lines to <literal role="path">/etc/sysctl.conf</literal>:</simpara>
<screen>net.ipv4.neigh.default.gc_thresh1 = 4096
net.ipv4.neigh.default.gc_thresh2 = 8192
net.ipv4.neigh.default.gc_thresh3 = 16384
net.ipv4.neigh.default.gc_interval = 60
net.ipv4.neigh.default.gc_stale_time = 120</screen>
</listitem>
</itemizedlist>
<tip>
<title>Start Small and Scale Up</title>
<simpara>Always start small and scale up gradually.
Keep the server monitored in order to identify possible issues early.</simpara>
</tip>
</section>
<section xml:id="optimizing.big.tuning">
<title>Tuning Proposals</title>
<simpara>SUSE proposes the following tuning settings in a big scale SUSE Manager deployment:</simpara>
<itemizedlist>
<listitem>
<simpara>Increase the maximum Tomcat heap memory to face a potentially long queue of Salt return results. Set 8 GiB instead of the current default 1 GiB: parameter <literal role="parameter">Xmx1G</literal> in <literal role="path">/etc/sysconfig/tomcat</literal> (affects onboarding and Action execution).</simpara>
</listitem>
<listitem>
<simpara>Increase the number of Taskomatic workers, allowing to parallelize work on a high number of separate jobs. Set parameter <literal role="parameter">org.quartz.threadPool.threadCount = 100</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects onboarding and staging).</simpara>
</listitem>
<listitem>
<simpara>Allow Taskomatic to check for runnable jobs more frequently to reduce latency. Set parameter <literal role="parameter">org.quartz.scheduler.idleWaitTime = 1000</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects onboarding, staging and Action execution).</simpara>
</listitem>
<listitem>
<simpara>Increase Tomcat&#8217;s Salt return result workers to allow parallelizing work on a high number of Salt return results. Set parameter <literal role="parameter">java.message_queue_thread_pool_size = 100</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects patching).</simpara>
</listitem>
<listitem>
<simpara>Increase the number of PostgreSQL connections available to Java applications (Tomcat, Taskomatic) according to the previous parameters, otherwise extra workers will starve waiting for a connection. Set parameter <literal role="parameter">hibernate.c3p0.max_size = 150</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects all minion operations). Make sure enough PostgreSQL connections are configured before changing this parameter - refer to <literal>smdba system-check autotuning --help</literal> to get automatic tuning of the PostgreSQL configuration file while changing the number of available connections. Additional manual tuning is usually not necessary but might be required depending on scale and exact use cases.</simpara>
</listitem>
<listitem>
<simpara>Increase Salt&#8217;s presence ping timeouts if responses might come back later than the defaults. Set parameters <literal role="parameter">java.salt_presence_ping_timeout = 20</literal> and <literal role="parameter">java.salt_presence_ping_gather_job_timeout = 20</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects all minion operations).</simpara>
</listitem>
<listitem>
<simpara>Increase the number of Salt master workers so that more requests can run in parallel (otherwise Tomcat and Taskomatic workers will starve waiting for the Salt API, and Salt will not be able to serve files timely). Set parameter <literal role="parameter">worker_threads: 100</literal> in <literal role="path">/etc/salt/master.d/susemanager.conf</literal> (affects onboarding and patching).</simpara>
<itemizedlist>
<listitem>
<simpara>Increase this parameter further if file management states fail with the error "Unable to manage file: Message timed out"</simpara>
</listitem>
<listitem>
<simpara>Note that Salt master workers can consume significant amounts of RAM (typically about 70&#160;MB per worker). It is recommended to keep usage monitored when increasing this value and to do so in relatively small increments (eg. 20) until failures are no longer produced.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Increase the maximum heap memory for the search daemon to be able to index many minions. Set 4 GiB instead of the current default 512 MB: add <literal role="parameter">rhn-search.java.maxmemory=4096</literal> in <literal role="path">/etc/rhn/rhn.conf</literal> (affects background indexing only).</simpara>
</listitem>
<listitem>
<simpara>Consider disabling Taskomatic jobs, especially if the provided functionality is not used:</simpara>
<itemizedlist>
<listitem>
<simpara>Disable daily comparison of configuration files.
Click <menuchoice><guimenu>Admin</guimenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice>, then the <guibutton>compare-configs-default</guibutton> link, then the <guibutton>Disable Schedule</guibutton> button and finally <guibutton>Delete Schedule</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Disable hourly synchronization of Cobbler files.
Click <menuchoice><guimenu>Admin</guimenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice>, then the <guibutton>cobbler-sync-default</guibutton> link, then the <guibutton>Disable Schedule</guibutton> button and finally <guibutton>Delete Schedule</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Disable daily run of Gatherer and Subscription Matcher.
Click <menuchoice><guimenu>Admin</guimenu> <guimenuitem>Task Schedules</guimenuitem></menuchoice>, then the <guibutton>gatherer-matcher-default</guibutton> link, then the <guibutton>Disable Schedule</guibutton> button and finally <guibutton>Delete Schedule</guibutton>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<simpara>Note that increasing the number of PostgreSQL connections will require more RAM, make sure the SUSE Manager server is monitored and swap is never used.</simpara>
<simpara>Also note the above settings should be regarded as guidelines-they have been tested to be safe but care should be exercised when changing them, and consulting support is highly recommended.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="_salt_ssh_integration">
<title>Salt SSH Integration</title>
<simpara>Version 1, 2018-03-20</simpara>
<simpara>The following topic provides an overview of the <link xl:href="https://docs.saltstack.com/en/latest/topics/ssh/">Salt SSH</link> integration with SUSE Manager. This integration adds support for both ssh-push and ssh-push-tunnel connections for Salt minions.</simpara>

<section xml:id="ssh-push-overview">
<title>SSH Push Overview</title>
<simpara>Like the traditional stack, Salt minions may use an ssh connection to manage minions in place of <link xl:href="https://docs.saltstack.com/en/latest/topics/transports/zeromq.html">Zeromq</link>. This additional functionality is based on Salt SSH. Salt SSH enables you to execute salt commands and states via ssh without ever needing to install a salt-minion.</simpara>
<simpara>When the server executes an action on a minion an ssh connection is made on demand. This connection differs from the always-connected mode used by minions managed via Zeromq.</simpara>
<simpara>In SUSE Manager there are two ssh-push methods. In both use cases the server initiates an ssh connection to the minion in order to execute a Salt call using <literal>salt-ssh</literal>. The difference in the two methods is how <literal>zypper/<emphasis>yum</emphasis></literal>  initially connects to the server repositories:</simpara>
<variablelist xml:id="zypper-connection-methods">
<title>zypper Connection Methods:</title>
<varlistentry>
<term>ssh-push</term>
<listitem>
<simpara>zypper works as usual. The http(s) connection to the server is created directly.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>ssh-push-tunnel</term>
<listitem>
<simpara>The server creates an http(s) connection through an ssh tunnel. The http(s) connection initiated by <literal>zypper</literal> is redirected through the tunnel by means of <literal>/etc/hosts</literal> aliasing (see below). This method should be used for in place firewall setups that block http(s) connections from a minion to the server.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="salt-ssh-integration">
<title>Salt SSH Integration</title>
<simpara>As with all Salt calls, SUSE Manager invokes <literal>salt-ssh</literal> via the <literal>salt-api</literal>.</simpara>
<simpara>Salt SSH relies on a Roster to obtain details such as hostname, ports, and ssh parameters of an ssh minion. SUSE Manager keeps these details in the database and makes them available to Salt by generating a temporary Roster file for each salt-ssh call. The location of the temporary Roster file is supplied to salt-ssh using the <literal>--roster-file= option</literal>.</simpara>
<section xml:id="authentication-types">
<title>Authentication</title>
<simpara>salt-ssh supports both password and key authentication. SUSE Manager uses both methods:</simpara>
<variablelist xml:id="password-and-key-authentication">
<title>Password and Key Authentication:</title>
<varlistentry>
<term>Bootstrapping Authentication</term>
<listitem>
<simpara>Password authentication is used only when bootstrapping. During the bootstrap step the key of the server is not authorized on the minion and therefore a password must be utilized for a connection to be made. The password is used transiently in a temporary roster file used for bootstrapping. This password is not stored.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Common Salt Call Authentication</term>
<listitem>
<simpara>All other common salt calls use key authentication. During the bootstrap step the ssh key of the server is authorized on the minion (added to a minion&#8217;s <literal>~/.ssh/authorized_keys</literal> file). Therefore subsequent calls no longer require a password.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="_user_account_for_salt_ssh_calls">
<title>User Account for salt-ssh Calls</title>
<simpara>The user for <literal>salt-ssh</literal> calls made by SUSE Manager is taken from the <literal>ssh_push_sudo_user</literal> setting. The default value of this is <literal>root</literal>.</simpara>
<simpara>If the value of <literal>ssh_push_sudo_user</literal> is not <literal>root</literal> then the <literal>--sudo</literal> options of <literal>salt-ssh</literal> are used.</simpara>
</section>
</section>
<section xml:id="_ssh_push_tunnel_https_redirection">
<title>SSH Push Tunnel HTTP(s) Redirection</title>
<simpara>For the <literal>ssh-push-tunnel</literal> method the traffic originating from zypper/yum has to be redirected through an ssh tunnel in order to bypass any firewall blocking a direct connection from the minion to the server.</simpara>
<simpara>This is achieved by using port <literal>1233</literal> in the repo url:</simpara>
<screen>https://suma-server:1233/repourl...</screen>
<simpara>Next alias the suma-server hostname to localhost in /etc/hosts:</simpara>
<screen>127.0.0.1       localhost    suma-server</screen>
<simpara>The server creates a reverse ssh tunnel that connects <literal>localhost:1233</literal> on the minion to <literal>suma-server:443</literal> (<literal>ssh &#8230;&#8203; -R 1233:suma-server:443</literal>)</simpara>
<simpara>The result is that zypper/yum will actually connect to <literal>localhost:1233</literal> which is then forwarded to <literal>suma-server:443</literal> via the ssh tunnel.</simpara>
<simpara>This implies that zypper can contact the server only if the tunnel is open. This happens only when the servers executes an action on the minion. Manual zypper operations that require server connectivity are not possible in this case.</simpara>
</section>
<section xml:id="_suse_manager_salt_ssh_call_sequence">
<title>SUSE Manager Salt SSH Call Sequence</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>Prepare the Salt Roster for the call</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Create remote port forwarding option IF the contact method is ssh-push-tunnel</simpara>
</listitem>
<listitem>
<simpara>Compute the ProxyCommand IF the minion is connected through a proxy</simpara>
</listitem>
<listitem>
<simpara>create Roster content:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>hostname</literal></simpara>
</listitem>
<listitem>
<simpara><literal>user</literal></simpara>
</listitem>
<listitem>
<simpara><literal>port</literal></simpara>
</listitem>
<listitem>
<simpara><literal>remote_port_forwards</literal>: The remote port forwarding ssh option</simpara>
</listitem>
<listitem>
<simpara><literal>ssh_options</literal>: other ssh options:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>ProxyCommand</literal>: If the minion connects through a SUMA proxy</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>timeout</literal>: default 180s</simpara>
</listitem>
<listitem>
<simpara><literal>minion_opts</literal>:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>master</literal>: set to the minion id if contact method is ssh-push-tunnel</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>create a temporary Roster file</simpara>
</listitem>
<listitem>
<simpara>execute a synchronous salt-ssh call via the API</simpara>
</listitem>
<listitem>
<simpara>remove the temporary Roster file</simpara>
</listitem>
</orderedlist>
<simpara><emphasis role="strong">Additional Information:</emphasis></simpara>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/java/code/src/com/suse/manager/webui/services/impl/SaltSSHService.java">SaltSSHService.callSyncSSH</link></simpara>
</section>
<section xml:id="_bootstrap_process_sequence">
<title>Bootstrap Process Sequence</title>
<simpara>Bootstrapping minions uses salt-ssh under the hood. This happens for both regular and ssh minion.</simpara>
<simpara>The bootstrap sequence is a bit different than the regular salt-ssh call:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>For a regular minion generate and pre-authorize the Salt key of the minion</simpara>
</listitem>
<listitem>
<simpara>If this is an ssh minion and a proxy was selected retrieve the ssh public key of the proxy using the mgrutil.chain_ssh_cmd runner. The runner copies the public key of the proxy to the server using ssh. If needed it can chain multiple ssh commands to reach the proxy across multiple hops.</simpara>
</listitem>
<listitem>
<simpara>Generate pillar data for bootstrap. Pillar data contains:</simpara>
<variablelist>
<varlistentry>
<term>mgr_server</term>
<listitem>
<simpara>The hostname of the SUSE Manager server</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>minion_id</term>
<listitem>
<simpara>The hostname of the minion to bootstrap</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>contact_method</term>
<listitem>
<simpara>The connection type</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>mgr_sudo_user</term>
<listitem>
<simpara>The user for salt-ssh</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>activation_key</term>
<listitem>
<simpara>If selected</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>minion_pub</term>
<listitem>
<simpara>The public minion key that was pre-authorized</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>minion_pem</term>
<listitem>
<simpara>The private minion key that was pre-authorized</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>proxy_pub_key</term>
<listitem>
<simpara>The public ssh key that was retrieved from the proxy if the target is an ssh minion and a proxy was selected</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
<listitem>
<simpara>If contact method is <literal>ssh-push-tunnel</literal> fill the remote port forwarding option</simpara>
</listitem>
<listitem>
<simpara>if the minion connects through a SUMA proxy compute the <literal>ProxyCommand</literal> option. This depends on the path used to connect to the proxy, e.g. server &#8594; proxy1 &#8594; proxy2 &#8594; minion</simpara>
</listitem>
<listitem>
<simpara>generate the roster for bootstrap into a temporary file. This contains:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>hostname</literal></simpara>
</listitem>
<listitem>
<simpara><literal>user</literal></simpara>
</listitem>
<listitem>
<simpara><literal>password</literal></simpara>
</listitem>
<listitem>
<simpara><literal>port</literal></simpara>
</listitem>
<listitem>
<simpara><literal>remote_port_forwards</literal>: the remote port forwarding ssh option</simpara>
</listitem>
<listitem>
<simpara><literal>ssh_options</literal>: other ssh options:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>ProxyCommand</literal> if the minion connects through a SUMA proxy</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>timeout</literal>: default 180s</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Via the Salt API execute:</simpara>
<screen>salt-ssh --roster-file=&lt;temporary_bootstrap_roster&gt; minion state.apply certs,&lt;bootstrap_state&gt;`</screen>
<note>
<simpara> &lt;bootstrap_state&gt; replaceable by <emphasis role="strong">bootstrap</emphasis> for regular minions or <emphasis role="strong">ssh_bootstrap</emphasis> for ssh minions.</simpara>
</note>
</listitem>
</orderedlist>
<simpara>The following image provides an overview of the Salt SSH bootstrap process.</simpara>
<figure>
<title>Salt SSH Bootstrap Process</title>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-bootstrap-process.png"/>
</imageobject>
<textobject><phrase>salt ssh bootstrap process</phrase></textobject>
</mediaobject>
</figure>
<simpara><emphasis role="strong">Additional Information:</emphasis></simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/java/code/src/com/suse/manager/webui/controllers/utils/RegularMinionBootstrapper.java">SSHMinionBootstrapper.java</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/java/code/src/com/suse/manager/webui/controllers/utils/SSHMinionBootstrapper.java">RegularMinionBootstrapper.java</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/susemanager-utils/susemanager-sls/salt/bootstrap/init.sls">bootstrap/init.sls</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/susemanager-utils/susemanager-sls/salt/ssh_bootstrap/init.sls">ssh_bootstrap/init.sls</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_proxy_support">
<title>Proxy Support</title>
<simpara>In order to make salt-ssh work with SUSE Managers proxies the ssh connection is chained from one server/proxy to the next. This is also know as multi-hop or multi gateway ssh connection.</simpara>
<figure>
<title>Salt SSH Proxy Multiple Hops</title>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-proxy-multi-hop.png"/>
</imageobject>
<textobject><phrase>salt ssh proxy multi hop</phrase></textobject>
</mediaobject>
</figure>
<section xml:id="_the_proxycommand">
<title>The ProxyCommand</title>
<simpara>In order to redirect the ssh connection through the proxies the ssh <literal>ProxyCommand</literal> option is used. This options invokes an arbitrary command that is expected to connect to the ssh port on the target host. The standard input and output of the command is used by the invoking ssh process to talk to the remote ssh daemon.</simpara>
<simpara>The ProxyCommand basically replaces the TCP/IP connection. It doesn&#8217;t do any authorization, encryption, etc. Its role is simply to create a byte stream to the remote ssh daemon&#8217;s port.</simpara>
<simpara>E.g. connecting to a server behind a gateway:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-proxycommand.png"/>
</imageobject>
<textobject><phrase>salt ssh proxycommand</phrase></textobject>
</mediaobject>
</informalfigure>
<note>
<simpara>In this example netcat (nc) is used to pipe port 22 of the target host into the ssh std i/o.</simpara>
</note>
</section>
<section xml:id="_salt_ssh_call_sequence_via_proxy">
<title>Salt SSH Call Sequence via Proxy</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>SUSE Manager initates the ssh connections as described above.</simpara>
</listitem>
<listitem>
<simpara>Additionally the ProxyCommand uses ssh to create a connection from the server to the minion through the proxies.</simpara>
</listitem>
</orderedlist>
<section xml:id="at-twin-proxies-and-ssh-push">
<title>Twin Proxies and SSH Push</title>
<simpara>The following example uses the ProxyCommand option with two proxies and the usual ssh-push method:</simpara>
<screen># 1
/usr/bin/ssh -i /srv/susemanager/salt/salt_ssh/mgr_ssh_id -o StrictHostKeyChecking=no -o User=mgrsshtunnel  proxy1
# 2
/usr/bin/ssh -i /var/lib/spacewalk/mgrsshtunnel/.ssh/id_susemanager_ssh_push -o StrictHostKeyChecking=no -o User=mgrsshtunnel -W minion:22  proxy2</screen>
<orderedlist numeration="arabic">
<title>Steps</title>
<listitem>
<simpara>connect from the server to the first proxy</simpara>
</listitem>
<listitem>
<simpara>connect from the first proxy to the second and forward standard input/output on the client to minion:22 using the -W option.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-push-push-plain-sequence.png"/>
</imageobject>
<textobject><phrase>salt ssh push push plain sequence</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="at-twin-proxies-and-ssh-push-tunnel">
<title>Twin Proxies and SSH Push Tunnel</title>
<simpara>The following example uses the ProxyCommand option with two proxies over an ssh-push-tunnel connection:</simpara>
<screen># 1
/usr/bin/ssh -i /srv/susemanager/salt/salt_ssh/mgr_ssh_id -o User=mgrsshtunnel  proxy1
# 2
/usr/bin/ssh -i /home/mgrsshtunnel/.ssh/id_susemanager_ssh_push -o User=mgrsshtunnel  proxy2
# 3
/usr/bin/ssh -i /home/mgrsshtunnel/.ssh/id_susemanager_ssh_push -o User=root -R 1233:proxy2:443 minion
# 4
/usr/bin/ssh -i /root/.ssh/mgr_own_id -W minion:22 -o User=root minion</screen>
<orderedlist numeration="arabic">
<title>Steps</title>
<listitem>
<simpara>Connect from the server to the first proxy.</simpara>
</listitem>
<listitem>
<simpara>Connect from the first proxy to the second.</simpara>
</listitem>
<listitem>
<simpara>connect from the second proxy to the minion and open an reverse tunnel (-R 1233:proxy2:443) from the minion to the https port on the second proxy.</simpara>
</listitem>
<listitem>
<simpara>Connect from the minion to itself and forward the std i/o of the server to the ssh port of the minion (-W minion:22). This is equivalent to ssh &#8230;&#8203; proxy2 netcat minion 22 and is needed because ssh doesn&#8217;t allow to have both the reverse tunnel (-R 1233:proxy2:443) and the standard i/o forwarding (-W minion:22) in the same command.</simpara>
</listitem>
</orderedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-push-push-tunnel-sequence.png"/>
</imageobject>
<textobject><phrase>salt ssh push push tunnel sequence</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara><emphasis role="strong">Additional Information:</emphasis></simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/java/code/src/com/suse/manager/webui/services/impl/SaltSSHService.java">SaltSSHService.sshProxyCommandOption</link></simpara>
</listitem>
</itemizedlist>
</section>
</section>
</section>
<section xml:id="_users_and_ssh_key_management">
<title>Users and SSH Key Management</title>
<simpara>In order to connect to a proxy the parent server/proxy uses a specific user called <literal>mgrsshtunnel</literal>.</simpara>
<simpara>The ssh config <literal>/etc/ssh/sshd_config</literal> of the proxy will force the execution of <literal>`/usr/sbin/mgr-proxy-ssh-force-cmd</literal> when <literal>mgrsshtunnel</literal> connects.</simpara>
<simpara><literal>`/usr/sbin/mgr-proxy-ssh-force-cmd</literal> is a simple shell script that allows only the execution of <literal>scp</literal>, <literal>ssh</literal> or <literal>cat</literal> commands.</simpara>
<simpara>The connection to the proxy or minion is authorized using ssh keys in the following way:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>The server connects to the minion and to the first proxy using the key in <literal>`/srv/susemanager/salt/salt_ssh/mgr_ssh_id</literal>.</simpara>
</listitem>
<listitem>
<simpara>Each proxy has its own key pair in <literal>`/home/mgrsshtunnel/.ssh/id_susemanager_ssh_push</literal>.</simpara>
</listitem>
<listitem>
<simpara>Each proxy authorizes the key of the parent proxy or server.</simpara>
</listitem>
<listitem>
<simpara>The minion authorized its own key.</simpara>
</listitem>
</orderedlist>
<figure>
<title>Salt SSH Key Authorization Process</title>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-push-ssh-keys.png"/>
</imageobject>
<textobject><phrase>salt ssh push ssh keys</phrase></textobject>
</mediaobject>
</figure>
<simpara><emphasis role="strong">Additional Information:</emphasis></simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/proxy/proxy/mgr-proxy-ssh-force-cmd">mgr-proxy-ssh-force-cmd</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_repository_access_via_proxy">
<title>Repository access via proxy</title>
<simpara>For both ssh-push and ssh-push-tunnel the minion connects to the proxy to retrieve packages and repo data.</simpara>
<simpara>The difference is how the connection works:</simpara>
<itemizedlist>
<listitem>
<simpara>In case of ssh-push, zypper or yum connect directly to the proxy using http(s). This assumes there&#8217;s not firewall between the minion and the proxy that would block http connections initiated by the minion.</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-push-repo-access.png"/>
</imageobject>
<textobject><phrase>salt ssh push repo access</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara>In case of ssh-push-tunnel, the http connection to the proxy is redirected through a reverse ssh tunnel.</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="salt-ssh-push-tunnel-repo-access.png"/>
</imageobject>
<textobject><phrase>salt ssh push tunnel repo access</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section xml:id="_proxy_setup">
<title>Proxy setup</title>
<simpara>When the <literal>spacewalk-proxy</literal> package is installed on the proxy the user <literal>mgrsshtunnel</literal> is created if it doesn&#8217;t already exist.</simpara>
<simpara>During the initial configuration with <literal>configure-proxy.sh</literal> the following happens:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Generate a ssh key pair or import an existing one</simpara>
</listitem>
<listitem>
<simpara>Retrieve the ssh key of the parent server/proxy in order to authorize it on the proxy</simpara>
</listitem>
<listitem>
<simpara>Configure the <literal>sshd</literal> of the proxy to restrict the user <literal>mgrsshtunnel</literal></simpara>
</listitem>
</orderedlist>
<simpara>This configuration is done by the <literal>mgr-proxy-ssh-push-init</literal> script. This is called from <literal>configure-proxy.sh</literal> and the user doesn&#8217;t have to invoke it manually.</simpara>
<simpara>Retrieving the parent key is done by calling an HTTP endpoint on the parent server or proxy.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>First <literal>https//$PARENT/pub/id_susemanager_ssh_push.pub</literal> is tried. If the parent is proxy this will return the public ssh key of that proxy.</simpara>
</listitem>
<listitem>
<simpara>If a <literal>404</literal> is received then it&#8217;s assumed the parent is a server not a proxy and <literal><link xl:href="https://$PARENT/rhn/manager/download/saltssh/pubkey">https://$PARENT/rhn/manager/download/saltssh/pubkey</link></literal> is tried.</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>If <literal>/srv/suseemanager/salt/salt_ssh/mgr_ssh_id.pub</literal> already exists on the server it&#8217;s returned</simpara>
</listitem>
<listitem>
<simpara>If the public key doesn&#8217;t exist (because <literal>salt-ssh</literal> has not been invoked yet) generate the key by calling the <literal>mgrutil.ssh_keygen</literal> runner</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
<note>
<simpara>salt-ssh generates a key pair the first time it is invoked in
<literal>/srv/suseemanager/salt/salt_ssh/mgr_ssh_id</literal>. The previous sequence is needed in case a proxy is configured before salt-ssh was invoked for the first time.</simpara>
</note>
<simpara><emphasis role="strong">Additional Information:</emphasis></simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/java/code/src/com/suse/manager/webui/controllers/SaltSSHController.java">com.suse.manager.webui.controllers.SaltSSHController</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/susemanager-utils/susemanager-sls/modules/runners/mgrutil.py">mgrutil.ssh_keygen</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/proxy/proxy/mgr-proxy-ssh-push-init">mgr-proxy-ssh-push-init</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://github.com/SUSE/spacewalk/blob/Manager/proxy/proxy/spacewalk-proxy.spec">spacewalk-proxy.spec</link></simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="advanced.topics.monitoring.with.icinga">
<title>Monitoring with Icinga</title>
<section xml:id="at.introduction.to.icinga">
<title>Introduction</title>
<simpara>This chapter provides guidance on the setup of an Icinga server using SLES 12 SP4.
For more information, see the Official Icinga documentation: <link xl:href="http://docs.icinga.org/latest/en/">http://docs.icinga.org/latest/en/</link>.</simpara>
</section>
<section xml:id="at.installation.and.basic.configuration.icinga">
<title>Installation and Basic Configuration</title>
<simpara>Icinga packages are found in the <literal>SLE-Manager-Tools12-Updates x86_64</literal>.</simpara>
<tip>
<title>Icinga Installation Location</title>
<simpara>Do not install Icinga on the SUSE Manager server.
Install Icinga on a stand-alone SUSE Linux Enterprise client.</simpara>
</tip>
<orderedlist numeration="arabic">
<title>Procedure: Installation and Basic Configuration</title>
<listitem>
<simpara>Register the new client with SUSE Manager and subscribe it to the SUSE Manager client and update channels.
SLES 12 and later include these channels by default.</simpara>
</listitem>
<listitem>
<simpara>Install the required Icinga packages on the new client:</simpara>
<screen>zypper in icinga icinga-idoutils-pgsql postgresql postgresql94-server \
monitoring-plugins-all apache2</screen>
</listitem>
<listitem>
<simpara>Edit the <literal>/etc/icinga/objects/contacts.cfg</literal> file and add the email address which you will use for reciving alerts.</simpara>
<screen>define contact {
  contact_name      icingaadmin          ; Short name of user
  use               generic-contact      ; Inherit default values
  alias             Icinga Admin         ; Full name of user
  email             icinga@localhost     ; &lt;&lt;*** CHANGE THIS TO YOUR EMAIL ADDRESS ***
}</screen>
</listitem>
<listitem>
<simpara>Enable postgres on boot and start the database:</simpara>
<screen>systemctl enable postgresql.service
systemctl start postgresql.service</screen>
</listitem>
<listitem>
<simpara>Create the database and user for Icinga:</simpara>
<screen>&gt;psql
 postgres=# ALTER USER postgres WITH PASSWORD '&lt;newpassword&gt;';
 postgres=# CREATE USER icinga;
 postgres=# ALTER USER icinga WITH PASSWORD 'icinga';
 postgres=# CREATE DATABASE icinga;
 postgres=# GRANT ALL ON DATABASE icinga TO icinga;
 postgres=# \q
 exit</screen>
</listitem>
<listitem>
<simpara>Adjust client authentication rights located in <literal>/var/lib/pgsql/data/pg_hba.conf</literal> to match the following:</simpara>
<screen># TYPE  DATABASE        USER            ADDRESS                 METHOD
local   icinga         icinga                                  trust
local   all            postgres                                ident

# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident</screen>
<important>
<title>Placement of Authentication Settings</title>
<simpara>Ensure the local entries for icinga authentication settings are placed above all other local entries or you will get an error when configuring the database schema.
The entries in <literal role="path">pg_hba.conf</literal> are read from top to bottom.</simpara>
</important>
</listitem>
<listitem>
<simpara>Reload the Postgres service:</simpara>
<screen>systemctl reload postgresql.service</screen>
</listitem>
<listitem>
<simpara>Configure the database schema by running the following command in <literal role="path">/usr/share/doc/packages/icinga-idoutils-pgsql/pgsql/</literal>:</simpara>
<screen>psql -U icinga -d icinga &lt; pgsql.sql</screen>
</listitem>
<listitem>
<simpara>Edit the following lines in <literal>/etc/icinga/ido2db.cfg</literal> to switch from the default setting of mysql to postgres:</simpara>
<screen>vi /etc/icinga/ido2db.cfg

 db_servertype=pgsql
 db_port=5432</screen>
<important>
<title>Open Firewall Port</title>
<simpara>Allow port <literal>5432</literal> through your firewall or you will not be able to access the WebGUI.</simpara>
</important>
</listitem>
<listitem>
<simpara>Create an icinga admin account for logging into the web interface:</simpara>
<screen>htpasswd -c /etc/icinga/htpasswd.users icingaadmin</screen>
</listitem>
<listitem>
<simpara>Enable and start all required services:</simpara>
<screen>systemctl enable icinga.service
systemctl start icinga.service
systemctl enable ido2db.service
systemctl start ido2db.service
systemctl enable apache2.service
systemctl start apache2.service</screen>
</listitem>
<listitem>
<simpara>Login to the WebGUI at: <link xl:href="http://localhost/icinga">http://localhost/icinga</link>.</simpara>
</listitem>
</orderedlist>
<simpara>This concludes setup and initial configuration of Icinga.</simpara>
</section>
<section xml:id="at.icinga.nrpe.quickstart">
<title>Icinga and NRPE Quickstart</title>
<simpara>The following sections provides an overview on monitoring your SUSE Manager server using Icinga.
You will add SUSE Manager as a host to Icinga and use a Nagios script/plugin to monitor running services via <literal>NRPE</literal> (Nagios Remote Plugin Executor).
This section does not attempt to cover all monitoring solutions Icinga has to offer but should help you get started.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Adding SUSE Managerto Icinga for Monitoring</title>
<listitem>
<simpara>On your SUSE Manager server install the required packages:</simpara>
<screen>zypper install nagios-nrpe susemanager-nagios-plugin insserv nrpe monitoring-plugins-nrpe</screen>
</listitem>
<listitem>
<simpara>Modify the NRPE configuration file located at:</simpara>
<screen>/etc/nrpe.cfg</screen>
<simpara>Edit or add the following lines:</simpara>
<screen>server_port=5666
nrpe_user=nagios
nrpe_group=nagios
allowed_hosts=Icinga.example.com
dont_blame_nrpe=1
command[check_systemd.sh]=/usr/lib/nagios/plugins/check_systemd.sh $ARG1$</screen>
<simpara>Variable definitions:</simpara>
<variablelist>
<varlistentry>
<term>server_port</term>
<listitem>
<simpara>The variable <literal>server_port</literal> defines the port nrpe will listen on.
The default port is 5666.
This port must be opened in your firewall.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>nrpe_user</term>
<listitem>
<simpara>The variables <literal>nrpe_user</literal> and <literal>nrpe_group</literal> control the user and group IDs that nrpe will run under. SUSE Manager
probes need access to the database, therefore nrpe requires access to database credentials stored in <literal role="path">/etc/rhn/rhn.conf</literal>.
There are multiple ways to achieve this.
You may add the user <literal>nagios</literal> to the group <literal>www</literal> (this is already done for other IDs such as tomcat); alternatively you can simply have nrpe run with the effective group ID <literal>www</literal> in <literal role="path">/etc/rhn/rhn.conf</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>allowed_hosts</term>
<listitem>
<simpara>The variable <literal>allowed_hosts</literal> defines which hosts nrpe will accept connections from.
Enter the FQDN or IP address of your Icinga server here.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>dont_blame_nrpe</term>
<listitem>
<simpara>The use of variable <literal>dont_blame_nrpe</literal> is unavoidable in this example.
<literal>nrpe</literal> commands by default will not allow arguments being passed due to security reasons.
However, in this example you should pass the name of the host you want information on to nrpe as an argument.
This action is only possible when setting the variable to 1.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>command[check_systemd.sh]</term>
<listitem>
<simpara>You need to define the command(s) that nrpe can run on SUSE Manager.
To add a new nrpe command specify a command call by adding <literal>command</literal> followed by square brackets containing the actual nagios/icinga plugin name.
Next define the location of the script to be called on your SUSE Manager server.
Finally the variable <literal>$ARG1$</literal> will be replaced by the actual host the Icinga server would like information about.
In the example above, the command is named <literal>check_systemd.sh</literal>.
You can specify any name you like but keep in mind the command name is the actual script stored in <literal role="path">/usr/lib/nagios/plugins/</literal> on your SUSE Manager server.
This name must also match your probe definition on the Icinga server.
<emphasis>This will be described in greater detail later in the chapter. The check_systemd.sh script/plugin will also be provided in a later section.</emphasis></simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
<listitem>
<simpara>One your configuration is complete load the new nrpe configuration as root with:</simpara>
<screen>systemctl start nrpe</screen>
</listitem>
</orderedlist>
<simpara>This concludes setup of nrpe.</simpara>
<section xml:id="at.add.a.host.to.icinga">
<title>Add a Host to Icinga</title>
<simpara>To add a new host to Icinga create a host.cfg file for each host in <literal role="path">/etc/icinga/conf.d/</literal>.
For example <literal role="path">susemanager.cfg</literal>:</simpara>
<screen>define host {
  host_name           susemanager
  alias               SUSE Manager
  address             192.168.1.1
  check_period        24x7
  check_interval      1
  retry_interval      1
  max_check_attempts  10
  check_command       check-host-alive
}</screen>
<note>
<simpara>Place the host IP address you want to add to Icinga on the <literal>Address</literal> line.</simpara>
</note>
<simpara>After adding a new host restart Icinga as root to load the new configuation:</simpara>
<screen>systemctl restart icinga</screen>
</section>
<section xml:id="at.adding.services.to.icinga">
<title>Adding Services to Icinga</title>
<simpara>To add services for monitoring on a specific host define them by adding a service definition to your host.cfg file located in <literal role="path">/etc/icinga/conf.d</literal>.
For example you can monitor if a systems SSH service is running with the following service definition.</simpara>
<screen>define service {
  host_name           susemanager
  use                 generic-service
  service_description SSH
  check_command       check_ssh
  check_interval      60
}</screen>
<simpara>After adding any new services restart Icinga as root to load the new configuration:</simpara>
<screen>systemctl restart icinga</screen>
</section>
<section xml:id="at.creating.icinga.hostgroups">
<title>Creating Icinga Hostgroups</title>
<simpara>You can create hostgroups to simplify and visualize hosts logically.
Create a <literal role="path">hostgroups.cfg</literal> file located in <literal role="path">/etc/icinga/conf.d/</literal> and add the following lines:</simpara>
<screen>define hostgroup {
  hostgroup_name  ssh_group
  alias           ssh group
  members         susemanager,mars,jupiter,pluto,examplehost4
}</screen>
<simpara>The <literal>members</literal> variable should contain the <literal>host_name</literal> from within each host.cfg file you created to represent your hosts.
Every time you add an additional host by creating a host.cfg ensure you add the host_name to the members list of included hosts if you want it to be included within a logical hostgroup.</simpara>
<simpara>After adding several hosts to a hostgroup restart Icinga as root to load the new configuration:</simpara>
<screen>systemctl restart icinga</screen>
</section>
<section xml:id="at.creating.icinga.servicegroups">
<title>Creating Icinga Servicegroups</title>
<simpara>You can create logical groupings of services as well.
For example if you would like to create a group of essential SUSE Manager services which are running define them within a <literal role="path">servicegroups.cfg</literal> file placed in <literal role="path">/etc/icinga/conf.d/</literal>:</simpara>
<screen>#Servicegroup 1
define servicegroup {
  servicegroup_name     SUSE Manager Essential Services
  alias                 Essential Services
}

#Servicegroup 2
define servicegroup {
  servicegroup_name     Client Patch Status
  alias                 SUSE Manager 3 Client Patch Status
}</screen>
<simpara>Within each host&#8217;s <literal role="path">host.cfg</literal> file add a service to a servicegroup with the following variable:</simpara>
<screen>define service {
  use                 generic-service
  service_description SSH
  check_command       check_ssh
  check_interval      60
  servicegroups       SUSE Manager Essential Services
}</screen>
<simpara>All services that include the <literal>servicegroups</literal> variable and the name of the servicegroup will be added to the specified servicegroup.
After adding services to a servicegroup restart Icinga as root to load the new configuation:</simpara>
<screen>systemctl restart icinga</screen>
</section>
</section>
<section xml:id="at.monitoring.systemd.services">
<title>Monitoring Systemd Services</title>
<simpara>The following section provides information on monitoring uptime of critical SUSE Manager services.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Monitoring Running Systemd Services</title>
<listitem>
<simpara>As root create a new plugin file called <literal role="path">check_systemd.sh</literal> in <literal role="path">/usr/lib/nagios/plugins/</literal> on your SUSE Manager server:</simpara>
<screen>vi /usr/lib/nagios/plugins/ check_systemd.sh</screen>
</listitem>
<listitem>
<simpara>For this example you will use an opensource community script to monitor Systemd services.
You may also wish to write your own.</simpara>
<screen>#!/bin/bash
# Copyright (C) 2016 Mohamed El Morabity &lt;melmorabity@fedoraproject.com&gt;
#
# This module is free software: you can redistribute it and/or modify it under
# the terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# This software is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.

PLUGINDIR=$(dirname $0)
. $PLUGINDIR/utils.sh


if [ $# -ne 1 ]; then
    echo "Usage: ${0##*/} &lt;service name&gt;" &gt;&amp;2
    exit $STATE_UNKNOWN
fi

service=$1

status=$(systemctl is-enabled $service 2&gt;/dev/null)
r=$?
if [ -z "$status" ]; then
    echo "ERROR: service $service doesn't exist"
    exit $STATE_CRITICAL
fi

if [ $r -ne 0 ]; then
    echo "ERROR: service $service is $status"
    exit $STATE_CRITICAL
fi

systemctl --quiet is-active $service
if [ $? -ne 0 ]; then
    echo "ERROR: service $service is not running"
    exit $STATE_CRITICAL
fi

echo "OK: service $service is running"
exit $STATE_OK</screen>
<simpara>A current version of this script can be found at: <link xl:href="https://github.com/melmorabity/nagios-plugin-systemd-service/blob/master/check_systemd_service.sh">https://github.com/melmorabity/nagios-plugin-systemd-service/blob/master/check_systemd_service.sh</link></simpara>
<warning>
<title>Non-supported 3rd Party Plugin</title>
<simpara>The script used in this example is an external script and is not supported by SUSE.</simpara>
</warning>
<simpara>Always check to ensure scripts are not modified or contain malicous code before using them on production machines.</simpara>
</listitem>
<listitem>
<simpara>Make the script executable:</simpara>
<screen>chmod 755 check_systemd.sh</screen>
</listitem>
<listitem>
<simpara>On your SUSE manager server add the following line to the <literal role="path">nrpe.cfg</literal> located at <literal role="path">/etc/nrpe.cfg</literal> :</simpara>
<screen># SUSE Manager Service Checks
command[check_systemd.sh]=/usr/lib/nagios/plugins/check_systemd.sh $ARG1$</screen>
<simpara>This will allow the Icinga server to call the plugin via nrpe on SUSE Manager.</simpara>
</listitem>
<listitem>
<simpara>Provide proper permissions by adding the script to the sudoers file:</simpara>
<screen>visudo</screen>
<screen>nagios  ALL=(ALL)       NOPASSWD:/usr/lib/nagios/plugins/check_systemd.sh
Defaults:nagios !requiretty</screen>
<simpara>You can also add permissions to the entire plugin directory instead of allowing permissions for individual scripts:</simpara>
<screen>nagios  ALL=(ALL)       NOPASSWD:/usr/lib/nagios/plugins/</screen>
</listitem>
<listitem>
<simpara>On your Icinga server define the following command within <literal role="path">/etc/icinga/objects/commands.cfg</literal> :</simpara>
<screen>define command {
        command_name   check-systemd-service
        command_line   /usr/lib/nagios/plugins/check_nrpe -H $HOSTADDRESS$ -c check_systemd.sh -a $ARG1$
}</screen>
</listitem>
<listitem>
<simpara>Now you will add the following critical services to be montitored to your SUSE Manager host file:</simpara>
<itemizedlist>
<listitem>
<simpara>auditlog-keeper.service</simpara>
</listitem>
<listitem>
<simpara>jabberd.service</simpara>
</listitem>
<listitem>
<simpara>spacewalk-wait-for-jabberd.service</simpara>
</listitem>
<listitem>
<simpara>tomcat.service</simpara>
</listitem>
<listitem>
<simpara>spacewalk-wait-for-tomcat.service</simpara>
</listitem>
<listitem>
<simpara>salt-master.service</simpara>
</listitem>
<listitem>
<simpara>salt-api.service</simpara>
</listitem>
<listitem>
<simpara>spacewalk-wait-for-salt.service</simpara>
</listitem>
<listitem>
<simpara>apache2.service</simpara>
</listitem>
<listitem>
<simpara>osa-dispatcher.service</simpara>
</listitem>
<listitem>
<simpara>rhn-search.service</simpara>
</listitem>
<listitem>
<simpara>cobblerd.service</simpara>
</listitem>
<listitem>
<simpara>taskomatic.service</simpara>
</listitem>
<listitem>
<simpara>spacewalk-wait-for-taskomatic.service</simpara>
<simpara>On your Icinga server add the following service blocks to your SUSE Manager host file <literal role="path">susemanager.cfg</literal> file located in <literal role="path">/etc/icinga/conf.d/</literal>.
(This configuration file was created in the previous section <emphasis>Adding a Host to Icinga</emphasis>.)</simpara>
<screen># Monitor Audit Log Keeper
define service {
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Audit Log Keeper Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!auditlog-keeper.service

}

# Monitor Jabberd
define service {
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Jabberd Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!jabberd.service

}

# Monitor Spacewalk Wait for Jabberd
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Spacewalk Wait For Jabberd Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!spacewalk-wait-for-jabberd.service
}

# Monitor Tomcat
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Tomcat Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!tomcat.service
}

# Monitor Spacewalk Wait for Tomcat
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Spacewalk Wait For Tomcat Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!spacewalk-wait-for-tomcat.service
}

# Monitor Salt Master
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Salt Master Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!salt-master.service
}

# Monitor Salt API
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Salt API Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!salt-api.service
}

# Monitor Spacewalk Wait for Salt
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Spacewalk Wait For Salt Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!spacewalk-wait-for-salt.service
}

# Monitor apache2
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Apache2 Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!apache2.service
}

# Monitor osa dispatcher
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Osa Dispatcher Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!osa-dispatcher.service
}

# Monitor rhn search
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    RHN Search Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!rhn-search.service
}

# Monitor Cobblerd
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Cobblerd Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!cobblerd.service
}

# Monitor taskomatic
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Taskomatic Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!taskomatic.service
}

# Monitor wait for taskomatic
define service{
       use                    generic-service
       host_name              susemanager
       check_interval         1
       active_checks_enabled  1
       service_description    Spacewalk Wait For Taskomatic Service
       servicegroups          SUSE Manager Essential Services
       check_command          check-systemd-service!spacewalk-wait-for-taskomatic.service
}</screen>
<simpara>Each of these service blocks will be passed as the check-systemd-service!$ARG1$ variable to SUSE manager server via nrpe.
You probably noticed the servicegroups parameter was also included.
This adds each service to a servicegroup and has been defined in a <literal role="path">servicesgroups.cfg</literal> file located in <literal role="path">/etc/icinga/conf.d/</literal>:</simpara>
<screen>define servicegroup {
       servicegroup_name     SUSE Manager Essential Services
       alias                 Essential Services
}</screen>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Restart Icinga:</simpara>
<screen>systemctl restart icinga</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="at.using.the.check.suma.patches.plugin">
<title>Using the check_suma_patches Plugin</title>
<simpara>You can use the <literal role="path">check_suma_patches</literal> plugin to check if any machines connected to SUSE Manager as clients require a patch or an update.
The following procedure will guide you through the setup of the check_suma_patches plugin.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Setup check_suma_patches</title>
<listitem>
<simpara>On your SUSE Manager server open <literal role="path">/etc/nrpe.cfg</literal> and add the following lines:</simpara>
<screen># SUSE Manager check_patches
command[check_suma_patches]=sudo /usr/lib/nagios/plugins/check_suma_patches $ARG1$</screen>
</listitem>
<listitem>
<simpara>On your Icinga server open <literal role="path">/etc/icinga/objects/commands.cfg</literal> and define the following command:</simpara>
<screen>define command{
        command_name    check_suma
        command_line    /usr/lib/nagios/plugins/check_nrpe -H 192.168.1.1 -c $ARG1$ -a $HOSTNAME$
}</screen>
</listitem>
<listitem>
<simpara>On your Icinga server open any of your SUSE Manager client host configration files located at <literal role="path">/etc/icinga/conf.d/clients.cfg</literal> and add the following service definition:</simpara>
<screen>define service {
        use                             generic-service
        host_name                       client-hostname
        service_description             Available Patches for client-host_name
        servicegroups                   Client Patch Status
        check_command                   check_suma!check_suma_patches
}</screen>
</listitem>
<listitem>
<simpara>In the above service definition notice that this host is included in the servicegroup labeled <emphasis>Client Patch Status</emphasis>.
Add the following servicegroup definition to <literal role="path">/etc/icinga/conf.d/servicegroups.cfg</literal> to create a servicegroup:</simpara>
<screen>define servicegroup {
       servicegroup_name     Client Patch Status
       alias                 SUSE Manager 3 Client Patch Status
}</screen>
</listitem>
<listitem>
<simpara></simpara>
<itemizedlist>
<listitem>
<simpara><literal>OK:System is up to date</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Warning: At least one patch or package update is available</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Critical:At least one security/critical update is available</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Unspecified:The host cannot be found in the SUSE Manager database or the host name is not unique</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>This concludes setup of the <literal>check_suma_patches</literal> plugin.</simpara>
</section>
<section xml:id="at.using.the.check.suma.lastevent.plugin">
<title>Using the check_suma_lastevent Plugin</title>
<simpara>You can use the <literal role="path">check_suma_lastevent</literal> plugin to display the last action executed on any host.</simpara>
<simpara>The following procedure will guide you through the setup of the check_suma_patches plugin.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Setup check_suma_lastevent</title>
<listitem>
<simpara>On your SUSE Manager server open <literal role="path">/etc/nrpe.cfg</literal> and add the following lines:</simpara>
<screen># Check SUSE Manager Hosts last events
command[check_events]=sudo /usr/lib/nagios/plugins/check_suma_lastevent $ARG1$</screen>
</listitem>
<listitem>
<simpara>On the Icinga server open <literal role="path">/etc/icinga/objects/commands.cfg</literal> and add the following lines:</simpara>
<screen>define command {
        command_name    check_events
        command_line    /usr/lib/nagios/plugins/check_nrpe -H manager.suse.de -c $ARG1$ -a $HOSTNAME$
}</screen>
</listitem>
<listitem>
<simpara>On your Icinga server add the following line to a host.cfg service definition:</simpara>
<screen>define service{
        use                             generic-service
        host_name                       hostname
        service_description             Last Events
        check_command                   check_events!check_suma_lastevent
}</screen>
</listitem>
<listitem>
<simpara>Status will be reported as follows:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>OK:Last action completed successfully</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Warning: Action is currently in progress</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Critical:Last action failed</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Unspecified:The host cannot be found in the SUSE Manager database or the host name is not unique</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>This concludes setup of the <literal>check_suma_lastevent</literal> plugin.</simpara>
</section>
<section xml:id="at.icinga.additional.resources.">
<title>Additional Resources</title>
<simpara>For more information, see Icinga&#8217;s official documentation located at <link xl:href="http://docs.icinga.org/latest/en">http://docs.icinga.org/latest/en</link>.</simpara>
<simpara>For some excellent time saving configuration tips and tricks not covered in this guide, see the following section located within the official documentation: <link xl:href="http://docs.icinga.org/latest/en/objecttricks.html">http://docs.icinga.org/latest/en/objecttricks.html</link></simpara>
</section>
</chapter>
<chapter xml:id="at.images">
<title>Image Building and Management</title>
<section xml:id="at.images.overview">
<title>Image Building Overview</title>
<simpara>SUSE Manager enables system administrators to build containers, systems, and virtual images.
SUSE Manager helps with creating Image Stores and managing Image Profiles.</simpara>
<simpara>SUSE Manager supports two distinct build types:</simpara>
<itemizedlist>
<listitem>
<simpara>Dockerfile-for more information, see <xref linkend="at.images.docker"/></simpara>
</listitem>
<listitem>
<simpara>Kiwi image system-for more information, see <xref linkend="at.images.kiwi"/></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.images.docker">
<title>Container Images</title>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="image-building.png" width="80%"/>
</imageobject>
<textobject><phrase>image building</phrase></textobject>
</mediaobject>
</informalfigure>
<section xml:id="at.images.docker.requirements">
<title>Requirements</title>
<simpara>The containers feature is available for Salt minions running SUSE Linux Enterprise Server 12 or later.
Before you begin, ensure your environment meets these requirements:</simpara>
<itemizedlist>
<listitem>
<simpara>An existing external GitHub or internal GitLab repository containing a Dockerfile and configuration scripts (example scripts are provided in this chapter).</simpara>
</listitem>
<listitem>
<simpara>A properly configured image registry.</simpara>
<note>
<title>Registry Provider Solutions</title>
<simpara>If you require a private image registry you can use an open source solution such as <literal>Portus</literal>.
For additional information on setting up Portus as a registry provider, see the <link xl:href="http://port.us.org/">Portus Documentation</link>.</simpara>
</note>
<simpara>For more information on Containers or CaaS Platform, see:</simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://www.suse.com/documentation/sles-12/book_sles_docker/data/book_sles_docker.html">SUSE Linux Enterprise Server 12 SP3 Docker Guide</link></simpara>
</listitem>
<listitem>
<simpara><link xl:href="https://www.suse.com/documentation/suse-caasp-2/">SUSE CaaS Platform 2 Documentation</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.images.docker.buildhost">
<title>Creating a Build Host</title>
<simpara>To build images with SUSE Manager, you will need to create and configure a build host.
Container build hosts are Salt minions running SUSE Linux Enterprise 12 or later.
This section guides you though the initial configuration for a build host.</simpara>
<simpara>From the SUSE Manager Web UI perform these steps to configure a build host.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select a minion to be designated as a build host from the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.</simpara>
</listitem>
<listitem>
<simpara>From the <literal role="guimenu">System Details</literal> page for the selected minion assign the containers modules by going to <menuchoice><guimenu>Software</guimenu> <guimenuitem>Software Channels</guimenuitem></menuchoice> and enabling <literal role="guimenu">SLE-Module-Containers12-Pool</literal> and <literal role="guimenu">SLE-Module-Containers12-Updates</literal>. Confirm by clicking <guibutton>Change Subscriptions</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Properties</guimenuitem></menuchoice> page, enable <literal role="guimenu">Add-on System Type</literal> and <literal>Container Build Host</literal> and confirm by clicking <guibutton>Update Properties</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Install all required packages by applying <literal>Highstate</literal>. From the system details page select <menuchoice><guimenu>States</guimenu> <guimenuitem>Highstate</guimenuitem></menuchoice> and click <literal role="guimenu">Apply Highstate</literal>.
Alternatively, apply Highstate from the SUSE Manager Server command line:</simpara>
<screen>salt '$your_minion' state.highstate</screen>
</listitem>
</orderedlist>
<section xml:id="at.images.docker.buildchannels">
<title>Define Container Build Channels with an Activation Key</title>
<simpara>Create an activation key associated with the channel that your images will use.</simpara>
<note>
<title>Relationship Between Activation Keys and Image Profiles</title>
<simpara>To build containers, you will need an activation key that is associated with a channel other than "SUSE Manager Default".</simpara>
</note>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_create_activation_key.png" width="80%"/>
</imageobject>
<textobject><phrase>systems create activation key</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click <guibutton>Create Key</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Enter a <literal role="guimenu">Description</literal> and a <literal role="guimenu">Key</literal> name. Use the drop-down menu to select the <literal role="guimenu">Base Channel</literal> to associate with this key.</simpara>
</listitem>
<listitem>
<simpara>Confirm with <guibutton>Create Activation Key</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>For more information, see <xref linkend="bp.key.managment"/>.</simpara>
</section>
</section>
<section xml:id="at.images.docker.imagestore">
<title>Creating an Image Store</title>
<simpara>Define a location to store all of your images by creating an Image Store.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_stores.png" width="80%"/>
</imageobject>
<textobject><phrase>images image stores</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Stores</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click <literal role="guimenu">Create</literal> to create a new store.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_stores_create.png" width="80%"/>
</imageobject>
<textobject><phrase>images image stores create</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>SUSE Manager currently provides support only for the <literal>Registry</literal> store type. Define a name for the image store in the <literal role="guimenu">Label</literal> field.</simpara>
</listitem>
<listitem>
<simpara>Provide the path to your image registry by filling in the <literal role="guimenu">URI</literal> field, as a fully qualified domain name (FQDN) for the container registry host (whether internal or external).</simpara>
<screen>registry.example.com</screen>
<simpara>The Registry URI can also be used to specify an image store on a used registry.</simpara>
<screen>registry.example.com:5000/myregistry/myproject</screen>
</listitem>
<listitem>
<simpara>Click <guibutton>Create</guibutton> to add the new image store.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.images.docker.profile">
<title>Creating an Image Profile</title>
<simpara>Manage Image Profiles from the <literal>Image Profile</literal> page.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_profiles.png" width="80%"/>
</imageobject>
<textobject><phrase>images image profiles</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Create an Image Profile</title>
<listitem>
<simpara>To create an image profile select <menuchoice><guimenu>Image</guimenu> <guimenuitem>Profiles</guimenuitem></menuchoice> and click <guibutton>Create</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_create_profile.png" width="80%"/>
</imageobject>
<textobject><phrase>images image create profile</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>Provide a name for the image profile by filling in the <guimenu>Label</guimenu> field.</simpara>
<note>
<simpara>Only lowercase characters are permitted in container labels.
If your container image tag is in a format such as <literal>myproject/myimage</literal>, make sure your image store registry URI contains the <literal>/myproject</literal> suffix.</simpara>
</note>
</listitem>
<listitem>
<simpara>Use a <literal>Dockerfile</literal> as the <literal>Image Type</literal></simpara>
</listitem>
<listitem>
<simpara>Use the drop-down menu to select your registry from the <literal>Target Image Store</literal> field.</simpara>
</listitem>
<listitem>
<simpara>Enter a Github or Gitlab repository URL (http, https, or token authentication) in the <literal role="guimenu">Path</literal> field using one of the following formats:</simpara>
</listitem>
</orderedlist>
<itemizedlist>
<title>Github Path Options</title>
<listitem>
<simpara>Github single user project repository</simpara>
</listitem>
</itemizedlist>
<screen>https://github.com/USER/project.git#branchname:folder</screen>
<itemizedlist>
<listitem>
<simpara>Github organization project repository</simpara>
</listitem>
</itemizedlist>
<screen>https://github.com/ORG/project.git#branchname:folder</screen>
<itemizedlist>
<listitem>
<simpara>Github token authentication:</simpara>
</listitem>
</itemizedlist>
<simpara>If your git repository is private and not publicly accessible, you need to modify the profile&#8217;s git URL to include authentication.
Use this URL format to authenticate with a Github token:</simpara>
<screen>https://USER:&lt;AUTHENTICATION_TOKEN&gt;@github.com/USER/project.git#master:/container/</screen>
<itemizedlist>
<title>Gitlab Path Options</title>
<listitem>
<simpara>Gitlab single user project repository</simpara>
</listitem>
</itemizedlist>
<screen>https://gitlab.example.com/USER/project.git#master:/container/</screen>
<itemizedlist>
<listitem>
<simpara>Gitlab groups project repository</simpara>
</listitem>
</itemizedlist>
<screen>https://gitlab.example.com/GROUP/project.git#master:/container/</screen>
<itemizedlist>
<listitem>
<simpara>Gitlab token authentication
If your git repository is private and not publicly accessible, you need to modify the profile&#8217;s git URL to include authentication.
Use this URL format to authenticate with a Gitlab token:</simpara>
</listitem>
</itemizedlist>
<screen>https://gitlab-ci-token:&lt;AUTHENTICATION_TOKEN&gt;@gitlab.example.com/USER/project.git#master:/container/</screen>
<important>
<title>Specifying a Github or Gitlab Branch</title>
<simpara>If a branch is not specified, the <literal>master</literal> branch will be used by default.
If a <literal>folder</literal> is not specified the image sources (<literal>Dockerfile</literal> sources) are expected to be in the root directory of the Github or Gitlab checkout.</simpara>
</important>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select an <literal>Activation Key</literal>.  Activation Keys ensure that images using a profile are assigned to the correct channel and packages.</simpara>
<note>
<title>Relationship Between Activation Keys and Image Profiles</title>
<simpara>When you associate an activation key with an image profile you are ensuring any image using the profile will use the correct software channel and any packages in the channel.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click the <guibutton>Create</guibutton> button.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.images.docker.sourceexample">
<title>Example Dockerfile and add_packages Script</title>
<simpara>This section contains an example Dockerfile.
You specify a Dockerfile that will be used during image building when creating an image profile.
A Dockerfile and any associated scripts should be stored within an internal or external Github or Gitlab repository:</simpara>
<important>
<title>Required Dockerfile Lines</title>
<simpara>The Dockerfile provides access to a specific repository version served by SUSE Manager.
This example Dockerfile is used by SUSE Manager to trigger a build job on a build host minion.
The <literal role="command">ARG</literal> parameters ensure that the image that is built is associated with the desired repository version served by SUSE Manager.
The <literal role="command">ARG</literal> parameters also allow you to build image versions of SUSE Linux Enterprise Server which may differ from the version of SUSE Linux Enterprise Server used by the build host itself.</simpara>
<simpara>For example: The <literal role="comand">ARG repo</literal> parameter and the <literal role="command">echo</literal> command pointing to the repository file, creates and then injects the correct path into the repository file for the desired channel version.</simpara>
<simpara><emphasis>The repository version is determined by the activation key that you assigned to your image profile.</emphasis></simpara>
</important>
<screen>FROM registry.example.com/sles12sp2
MAINTAINER Tux Administrator "tux@example.com"

### Begin: These lines Required for use with {productname}

ARG repo
ARG cert

# Add the correct certificate
RUN echo "$cert" &gt; /etc/pki/trust/anchors/RHN-ORG-TRUSTED-SSL-CERT.pem

# Update certificate trust store
RUN update-ca-certificates

# Add the repository path to the image
RUN echo "$repo" &gt; /etc/zypp/repos.d/susemanager:dockerbuild.repo

### End: These lines required for use with {productname}

# Add the package script
ADD add_packages.sh /root/add_packages.sh

# Run the package script
RUN /root/add_packages.sh

# After building remove the repository path from image
RUN rm -f /etc/zypp/repos.d/susemanager:dockerbuild.repo</screen>
<simpara>This is an example <literal role="path">add_packages.sh</literal> script for use with your Dockerfile:</simpara>
<screen>#!/bin/bash
set -e

zypper --non-interactive --gpg-auto-import-keys ref

zypper --non-interactive in python python-xml aaa_base aaa_base-extras net-tools timezone vim less sudo tar</screen>
<note>
<title>Packages Required for Inspecting Your Images</title>
<simpara>To inspect images and provide the package and product list of a container to the SUSE Manager Web UI you will need to install <phrase role="package">python</phrase> and <phrase role="package">python-xml</phrase> within the container.
If these packages remain uninstalled, your images will still build, but the package and product list will be unavailable from the Web UI.</simpara>
</note>
</section>
<section xml:id="at.images.docker.building">
<title>Building an Image</title>
<simpara>There are two ways to build an image.
You can select <menuchoice><guimenu>Images</guimenu> <guimenuitem>Build</guimenuitem></menuchoice> from the left navigation bar, or click the build icon in the <menuchoice><guimenu>Images</guimenu> <guimenuitem>Profiles</guimenuitem></menuchoice> list.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_build.png" width="80%"/>
</imageobject>
<textobject><phrase>images image build</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Build an Image</title>
<listitem>
<simpara>For this example select <menuchoice><guimenu>Images</guimenu> <guimenuitem>Build</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Add a different tag name if you want a version other than the default <literal>latest</literal> (only relevant to containers).</simpara>
</listitem>
<listitem>
<simpara>Select <literal role="guimenu">Build Profile</literal> and <literal role="guimenu">Build Host</literal>.</simpara>
<note>
<title>Profile Summary</title>
<simpara>Notice the <literal role="guimenu">Profile Summary</literal> to the right of the build fields.
When you have selected a build profile, detailed information about the selected profile will be displayed in this area.</simpara>
</note>
</listitem>
<listitem>
<simpara>To schedule a build click the <guibutton>Build</guibutton> button.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.images.docker.importing">
<title>Importing an Image</title>
<simpara>You can import and inspect arbitrary images.
Select <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> from the left navigation bar.
Complete the text boxes of the <literal role="guimenu">Import</literal> dialog.
Once it has processed, the imported image will be listed on the <literal role="guimenu">Images</literal> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Import an Image</title>
<listitem>
<simpara>From <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> click <guibutton>Import</guibutton> to open the <literal role="guimenu">Import Image</literal> dialog.</simpara>
</listitem>
<listitem>
<simpara>In the <literal role="guimenu">Import Image</literal> dialog complete these fields:</simpara>
<variablelist>
<varlistentry>
<term>Image store</term>
<listitem>
<simpara>The registry from where the image will be pulled for inspection.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Image name</term>
<listitem>
<simpara>The name of the image in the registry.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Image version</term>
<listitem>
<simpara>The version of the image in the registry.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Build host</term>
<listitem>
<simpara>The build host that will pull and inspect the image.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Activation key</term>
<listitem>
<simpara>The activation key that provides the path to the software channel that the image will be inspected with.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>For confirmation, click <guibutton>Import</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>The entry for the image is created in the database, and an <literal>Inspect Image</literal> action on SUSE Manager is scheduled.</simpara>
<simpara>Once it has been processed, you can find the imported image in the <literal>Images</literal> list.
It has a different icon in the <literal>Build</literal> column, to indicate that the image is imported (see screenshot).
The status icon for the imported image can also be seen on the <literal>Overview</literal> tab for the image.</simpara>
</section>
<section xml:id="at.images.docker.troubleshooting">
<title>Troubleshooting</title>
<simpara>These are some known problems that you might encounter when working with images:</simpara>
<itemizedlist>
<listitem>
<simpara>HTTPS certificates to access the registry or the git repositories should be deployed to the minion by a custom state file.</simpara>
</listitem>
<listitem>
<simpara>SSH git access using Docker is currently unsupported.
You may test it, but SUSE will not provide support.</simpara>
</listitem>
<listitem>
<simpara>If the <phrase role="package">python</phrase> and <phrase role="package">python-xml</phrase> packages are not installed in your images during the build process, Salt cannot run within the container and reporting of installed packages or products will fail.
This will result in an <literal>unknown</literal> update status.</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="at.images.kiwi">
<title>OS Images</title>
<simpara>OS images are built by the Kiwi image system.
They can be of various types: PXE, QCOW2, LiveCD images, and others.</simpara>
<simpara>For more information about the Kiwi build system, see the <link xl:href="https://doc.opensuse.org/projects/kiwi/doc/">Kiwi documentation</link>.</simpara>
<section xml:id="at.images.kiwi.enablement">
<title>Enabling OS Image Building</title>
<simpara>OS image building is disabled by default. You can enable it in <literal>/etc/rhn/rhn.conf</literal> by setting:</simpara>
<screen>java.kiwi_os_image_building_enabled = true</screen>
<simpara>Restart the Spacewalk service to pick up the changes:</simpara>
<screen>spacewalk-service restart</screen>
</section>
<section xml:id="at.images.kiwi.requirements">
<title>Requirements</title>
<simpara>The Kiwi image building feature is available for Salt minions running SUSE Linux Enterprise Server&#160;12.
It is currently not supported to build SUSE Linux Enterprise 15 images.</simpara>
<simpara>Kiwi image configuration files and configuration scripts must be accessible in one of these locations:</simpara>
<itemizedlist>
<listitem>
<simpara>Git repository</simpara>
</listitem>
<listitem>
<simpara>HTTP hosted tarball</simpara>
</listitem>
<listitem>
<simpara>Local build host directory</simpara>
</listitem>
</itemizedlist>
<simpara>Example scripts are provided in the following sections.</simpara>
<note>
<title>Hardware Requirements for Hosts Running OS Images</title>
<simpara>Hosts running OS images built with Kiwi need at least 1 GB of RAM.
Disk space depends on the actual size of the image.
For more information, see the documentation of the underlying system.</simpara>
</note>
</section>
<section xml:id="at.images.kiwi.buildhost">
<title>Creating a Build Host</title>
<simpara>To build all kinds of images with SUSE Manager, create and configure a build host.
OS image build hosts are Salt minions running SUSE Linux Enterprise Server&#160;12 (SP3 or later).
This procedure will guide you though the initial configuration for a build host.</simpara>
<simpara>From the SUSE Manager Web UI perform these steps to configure a build host:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select a minion that will be designated as a build host from the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Overview</guimenuitem></menuchoice> page.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Properties</guimenuitem></menuchoice> page, enable the <literal role="guimenu">Add-on System Type:</literal> <literal role="guimenu">OS Image Build Host</literal> and confirm with <guibutton>Update Properties</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="os-image-build-host.png" width="80%"/>
</imageobject>
<textobject><phrase>os image build host</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guisubmenu>Software</guisubmenu> <guimenuitem>Software Channels</guimenuitem></menuchoice> page, enable <literal>SLE-Manager-Tools12-Pool</literal> and <literal>SLE-Manager-Tools12-Updates</literal> (or a later version).
Schedule and click <guibutton>Confirm</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Install Kiwi and all required packages by applying Highstate.
From the system details page select <menuchoice><guimenu>States</guimenu> <guimenuitem>Highstate</guimenuitem></menuchoice> and click <guibutton>Apply Highstate</guibutton>.
Alternatively, apply Highstate from the SUSE Manager Server command line:</simpara>
<screen>salt '$your_minion' state.highstate</screen>
</listitem>
</orderedlist>
<formalpara>
<title>SUSE Manager Web Server Public Certificate RPM</title>
<para>Build host provisioning copies the SUSE Manager certificate RPM to the build host.
This certificate is used for accessing repositories provided by SUSE Manager.</para>
</formalpara>
<simpara>The certificate is packaged in RPM by the <literal>mgr-package-rpm-certificate-osimage</literal> package script.
The package script is called automatically during a new SUSE Manager installation.</simpara>
<simpara>When you upgrade the <literal>spacewalk-certs-tools</literal> package, the upgrade scenario will call the package script using the default values.
However if the certificate path was changed or unavailable, you will need to call the package script manually using <literal>--ca-cert-full-path &lt;path_to_certificate&gt;</literal> after the upgrade procedure has finished.</simpara>
<formalpara>
<title>Package script call example</title>
<para>
<programlisting language="bash" linenumbering="unnumbered">/usr/sbin/mgr-package-rpm-certificate-osimage --ca-cert-full-path /root/ssl-build/RHN-ORG-TRUSTED-SSL-CERT</programlisting>
</para>
</formalpara>
<simpara>The RPM package with the certificate is stored in a salt-accessible directory such as <literal>/usr/share/susemanager/salt/images/rhn-org-trusted-ssl-cert-osimage-1.0-1.noarch.rpm</literal>.</simpara>
<simpara>The RPM package with the certificate is provided in the local build host repository <literal>/var/lib/Kiwi/repo</literal>.</simpara>
<important>
<title>The RPM Package with the SUSE Manager Certificate Must Be Specified in the Build Source</title>
<simpara>Make sure your build source Kiwi configuration contains <literal>rhn-org-trusted-ssl-cert-osimage</literal> as a required package in the <literal>bootstrap</literal> section.</simpara>
<formalpara>
<title>config.xml</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">...
  &lt;packages type="bootstrap"&gt;
    ...
    &lt;package name="rhn-org-trusted-ssl-cert-osimage" bootinclude="true"/&gt;
  &lt;/packages&gt;
...</programlisting>
</para>
</formalpara>
</important>
<section xml:id="at.images.kiwi.buildchannels">
<title>Define Kiwi Build Channels with an Activation Key</title>
<simpara>Create an activation key associated with the channel that your images will use.
Activation keys are mandatory for OS Image building.</simpara>
<note>
<title>Relationship Between Activation Keys and Image Profiles</title>
<simpara>To build OS Images, you will need an activation key that is associated with a channel other than "SUSE Manager Default".</simpara>
</note>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_create_activation_key.png" width="80%"/>
</imageobject>
<textobject><phrase>systems create activation key</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<listitem>
<simpara>In the Web UI, select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Activation Keys</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Click <literal role="guimenu">Create Key</literal>.</simpara>
</listitem>
<listitem>
<simpara>Enter a <literal role="guimenu">Description</literal>, a <literal role="guimenu">Key</literal> name, and use the drop-down box to select a <literal role="guimenu">Base Channel</literal> to associate with the key.</simpara>
</listitem>
<listitem>
<simpara>Confirm with <guibutton>Create Activation Key</guibutton>.</simpara>
</listitem>
</orderedlist>
<simpara>For more information, see <xref linkend="bp.key.managment"/>.</simpara>
</section>
</section>
<section xml:id="at.images.kiwi.imagestore">
<title>Image Store</title>
<simpara>OS images can require  a significant amount of storage space.
Therefore, we recommended that the OS image store is located on a partition of its own or on a btrfs subvolume, separate from the root partition.
By default, the image store will be located at <literal role="path">/srv/www/os-images</literal>.</simpara>
<note>
<title>Image stores for Kiwi build type</title>
<simpara>Image stores for Kiwi build type, used to build system, virtual and other images, are not supported yet.</simpara>
<simpara>Images are always stored in <literal role="path">/srv/www/os-images/&lt;organization id&gt;</literal> and are accessible via HTTP/HTTPS <literal role="url"><link xl:href="https://&lt;susemanager_host&gt;/os-images/&lt;organization">https://&lt;susemanager_host&gt;/os-images/&lt;organization</link> id&gt;</literal></simpara>
</note>
</section>
<section xml:id="at.images.kiwi.profile">
<title>Creating an Image Profile</title>
<simpara>Manage Image Profiles using the Web UI.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_profiles.png" width="80%"/>
</imageobject>
<textobject><phrase>images image profiles</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Create an Image Profile</title>
<listitem>
<simpara>To create an image profile select from <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice> and click <guibutton>Create</guibutton>.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_create_profile_kiwi.png" width="80%"/>
</imageobject>
<textobject><phrase>images image create profile kiwi</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
<listitem>
<simpara>In the <literal role="guimenu">Label</literal> field, provide a name for the <literal>Image Profile</literal>.</simpara>
</listitem>
<listitem>
<simpara>Use <literal>Kiwi</literal> as the <literal role="guimenu">Image Type</literal>.</simpara>
</listitem>
<listitem>
<simpara>Image store is automatically selected.</simpara>
</listitem>
<listitem>
<simpara>Enter a <literal role="guimenu">Config URL</literal> to the directory containing the Kiwi configuration files:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Git URI</simpara>
</listitem>
<listitem>
<simpara>HTTPS tarball</simpara>
</listitem>
<listitem>
<simpara>Path to build host local directory</simpara>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Select an <literal role="guimenu">Activation Key</literal>. Activation keys ensure that images using a profile are assigned to the correct channel and packages.</simpara>
<note>
<title>Relationship Between Activation Keys and Image Profiles</title>
<simpara>When you associate an activation key with an image profile you are ensuring any image using the profile will use the correct software channel and any packages in the channel.</simpara>
</note>
</listitem>
<listitem>
<simpara>Confirm with the <guibutton>Create</guibutton> button.</simpara>
</listitem>
</orderedlist>
<itemizedlist>
<title>Source format options</title>
<listitem>
<simpara>Git/HTTP(S) URL to the repository</simpara>
<simpara>URL to the Git repository containing the sources of the image to be built.
Depending on the layout of the repository the URL can be:</simpara>
<screen>https://github.com/SUSE/manager-build-profiles</screen>
<simpara>You can specify a branch after the <literal>#</literal> character in the URL.
In this example, we use the <literal>master</literal> branch:</simpara>
<screen>https://github.com/SUSE/manager-build-profiles#master</screen>
<simpara>You can specify a directory that contains the image sources after the <literal>:</literal> character.
In this example, we use <literal>OSImage/POS_Image-JeOS6</literal>:</simpara>
<screen>https://github.com/SUSE/manager-build-profiles#master:OSImage/POS_Image-JeOS6</screen>
</listitem>
<listitem>
<simpara>HTTP(S) URL to the tarball</simpara>
<simpara>URL to the tar archive, compressed or uncompressed, hosted on the webserver.</simpara>
<screen>https://myimagesourceserver.example.org/MyKiwiImage.tar.gz</screen>
</listitem>
<listitem>
<simpara>Path to the directory on the build host</simpara>
<simpara>Enter the path to the directory with the Kiwi build system sources. This directory must be present on the selected build host.</simpara>
<screen>/var/lib/Kiwi/MyKiwiImage</screen>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.images.kiwi.sourceexample">
<title>Example of Kiwi sources</title>
<simpara>Kiwi sources consist at least of <literal>config.xml</literal>.
Usually <literal>config.sh</literal> and <literal>images.sh</literal> are present as well.
Sources can also contain files to be installed in the final image under the <literal>root</literal> subdirectory.</simpara>
<simpara>For information about the Kiwi build system, see the <link xl:href="https://doc.opensuse.org/projects/kiwi/doc/">Kiwi documentation</link>.</simpara>
<simpara>SUSE provides examples of fully functional image sources at the <link xl:href="https://github.com/SUSE/manager-build-profiles">SUSE/manager-build-profiles</link> public GitHub repository.</simpara>
<formalpara>
<title>Example of JeOS config.xml</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;?xml version="1.0" encoding="utf-8"?&gt;

&lt;image schemaversion="6.1" name="POS_Image_JeOS6"&gt;
    &lt;description type="system"&gt;
        &lt;author&gt;Admin User&lt;/author&gt;
        &lt;contact&gt;noemail@example.com&lt;/contact&gt;
        &lt;specification&gt;SUSE Linux Enterprise 12 SP3 JeOS&lt;/specification&gt;
    &lt;/description&gt;
    &lt;preferences&gt;
        &lt;version&gt;6.0.0&lt;/version&gt;
        &lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
        &lt;bootsplash-theme&gt;SLE&lt;/bootsplash-theme&gt;
        &lt;bootloader-theme&gt;SLE&lt;/bootloader-theme&gt;

        &lt;locale&gt;en_US&lt;/locale&gt;
        &lt;keytable&gt;us.map.gz&lt;/keytable&gt;
        &lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
        &lt;hwclock&gt;utc&lt;/hwclock&gt;

        &lt;rpm-excludedocs&gt;true&lt;/rpm-excludedocs&gt;
        &lt;type boot="saltboot/suse-SLES12" bootloader="grub2" checkprebuilt="true" compressed="false" filesystem="ext3" fsmountoptions="acl" fsnocheck="true" image="pxe" kernelcmdline="quiet"&gt;&lt;/type&gt;
    &lt;/preferences&gt;
    &lt;!--    CUSTOM REPOSITORY
    &lt;repository type="rpm-dir"&gt;
      &lt;source path="this://repo"/&gt;
    &lt;/repository&gt;
    --&gt;
    &lt;packages type="image"&gt;
        &lt;package name="patterns-sles-Minimal"/&gt;
        &lt;package name="aaa_base-extras"/&gt; &lt;!-- wouldn't be SUSE without that ;-) --&gt;
        &lt;package name="kernel-default"/&gt;
        &lt;package name="salt-minion"/&gt;
        ...
    &lt;/packages&gt;
    &lt;packages type="bootstrap"&gt;
        ...
        &lt;package name="sles-release"/&gt;
        &lt;!-- this certificate package is required to access {productname} repositories
             and is provided by {productname} automatically --&gt;
        &lt;package name="rhn-org-trusted-ssl-cert-osimage" bootinclude="true"/&gt;

    &lt;/packages&gt;
    &lt;packages type="delete"&gt;
        &lt;package name="mtools"/&gt;
        &lt;package name="initviocons"/&gt;
        ...
    &lt;/packages&gt;
&lt;/image&gt;</programlisting>
</para>
</formalpara>
</section>
<section xml:id="at.images.kiwi.building">
<title>Building an Image</title>
<simpara>There are two ways to build an image using the Web UI.
Either select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Build</guimenuitem></menuchoice>, or click the build icon in the <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice> list.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_image_build.png" width="80%"/>
</imageobject>
<textobject><phrase>images image build</phrase></textobject>
</mediaobject>
</informalfigure>
<orderedlist numeration="arabic">
<title>Procedure: Build an Image</title>
<listitem>
<simpara>Select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Build</guimenuitem></menuchoice>.</simpara>
</listitem>
<listitem>
<simpara>Add a different tag name if you want a version other than the default <literal>latest</literal> (applies only to containers).</simpara>
</listitem>
<listitem>
<simpara>Select the <literal role="guimenu">Image Profile</literal> and a <literal role="guimenu">Build Host</literal>.</simpara>
<note>
<title>Profile Summary</title>
<simpara>A <literal role="guimenu">Profile Summary</literal> is displayed to the right of the build fields.
When you have selected a build profile detailed information about the selected profile will show up in this area.</simpara>
</note>
</listitem>
<listitem>
<simpara>To schedule a build, click the <guibutton>Build</guibutton> button.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.images.kiwi.inspection">
<title>Image Inspection and Salt Integration</title>
<simpara>After the image is successfully built, the inspection phase begins.
During the inspection phase SUSE Manager collects information about the image:</simpara>
<itemizedlist>
<listitem>
<simpara>List of packages installed in the image</simpara>
</listitem>
<listitem>
<simpara>Checksum of the image</simpara>
</listitem>
<listitem>
<simpara>Image type and other image details</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>If the built image type is <literal>PXE</literal>, a Salt pillar will also be generated.
Image pillars are stored in the <literal>/srv/susemanager/pillar_data/images/</literal> directory and the Salt subsystem can access details about the generated image.
Details include where the pillar is located and provided, image checksums, information needed for network boot, and more.</simpara>
<simpara>The generated pillar is available to all connected minions.</simpara>
</note>
</section>
<section xml:id="at.images.kiwi.troubleshooting">
<title>Troubleshooting</title>
<simpara>Building an image requires of several dependent steps.
When the build fails, investigation of salt states results can help you to identify the source of the failure.
Usual checks when the build fails:</simpara>
<itemizedlist>
<listitem>
<simpara>The build host can access the build sources</simpara>
</listitem>
<listitem>
<simpara>There is enough disk space for the image on both the build host and the SUSE Manager server</simpara>
</listitem>
<listitem>
<simpara>The activation key has the correct channels associated with it</simpara>
</listitem>
<listitem>
<simpara>The build sources used are valid</simpara>
</listitem>
<listitem>
<simpara>The RPM package with the SUSE Manager public certificate is up to date and available at <literal>/usr/share/susemanager/salt/images/rhn-org-trusted-ssl-cert-osimage-1.0-1.noarch.rpm</literal>.</simpara>
<simpara>For more on how to refresh a public certificate RPM, see <xref linkend="at.images.kiwi.buildhost"/>.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.images.kiwi.limitations">
<title>Limitations</title>
<simpara>The section contains some known issues when working with images.</simpara>
<itemizedlist>
<listitem>
<simpara>HTTPS certificates used to access the HTTP sources or Git repositories should be deployed to the minion by a custom state file, or configured manually.</simpara>
</listitem>
<listitem>
<simpara>Importing Kiwi-based images is not supported.</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="at.images.listing">
<title>Listing Image Profiles Available for Building</title>
<simpara>To list images available for building select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Images</guisubmenu> <guimenuitem>Images</guimenuitem></menuchoice>.
A list of all images will be displayed.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images_list_images.png" width="80%"/>
</imageobject>
<textobject><phrase>images list images</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Displayed data about images includes an image <literal role="guimenu">Name</literal>, its <literal role="guimenu">Version</literal> and the build <literal role="guimenu">Status</literal>.
You will also see the image update status with a listing of possible patch and package updates that are available for the image.</simpara>
<simpara>Clicking the <guibutton>Details</guibutton> button on an image will provide a detailed view including an exact list of relevant patches and a list of all packages installed within the image.</simpara>
<note>
<simpara>The patch and the package list is only available if the inspect state after a build was successful.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="advanced.topics.kubernetes.integration">
<title>Kubernetes Integration Guide</title>
<section xml:id="at.k8s.integration.requires">
<title>Prerequisites</title>
<simpara>The prerequisites listed below should be met before proceeding.</simpara>
<itemizedlist>
<listitem>
<simpara>At least one <emphasis>Kubernetes</emphasis> or _SUSE CaaS Platform _ cluster available on your network</simpara>
</listitem>
<listitem>
<simpara>SUSE Manager configured for container management</simpara>
<note>
<simpara>Required channels are present, a registered build host available etc.</simpara>
</note>
</listitem>
<listitem>
<simpara><phrase role="package">virtual-host-gatherer-Kubernetes</phrase> package installed on your SUSE Manager server</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.requirements">
<title>Requirements</title>
<itemizedlist>
<listitem>
<simpara>Kubernetes version 1.5.0 or higher.
Alternatively use SUSE CaaS Platform <emphasis>(SUSE CaaS Platform includes Kubernetes 1.5.0 by default)</emphasis></simpara>
</listitem>
<listitem>
<simpara>Docker version 1.12 or higher on the container build host</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>To enable all Kubernetes related features within the Web UI, the <phrase role="package">virtual-host-gatherer-Kubernetes</phrase> package must be installed.</simpara>
</note>
</section>
<section xml:id="at.registering.kubernetes.as.a.virtual.host.manager">
<title>Register Kubernetes as a Virtual Host Manager</title>
<simpara><emphasis>Kubernetes</emphasis> clusters are registered with SUSE Manager as <literal>virtual host managers</literal>.
Registration and authorization begins with importing a <literal>kubeconfig</literal> file using Kubernetes official command line tool <literal>kubectl</literal>.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Registering a Kubernetes Cluster with SUSE Manager</title>
<listitem>
<simpara>Select <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> from the navigation menu.</simpara>
</listitem>
<listitem>
<simpara>Expand the <literal>Create</literal> dropdown in the upper right corner of the page and select <guimenu>Kubernetes Cluster</guimenu> .</simpara>
</listitem>
<listitem>
<simpara>Input a label for the new Virtual Host Manager.</simpara>
</listitem>
<listitem>
<simpara>Select the <literal>kubeconfig</literal> file which contains the required data for the Kubernetes cluster.</simpara>
</listitem>
<listitem>
<simpara>Select the correct <emphasis>context</emphasis> for the cluster, as specified in the kubeconfig file.</simpara>
</listitem>
<listitem>
<simpara>Click <literal>Create</literal>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.view.the.list.of.nodes.in.a.cluster">
<title>View the List of Nodes in a Cluster</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> from the navigation menu.</simpara>
</listitem>
<listitem>
<simpara>Select the desired Kubernetes cluster to view it.</simpara>
</listitem>
<listitem>
<simpara>Node data is not refreshed during registration.
To refresh node data, click on <literal>Schedule refresh data</literal>.</simpara>
</listitem>
<listitem>
<simpara>Refresh the browser.
If the node data is not available wait a few moments and try again.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.obtain.runtime.data.about.images">
<title>Obtain Runtime Data about Images</title>
<simpara>See the following steps to find runtime data for images.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> from the navigation menu.</simpara>
</listitem>
<listitem>
<simpara>In the image list table, take notice of the new runtime columns.
These are labeled: <literal>Revision</literal>, <literal>Runtime</literal> and <literal>Instances</literal>.
Initially these columns will not provide useful data.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>Revision</literal>: An artificial sequence number which increments on every rebuild for manager-built images, or on every reimport for externally built images.</simpara>
</listitem>
<listitem>
<simpara><literal>Runtime</literal>: Overall status of the running instances of the image throughout the registered clusters.
The status can be one of the following:</simpara>
<itemizedlist>
<listitem>
<simpara>All instances are consistent with SUSE Manager: All the running instances are running the same build of the image as tracked by SUSE Manager.</simpara>
</listitem>
<listitem>
<simpara>Outdated instances found: Some of the instances are running an older build of the image.
A redeploy of the image into the pod may be required.</simpara>
</listitem>
<listitem>
<simpara>No information: The checksum of the instance image does not match the image data contained in SUSE Manager.
A redeploy of the image into the pod may be required.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>Instances</literal>: Number of instances running this image across all the clusters registered in SUSE Manager.
A breakdown of numbers can be seen by clicking on the pop-up icon next to the number.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="at.build.an.image.for.deployment.in.kubernetes">
<title>Build an image for deployment in Kubernetes</title>
<simpara>The following steps will help you build an image for deployment in Kubernetes.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Under <menuchoice><guimenu>Images</guimenu> <guimenuitem>Stores</guimenuitem></menuchoice>, create an image store.</simpara>
</listitem>
<listitem>
<simpara>Under <menuchoice><guimenu>Images</guimenu> <guimenuitem>Profiles</guimenuitem></menuchoice>, create an image profile (with a Dockerfile which is suitable to deploy to Kubernetes).</simpara>
</listitem>
<listitem>
<simpara>Under <menuchoice><guimenu>Images</guimenu> <guimenuitem>Build</guimenuitem></menuchoice>, build an image with the new profile and wait for the build to finish.</simpara>
</listitem>
<listitem>
<simpara>Deploy the image into one of the registered Kubernetes clusters (via <literal>kubectl</literal>).</simpara>
</listitem>
<listitem>
<simpara>Notice the updated data in <literal>Runtime</literal> and <literal>Instances</literal> columns in the respective image row.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.import.a.previously.deployed.image.in.kubernetes">
<title>Import a Previously Deployed Image in Kubernetes</title>
<simpara>The following steps will guide you through importing a previously deployed image in Kubernetes.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select an image that has already been deployed to any of your registered Kubernetes clusters.</simpara>
</listitem>
<listitem>
<simpara>Add the registry owning the image to SUSE Manager as an image store.</simpara>
</listitem>
<listitem>
<simpara>Select <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> , click <literal>Import</literal> from the top-right corner, fill in the form fields and click <literal>Import</literal>.</simpara>
</listitem>
<listitem>
<simpara>Notice the updated data in <literal>Runtime</literal> and <literal>Instances</literal> columns in the respective image row.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.obtain.additional.runtime.data">
<title>Obtain Additional Runtime Data</title>
<simpara>The following steps will help you find additional runtime data.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select to <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> , click the <literal>Details</literal> button on the right end of a row which has running instances.</simpara>
</listitem>
<listitem>
<simpara>Under the <literal>Overview</literal> tab, notice the data in <literal>Runtime</literal> and <literal>Instances</literal> fields under <literal>Image Info</literal> section.</simpara>
</listitem>
<listitem>
<simpara>Select the <literal>Runtime</literal> tab.</simpara>
</listitem>
<listitem>
<simpara>Here is a breakdown of the Kubernetes pods running this image in all the registered clusters including the following data:</simpara>
<itemizedlist>
<listitem>
<simpara>Pod name</simpara>
</listitem>
<listitem>
<simpara>Namespace which the pod resides in</simpara>
</listitem>
<listitem>
<simpara>The runtime status of the container in the specific pod.
Status icons are explained in the preceeding example.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="at.rebuild.a.previously.deployed.image.in.kubernetes">
<title>Rebuild a Previously Deployed Image in Kubernetes</title>
<simpara>The following steps will guide you through rebuilding an image which has been deployed to a Kubernetes cluster.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Go to <menuchoice><guimenu>Images</guimenu> <guimenuitem>Images</guimenuitem></menuchoice> , click the Details button on the right end of a row which has running instances.
The image must be manager-built.</simpara>
</listitem>
<listitem>
<simpara>Click the <literal>Rebuild</literal> button located under the <literal>Build Status</literal> section and wait for the build to finish.</simpara>
</listitem>
<listitem>
<simpara>Notice the change in the <literal>Runtime</literal> icon and title, reflecting the fact that now the instances are running a previous build of the image.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="at.role.based.access.control.permissions.and.certificate.data">
<title>Role Based Access Control Permissions and Certificate Data</title>
<important>
<simpara>Currently, only kubeconfig files containing all embedded certificate data may be used with SUSE Manager</simpara>
</important>
<simpara>The API calls from SUSE Manager are:</simpara>
<itemizedlist>
<listitem>
<simpara>GET /api/v1/pods</simpara>
</listitem>
<listitem>
<simpara>GET /api/v1/nodes</simpara>
</listitem>
</itemizedlist>
<simpara>According to this list, the minimum recommended permissions for SUSE Manager should be as follows:</simpara>
<itemizedlist>
<listitem>
<simpara>A ClusterRole to list all the nodes:</simpara>
<screen>resources: ["nodes"]
verbs: ["list"]</screen>
</listitem>
<listitem>
<simpara>A ClusterRole to list pods in all namespaces (role binding must not restrict the namespace):</simpara>
<screen>resources: ["pods"]
verbs: ["list"]</screen>
</listitem>
</itemizedlist>
<simpara>Due to a a 403 response from /pods, the entire cluster will be ignored by SUSE Manager.</simpara>
<simpara>For more information on working with RBAC Authorization see: <link xl:href="https://kubernetes.io/docs/admin/authorization/rbac/">https://kubernetes.io/docs/admin/authorization/rbac/</link></simpara>
</section>
</chapter>
<chapter xml:id="advanced.topics.cobbler">
<title>Cobbler</title>
<section xml:id="at.introduction.cobbler">
<title>Introduction</title>
<simpara>SUSE Manager features the Cobbler server, which allows administrators to centralize system installation and provisioning infrastructure.
Cobbler is an installation server that provides various methods of performing unattended system installations.
It can be used on server, workstation, or guest systems, in full or para-virtualized environments.</simpara>
<simpara>Cobbler offers several tools for pre-installation guidance, automated installation file management, installation environment management, and more.
This section explains some of the supported features of Cobbler, including:</simpara>
<itemizedlist>
<listitem>
<simpara>Installation environment analysis using the <literal role="command">cobbler check</literal> command</simpara>
</listitem>
<listitem>
<simpara>Multi-site installation server configuration using the <literal role="command">cobbler replicate</literal> command</simpara>
</listitem>
<listitem>
<simpara>Virtual machine guest installation automation with the <literal role="command">koan</literal> client-side tool</simpara>
</listitem>
<listitem>
<simpara>Building installation ISOs with PXE-like menus using the <literal role="command">cobbler buildiso</literal> command (for SUSE Manager systems with x86_64 architecture)</simpara>
</listitem>
</itemizedlist>
<simpara>For more detailed Cobbler documentation, see <link xl:href="http://cobbler.github.io/manuals/">http://cobbler.github.io/manuals/</link>.</simpara>
<important>
<title>Supported Cobbler Functions</title>
<simpara>SUSE only support those Cobbler functions that are either listed within our formal documentation or available via the web interface and API.</simpara>
</important>
</section>
<section xml:id="advanced.topics.cobbler.reqs">
<title>Cobbler Requirements</title>
<simpara>To use Cobbler for system installation with PXE, you will require a TFTP server. SUSE Manager installs a TFTP server by default.
To PXE boot systems, you will require a DHCP server, or have access to a network DHCP server. Edit the <literal role="path">/etc/dhcp.conf</literal> configuration file to change <literal role="option">next-server</literal> to the hostname or IP address of your Cobbler server.</simpara>
<important>
<title>Correct Hostname Configuration</title>
<simpara>Cobbler uses hostnames as a unique key for each system.
If you are using the <literal role="option">pxe-default-image</literal> to onboard bare metal systems, make sure every system has a unique hostname.
Non-unique hostnames will cause all systems with the same hostname to have the configuration filess overwritten when a provisioning profile is assigned.</simpara>
</important>
<section xml:id="advanced.topics.cobbler.reqs.settings">
<title>Configuring Cobbler with /etc/cobbler/settings</title>
<simpara>Cobbler configuration is primarily managed using the <literal role="path">/etc/cobbler/settings</literal> file.
Cobbler will run with the default settings unchanged.
All configurable settings are explained in detail in the <literal role="path">/etc/cobbler/settings</literal> file, including information on each setting, and recommendations.</simpara>
<note>
<title>Supported Languages</title>
<simpara>If SUSE Manager complains that language <literal>en</literal> was not found within the list of supported languages available at <literal role="path">/usr/share/YaST2/data/languages</literal>, remove the <literal role="option">lang</literal> parameter in the <literal role="path">/etc/cobbler/settings</literal> file, or add a valid parameter such as <literal>en_US</literal>.</simpara>
<simpara>For more on this topic, see <link xl:href="https://www.suse.com/support/kb/doc?id=7018334">https://www.suse.com/support/kb/doc?id=7018334</link>.</simpara>
</note>
</section>
<section xml:id="advanced.topics.cobbler.req.dhcp">
<title>Cobbler and DHCP</title>
<simpara>Cobbler uses DHCP to automate bare metal installations from a PXE boot server.
You must have administrative access to the network&#8217;s DHCP server, or be able to configure DHCP directly on the the Cobbler server.</simpara>
<section xml:id="advanced.topics.cobbler.reqs.dhcp.notmanaged">
<title>Configuring an Existing DHCP Server</title>
<simpara>If you have existing DHCP server, you will need to edit the DHCP configuration file so that it points to the Cobbler server and PXE boot image.</simpara>
<simpara>As root on the DHCP server, edit the <literal role="path">/etc/dhcpd.conf</literal> file and append a new class with options for performing PXE boot installation.
For example:</simpara>
<informalexample>
<screen>allow booting;
allow bootp; <co xml:id="CO1-1"/>
class "PXE" <co xml:id="CO1-2"/>
{match if substring(option vendor-class-identifier, 0, 9) = "PXEClient"; <co xml:id="CO1-3"/>
next-server 192.168.2.1; <co xml:id="CO1-4"/>
filename "pxelinux.0";} <co xml:id="CO1-5"/></screen>
<calloutlist>
<callout arearefs="CO1-1">
<para>Enable network booting with the <literal role="systemitem">bootp</literal> protocol.</para>
</callout>
<callout arearefs="CO1-2">
<para>Create a class called <literal>PXE</literal>.</para>
</callout>
<callout arearefs="CO1-3">
<para>A system configured to have PXE first in its boot priority identifies itself as <literal>PXEClient</literal>.</para>
</callout>
<callout arearefs="CO1-4">
<para>As a result, the DHCP server directs the system to the Cobbler server at <literal>192.168.2.1</literal>.</para>
</callout>
<callout arearefs="CO1-5">
<para>The DHCP server retrieves the <literal role="path">pxelinux.0</literal>bootloader file.</para>
</callout>
</calloutlist>
</informalexample>
</section>
<section xml:id="advanced.topics.cobbler.reqs.dhcp.kvm">
<title>Setting up PXE Boot in KVM</title>
<simpara>It is possible to set up PXE booting in KVM, however we do not recommend you use this method for production systems.
This method can replace the <literal role="guilabel">next-server</literal> setting on a DHCP server, as described in <xref linkend="advanced.topics.cobbler.reqs.dhcp.notmanaged"/>.
Edit the network XML description with <literal role="command">virsh</literal>:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Produce an XML dump of the current description:</simpara>
<screen>virsh net-dumpxml --inactive network &gt; network.xml</screen>
</listitem>
<listitem>
<simpara>Open the XML dump file at <literal role="path">network.xml</literal> with a text editor and add a <literal role="systemitem">bootp</literal> parameter within the <literal role="systemitem">&lt;dhcp&gt;</literal>` element:</simpara>
<screen>&lt;bootp file='/pxelinux.0' server='192.168.100.153'/&gt;</screen>
</listitem>
<listitem>
<simpara>Install the updated description:</simpara>
<screen>virsh net-define network.xml</screen>
</listitem>
</orderedlist>
<simpara>Alternatively, use the <literal role="command">net-edit</literal> subcommand, which will also perform some error checking.</simpara>
<example xml:id="at.cobbler.bootp.kvm">
<title>Minimal Network XML Description for KVM</title>
<screen>&lt;network&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;uuid&gt;1da84185-31b5-4c8b-9ee2-a7f5ba39a7ee&lt;/uuid&gt;
  &lt;forward mode='nat'&gt;
    &lt;nat&gt;
      &lt;port start='1024' end='65535'/&gt;
    &lt;/nat&gt;
  &lt;/forward&gt;
  &lt;bridge name='virbr0' stp='on' delay='0'/&gt;
  &lt;mac address='52:54:00:29:59:18'/&gt;
  &lt;domain name='default'/&gt;
  &lt;ip address='192.168.100.1' netmask='255.255.255.0'&gt;
    &lt;dhcp&gt;
      &lt;range start='192.168.100.128' end='192.168.100.254'/&gt;
      &lt;bootp file='/pxelinux.0' server='192.168.100.153'/&gt; <co xml:id="CO2-1"/>
&lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;</screen>
<calloutlist>
<callout arearefs="CO2-1">
<para><literal>bootp</literal> statement that directs to the PXE server.</para>
</callout>
</calloutlist>
</example>
</section>
</section>
<section xml:id="advanced.topics.cobbler.reqs.tftp">
<title>TFTP</title>
<simpara>SUSE Manager uses the <literal role="daemon">atftpd</literal> daemon, but it can also use TFTP.
The <literal role="daemon">atftpd</literal> daemon is the recommended method for PXE serviices, and is installed by default.
Usually, you do not have to change its configuration, but if you have to, use the YaST Services Manager.</simpara>
<simpara>Before TFTP can serve the <literal role="path">pxelinux.0</literal> boot image, you must start the tftp service.
Start YaST and use <menuchoice><guimenu>System</guimenu> <guimenuitem>Services Manager</guimenuitem></menuchoice> to configure the <literal role="daemon">tftpd</literal> daemon.</simpara>
</section>
<section xml:id="advanced.topics.cobbler.reqs.sync.tftp">
<title>Syncing TFTP Contents to SUSE Manager Proxies</title>
<simpara>It is possible to synchronize Cobbler-generated TFTP contents to SUSE Manager proxies to perform PXE booting using proxies.</simpara>
<section xml:id="_installation">
<title>Installation</title>
<simpara>On the SUSE Manager Server as the root user, install the <literal role="systemitem">susemanager-tftpsync</literal> package:</simpara>
<screen>zypper install susemanager-tftpsync</screen>
<simpara>On the SUSE Manager Proxy systems as the root user , install the <literal role="systemitem">susemanager-tftpsync-recv</literal> package:</simpara>
<screen>zypper install susemanager-tftpsync-recv</screen>
</section>
<section xml:id="_configuring_suse_manager_proxy">
<title>Configuring SUSE Manager Proxy</title>
<simpara>Execute <literal role="path">configure-tftpsync.sh</literal> on the SUSE Manager Proxy systems.</simpara>
<simpara>This setup script asks for hostnames and IP addresses of the SUSE Manager server and the proxy.
Additionally, it asks for the <literal>tftpboot</literal> directory on the proxy.
For more information, see the output of <literal role="command">configure-tftpsync.sh --help</literal>.</simpara>
</section>
<section xml:id="_configuring_suse_manager_server">
<title>Configuring SUSE Manager Server</title>
<simpara>As the root user, execute <literal role="path">configure-tftpsync.sh</literal> on SUSE Manager Server:</simpara>
<screen>configure-tftpsync.sh proxy1.example.com proxy2.example.com</screen>
<simpara>Execute <literal role="command">cobbler sync</literal> to initially push the files to the proxy systems.
This will succeed if all listed proxies are properly configured.</simpara>
<note>
<title>Changing the List of Proxy Systems</title>
<simpara>You can call <literal role="command">configure-tftpsync.sh</literal> to change the list of proxy systems.
You must always provide the full list of proxy systems.</simpara>
</note>
<note>
<title>Reinstalling a Configured Proxy</title>
<simpara>If you reinstall an already configured proxy and want to push all the files again you must remove the cache file at <literal role="path">/var/lib/cobbler/pxe_cache.json</literal> before you can call <literal role="command">cobbler sync</literal> again.</simpara>
</note>
</section>
<section xml:id="_requirements_2">
<title>Requirements</title>
<simpara>The SUSE Manager Server must be able to access the SUSE Manager Proxy systems directly.
You cannot push using a proxy.</simpara>
</section>
</section>
<section xml:id="advanced.topics.cobbler.reqs.service">
<title>Syncing and Starting the Cobbler Service</title>
<simpara>Before starting the Cobbler service, run a check to make sure that all the prerequisites are configured according to your requirements using the <literal role="command">cobbler check</literal> command.</simpara>
<simpara>If configuration is correct, start the SUSE Manager server with this command:</simpara>
<screen>/usr/sbin/spacewalk-service start</screen>
<warning>
<simpara>Do not start or stop the <literal role="command">cobblerd</literal> service independent of the SUSE Manager service.
Doing so may cause errors and other issues.</simpara>
<simpara>Always use <literal role="command">/usr/sbin/spacewalk-service</literal> to start or stop SUSE Manager.</simpara>
</warning>
</section>
</section>
<section xml:id="advanced.topics.cobbler.adddistro">
<title>Adding a Distribution to Cobbler</title>
<simpara>If all Cobbler prerequisites have been met and Cobbler is running, you can use the Cobbler server as an installation source for a distribution:</simpara>
<simpara>Make installation files such as the kernel image and the initrd image available on the Cobbler server.
Then add a distribution to Cobbler, using either the Web interface or the command line tools.</simpara>
<simpara>For information about creating and configuring AutoYaST or Kickstart distributions from the SUSE Manager interface, refer to <xref linkend="ref.webui.systems.autoinst.distribution"/>.</simpara>
<simpara>To create a distribution from the command line, use the <literal role="command">cobbler</literal> command as root:</simpara>
<screen>cobbler distro add --name=`string`--kernel=`path`--initrd=`path`</screen>
<variablelist>
<varlistentry>
<term><literal role="option">--name=</literal><literal role="replaceable">string</literal> option</term>
<listitem>
<simpara>A label used to differentiate one distribution choice from another (for example, <literal>sles12server</literal>).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--kernel=</literal><literal role="replaceable">path</literal> option</term>
<listitem>
<simpara>Specifies the path to the kernel image file.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--initrd=</literal><literal role="replaceable">path</literal> option</term>
<listitem>
<simpara>specifies the path to the initial ram disk (initrd) image file.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="advanced.topics.cobbler.addprofile">
<title>Adding a Profile to Cobbler</title>
<simpara>Once you have added a distribution to Cobbler, you can add profiles.</simpara>
<simpara>Cobbler profiles associate a distribution with additional options like AutoYaST or Kickstart files.
Profiles are the core unit of provisioning and there must be at least one Cobbler profile for every distribution added.
For example, two profiles might be created for a Web server and a desktop configuration.
While both profiles use the same distribution, the profiles are for different installation types.</simpara>
<simpara>For information about creating and configuring Kickstart and AutoYaST profiles in the SUSE Manager interface, refer to <xref linkend="ref.webui.systems.autoinst.profiles"/>.</simpara>
<simpara>Use the <literal role="command">cobbler</literal> command as root to create profiles from the command line:</simpara>
<screen>cobbler profile add --name=string --distro=string [--kickstart=url] \
  [--virt-file-size=gigabytes] [--virt-ram=megabytes]</screen>
<variablelist>
<varlistentry>
<term><literal role="option">--name=</literal><literal role="replaceable">string</literal></term>
<listitem>
<simpara>A unique label for the profile, such as <literal>sles12webserver</literal> or <literal>sles12workstation</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--distro=</literal><literal role="replaceable">string</literal></term>
<listitem>
<simpara>The distribution that will be used for this profile.
For adding distributions, see <xref linkend="advanced.topics.cobbler.adddistro"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--kickstart=</literal><literal role="replaceable">url</literal></term>
<listitem>
<simpara>The location of the Kickstart file (if available).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--virt-file-size=</literal><literal role="replaceable">gigabytes</literal></term>
<listitem>
<simpara>The size of the virtual guest file image (in gigabytes).
The default is 5&#160;GB.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--virt-ram=</literal><literal role="replaceable">megabytes</literal></term>
<listitem>
<simpara>The maximum amount of physical RAM a virtual guest can consume (in megabytes).
The default is 512&#160;MB.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="advanced.topics.cobbler.addsystem">
<title>Adding a System to Cobbler</title>
<simpara>Once the distributions and profiles for Cobbler have been created, add systems to Cobbler.
System records map a piece of hardware on a client with the Cobbler profile assigned to run on it.</simpara>
<note>
<simpara>If you are provisioning using <literal role="command">koan</literal> and PXE menus alone, it is not required to create system records.
They are useful when system-specific Kickstart templating is required or to establish that a specific system should always get specific content installed.
If a client is intended for a certain role, system records should be created for it.</simpara>
</note>
<simpara>For information about creating and configuring automated installation from the SUSE Manager interface, refer to <xref linkend="s4-sm-system-details-kick"/>.</simpara>
<simpara>Run this command as the root user to add a system to the Cobbler configuration:</simpara>
<screen>cobbler system add --name=string --profile=string \
  --mac-address=AA:BB:CC:DD:EE:FF</screen>
<variablelist>
<varlistentry>
<term><literal role="option">--name=</literal><literal role="replaceable">string</literal></term>
<listitem>
<simpara>A unique label for the system, such as <literal>engineering_server</literal> or <literal>frontoffice_workstation</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--profile=</literal><literal role="replaceable">string</literal></term>
<listitem>
<simpara>Specifies the name of one of the profiles added in <xref linkend="advanced.topics.cobbler.addprofile"/>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal role="option">--mac-address=</literal><literal role="replaceable">AA:BB:CC:DD:EE:FF</literal></term>
<listitem>
<simpara>Allows systems with the specified MAC address to automatically be provisioned to the profile associated with the system record when they are being installed.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>For more options, such as setting hostname or IP addresses, refer to the Cobbler manpage (<literal role="command">man cobbler</literal>).</simpara>
</section>
<section xml:id="advanced.topics.cobbler.templates">
<title>Using Cobbler Templates</title>
<simpara>The SUSE Manager web interface allows you to create variables for use with Kickstart distributions and profiles.
For more information on creating Kickstart profile variables, refer to <xref linkend="s4-sm-system-kick-details-variables"/>.</simpara>
<simpara>Kickstart variables are part of an infrastructure change in SUSE Manager to support templating in Kickstart files.
Kickstart templates are files that describe how to build Kickstart files, rather than creating specific Kickstarts.
The templates are shared by various profiles and systems that have their own variables and corresponding values.
These variables modify the templates and a template engine parses the template and variable data into a usable Kickstart file.
Cobbler uses an advanced template engine called Cheetah that provides support for templates, variables, and snippets.</simpara>
<simpara>Advantages of using templates include:</simpara>
<itemizedlist>
<listitem>
<simpara>Robust features that allow administrators to create and manage large amounts of profiles or systems without duplication of effort or manually creating Kickstarts for every unique situation.</simpara>
</listitem>
<listitem>
<simpara>While templates can become complex and involve loops, conditionals and other enhanced features and syntax, you can also create simpler Kickstart files without such complexity.</simpara>
</listitem>
</itemizedlist>
<section xml:id="advanced.topics.cobbler.templates.usage">
<title>Using Templates</title>
<simpara>Kickstart templates can have static values for certain common items such as PXE image file names, subnet addresses, and common paths such as <literal role="path">/etc/sysconfig/network-scripts/</literal>.
However, templates differ from standard Kickstart files in their use of variables.</simpara>
<simpara>For example, a standard Kickstart file may have a networking section similar to this:</simpara>
<screen>network --device=eth0 --bootproto=static --ip=192.168.100.24 \
  --netmask=255.255.255.0 --gateway=192.168.100.1 --nameserver=192.168.100.2</screen>
<simpara>In a Kickstart template file, the networking section would look like this instead:</simpara>
<screen>network --device=$net_dev --bootproto=static --ip=$ip_addr \
  --netmask=255.255.255.0 --gateway=$my_gateway --nameserver=$my_nameserver</screen>
<simpara>These variables are substituted with the values set in your Kickstart profile variables or in your system detail variables.
If the same variable is defined in both the profile and the system detail, then the system detail variable takes precedence.</simpara>
<note>
<simpara>The template for the autoinstallation has syntax rules which relies on punctuation symbols.
To avoid clashes, they need to be properly treated.</simpara>
</note>
<simpara>In case the autoinstallation scenario contains any shell script using variables like <literal>$(example)</literal>, its content should be escaped by using the backslash symbol: <literal>\$(example)</literal>.</simpara>
<simpara>If the variable named <literal>example</literal> is defined in the autoinstallation snippet, the templating engine will evaluate <literal>$example</literal> with its content.
If there is no such variable, the content will be left unchanged.
Escaping the <keycap>$</keycap> symbol will prevent the templating engine from evaluating the symbol as an internal variable.
Long scripts or strings can be escaped by wrapping them with the <literal>\#raw</literal> and <literal>\#end raw</literal> directives.
For example:</simpara>
<screen>#raw
#!/bin/bash
for i in {0..2}; do
 echo "$i - Hello World!"
done
#end raw</screen>
<simpara>Also, pay attention to scenarios like this:</simpara>
<screen>#start some section (this is a comment)
echo "Hello, world"
#end some section (this is a comment)</screen>
<simpara>Any line with a <keycap>#</keycap> symbol followed by a whitespace is treated as a comment and is therefore not evaluated.</simpara>
<simpara>For more information about Kickstart templates, refer to the Cobbler project page at:</simpara>
<simpara><link xl:href="https://fedorahosted.org/cobbler/wiki/KickstartTemplating">https://fedorahosted.org/cobbler/wiki/KickstartTemplating</link></simpara>
</section>
<section xml:id="advanced.topics.cobbler.templates.snippets">
<title>Kickstart Snippets</title>
<simpara>If you have common configurations across all Kickstart templates and profiles, you can use the Snippets feature of Cobbler to take advantage of code reuse.</simpara>
<simpara>Kickstart snippets are sections of Kickstart code that can be called by a <literal role="option">$SNIPPET()</literal> function that will be parsed by Cobbler and substituted with the contents of the snippet.</simpara>
<simpara>For example, you might have a common hard drive partition configuration for all servers, such as:</simpara>
<screen>clearpart --all
part /boot --fstype ext3 --size=150 --asprimary
part / --fstype ext3 --size=40000 --asprimary
part swap --recommended

part pv.00 --size=1 --grow

volgroup vg00 pv.00
logvol /var --name=var vgname=vg00 --fstype ext3 --size=5000</screen>
<simpara>Save this snippet of the configuration to a file like <literal role="path">my_partition</literal> and place the file in <literal role="path">/var/lib/cobbler/snippets/</literal>, where Cobbler can access it.</simpara>
<simpara>Use the snippet by calling the <literal role="option">$SNIPPET()</literal> function in your Kickstart templates.
For example:</simpara>
<screen>$SNIPPET('my_partition')</screen>
<simpara>Wherever you invoke that function, the Cheetah parser will substitute the function with the snippet of code contained in the <literal role="path">my_partition</literal> file.</simpara>
</section>
</section>
<section xml:id="advanced.topics.cobbler.koan">
<title>Using Koan</title>
<simpara>Whether you are provisioning guests on a virtual machine or reinstalling a new distribution on a running system, Koan works in conjunction with Cobbler to provision systems.</simpara>
<section xml:id="advanced.topics.cobbler.koan.virt">
<title>Using Koan to Provision Virtual Systems</title>
<simpara>If you have created a virtual machine profile as documented in <xref linkend="advanced.topics.cobbler.addprofile"/>, you can use <literal role="command">koan</literal> to initiate the installation of a virtual guest on a system.
For example, create a Cobbler profile with the following command:</simpara>
<screen>cobbler add profile --name=virtualfileserver \
  --distro=sles12-x86_64-server --virt-file-size=20 --virt-ram=1000</screen>
<simpara>This profile is for a fileserver running SUSE Linux Enterprise Server&#160;12 with a 20&#160;GB guest image size and allocated 1&#160;GB of system RAM.
To find the name of the virtual guest system profile, use the <literal role="command">koan</literal> command:</simpara>
<screen>koan --server=hostname --list-profiles</screen>
<simpara>This command lists all the available profiles created with <literal role="command">cobbler profile add</literal>.</simpara>
<simpara>Create the image file, and begin installation of the virtual guest system:</simpara>
<screen>koan --virt --server=cobbler-server.example.com \
  --profile=virtualfileserver --virtname=marketingfileserver</screen>
<simpara>This command specifies that a virtual guest system be created from the Cobbler server (hostname <literal role="server">cobbler-server.example.com</literal>) using the <literal>virtualfileserver</literal> profile.
The <literal role="option">virtname</literal> option specifies a label for the virtual guest, which by default is the system&#8217;s MAC address.</simpara>
<simpara>Once the installation of the virtual guest is complete, it can be used as any other virtual guest system.</simpara>
</section>
<section xml:id="advanced.topics.cobbler.koan.reinstall">
<title>Using Koan to Reinstall Running Systems</title>
<simpara><literal role="command">koan</literal> can replace a still running system with a new installation from the available Cobbler profiles by executing the following command <emphasis>on the system to be reinstalled</emphasis>:</simpara>
<screen>koan --replace-self --server=hostname --profile=name</screen>
<simpara>This command, running on the system to be replaced, will start the provisioning process and replace the system with the profile in <literal role="option">--profile=name</literal> on the Cobbler server specified in <literal role="option">--server=hostname</literal>.</simpara>
</section>
</section>
<section xml:id="advanced.topics.cobbler.buildiso">
<title>Building ISOs with Cobbler</title>
<simpara>Some environments might lack PXE support.
The Cobbler <literal role="command">buildiso</literal> command creates a ISO boot image containing a set of distributions and kernels, and a menu similar to PXE network installations.
Define the name and output location of the boot ISO using the <literal role="option">--iso</literal> option.</simpara>
<note>
<title>ISO Build Directory</title>
<simpara>Depending on Cobbler-related systemd settings (see <literal role="path">/usr/lib/systemd/system/cobblerd.service</literal>) writing ISO images to public <literal role="path">tmp</literal> directories will not work.</simpara>
</note>
<screen>cobbler buildiso --iso=/path/to/boot.iso</screen>
<simpara>The boot ISO includes all profiles and systems by default.
Limit these profiles and systems using the <literal role="option">--profiles</literal> and <literal role="option">--systems</literal> options.</simpara>
<screen>cobbler buildiso --systems="system1,system2,system3" \
  --profiles="profile1,profile2,profile3"</screen>
<note>
<simpara>Building ISOs with the <literal role="command">cobbler buildiso</literal> command is supported for all architectures except the z Systems architecture.</simpara>
</note>
</section>
<section xml:id="advanced.topics.cobbler.baremetal">
<title>Bare Metal Provisioning</title>
<simpara>Systems that have not yet been provisioned are called bare metal systems.
You can provision bare metal systems using Cobbler.
Once a bare metal system has been provisioned in this way, it will appear in the <literal role="guilabel">Systems</literal> list, where you can perform regular provisioning with autoinstallation, for a completely unattended installation.</simpara>
<section xml:id="advanced.topics.cobbler.baremetal.requirements">
<title>Bare Metal Provisioning System Requirements</title>
<simpara>To successfully provision a bare metal system, you will require a fully patched SUSE Manager server, version 2.1 or higher.</simpara>
<simpara>The system to be provisioned must have x86_64 architecture, with at least 1&#160;GB RAM, and be capable of PXE booting.</simpara>
<simpara>The server uses TFTP to provision the bare metal client, so the appropriate port and networks must be configured correctly in order for provisioning to be successful. In particular, ensure that you have a DHCP server, and have set the <literal role="option">next-server</literal> parameter to the SUSE Manager server IP address or hostname.</simpara>
</section>
<section xml:id="advanced.topics.cobbler.baremetal.enabling">
<title>Enabling Bare Metal Systems Management</title>
<simpara>Bare metal systems management can be enabled or disabled in the Web UI by clicking <menuchoice><guimenu>Admin</guimenu> <guisubmenu>SUSE Manager Configuration</guisubmenu> <guimenuitem>Bare-metal systems</guimenuitem></menuchoice>.</simpara>
<note>
<simpara>New systems are added to the organization of the administrator who enabled the bare metal systems management feature. To change the organization, log in as an Administrator of the required organization, and re-enable the feature.</simpara>
</note>
<simpara>Once the feature has been enabled, any bare metal system connected to the server network will be automatically added to the organization when it is powered on.
The process can take a few minutes, and the system will automatically shut down once it is complete.
After the reboot, the system will appear in the <literal role="guilabel">Systems</literal> list.
Click on the name of the system to see basic information, or go to the <literal role="guilabel">Properties</literal>, <literal role="guilabel">Notes</literal>, and <literal role="guilabel">Hardware</literal> tabs for more details.
You can migrate bare metal systems to other organizations if required, using the <literal role="guilabel">Migrate</literal> tab.</simpara>
</section>
<section xml:id="advanced.topics.cobbler.baremetal.provisioning">
<title>Provisioning Bare Metal Systems</title>
<simpara>Provisioning bare metal systems is similar to provisioning other systems, and can be done using the <literal role="guilabel">Provisioning</literal> tab.
However, you will not be able to schedule provisioning, it will happen automatically as soon as the system is configured and powered on.</simpara>
<note>
<title>Bare Metal and System Set Manager</title>
<simpara>System Set Manager can be used with bare metal systems, although not all features will be available, because bare metal systems do not have an operating system installed.
This limitation also applies to mixed sets that contain bare metal systems; all features will be re-enabled if the bare metal systems are removed from the set.</simpara>
</note>
</section>
<section xml:id="advanced.topics.cobbler.baremetal.troubleshooting">
<title>Troubleshooting Bare Metal Systems</title>
<simpara>If a bare metal system on the network is not automatically added to the <literal role="guilabel">Systems</literal> list, check these things first:</simpara>
<itemizedlist>
<listitem>
<simpara>You must have the <literal role="path">pxe-default-image</literal> package installed.</simpara>
</listitem>
<listitem>
<simpara>File paths and parameters must be configured correctly. Check that the <literal role="path">vmlinuz0</literal> and <literal role="path">initrd0.img</literal> files, which are provided by <literal role="path">pxe-default-image</literal>, are in the locations specified in the <literal role="path">rhn.conf</literal> configuration file.</simpara>
</listitem>
<listitem>
<simpara>Ensure the networking equipment connecting the bare metal system to the SUSE Manager server is working correctly, and that you can reach the SUSE Manager server IP address from the server.</simpara>
</listitem>
<listitem>
<simpara>The bare metal system to be provisioned must have PXE booting enabled in the boot sequence, and must not be attempting to boot an operating system.</simpara>
</listitem>
<listitem>
<simpara>The DHCP server must be responding to DHCP requests during boot. Check the PXE boot messages to ensure that:</simpara>
<itemizedlist>
<listitem>
<simpara>the DHCP server is assigning the expected IP address</simpara>
</listitem>
<listitem>
<simpara>the DHCP server is assigning the the SUSE Manager server IP address as <literal role="option">next-server</literal> for booting.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Ensure Cobbler is running, and that the Discovery feature is enabled.</simpara>
</listitem>
</itemizedlist>
<simpara>If you see a blue Cobbler menu shortly after booting, discovery has started.
If it does not complete successfully, temporarily disable automatic shutdown in order to help diagnose the problem. To disable automatic shutdown:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Select <literal role="option">pxe-default-profile</literal> in the Cobbler menu with the arrow keys, and press the Tab key before the timer expires.</simpara>
</listitem>
<listitem>
<simpara>Add the kernel boot parameter <literal role="option">spacewalk-finally=running</literal> using the integrated editor, and press Enter to continue booting.</simpara>
</listitem>
<listitem>
<simpara>Enter a shell with the username <literal role="option">root</literal> and password <literal role="option">linux</literal> to continue debugging.</simpara>
</listitem>
</orderedlist>
<important>
<title>Duplicate profiles</title>
<simpara>Due to a technical limitation, it is not possible to reliably distinguish a new bare metal system from a system that has previously been discovered.
Therefore, we recommended that you do not power on bare metal systems multiple times, as this will result in duplicate profiles.</simpara>
</important>
</section>
</section>
</chapter>
<chapter xml:id="advanced.topics.virtualization">
<title>Virtualization</title>
<simpara>SUSE Manager allows you to autoinstall and manage Xen and KVMVM Guests on a registered VM Host Server.
To autoinstall a VM Guest, an autoinstallable distribution and an autoinstallation profile (AutoYaST or {kickstart}) need to exist on SUSE Manager.
VM Guests registered with SUSE Manager can be managed like <quote>regular</quote> machines.
In addition, basic VM Guestmanagement tasks such as (re)starting and stopping or changing processor and memory allocation can be carried out using SUSE Manager.</simpara>
<simpara>The following documentation is valid in the context of traditional clients.
Salt minions must be treated differently:</simpara>
<itemizedlist>
<listitem>
<simpara>Autoinstallation is still not supported and libvirt hosts are supported as read-only.</simpara>
</listitem>
</itemizedlist>
<warning>
<title>Limitation to Xen and KVM Guests</title>
<simpara>Autoinstalling and managing VM Guests via SUSE Manager is limited to Xen and KVM guests.
SUSE Manager uses <literal role="library">libvirt</literal> for virtual machine management.
Currently, virtual machines from other virtualization solutions such as VMware* or VirtualBox*, are recognized as VM Guests, but cannot be managed from within SUSE Manager.</simpara>
</warning>
<section xml:id="sec.virtualization.autoinstall">
<title>Autoinstalling VM Guest s</title>
<simpara>With SUSE Manager you can automatically deploy Xen and KVM VM Guests using AutoYaST or {kickstart} profiles.
It is also possible to automatically register the VM Guests, so they can immediately be managed by SUSE Manager.</simpara>
<section xml:id="sec.virtualization.autoinstall.req_mgr">
<title>Requirements on SUSE Manager</title>
<simpara>Setting up and managing VM Guest
s with SUSE Manager
does not require special configuration options.
However, you need to provide activation keys for the VM Host Server
and the VM Guest
s, an autoinstallable distribution and an autoinstallation profile.
To automatically register VM Guest
s with SUSE Manager
, a bootstrap script is needed.</simpara>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.keys">
<title>Activation Keys</title>
<simpara>Just like any other client, VM Host Server
and VM Guest
s need to be registered with SUSE Manager
using activation keys.
Find details on how to set up activation keys at <xref linkend="create.act.keys"/>.
While there are no special requirements for a VM Guest
 key, at least the following requirements must be met for the VM Host Server
 activation key.</simpara>
<itemizedlist>
<title>VM Host ServerActivation Key: Minimum Requirements</title>
<listitem>
<simpara>Entitlements: Provisioning, Virtualization Platform.</simpara>
</listitem>
<listitem>
<simpara>Packages: <literal role="resource">rhn-virtualization-host</literal> , <literal role="resource">osad</literal> .</simpara>
<simpara>If you want to manage the VM Host Server
system from SUSE Manager
(e.g.
by executing remote scripts), the package <literal role="resource">rhncfg-actions</literal>
needs to be installed as well.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.inst-source">
<title>Setting up an Autoinstallable Distribution</title>
<simpara>To autoinstall clients from SUSE Manager
, you need to provide an <quote>autoinstallable distribution</quote>
, also referred to as autoinstallable tree or installation source.
This installation source needs to be made available through the file system of the SUSE Manager
 host.
It can for example be a mounted local or remote directory or a <quote>loop-mounted</quote>
 ISO image.
It must match the following requirements:</simpara>
<itemizedlist>
<listitem>
<simpara>Kernel and initrd location:</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>RedHat / Generic RPM</title>
<listitem>
<simpara>images/pxeboot/vmlinuz</simpara>
</listitem>
<listitem>
<simpara>images/pxeboot/initrd.img</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>SUSE</title>
<listitem>
<simpara>boot/<literal role="replaceable">arch</literal>/loader/initrd</simpara>
</listitem>
<listitem>
<simpara>boot/<literal role="replaceable">arch</literal>/loader/linux</simpara>
<itemizedlist>
<listitem>
<simpara>The <guimenu>Base Channel</guimenu> needs to match the autoinstallable distribution.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<important>
<title>Autoinstallation package sources</title>
<simpara>There is a fundamental difference between RedHat and SUSE
systems regarding the package sources for autoinstallation.
The packages for a RedHat installation are being fetched from the <guimenu>Base Channel</guimenu>
.
Packages for installing SUSE
 systems are being fetched from the autoinstallable distribution.</simpara>
<simpara>As a consequence, the autoinstallable distribution for a SUSE
system has to be a complete installation source (same as for a regular installation).</simpara>
</important>
<orderedlist numeration="arabic">
<title>Procedure: Creating Autoinstallable Distribution</title>
<listitem>
<simpara>Make sure an installation source is available from a local directory. The data source can be any kind of network resource, a local directory or an ISO image (which has to be <quote>loop-mounted</quote> ). Files and directories must be world readable.</simpara>
</listitem>
<listitem>
<simpara>Log in to the SUSE Manager Web UI} and navigate to <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guisubmenu>Distributions</guisubmenu> <guimenuitem>Create Distribution</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>Fill out the form <guimenu>Create Autoinstallable Distribution</guimenu> as follows:</simpara>
<variablelist>
<varlistentry>
<term><guimenu>Distribution Label</guimenu></term>
<listitem>
<simpara>Choose a unique name for the distribution.
Only letters, numbers, hyphens, periods, and underscores are allowed; the minimum length is 4 characters.
This field is mandatory.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Tree Path</guimenu></term>
<listitem>
<simpara>Absolute local disk path to installation source.
This field is mandatory.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Base Channel</guimenu></term>
<listitem>
<simpara>Channel matching the installation source.
This channel is the package source for non-SUSE
installations.
This field is mandatory.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Installer Generation</guimenu></term>
<listitem>
<simpara>Operating system version matching the installation source.
This field is mandatory.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Kernel Options</guimenu></term>
<listitem>
<simpara>Options passed to the kernel when booting for the installation.
There is no need to specify the <literal role="option">install=</literal> parameter since it will automatically be added.
Moreover, the parameters <literal role="option">self_update=0 pt.options=self_update</literal> are added automatically to prevent AutoYaST from updating itself during the system installation.
This field is optional.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><guimenu>Post Kernel Options</guimenu></term>
<listitem>
<simpara>Options passed to the kernel when booting the installed system for the first time.
This field is optional.</simpara>
</listitem>
</varlistentry>
</variablelist>
</listitem>
<listitem>
<simpara>Save your settings by clicking <guimenu>Create Autoinstallable Distribution</guimenu> .</simpara>
</listitem>
</orderedlist>
<simpara>To edit an existing <menuchoice><guimenu>Autoinstallable Distribution</guimenu> <guisubmenu>]
, go to menu:Systems[Autoinstallation</guisubmenu> <guimenuitem>Distributions</guimenuitem></menuchoice>
 and click on a <menuchoice><guimenu>Label</guimenu> <guimenuitem>]
.
Make the desired changes and save your settings by clicking menu:Update Autoinstallable Distribution[</guimenuitem></menuchoice>
.</simpara>
</section>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.profile">
<title>Providing an Autoinstallation Profile</title>
<simpara>Autoinstallation profiles (AutoYaST
or {kickstart}
files) contain all the installation and configuration data needed to install a system without user intervention.
They may also contain scripts that will be executed after the installation has completed.</simpara>
<simpara>All profiles can be uploaded to SUSE Manager
and be edited afterwards.
Kickstart profiles can also be created from scratch with SUSE Manager
.</simpara>
<simpara>A minimalist AutoYaST
profile including a script for registering the client with SUSE Manager
is listed in
<xref linkend="advanced.topics.app.ay.example-simple"/>.
For more information, examples and HOWTOs on AutoYaST
 profiles, refer to <emphasis><phrase role="ref">SUSE Linux Enterprise AutoYaST</phrase></emphasis>
 (<link xl:href="https://www.suse.com/documentation/sles-12/book_autoyast/data/book_autoyast.html">https://www.suse.com/documentation/sles-12/book_autoyast/data/book_autoyast.html</link>). For more information on {kickstart}
 profiles, refer to your RedHat documentation.</simpara>
</section>
<section xml:id="_suse_linux_enterprise_15_systems">
<title>SUSE Linux Enterprise 15 Systems</title>
<simpara>You need the installation media to setup the distribution.  Starting with version 15, there is only one installation media.  You will use the same one for SLES, SLED, and all the other SUSE Linux Enterprise 15 based products.</simpara>
<simpara>In the AutoYaST profile specify which product is to be installed.
For installing SUSE Linux Enterprise Server use the following snippet in <literal role="path">autoyast.xml</literal>:</simpara>
<screen>&lt;products config:type="list"&gt;
  &lt;listentry&gt;SLES&lt;/listentry&gt;
&lt;/products&gt;</screen>
<simpara>Then then specify all the required modules as <literal>add-on</literal> in <literal role="path">autoyast.xml</literal>. This is a minimal <literal>SLE-Product-SLES15-Pool</literal> selection that will result in a working
installation and can be managed by SUSE Manager:</simpara>
<itemizedlist>
<listitem>
<simpara>SLE-Manager-Tools15-Pool</simpara>
</listitem>
<listitem>
<simpara>SLE-Manager-Tools15-Updates</simpara>
</listitem>
<listitem>
<simpara>SLE-Module-Basesystem15-Pool</simpara>
</listitem>
<listitem>
<simpara>SLE-Module-Basesystem15-Updates</simpara>
</listitem>
<listitem>
<simpara>SLE-Product-SLES15-Updates</simpara>
</listitem>
</itemizedlist>
<simpara>It is also recommended to add the following modules:</simpara>
<itemizedlist>
<listitem>
<simpara>SLE-Module-Server-Applications15-Pool</simpara>
</listitem>
<listitem>
<simpara>SLE-Module-Server-Applications15-Updates</simpara>
</listitem>
</itemizedlist>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.profile.upload">
<title>Uploading an Autoinstallation Profile</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>Log in to the SUSE Manager Web interface and open <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guisubmenu>Profiles</guisubmenu> <guimenuitem>Upload New Kickstart/AutoYaST File</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>Choose a unique name for the profile. Only letters, numbers, hyphens, periods, and underscores are allowed; the minimum length is 6 characters. This field is mandatory.</simpara>
</listitem>
<listitem>
<simpara>Choose an <menuchoice><guimenu>Autoinstallable Tree</guimenu> <guimenuitem>] from the drop-down menu. If no menu:Autoinstallable Tree[</guimenuitem></menuchoice> is available, you need to add an Autoinstallable Distribution. Refer to <xref linkend="sec.virtualzation.autoinstall.req-mgr.inst-source"/> for instructions.</simpara>
</listitem>
<listitem>
<simpara>Choose a <menuchoice><guimenu>Virtualization Type</guimenu> <guimenuitem>] from the drop-down menu. KVM and Xen (para-virtualized and fully-virtualized) are available. Do not choose menu:Xen Virtualized Host[</guimenuitem></menuchoice> here.</simpara>
</listitem>
<listitem>
<simpara>Scroll down to the <menuchoice><guimenu>File to Upload</guimenu> <guisubmenu>] dialog</guisubmenu> <guimenuitem>click menu:Browse[</guimenuitem></menuchoice> to select it, then click <guimenu>Upload File</guimenu> .</simpara>
</listitem>
<listitem>
<simpara>The uploaded file will be displayed in the <guimenu>File Contents</guimenu> section, where you can edit it.</simpara>
</listitem>
<listitem>
<simpara>Click <guimenu>Create</guimenu> to store the profile.</simpara>
</listitem>
</orderedlist>
<simpara>To edit an existing profile, go to <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice>
 and click on a <menuchoice><guimenu>Label</guimenu> <guimenuitem>]
.
Make the desired changes and save your settings by clicking menu:Create[</guimenuitem></menuchoice>
.</simpara>
<note>
<title>Editing existing {kickstart}profiles</title>
<simpara>If you are changing the <menuchoice><guimenu>Virtualization Type</guimenu> <guisubmenu>]
 of an existing {kickstart}
 profile</guisubmenu> <guisubmenu>it may also modify the bootloader and partition options</guisubmenu> <guimenuitem>potentially overwriting any user customizations.
Be sure to review the menu:Partitioning[</guimenuitem></menuchoice>
 tab to verify these settings when changing the <guimenu>Virtualization Type</guimenu>
.</simpara>
</note>
</section>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.profile.generate">
<title>Creating a Kickstart Profile</title>
<note>
<simpara>Currently it is only possible to create autoinstallation profiles for RHEL systems.
If installing a SUSE Linux Enterprise Server
system, you need to upload an existing AutoYaST
profile as described in <xref linkend="sec.virtualzation.autoinstall.req-mgr.profile.upload"/>.</simpara>
</note>
<orderedlist xml:id="pro.at.virtualzation.autoinstall.ks.profile.generate" numeration="arabic">
<listitem>
<simpara>Log in to the SUSE Manager Web interface and go to <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guisubmenu>Profiles</guisubmenu> <guimenuitem>Create New Kickstart File</guimenuitem></menuchoice> .</simpara>
</listitem>
<listitem>
<simpara>Choose a unique name for the profile. The minimum length is 6 characters. This field is mandatory.</simpara>
</listitem>
<listitem>
<simpara>Choose a <menuchoice><guimenu>Base Channel</guimenu> <guimenuitem>] . This channel is the package source for non-SUSE installations and must match the menu:Autoinstallable Tree[</guimenuitem></menuchoice> . This field is mandatory.</simpara>
</listitem>
<listitem>
<simpara>Choose an <menuchoice><guimenu>Autoinstallable Tree</guimenu> <guimenuitem>] from the drop-down menu. If no menu:Autoinstallable Tree[</guimenuitem></menuchoice> is available, you need to add an Autoinstallable Distribution. Refer to <xref linkend="sec.virtualzation.autoinstall.req-mgr.inst-source"/> for instructions.</simpara>
</listitem>
<listitem>
<simpara>Choose a <menuchoice><guimenu>Virtualization Type</guimenu> <guimenuitem>] from the drop-down menu. KVM and Xen (para-virtualized and fully-virtualized) are available. Do not choose menu:Xen Virtualized Host[</guimenuitem></menuchoice> here.</simpara>
</listitem>
<listitem>
<simpara>Click the <guimenu>Next</guimenu> button.</simpara>
</listitem>
<listitem>
<simpara>Select the location of the distribution files for the installation of your VM Guest s. There should already be a <menuchoice><guimenu>Default Download Location</guimenu> <guimenuitem>] filled out and selected for you on this screen. Click the menu:Next[</guimenuitem></menuchoice> button.</simpara>
</listitem>
<listitem>
<simpara>Choose a root password for the VM Guest s. Click the <guimenu>Finish</guimenu> button to generate the profile.</simpara>
<simpara>This completes {kickstart} profile creation.
After generating a profile, you are taken to the newly-created {kickstart} profile.
You may browse through the various tabs of the profile and modify the settings as you see fit, but this is not necessary as the default settings should work well for the majority of cases.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="sec.virtualzation.autoinstall.req-mgr.profile.scripts">
<title>Adding a Registration Script to the Autoinstallation Profile</title>
<simpara>A VM Guest
that is autoinstalled does not get automatically registered.
Adding a section to the autoinstallation profile that invokes a bootstrap script for registration will fix this.
The following procedure describes adding a corresponding section to an AutoYaST
profile.
Refer to your RedHat Enterprise Linux documentation for instructions on adding scripts to a {kickstart}
file.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>First, provide a bootstrap script on the SUSE Manager :</simpara>
<itemizedlist>
<listitem>
<simpara>Create a bootstrap script for VM Guest s on the SUSE Manager as described in <xref linkend="generate.bootstrap.script"/>.</simpara>
</listitem>
<listitem>
<simpara>Log in as root to the konsole of SUSE Manager and go to <literal role="path">/srv/www/htdocs/pub/bootstrap</literal> . Copy <literal role="path">bootstrap.sh</literal> (the bootstrap script created in the previous step) to e.g. <literal role="path">bootstrap_vm_guests.sh</literal> in the same directory.</simpara>
</listitem>
<listitem>
<simpara>Edit the newly created file according to your needs. The minimal requirement is to include the activation key for the VM Guest s (see <xref linkend="sec.virtualzation.autoinstall.req-mgr.keys"/> for details). We strongly recommend to also include one or more GPG keys (for example, your organization key and package signing keys).</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Log in to the SUSE Manager Web interface and go to <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guimenuitem>Profiles</guimenuitem></menuchoice> . Click on the profile that is to be used for autoinstalling the VM Guest s to open it for editing.</simpara>
<simpara>Scroll down to the <guimenu>File Contents</guimenu>
section where you can edit the AutoYaST
XML file.
Add the following snippet at the end of the XML file right before the closing <literal>&lt;/profile&gt;</literal> tag and replace the given IP address with the address of the SUSE Manager
server.
See <xref linkend="advanced.topics.app.ay.example-simple"/>for an example script.</simpara>
<screen>&lt;scripts&gt;
  &lt;init-scripts config:type="list"&gt;
    &lt;script&gt;
      &lt;interpreter&gt;shell &lt;/interpreter&gt;
      &lt;location&gt;
        http://`192.168.1.1`/pub/bootstrap/bootstrap_vm_guests.sh
      &lt;/location&gt;
    &lt;/script&gt;
  &lt;/init-scripts&gt;
&lt;/scripts&gt;</screen>
<important>
<title>Only one <literal>&lt;scripts&gt;</literal> section allowed</title>
<simpara>If your AutoYaST
profile already contains a <literal>&lt;scripts&gt;</literal> section, do not add a second one, but rather place the <literal>&lt;script&gt;</literal> part above within the existing <literal>&lt;scripts&gt;</literal> section!</simpara>
</important>
</listitem>
<listitem>
<simpara>Click <guimenu>Update</guimenu> to save the changes.</simpara>
</listitem>
</orderedlist>
</section>
</section>
</section>
<section xml:id="sec.virtualization.autoinstall.req_vmhost">
<title>VM Host Server Setup</title>
<simpara>A VM Host Server
system serving as a target for autoinstalling VM Guest
s from SUSE Manager
must be capable of running guest operating systems.
This requires either KVM
or Xen
being properly set up.
For installation instructions for SUSE Linux Enterprise Server
systems refer to the <emphasis><phrase role="ref">SLES Virtualization Guide</phrase></emphasis>
 available from <link xl:href="https://www.suse.com/documentation/sles-12/book_virt/data/book_virt.html">https://www.suse.com/documentation/sles-12/book_virt/data/book_virt.html</link>.
For instructions on setting up a RedHat VM Host Server
 refer to your RedHat Enterprise Linux documentation.</simpara>
<simpara>Since SUSE Manager
uses <literal role="library">libvirt</literal>
 for VM Guest
 installation and management, the <literal role="daemon">libvirtd</literal>
 needs to run on the VM Host Server
.
The default <literal role="library">libvirt</literal>
 configuration is sufficient to install and manage VM Guest
s from SUSE Manager
.
However, in case you want to access the VNC console of a VM Guest
 as a non-root
 user, you need to configure <literal role="library">libvirt</literal>
 appropriately.
Configuration instructions for <literal role="library">libvirt</literal>
 on SUSE Linux Enterprise Server
 are available in the <emphasis><phrase role="ref">SLES Virtualization
    Guide</phrase></emphasis>
 available from <link xl:href="https://www.suse.com/documentation/sles-12/book_virt/data/book_virt.html">https://www.suse.com/documentation/sles-12/book_virt/data/book_virt.html</link> available from <link xl:href="http://www.suse.com/documentation/sles11/">http://www.suse.com/documentation/sles11/</link>.
For instructions for a RedHat VM Host Server
 refer to your RedHat Enterprise Linux documentation.</simpara>
<simpara>Apart from being able to serve as a host for KVM
or Xen
guests, which are managed by <literal role="library">libvirt</literal>
, a VM Host Server
 must be registered with SUSE Manager
.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Make sure either KVM or Xen is properly set up.</simpara>
</listitem>
<listitem>
<simpara>Make sure the <literal role="daemon">libvirtd</literal> is running.</simpara>
</listitem>
<listitem>
<simpara>Register the VM Host Server with SUSE Manager :</simpara>
<itemizedlist>
<listitem>
<simpara>Create a bootstrap script on the SUSE Manager as described in <xref linkend="generate.bootstrap.script"/>.</simpara>
</listitem>
<listitem>
<simpara>Download the bootstrap script from <literal>susemanager.example.com/pub/bootstrap/bootstrap.sh</literal> to the VM Host Server .</simpara>
</listitem>
<listitem>
<simpara>Edit the bootstrap script according to your needs. The minimal requirement is to include the activation key for the VM Host Server (see <xref linkend="sec.virtualzation.autoinstall.req-mgr.keys"/> for details). We strongly recommend to also include one or more GPG keys (for example, your organization key and package signing keys).</simpara>
</listitem>
<listitem>
<simpara>Execute the bootstrap script to register the VM Host Server .</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<section xml:id="sec.virtualization.autoinstall.req_vmhost.salt">
<title>VM Host Server setup on Salt clients</title>
<simpara>If the VM Host Server is registered as a Salt minion, a final configuration step is needed in order to gather all the guest VMs defined on the VM Host Server:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>From the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Properties</guimenuitem></menuchoice> page, enable the <literal role="guimenu">Add-on System Type</literal> <literal>Virtualization Host</literal> and confirm with <guibutton>Update Properties</guibutton>.</simpara>
</listitem>
<listitem>
<simpara>Schedule a Hardware Refresh. On the <menuchoice><guimenu>System Details</guimenu> <guimenuitem>Hardware</guimenuitem></menuchoice> page click <guibutton>Schedule Hardware Refresh</guibutton>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="sec.virtualization.autoinstall.req_vmhost.traditional">
<title>VM Host Server setup on Traditional clients</title>
<simpara>When the registration process is finished and all packages have been installed, enable the <literal role="daemon">osad</literal> (Open Source Architecture Daemon).
On SUSE Linux Enterprise Server 12 systems and later, it can be achieved by running the following commands as user root:</simpara>
<screen>service rhnsd stop
service rhnsd disable</screen>
<screen>service osad enable
service osad start</screen>
<important>
<title><literal role="systemitem">osad</literal>Together with <literal role="systemitem">rhnsd</literal></title>
<simpara><literal role="systemitem">rhnsd</literal> daemon checks for scheduled actions every four hours, so it can take up to four hours before a scheduled action is carried out.
If many clients are registered with SUSE Manager, this long interval ensures a certain level of load balancing since not all clients act on a scheduled action at the same time.</simpara>
</important>
<simpara>For setting the time interval, see &lt;&lt;[[bp.systems.management&gt;&gt;.</simpara>
<simpara>However, when managing VM Guests, you usually want actions like rebooting a VM Guest to be carried out immediately, which can be done by adding <literal role="systemitem">osad</literal>.
The <literal role="systemitem">osad</literal> daemon receives commands over the jabber protocol from SUSE Manager and commands are instantly executed.
Alternatively you may schedule actions to be carried out at a fixed time in the future (whereas with <literal role="systemitem">rhnsd</literal> you can only schedule for a time in the future plus up to four hours).</simpara>
</section>
</section>
<section xml:id="sec.virtualization.autoinstall.installation">
<title>Autoinstalling VM Guest s</title>
<simpara>When all requirements on the SUSE Manager and the VM Host Server are met, you can start to autoinstall VM Guests on the host.
Note that VM Guests will not be automatically registered with SUSE Manager, therefore we strongly recommend to modify the autoinstallation profile as described in <xref linkend="sec.virtualzation.autoinstall.req-mgr.profile.scripts"/>. VM Guests need to be registered to manage them with SUSE Manager.
Proceed as follows to autoinstall a VM Guest:</simpara>
<important>
<title>No parallel Autoinstallations on VM Host Server</title>
<simpara>It is not possible to install more than one VM Guest
at a time on a single VM Host Server.
When scheduling more than one autoinstallation with SUSE Manager
make sure to choose a timing, that starts the next installation after the previous one has finished.
If a guest installation starts while another one is still running, the running installation will be cancelled.</simpara>
</important>
<orderedlist numeration="arabic">
<listitem>
<simpara>Log in to the SUSE Manager Web interface and click the <guimenu>Systems</guimenu> tab.</simpara>
</listitem>
<listitem>
<simpara>Click the VM Host Server 's name to open its <guimenu>System Status</guimenu> page.</simpara>
</listitem>
<listitem>
<simpara>Open the form for creating a new VM Guest by clicking <menuchoice><guimenu>Virtualization</guimenu> <guimenuitem>Provisioning</guimenuitem></menuchoice> . Fill out the form by choosing an autoinstallation profile and by specifying a name for the VM Guest (must not already exist on VM Host Server ). Choose a proxy if applicable and enter a schedule. To change the VM Guest 's hardware profile and configuration options, click <guimenu>Advanced Options</guimenu> .</simpara>
</listitem>
<listitem>
<simpara>Finish the configuration by clicking <menuchoice><guimenu>Schedule Autoinstallation and Finish</guimenu> <guimenuitem>] . The menu:Session Status[</guimenuitem></menuchoice> page opens for you to monitor the autoinstallation process.</simpara>
</listitem>
</orderedlist>
<note>
<title>Checking the Installation Log</title>
<simpara>To view the installation log, click <menuchoice><guimenu>Events</guimenu> <guimenuitem>History</guimenuitem></menuchoice>
 on the <menuchoice><guimenu>Session Status</guimenu> <guimenuitem>]
 page.
On the menu:System History Event[</guimenuitem></menuchoice>
 page you can click a <guimenu>Summary</guimenu>
 entry to view a detailed log.</simpara>
<simpara>In case an installation has failed, you can <guimenu>Reschedule</guimenu>
 it from this page once you have corrected the problem.
You do not have to configure the installation again.</simpara>
<simpara>If the event log does not contain enough information to locate a problem, log in to the VM Host Server
console and read the log file <literal role="path">/var/log/up2date</literal>.
If you are using <literal role="systemitem">rhnsd</literal>, you may alternatively immediately trigger any scheduled actions by calling <literal role="command">rhn_ckeck</literal> on the VM Host Server.
Increase the command&#8217;s verbosity by using the options <literal role="option">-v</literal>, <literal role="option">-vv</literal>, or <literal role="option">-vvv</literal>, respectively.</simpara>
</note>
</section>
</section>
<section xml:id="sec.virtualization.vmguest-manage">
<title>Managing VM Guest s</title>
<simpara>Basic VM Guest
management actions such as restarting or shutting down a virtual machine as well as changing the CPU and memory allocation can be carried out in the SUSE Manager
Web interface if the following requirements are met:</simpara>
<itemizedlist>
<listitem>
<simpara>VM Host Server must be a KVM or Xen host.</simpara>
</listitem>
<listitem>
<simpara><literal role="daemon">libvirtd</literal> must be running on VM Host Server .</simpara>
</listitem>
<listitem>
<simpara>VM Host Server must be registered with SUSE Manager.</simpara>
</listitem>
</itemizedlist>
<simpara>In addition, if you want to see the profile of the VM Guest, install packages, etc., you must also register it with SUSE Manager.</simpara>
<simpara>All actions can be triggered in the SUSE Manager Web UI from the <menuchoice><guimenu>Virtualization</guimenu> <guimenuitem>]
 page of the VM Host Server
.
Navigate to this page by clicking the menu:Systems[</guimenuitem></menuchoice>
 tab.
On the resulting page, click the VM Host Server
's name and then on <guimenu>Virtualization</guimenu>
.
This page lists all VM Guest
s for this host, known to SUSE Manager
.</simpara>
<section xml:id="sec.virtualization.vmguest-manage.details">
<title>Displaying a VM Guest 's Profile</title>
<simpara>Click the name of a VM Guest
on the VM Host Server
's <guimenu>Virtualization</guimenu>
 page to open its profile page with detailed information about this guest.
For details, refer to <xref linkend="ref.webui.systems.systems"/>.</simpara>
<simpara>A profile page for a virtual system does not differ from a regular system&#8217;s profile page.
You can perform the same actions (e.g.
installing software or changing its configuration).</simpara>
</section>
<section xml:id="sec.virtualization.vmguest-manage.status">
<title>Starting, Stopping, Suspending and Resuming a VM Guest</title>
<simpara>To start, stop, restart, suspend, or resume a VM Guest
, navigate to the VM Host Server
's <menuchoice><guimenu>Virtualization</guimenu> <guimenuitem>]
 page.
Check one or more menu:Guests[</guimenuitem></menuchoice>
 listed in the table and scroll down to the bottom of the page.
Choose an action from the drop-down list and click <menuchoice><guimenu>Apply Action</guimenu> <guimenuitem>]
. menu:Confirm[</guimenuitem></menuchoice>
 the action on the next page.</simpara>
<note>
<title>Automatically restarting a VM Guest</title>
<simpara>Automatically restarting a VM Guest
when the VM Host Server
reboots is not enabled by default on VM Guest
s and cannot be configured from SUSE Manager
.
Refer to your KVM
or Xen
documentation.
Alternatively, you may use <literal role="library">libvirt</literal>
 to enable automatic reboots.</simpara>
</note>
</section>
<section xml:id="_changing_the_cpu_or_ram_allocation_of_a_vm_guest">
<title>Changing the CPU or RAM allocation of a VM Guest</title>
<simpara>To change the CPU or RAM allocation of a VM Guest
navigate to the VM Host Server
's <menuchoice><guimenu>Virtualization</guimenu> <guimenuitem>]
 page.
Check one or more menu:Guests[</guimenuitem></menuchoice>
 from the table and scroll down to the bottom of the page.
Choose an action from the <menuchoice><guimenu>Set</guimenu> <guimenuitem>]
 drop-down list and provide a new value.
Confirm with menu:Apply Changes[</guimenuitem></menuchoice>
 followed by <guimenu>Confirm</guimenu>
.</simpara>
<simpara>The memory allocation can be changed on the fly, provided the memory ballooning driver is installed on the VM Guest
.
If this is not the case, or if you want to change the CPU allocation, you need to shutdown the guest first.
Refer to <xref linkend="sec.virtualization.vmguest-manage.status"/> for details.</simpara>
</section>
<section xml:id="sec.virtualization.vmguest-manage.delete">
<title>Deleting a VM Guest</title>
<simpara>To delete a VM Guest
you must first shut it down as described in <xref linkend="sec.virtualization.vmguest-manage.status"/>.
Wait at least two minutes to allow the shutdown to finish and then choose <menuchoice><guimenu>Delete Systems</guimenu> <guimenuitem>]
 followed by menu:Apply Action[</guimenuitem></menuchoice>
 and <guimenu>Confirm</guimenu>
.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="advanced.topics.adding.vmware.esxi.host">
<title>Inventorying vCenter/vSphere ESXi Hosts with SUSE Manager</title>
<section xml:id="_introduction_3">
<title>Introduction</title>
<simpara>Foreign virtual hosts (such as vCenter and vSphere ESXi) can be inventoried using the <literal role="guimenu">Virtual Host Manager</literal>.
From the vSphere Client you can define roles and permissions for vCenter and vSphere ESXi users allowing vSphere objects and resources to be imported and inventoried by SUSE Manager.
Objects and resources are then displayed as foreign hosts on the SUSE Manager <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Systems</guimenuitem></menuchoice> page.</simpara>
<simpara>The following sections will guide you through:</simpara>
<itemizedlist>
<listitem>
<simpara>Requirements</simpara>
</listitem>
<listitem>
<simpara>Overview of permissions and roles</simpara>
</listitem>
<listitem>
<simpara>Adding vCenter and vSphere ESXi hosts to SUSE Manager</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_requirements_3">
<title>Requirements</title>
<simpara>This table displays the default API communication port and required access rights for inventorying objects and resources:</simpara>
<informaltable frame="all" rowsep="1" colsep="1">
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Ports / Permissions</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>443</simpara></entry>
<entry align="left" valign="top"><simpara>Default port that SUSE Manager uses to access the ESXi API for obtaining infrastructure data</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>read-only</simpara></entry>
<entry align="left" valign="top"><simpara>All vCenter/ESXi objects and resources that should be inventoried by the Virtual Host Manager should be at least assigned the <emphasis>read-only</emphasis> role.
Mark objects and resources with <emphasis>no-access</emphasis> to exclude them from the inventory.</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
<section xml:id="_permissions_and_roles_overview">
<title>Permissions and Roles Overview</title>
<simpara>This section will guide you through assigning user permissions and roles in vCenter/ESXi.</simpara>
<simpara>A user is someone who has been authorized to access an ESXi host.
The Virtual Host Manager (located on the SUSE Manager server) will inventory ESXi data defined by assigned roles and permissions on a user account.</simpara>
<simpara>For example: The user <emphasis>John</emphasis> has been assigned the <emphasis>read-only</emphasis> access role to all servers and datacenters in his company with one exception.
John&#8217;s account has been assigned the <emphasis>no-access</emphasis> role on the company&#8217;s <emphasis>Financial Database server</emphasis>.
You decide to use John&#8217;s user account and add the ESXi host to SUSE Manager.
During the inventory the <emphasis>Financial Database server</emphasis> will be excluded.</simpara>
<simpara>Keep user access roles in mind when planning to add ESXi hosts to SUSE manager.
Note that SUSE Manager will not inventory any objects or resources assigned with the <emphasis>no-access</emphasis> role on any user account.</simpara>
<tip>
<title>User Roles/Permissions</title>
<simpara>When planning to add new ESXi hosts to SUSE Manager, consider if the roles and permissions assigned users require need to be inventoried by SUSE Manager.</simpara>
</tip>
</section>
<section xml:id="_adding_new_users_and_assigning_roles">
<title>Adding New Users and Assigning Roles</title>
<simpara>See the official vSphere documentation on adding new users and assigning roles.</simpara>
<itemizedlist>
<listitem>
<simpara><link xl:href="https://pubs.vmware.com/vsphere-50/index.jsp#com.vmware.vsphere.security.doc_50/GUID-D7AEC653-EBC8-4573-B990-D8E58742F8ED.html">Authentication and User Management</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_inventorying_vcentervsphere_esxi_hosts">
<title>Inventorying vCenter/vSphere ESXi Hosts</title>
<simpara>This procedure guides you through inventorying a VSphere ESXi host with SUSE Manager.</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>From the SUSE Manager Web UI select <menuchoice><guimenu>Main Menu</guimenu> <guisubmenu>Systems</guisubmenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> from the left navigation bar.</simpara>
</listitem>
<listitem>
<simpara>From the upper right corner of the <emphasis>Virtual Host Managers</emphasis> page select <guibutton>Create</guibutton> VMWare-based.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis>Add a VMware-based Virtual Host Manager</emphasis> page complete these fields with your ESXi host data:</simpara>
<variablelist>
<varlistentry>
<term>Label</term>
<listitem>
<simpara>Custom name for your Virtual Host Manager</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Hostname</term>
<listitem>
<simpara>Fully-qualified domain name (FQDN) or host IP address</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Port</term>
<listitem>
<simpara>Default ESXi API port</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Username</term>
<listitem>
<simpara>Assign a username</simpara>
<important>
<simpara>Remember that only objects and resources which match a user&#8217;s defined role will be inventoried.
Set the user&#8217;s role on objects and resources you want inventoried to <emphasis>read-only</emphasis>.</simpara>
</important>
</listitem>
</varlistentry>
<varlistentry>
<term>Password</term>
<listitem>
<simpara>ESXi users password</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="systems_virtual_host_managers_vmware.png" width="80%"/>
</imageobject>
<textobject><phrase>systems virtual host managers vmware</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</varlistentry>
</variablelist>
</listitem>
<listitem>
<simpara>Click the <guibutton>Create</guibutton> button.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Host Managers</guimenuitem></menuchoice> page select the new Virtual Host manager.</simpara>
</listitem>
<listitem>
<simpara>From the <menuchoice><guimenu>Virtual Host Managers</guimenu> <guimenuitem>Properties</guimenuitem></menuchoice> page click the <guibutton>Refresh</guibutton> button.</simpara>
<important>
<simpara>If you do not refresh the data from a new Virtual Host Manager, host data will not be inventoried and therefore will not be displayed under <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Systems</guimenuitem></menuchoice>.</simpara>
</important>
</listitem>
<listitem>
<simpara>View inventoried ESXi host objects and resources by selecting <menuchoice><guimenu>Systems</guimenu> <guimenuitem>Virtual Systems</guimenuitem></menuchoice> .</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="suse.mgr.command.line.tools">
<title>SUSE Manager Command Line Tools</title>
<section xml:id="_installing_command_line_tool_packages">
<title>Installing Command Line Tool Packages</title>
<simpara>In addition to the SUSE Manager Web interface, SUSE Manager offers two command line tools for managing (Traditional) system configuration files :</simpara>
<itemizedlist>
<listitem>
<simpara>The Configuration Client (<emphasis role="strong">mgrcfg-client</emphasis>)</simpara>
</listitem>
<listitem>
<simpara>The Configuration Manager (<emphasis role="strong">mgrcfg-manager</emphasis>)</simpara>
</listitem>
</itemizedlist>
<simpara>You can use the <emphasis role="strong">mgrcfg-actions</emphasis> tool to <emphasis>enable</emphasis> and <emphasis>disable</emphasis> configuration management on client systems.</simpara>
<simpara>To work with these tools install them from the SUSE Manager Tools child channel as root.</simpara>
<screen>zypper in rhncfg-manager</screen>
<screen>zypper in rhncfg-actions</screen>
<simpara>Install the following package on client systems:</simpara>
<screen>zypper in rhncfg-client</screen>
<tip>
<title>Configuration File Backups</title>
<simpara>When a configuration file is deployed via SUSE Manager, a backup of the previous file including its full path is stored in the <literal role="path">/var/lib/rhncfg/backups/</literal>.
The backup retains its filename but has a <emphasis>.rhn-cfg-backup</emphasis> extension appended.</simpara>
</tip>
</section>
<section xml:id="mgr.actions.control">
<title>Actions Control  (mgr-actions-control)</title>
<simpara>The Actions Control (<emphasis role="strong">mgr-actions-control</emphasis>) application is used to enable and disable configuration management on a system.
Client systems cannot be managed in this fashion by default.
This tool allows SUSE Manager administrators to enable or disable specific modes of allowable actions such as:</simpara>
<itemizedlist>
<listitem>
<simpara>Deploying a configuration file on the system</simpara>
</listitem>
<listitem>
<simpara>Uploading a file from the system</simpara>
</listitem>
<listitem>
<simpara>Using the diff command to find out what is currently managed on a system with what is available</simpara>
</listitem>
<listitem>
<simpara>Running remote commands</simpara>
</listitem>
</itemizedlist>
<simpara>These various modes are enabled/disabled by placing/removing files and directories in the <literal role="path">/etc/sysconfig/rhn/allowed-actions/</literal> directory.
Due to the default permissions of the <literal role="path">/etc/sysconfig/rhn/</literal> directory, Actions Control has to be run by someone with root access.</simpara>
<section xml:id="_general_command_line_options">
<title>General command line options</title>
<simpara>There is a manpage available, as for most command line tools.
First, decide which scheduled actions should be enabled for use by system administrators.
The following options enable the various scheduled action modes:</simpara>
<variablelist>
<varlistentry>
<term>--enable-deploy</term>
<listitem>
<simpara>Allow mgrcfg-client to deploy files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--enable-diff</term>
<listitem>
<simpara>Allow mgrcfg-client to diff files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--enable-upload</term>
<listitem>
<simpara>Allow mgrcfg-client to upload files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--enable-mtime-upload</term>
<listitem>
<simpara>Allow mgrcfg-client to upload mtime (file modification time).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--enable-all</term>
<listitem>
<simpara>Allow mgrcfg-client to do everything.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--enable-run</term>
<listitem>
<simpara>Enable running scripts.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-deploy</term>
<listitem>
<simpara>Disable deployment.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-diff</term>
<listitem>
<simpara>Prohibit diff use.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-upload</term>
<listitem>
<simpara>No file uploads allowed.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-mtime-upload</term>
<listitem>
<simpara>Disable mtime upload.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-all</term>
<listitem>
<simpara>Disable all options.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--disable-run</term>
<listitem>
<simpara>No scripts allowed to run.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--report</term>
<listitem>
<simpara>Report whether modes are enabled or disabled.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-f, --force</term>
<listitem>
<simpara>Force the operation without asking first.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Once a mode is set, your system is ready for configuration management through SUSE Manager.
A common option is <literal role="command">mgr-actions-control --enable-all</literal>.</simpara>
</section>
</section>
<section xml:id="mgrcfg.client.tool">
<title>Configuration Client  (mgrcfg-client)</title>
<simpara>The Configuration Client (mgrcfg-client) is installed on and run from an individual client system to gain knowledge about how SUSE Manager deploys configuration files to the client.</simpara>
<simpara>The Configuration Client offers these primary modes:</simpara>
<itemizedlist>
<listitem>
<simpara>list</simpara>
</listitem>
<listitem>
<simpara>get</simpara>
</listitem>
<listitem>
<simpara>channels</simpara>
</listitem>
<listitem>
<simpara>diff</simpara>
</listitem>
<listitem>
<simpara>verify</simpara>
</listitem>
</itemizedlist>
<section xml:id="_listing_configuration_files">
<title>Listing Configuration Files</title>
<simpara>To list the configuration files for the machine and the labels of the config channels containing them, issue the command:</simpara>
<screen>mgrcfg-client list</screen>
<simpara>The output resembles the following list ("DoFoS" is a shortcut for "D or F or S", which means "Directory", "File", or "Something else"(?)):</simpara>
<screen>DoFoS   Config Channel      File
F      config-channel-17   /etc/example-config.txt
F      config-channel-17   /var/spool/aalib.rpm
F      config-channel-14   /etc/rhn/rhn.conf</screen>
<simpara>These configuration files apply to your system.
However, there may be duplicate files present in other channels.
For example, issue the following command:</simpara>
<screen>mgrcfg-manager list config-channel-14</screen>
<simpara>and observe the following output:</simpara>
<screen>Files in config channel 'config-channel-14'
/etc/example-config.txt /etc/rhn/rhn.conf</screen>
<simpara>You may wonder why the second version of <literal role="path">/etc/example-config.txt</literal> in <emphasis role="strong">config-channel-14</emphasis> does not apply to the client system.
The rank of the <literal role="path">/etc/example-config.txt</literal> file in <emphasis role="strong">config-channel-17</emphasis> was higher than that of the same file in <emphasis role="strong">config-channel-14</emphasis>.
As a result, the version of the configuration file in config-channel-14 is not deployed for this system, therefore mgrcfg-client command does not list the file.</simpara>
</section>
<section xml:id="getting.a.config.file">
<title>Downloading a Config File</title>
<simpara>To download the most relevant configuration file for the machine, issue the command:</simpara>
<screen>mgrcfg-client get /etc/example-config.txt</screen>
<simpara>You should see output resembling:</simpara>
<screen>Deploying /etc/example-config.txt</screen>
<simpara>View the contents of the file with less or another pager.
Note that the file is selected as the most relevant based on the rank of the config channel containing it.
This is accomplished within the Configuration tab of the System Details page.</simpara>
<simpara>Refer to Section "System Details" (Chapter 4, Systems, User Guide) for instructions.</simpara>
</section>
<section xml:id="viewing.config.channels">
<title>Viewing Config Channels</title>
<simpara>To view the labels and names of the config channels that apply to the system, issue the command:</simpara>
<screen>mgrcfg-client channels</screen>
<simpara>You should see output resembling:</simpara>
<screen>Config channels:
Label                   Name
-----                   ----
config-channel-17       config chan 2
config-channel-14       config chan 1</screen>
<simpara>The list of options available for <literal role="command">mgrcfg-client get</literal>:</simpara>
<variablelist>
<varlistentry>
<term>--topdir=TOPDIR</term>
<listitem>
<simpara>Make all file operations relative to this string.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--exclude=EXCLUDE</term>
<listitem>
<simpara>Exclude a file from being deployed with get.
May be used multiple times.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="diff.between.config.files">
<title>Differentiating between Config Files</title>
<simpara>To view the differences between the config files deployed on the system and those stored by SUSE Manager, issue the command:</simpara>
<screen>mgrcfg-client diff</screen>
<simpara>The output resembles the following:</simpara>
<screen>rhncfg-client diff
--- /etc/test
+++ /etc/test 2013-08-28 00:14:49.405152824 +1000
@@ -1 +1,2 @@
This is the first line
+This is the second line added</screen>
<simpara>In addition, you can include the <literal role="option">--topdir</literal> option to compare config files with those located in an arbitrary (and unused) location on the client system, like this:</simpara>
<screen># mgrcfg-client diff --topdir /home/test/blah/
/usr/bin/diff: /home/test/blah/etc/example-config.txt: No such file or directory
/usr/bin/diff: /home/test/blah/var/spool/aalib.rpm: No such file or directory</screen>
</section>
<section xml:id="verify.config.files">
<title>Verifying Config Files</title>
<simpara>To quickly determine if client configuration files are different from those associated with it via SUSE Manager, issue the command:</simpara>
<screen>mgrcfg-client verify</screen>
<simpara>The output resembles the following:</simpara>
<screen>modified /etc/example-config.txt /var/spool/aalib.rpm</screen>
<simpara>The file <literal role="filename">example-config.txt</literal> is locally modified, while <literal role="package">aalib.rpm</literal> is not.</simpara>
<simpara>The list of the options available for mgrcfg-client verify:</simpara>
<variablelist>
<varlistentry>
<term>-v, --verbose</term>
<listitem>
<simpara>Increase the amount of output detail.
Display differences in the mode, owner, and group permissions for the specified config file.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-o, --only</term>
<listitem>
<simpara>Only show differing files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section xml:id="the.configuration.manager">
<title>Configuration Manager (mgrcfg-manager)</title>
<simpara>The Configuration Manager (<emphasis role="strong">mgrcfg-manager</emphasis>) is designed to maintain SUSE Manager&#8217;s central repository of config files and channels, not those located on client systems.
This tool offers a command line alternative to the configuration management features in the SUSE Manager Web interface.
Additionally, some or all of the related maintenance tasks can be scripted.</simpara>
<simpara>To use the command line interface, configuration administrators require a SUSE Manager account (username and password) with the appropriate permission set.
The username may be specified in <literal role="path">/etc/sysconfig/rhn/rhncfg-manager.conf</literal> or in the <literal role="option">[rhncfg-manager]</literal> section of <literal role="path">~/.rhncfgrc</literal>.</simpara>
<simpara>When the Configuration Manager is run as <emphasis role="strong">root</emphasis>, it attempts to pull in needed configuration values from the Red Hat Update Agent.
When run as a user other than root, you may have to change the <literal role="path">~/.rhncfgrc</literal> configuration file.
The session file is cached in <literal role="path">~/.rhncfg-manager-session</literal> to avoid having to log in for every command.</simpara>
<simpara>The default timeout for the Configuration Manager is 30 minutes.
To adjust this, add the <literal role="option">server.session_lifetime</literal> option and a new value to the <literal role="path">/etc/rhn/rhn.conf</literal> file on the server running the manager.
For example set the time out to <emphasis role="strong">120 minutes</emphasis>:</simpara>
<screen>server.session_lifetime = 120</screen>
<simpara>The Configuration Manager offers the following primary <emphasis role="strong">modes</emphasis>:</simpara>
<itemizedlist>
<listitem>
<simpara>add</simpara>
</listitem>
<listitem>
<simpara>create-channel</simpara>
</listitem>
<listitem>
<simpara>diff</simpara>
</listitem>
<listitem>
<simpara>diff-revisions</simpara>
</listitem>
<listitem>
<simpara>download-channel</simpara>
</listitem>
<listitem>
<simpara>get</simpara>
</listitem>
<listitem>
<simpara>list</simpara>
</listitem>
<listitem>
<simpara>list-channels</simpara>
</listitem>
<listitem>
<simpara>remove</simpara>
</listitem>
<listitem>
<simpara>remove-channel</simpara>
</listitem>
<listitem>
<simpara>revisions</simpara>
</listitem>
<listitem>
<simpara>update</simpara>
</listitem>
<listitem>
<simpara>upload-channel</simpara>
</listitem>
</itemizedlist>
<simpara>Each mode offers its own set of options, which can be displayed by issuing the following command:</simpara>
<screen>mgrcfg-manager mode --help</screen>
<simpara>Replace mode with the name of the mode whose options you want to see:</simpara>
<screen>mgrcfg-manager diff-revisions --help</screen>
<section xml:id="creating.a.config.channel">
<title>Creating a Config Channel</title>
<simpara>To create a config channel for your organization, issue the command:</simpara>
<screen>mgrcfg-manager create-channel channel-label</screen>
<simpara>If prompted for your SUSE Manager username and password, provide them.
Once you have created a config channel, use the remaining modes listed above to populate and maintain that channel.</simpara>
</section>
<section xml:id="adding.files.to.a.config.channel">
<title>Adding Files to a Config Channel</title>
<simpara>To add a file to a config channel, specify the channel label and the local file to be uploaded:</simpara>
<screen>mgrcfg-manager add --channel=channel-label /path/to/file</screen>
<simpara>In addition to the required channel label and the path to the file, you can use the available options for modifying the file during its addition.
For instance, you can alter the path and file name by including the <literal role="option">--dest-file</literal> option in the command:</simpara>
<screen>mgrcfg-manager add --channel=channel-label \
  --dest-file=/new/path/to/file.txt/path/to/file</screen>
<simpara>The output resembles the following:</simpara>
<screen>Pushing to channel example-channel
Local file &gt;/path/to/file -&gt; remote file /new/path/to/file.txt</screen>
<simpara>The list of options available for mgrcfg-manager add:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL --channel=CHANNEL</term>
<listitem>
<simpara>Upload files in this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-d DEST_FILE --dest-file=DEST_FILE</term>
<listitem>
<simpara>Upload the file as this path.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--delim-start=DELIM_START</term>
<listitem>
<simpara>Start delimiter for variable interpolation.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--delim-end=DELIM_END</term>
<listitem>
<simpara>End delimiter for variable interpolation.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-i, --ignore-missing</term>
<listitem>
<simpara>Ignore missing local files.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
<tip>
<title>Max File size</title>
<simpara>By default, the maximum file size for configuration files is 128KB.
If you need to change that value, find or create the following line in the <literal role="path">/etc/rhn/rhn.conf</literal> file:</simpara>
<screen>web.maximum_config_file_size=128</screen>
<simpara>Change the value from 128 to whatever limit you need in kilobytes.</simpara>
</tip>
</section>
<section xml:id="diff.between.latest.config.files">
<title>Differentiating between Latest Config Files</title>
<simpara>To view the differences between the config files on disk and the latest revisions in a channel, issue the command:</simpara>
<screen>mgrcfg-manager diff --channel=channel-label --dest-file=/path/to/file.txt \
/local/path/to/file</screen>
<simpara>You should see output resembling:</simpara>
<screen>--- /tmp/dest_path/example-config.txt config_channel: example-channel revision: 1
+++ /home/test/blah/hello_world.txt 2003-12-14 19:08:59.000000000 -0500
@@ -1 +1 @@
-foo
+hello, world</screen>
<simpara>The list of options available for <literal role="command">mgrcfg-manager diff</literal>:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>Get file(s) from this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-r REVISION, --revision=REVISION</term>
<listitem>
<simpara>Use this revision.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-d DEST_FILE, --dest-file=DEST_FILE</term>
<listitem>
<simpara>Upload the file at this path.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Make all files relative to this string.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="diff.between.various.versions">
<title>Differentiating between Various Versions</title>
<simpara>To compare different versions of a file across channels and revisions, use the <emphasis role="strong">-r</emphasis> flag to indicate which revision of the file should be compared and the <emphasis role="strong">-n</emphasis> flag to identify the two channels to be checked.
Specify only one file name here since you are comparing the file against another version of itself.
For example:</simpara>
<screen>mgrcfg-manager diff-revisions -n=channel-label1 -r=1 \
  -n=channel-label2 -r=1 \
  /path/to/file.txt</screen>
<simpara>The output resembles the following:</simpara>
<screen>--- /tmp/dest_path/example-config.txt 2004-01-13 14:36:41 \
config channel: example-channel2 revision: 1
--- /tmp/dest_path/example-config.txt 2004-01-13 14:42:42 \
config channel: example-channel3 revision: 1
@@ -1 +1,20 @@
-foo
+blah
+-----BEGIN PGP SIGNATURE-----
+Version: GnuPG v1.0.6 (GNU/Linux)
+Comment: For info see http://www.gnupg.org
+
+iD8DBQA9ZY6vse4XmfJPGwgRAsHcAJ9ud9dabUcdscdcqB8AZP7e0Fua0NmKsdhQCeOWHX
+VsDTfen2NWdwwPaTM+S+Cow=
+=Ltp2
+-----END PGP SIGNATURE-----</screen>
<simpara>The list of options available for <literal role="command">mgrcfg-manager diff-revisions</literal>:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>Use this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-r REVISION, --revision=REVISION</term>
<listitem>
<simpara>Use this revision.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="downloading.all.files.in.a.channel">
<title>Downloading All Files in a Channel</title>
<simpara>To download all the files in a channel to disk, create a directory and issue the following command:</simpara>
<screen>mgrcfg-manager download-channel channel-label --topdir .</screen>
<simpara>The output resembles the following:</simpara>
<screen>Copying /tmp/dest_path/example-config.txt -&gt; \
blah2/tmp/dest_path/example-config.txt</screen>
<simpara>The list of options available for mgrcfg-manager download-channel:</simpara>
<variablelist>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Directory to which all the file paths are relative. This option must be set.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="getting.the.contents.of.a.file">
<title>Getting the Contents of a File</title>
<simpara>To direct the contents of a particular file to stdout, issue the command:</simpara>
<screen>mgrcfg-manager get --channel=channel-label \
/tmp/dest_path/example-config.txt</screen>
<simpara>You should see the contents of the file as the output.</simpara>
</section>
<section xml:id="listing.all.files.in.a.channel">
<title>Listing All Files in a Channel</title>
<simpara>To list all the files in a channel, issue the command:</simpara>
<screen>mgrcfg-manager list channel-label</screen>
<simpara>You should see output resembling:</simpara>
<screen>Files in config channel `example-channel3':
/tmp/dest_path/example-config.txt</screen>
<simpara>The list of the options available for mgrcfg-manager get:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>Get file(s) from this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Directory to which all files are relative.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-r REVISION, --revision=REVISION</term>
<listitem>
<simpara>Get this file revision.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="listing.all.config.channels">
<title>Listing All Config Channels</title>
<simpara>To list all of your organization&#8217;s configuration channels, issue the command:</simpara>
<screen>mgrcfg-manager list-channels</screen>
<simpara>The output resembles the following:</simpara>
<screen>Available config channels:
example-channel example-channel2 example-channel3 config-channel-14 config-channel-17</screen>
<note>
<simpara>This does not list <emphasis role="strong">local_override</emphasis> or <emphasis role="strong">server_import</emphasis> channels.</simpara>
</note>
</section>
<section xml:id="removing.a.file.from.a.channel">
<title>Removing a File from a Channel</title>
<simpara>To remove a file from a channel, issue the command:</simpara>
<screen>mgrcfg-manager remove --channel=channel-label /tmp/dest_path/example-config.txt</screen>
<simpara>If prompted for your SUSE Manager username and password, provide them.</simpara>
<simpara>The list of the options available for mgrcfg-manager remove:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>Remove files from this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Directory to which all files are relative.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="deleting.a.config.channel">
<title>Deleting a Config Channel</title>
<simpara>To remove a config channel in your organization, issue the command:</simpara>
<screen>mgrcfg-manager remove-channel channel-label</screen>
<simpara>The output resembles the following:</simpara>
<screen>Removing config channel example-channel
Config channel example-channel removed</screen>
</section>
<section xml:id="determine.the.number.of.file.revisions">
<title>Determining the Number of File Revisions</title>
<simpara>To find out how many revisions (from <emphasis role="strong">1 to N</emphasis> where N is an integer greater than 0) of a file/path are in a channel, issue the following command:</simpara>
<screen>mgrcfg-manager revisions channel-label /tmp/dest_path/example-config.txt</screen>
<simpara>The output resembles the following:</simpara>
<screen>Analyzing files in config channel example-channel \
/tmp/dest_path/example-config.txt: 1</screen>
</section>
<section xml:id="update.a.file.in.a.channel">
<title>Updating a File in a Channel</title>
<simpara>To create a new revision of a file in a channel (or to add the first revision to that channel if none existed before for the given path), issue the following command:</simpara>
<screen>mgrcfg-manager update --channel=channel-label \
--dest-file=/path/to/file.txt /local/path/to/file</screen>
<simpara>The output resembles the following:</simpara>
<screen>Pushing to channel example-channel:
Local file example-channel /tmp/local/example-config.txt -&gt; \
remote file /tmp/dest_path/example-config.txt</screen>
<simpara>The list of the options available for mgrcfg-manager update:</simpara>
<variablelist>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>Upload files in this config channel.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-d DEST_FILE, --dest-file=DEST_FILE</term>
<listitem>
<simpara>Upload the file to this path.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Directory to which all files are relative.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--delim-start=DELIM_START</term>
<listitem>
<simpara>Start delimiter for variable interpolation.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>--delim-end=DELIM_END</term>
<listitem>
<simpara>End delimiter for variable interpolation.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="uploading.multiple.files.at.once">
<title>Uploading Multiple Files at Once</title>
<simpara>To upload multiple files to a config channel from a local disk at once, issue the command:</simpara>
<screen>mgrcfg-manager upload-channel --topdir=topdir channel-label</screen>
<simpara>The output resembles the following:</simpara>
<screen>Using config channel example-channel4
Uploading /tmp/ola_world.txt from blah4/tmp/ola_world.txt</screen>
<simpara>The list of the options available for mgrcfg-manager upload-channel:</simpara>
<variablelist>
<varlistentry>
<term>-t TOPDIR, --topdir=TOPDIR</term>
<listitem>
<simpara>Directory all the file paths are relative to.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-c CHANNEL, --channel=CHANNEL</term>
<listitem>
<simpara>List of channels the config info will be uploaded into channels delimited by ','. Example: --channel=foo,bar,baz.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>-h, --help</term>
<listitem>
<simpara>Show help message and exit.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
<section xml:id="syncing.suse.mgr.repositories.scc">
<title>Syncing SUSE Manager Repositories from SCC (mgr-sync)</title>
<simpara><literal role="command">mgr-sync</literal> should be used if SUSE Manager is connected to SUSE Customer Center (SCC).
With <literal role="command">mgr-sync</literal> you may add or synchronize products and channels.
The <literal role="command">mgr-sync</literal> command also enables and refreshes SCC data.</simpara>
<simpara>By default, log rotation of <literal role="path">spacewalk-repo-sync</literal> is disabled.
This logfile is run by a cron job, and managed by a configuration file.
You can enable log rotation by editing the configuration file at <literal role="path">etc/sysconfig/rhn/reposync</literal> and setting the <literal role="command">MAX_DAYS</literal> parameter.
This will permit the deletion of files that are older than the specified period of time.</simpara>
<important>
<title>Admin credentials</title>
<simpara><literal role="command">mgr-sync</literal> now requires the username/password of a <emphasis role="strong">SUSE Manager administrator</emphasis>.
Most functions are available as part of the public API.</simpara>
</important>
<simpara>mgr-sync provides a command structure with sub-commands similar to git or osc.
For a complete list of command line option, see the mgr-sync manpage (man mgr-sync).
Basic actions are:</simpara>
<screen>mgr-sync list channel(s)|product(s)|credentials
mgr-sync add  channel(s)|product(s)|credentials
mgr-sync delete  credentials

mgr-sync refresh [--refresh-channels] [--from-mirror MIRROR]</screen>
<simpara>See the following examples.</simpara>
<variablelist>
<varlistentry>
<term>List channels</term>
<listitem>
<screen>mgr-sync list channels</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Add a channel</term>
<listitem>
<screen>mgr-sync add channel LABEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>List products</term>
<listitem>
<screen>mgr-sync list products</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Add a product</term>
<listitem>
<screen>mgr-sync add product</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Refresh the data</term>
<listitem>
<screen>mgr-sync refresh</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Refresh data and schedule a reposync for all installed vendor channels</term>
<listitem>
<screen>mgr-sync refresh --refresh-channels</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>List SCC credentials</term>
<listitem>
<screen>mgr-sync list credentials</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Add new SCC credentials</term>
<listitem>
<screen>mgr-sync add credentials</screen>
</listitem>
</varlistentry>
</variablelist>
<tip>
<title>Credentials</title>
<simpara>There can be one primary credential only.
This is username/password used first when retrieving the list of available channels and packages.</simpara>
</tip>
<variablelist>
<varlistentry>
<term>Add SCC primary credentials</term>
<listitem>
<screen>mgr-sync add credentials --primary</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Delete SCC credentials</term>
<listitem>
<screen>mgr-sync delete credentials</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="configure.suse.manager.database.smdba">
<title>Configuring SUSE Manager&#8217;s Database (smdba)</title>
<simpara>SUSE Manager provides the smdba command for managing the installed database.
It is the successor of <literal role="package">db-control</literal>, which is now <emphasis role="strong">unsupported</emphasis>.</simpara>
<simpara>The smdba command works on local databases only, not remote.
This utility allows you to do several administrative tasks like backing up and restoring the database.
It also allows you to create, verify, restore backups, obtaining database status, and restart the database if necessary.
The smdba command supports <emphasis role="strong">PostgreSQL</emphasis>.</simpara>
<simpara>Find basic information about <emphasis role="strong">smdba</emphasis> in the <emphasis role="strong">smdba manpage</emphasis>.</simpara>
<note>
<title>Restart Spacewalk Services When Connection is Lost</title>
<simpara>If you have stopped or restarted the database, Spacewalk services can lose their connections. In such a case, run the following command:</simpara>
<screen>spacewalk-service restart</screen>
</note>
<section xml:id="smdba.control.options">
<title>Control Options</title>
<simpara>Depending on the database installed, smdba provides several subcommands:</simpara>
<screen>backup-hot      Enable continuous archiving backup
backup-restore  Restore the SUSE Manager Database from backup.
backup-status   Show backup status.
db-start        Start the SUSE Manager Database.
db-status       Show database status.
db-stop         Stop the SUSE Manager Database.
space-overview  Show database space report.
space-reclaim   Free disk space from unused object in tables and indexes.
space-tables    Show space report for each table.
system-check    Common backend healthcheck.</screen>
<simpara>For a list of available commands on your particular appliance, call smdba help.
To display the help message for a specific subcommand, call <literal role="command">smdba COMMAND help</literal>.</simpara>
</section>
<section xml:id="starting.and.stopping.the.database">
<title>Starting and Stopping the Database</title>
<simpara>There are three commands to start, stop, or get the status of the database.
Use the following commands:</simpara>
<screen># smdba db-status
Checking database core...       online
# smdba db-stop
Stopping the SUSE Manager database...
Stopping listener:     done
Stopping core:         done
# smdba db-status
Checking database core...       offline
# smdba db-start
Starting listener:     done
Starting core...       done</screen>
</section>
</section>
<section xml:id="at.clitools.createbootstraprepo">
<title>Creating a Bootstrap Repository (mgr-create-bootstrap-repo)</title>
<simpara>The <literal role="code">mgr-create-bootstrap-repo</literal> command is used on the SUSE Manager Server to create a new bootstrap repository.</simpara>
<simpara>Use the <literal role="code">-l</literal> option to list all available repositories:</simpara>
<screen># mgr-create-bootstrap-repo -l</screen>
<simpara>You can then invoke the command with the appropriate repository name to create the bootstrap repository you require, for example:</simpara>
<screen># mgr-create-bootstrap-repo SLE-version-x86_64</screen>
<literallayout class="monospaced">[[at.clitools.createbootstraprepo.customchannels]]
=== Creating a Bootstrap Repository with Custom Channels</literallayout>
<literallayout class="monospaced">Custom channels are channels that have been created to manage any custom packages that an organization might require.
To create a new bootstrap repository from a custom channel, use the [code]``mgr-create-bootstrap-repo`` command with the [code]``with-custom-channels`` option:</literallayout>
<screen># mgr-create-bootstrap-repo --with-custom-channels</screen>
<note>
<title>Flushing a Bootstrap Repository to Remove Custom Channels</title>
<simpara>If you create a bootstrap repository that contains custom channels, and later attempt to rebuild with the <literal role="code">mgr-create-bootstrap-repo</literal> command, the custom channel information will remain in the bootstrap repository.
If you want to remove custom channel information from your bootstrap repository, you will need to use the <literal role="code">flush</literal> option when you rebuild:</simpara>
<screen># mgr-create-bootstrap-repo --flush</screen>
</note>
</section>
</chapter>
<chapter xml:id="at.mgr.spacecmd.command.guide">
<title>spacecmd Reference</title>
<section xml:id="at.spacecmd.introduction">
<title>Introduction</title>
<simpara>The following section will help you become more familiar with the <literal role="command">spacecmd</literal> command-line interface.
This interface is available for SUSE Manager, Satellite and Spacewalk servers.
spacecmd is written in Python and uses the XML-RPC API provided by the server.</simpara>
<itemizedlist>
<title>What can spacecmd do for me?</title>
<listitem>
<simpara>Manage almost all aspects of SUSE Manager from the command line with spacecmd</simpara>
</listitem>
<listitem>
<simpara>Tab completion is available for all commands</simpara>
</listitem>
<listitem>
<simpara>Single commands can be passed to spacecmd without entering the interactive shell (excellent for shell scripts)</simpara>
</listitem>
<listitem>
<simpara>May also be accessed and used as an interactive shell</simpara>
</listitem>
<listitem>
<simpara>Advanced search methods are available for finding specific systems, thus removing the need to create system groups (nevertheless groups are still recommended)</simpara>
</listitem>
<listitem>
<simpara>Complete functionality through the Spacewalk API. Almost all commands that can be executed from the WebUI can be performed via the spacecmd command-line</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="at.spacecmd.configuration.overview">
<title>Configuring spacecmd</title>
<simpara>The following section provides configuration tips for spacecmd.</simpara>
<section xml:id="_setup_spacecmd_credentials">
<title>Setup Spacecmd Credentials</title>
<simpara>Normally spacecmd prompts you for a username and password each time you attempt to login to the interactive shell.
Alternatively you can configure spacecmd with a credentials file to avoid this requirement.</simpara>
<orderedlist numeration="arabic">
<title>Procedure: Creating a spacecmd Credentials File</title>
<listitem>
<simpara>Create a hidden spacecmd directory in your home directory and set permissions:</simpara>
<screen>mkdir ~/.spacecmd
chmod 700 ~/.spacecmd</screen>
</listitem>
<listitem>
<simpara>Create a <literal>config</literal> file in <literal role="path">~/.spacecmd/</literal> and provide proper permissions:</simpara>
<screen>touch ~/.spacecmd/config
chmod 600 ~/.spacecmd/config</screen>
</listitem>
<listitem>
<simpara>Edit the <literal>config</literal> file and add the following configuration lines. (You can use either localhost or the FQDN of your SUSE Manager server):</simpara>
<screen>[spacecmd]

server=FQDN-here

username=username-here
password=password-here</screen>
</listitem>
<listitem>
<simpara>Check connectivity by entering <literal role="command">spacecmd</literal> as root:</simpara>
<screen># spacecmd</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="_spacecmd_quiet_mode">
<title>spacecmd Quiet Mode</title>
<simpara>By default spacecmd prints server status messages during connection attempts.
These messages can cause a lot of clutter when parsing system lists.
The following alias will force spacecmd to use quiet mode thus preventing this behavior.
Add the following line to your <literal>~/.bashrc</literal> file:</simpara>
<screen>alias spacecmd='spacecmd -q'</screen>
</section>
<section xml:id="_spacecmd_help">
<title>spacecmd Help</title>
<simpara>spacecmd help can be access by typing spacecmd <literal role="command">-h --help</literal></simpara>
<screen>Usage: spacecmd [options] [command]

Options:
  -u USERNAME, --username=USERNAME
                        use this username to connect to the server
  -p PASSWORD, --password=PASSWORD
                        use this password to connect to the server
  -s SERVER, --server=SERVER
                        connect to this server [default: local hostname]
  --nossl               use HTTP instead of HTTPS
  --nohistory           do not store command history
  -y, --yes             answer yes for all questions
  -q, --quiet           print only error messages
  -d, --debug           print debug messages (can be passed multiple times)
  -h, --help            show this help message and exit</screen>
<simpara>As root you can access available functions without entering the spacecmd shell:</simpara>
<screen># spacecmd -- help

        Documented commands (type help &lt;topic&gt;):
========================================
activationkey_addchildchannels         org_trustdetails
activationkey_addconfigchannels        package_details
activationkey_addentitlements          package_listdependencies
activationkey_addgroups                package_listerrata
activationkey_addpackages              package_listinstalledsystems
activationkey_clone                    package_listorphans
activationkey_create                   package_remove
activationkey_delete                   package_removeorphans
activationkey_details                  package_search
activationkey_diff                     repo_addfilters
activationkey_disable                  repo_clearfilters
activationkey_disableconfigdeployment  repo_create

...</screen>
</section>
</section>
<section xml:id="_troubleshooting">
<title>Troubleshooting</title>
<simpara>This section provides troubleshooting solutions when working with spacecmd</simpara>
<section xml:id="_creating_a_distribution_with_spacecmd_sets_localhost_instead_of_fqdn">
<title>Creating a Distribution With spacecmd Sets Localhost Instead of FQDN</title>
<simpara>The support article associated with this issue may be located at:https://www.suse.com/support/kb/doc/?id=7018627</simpara>
<variablelist>
<varlistentry>
<term>Situation</term>
<listitem>
<simpara>When creating a distribution with spacecmd it will  automatically set localhost as the server name instead of the FQDN of SUSE Manager.
This will result in the following kernel option being written:</simpara>
<screen>install=http://localhost/ks/dist/&lt;distributionname&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Resolution</term>
<listitem>
<simpara>Set the FQDN in <literal role="path">$HOME/.spacecmd/config</literal>
like the following:</simpara>
<screen>test:~/.spacecmd # cat config
[spacecmd]
server=test.mytest.env
username=admin
password=password
nossl=0</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>Cause</term>
<listitem>
<simpara>This problem may be experienced if <literal role="path">$HOME/.spacecmd/config</literal>
has been created and the server name option was set to localhost.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="_spacecmd_not_accepting_commands_or_options">
<title>Spacecmd not Accepting Commands or Options</title>
<simpara>When running <literal role="command">spacecmd</literal> non-interactively, you must escape arguments passed to the command.
Always put <literal>--</literal> before arguments, to avoid them being treated as global arguments.
Additionally, make sure you escape any quotes that you pass to the functions so that they are not interpreted.
An example of a well-formed <literal role="command">spacecmd</literal> command:</simpara>
<screen>spacecmd -s server1 -- softwarechannel_create -n \'My Channel\' -l channel1 -a x86_64</screen>
</section>
<section xml:id="_spacecmd_caching_problems">
<title>Spacecmd caching problems</title>
<simpara>The <literal role="command">spacecmd</literal> command keeps a cache of the various systems and packages that you have installed.
Sometimes, this can result in a mismatch between the system name and the system ID.
To clear the <literal role="command">spacecmd</literal> cache, use this command:</simpara>
<screen>spacecmd clear_caches</screen>
</section>
</section>
<section xml:id="at.spacecmd.command.reference">
<title>spacecmd Functions</title>
<simpara>The following sections provide descriptions for all documented spacecmd commands.
Each command is grouped by the function prefix.
Keep in mind that all commands may also be called using scripts and passed to spacecmd as stand-alone commands.</simpara>
<section xml:id="at.spacecmd.activationkey">
<title>activationkey_</title>
<simpara>The following spacecmd commands are available for use with activation keys.</simpara>
<variablelist>
<varlistentry>
<term>activationkey_addchildchannels</term>
<listitem>
<simpara>Add child channels to an activation key.</simpara>
<screen>usage: activationkey_addchildchannels KEY &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_addconfigchannels</term>
<listitem>
<simpara>Add configuration channels to an activation key.</simpara>
<screen>usage: activationkey_addconfigchannels KEY &lt;CHANNEL ...&gt; [options]

options:
  -t add channels to the top of the list
  -b add channels to the bottom of the list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_addentitlements</term>
<listitem>
<simpara>Add available entitlements to an activation key.</simpara>
<note>
<title>WebUI Name Change</title>
<simpara>In the WebUI entitlements are known as System Types.
Nevertheless the spacecmd backend still utilizes the entitlements term.
Therefore any scripts you may be using can remain unchanged.</simpara>
</note>
<screen>usage: activationkey_addentitlements KEY &lt;ENTITLEMENT ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_addgroups</term>
<listitem>
<simpara>Add existing groups to an activation key.</simpara>
<screen>usage: activationkey_addgroups KEY &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_addpackages</term>
<listitem>
<simpara>Add packages to an activation key.</simpara>
<screen>usage: activationkey_addpackages KEY &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_clone</term>
<listitem>
<simpara>Clone an existing activation key.</simpara>
<screen>usage examples:
                 activationkey_clone foo_key -c bar_key
                 activationkey_clone foo_key1 foo_key2 -c prefix
                 activationkey_clone foo_key -x "s/foo/bar"
                 activationkey_clone foo_key1 foo_key2 -x "s/foo/bar"

options:
  -c CLONE_NAME  : Name of the resulting key, treated as a prefix for multiple
                   keys
  -x "s/foo/bar" : Optional regex replacement, replaces foo with bar in the
                   clone description, base-channel label, child-channel
                   labels, config-channel names</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_create</term>
<listitem>
<simpara>Create a new activation key.</simpara>
<screen>usage: activationkey_create [options]

options:
  -n NAME
  -d DESCRIPTION
  -b BASE_CHANNEL
  -u set key as universal default
  -e [enterprise_entitled,virtualization_host]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_delete</term>
<listitem>
<simpara>Delete an existing activation key.</simpara>
<screen>usage: activationkey_delete KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_details</term>
<listitem>
<simpara>Show details of an existing activation key.</simpara>
<screen>usage: activationkey_details KEY ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_diff</term>
<listitem>
<simpara>Check the difference between two activation keys.</simpara>
<screen>usage: activationkey_diff SOURCE_ACTIVATIONKEY TARGET_ACTIVATIONKEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_disable</term>
<listitem>
<simpara>Disable an existing activation key.</simpara>
<screen>usage: activationkey_disable KEY [KEY ...]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_disableconfigdeployment</term>
<listitem>
<simpara>Disable configuration channel deployment for an existing activation key.</simpara>
<screen>usage: activationkey_disableconfigdeployment KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_enable</term>
<listitem>
<simpara>Enable an existing activation key.</simpara>
<screen>usage: activationkey_enable KEY [KEY ...]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_enableconfigdeployment</term>
<listitem>
<simpara>Enable configuration channel deployment for an existing activation key.</simpara>
<screen>usage: activationkey_enableconfigdeployment KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_export</term>
<listitem>
<simpara>Export activation key(s) to a JSON formatted file.</simpara>
<screen>usage: activationkey_export [options] [&lt;KEY&gt; ...]

options:
    -f outfile.json : specify an output filename, defaults to &lt;KEY&gt;.json
                      if exporting a single key, akeys.json for multiple keys,
                      or akey_all.json if no KEY specified (export ALL)

Note : KEY list is optional, default is to export ALL keys</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_import</term>
<listitem>
<simpara>Import activation key(s) from JSON file(s)</simpara>
<screen>usage: activationkey_import &lt;JSONFILE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_list</term>
<listitem>
<simpara>List all existing activation keys.</simpara>
<screen>usage: activationkey_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listbasechannel</term>
<listitem>
<simpara>List the base channel associated with an activation key.</simpara>
<screen>usage: activationkey_listbasechannel KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listchildchannels</term>
<listitem>
<simpara>List child channels associated with an activation key.</simpara>
<screen>usage: activationkey_listchildchannels KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listconfigchannels</term>
<listitem>
<simpara>List configuration channels associated with an activation key.</simpara>
<screen>usage: activationkey_listconfigchannels KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listentitlements</term>
<listitem>
<simpara>List entitlements associated with an activation key.</simpara>
<screen>usage: activationkey_listentitlements KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listgroups</term>
<listitem>
<simpara>List groups associated with an activation key</simpara>
<screen>usage: activationkey_listgroups KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listpackages</term>
<listitem>
<simpara>List packages associated with an activation key.</simpara>
<screen>usage: activationkey_listpackages KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_listsystems</term>
<listitem>
<simpara>List systems registered with an activation key.</simpara>
<screen>usage: activationkey_listsystems KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_removechildchannels</term>
<listitem>
<simpara>Remove child channels from an activation key.</simpara>
<screen>usage: activationkey_removechildchannels KEY &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_removeconfigchannels</term>
<listitem>
<simpara>Remove configuration channels from an activation key.</simpara>
<screen>usage: activationkey_removeconfigchannels KEY &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_removeentitlements</term>
<listitem>
<simpara>Remove entitlements from an activation key.</simpara>
<screen>usage: activationkey_removeentitlements KEY &lt;ENTITLEMENT ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_removegroups</term>
<listitem>
<simpara>Remove groups from an activation key.</simpara>
<screen>usage: activationkey_removegroups KEY &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_removepackages</term>
<listitem>
<simpara>Remove packages from an activation key.</simpara>
<screen>usage: activationkey_removepackages KEY &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setbasechannel</term>
<listitem>
<simpara>Set the base channel for an activation key.</simpara>
<screen>usage: activationkey_setbasechannel KEY CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setconfigchannelorder</term>
<listitem>
<simpara>Set the ranked order of configuration channels.</simpara>
<screen>usage: activationkey_setconfigchannelorder KEY</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setcontactmethod</term>
<listitem>
<simpara>Set the contact method to use for systems registered with a specific key.
(Use the XML-RPC API to access the latest contact methods.) The following contact methods are available for use with traditional spacecmd: ['default', 'ssh-push', 'ssh-push-tunnel']</simpara>
<screen>usage: activationkey_setcontactmethod KEY CONTACT_METHOD</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setdescription</term>
<listitem>
<simpara>Add a description for an activation key.</simpara>
<screen>usage: activationkey_setdescription KEY DESCRIPTION</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setuniversaldefault</term>
<listitem>
<simpara>Set a specific key as the universal default.</simpara>
<screen>usage: activationkey_setuniversaldefault KEY</screen>
<warning>
<title>Universal Default Key</title>
<simpara>Using a universal default key is not a Best Practice recommendation.</simpara>
</warning>
</listitem>
</varlistentry>
<varlistentry>
<term>activationkey_setusagelimit</term>
<listitem>
<simpara>Set the usage limit of an activation key, can be a number or "unlimited".</simpara>
<screen>usage: activationkey_setbasechannel KEY &lt;usage limit&gt;
usage: activationkey_setbasechannel KEY unlimited</screen>
</listitem>
</varlistentry>
</variablelist>
<tip>
<title>Usage Limits</title>
<simpara>Usage limits are only applicable to traditionally managed systems.
Currently usage limits do not apply to Salt or foreign managed systems.</simpara>
</tip>
</section>
<section xml:id="at.spacecmd.api">
<title>api</title>
<simpara>The following API command and its options are available for calling the XML-RPC API directly.
Calling the API directly allows you to use the latest features in SUSE Manager from the command-line using spacecmd as a wrapper for stand-alone commands or used from within scripts.</simpara>
<note>
<title>Use the api Command for Access to Latest Features</title>
<simpara>spacecmd is the traditional tool for spacewalk.
It functions out of the box with SUSE Manager but you should know that latest features (for example, Salt) are often excluded from traditional spacecmd command-line tool.
To gain access to the latest feature additions call <literal role="command">api api.getApiCallList</literal> from within spacecmd to list all currently available API commands formatted in json.
You can then call these commands directly.</simpara>
</note>
<variablelist>
<varlistentry>
<term>api</term>
<listitem>
<simpara>Call XML-RPC API with arguments directly.</simpara>
<screen>usage: api [options] API_STRING

options:
  -A, --args  Arguments for the API other than session id in comma separated
              strings or JSON expression
  -F, --format   Output format
  -o, --output   Output file

examples:
  api api.getApiCallList
  api --args "sysgroup_A" systemgroup.listSystems
  api -A "rhel-i386-server-5,2011-04-01,2011-05-01" -F "%(name)s" \
      channel.software.listAllPackages</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.clear">
<title>clear</title>
<simpara>Clears the terminal screen</simpara>
</section>
<section xml:id="at.spacecmd.clearcaches">
<title>clear_caches</title>
<simpara>Clear the internal caches kept for systems and packages</simpara>
<screen>usage: clear_caches</screen>
</section>
<section xml:id="at.spacecmd.configchannel">
<title>configchannel_</title>
<simpara>The following spacecmd commands are available for use with configuration channels.</simpara>
<variablelist>
<varlistentry>
<term>configchannel_addfile</term>
<listitem>
<simpara>Creates a configuration file.</simpara>
<screen>usage: configchannel_addfile [CHANNEL] [options]

options:
  -c CHANNEL
  -p PATH
  -r REVISION
  -o OWNER [default: root]
  -g GROUP [default: root]
  -m MODE [defualt: 0644]
  -x SELINUX_CONTEXT
  -d path is a directory
  -s path is a symlink
  -b path is a binary (or other file which needs base64 encoding)
  -t SYMLINK_TARGET
  -f local path to file contents

  Note re binary/base64: Some text files, notably those containing trailing
  newlines, those containing ASCII escape characters (or other charaters not
  allowed in XML) need to be sent as binary (-b).  Some effort is made to auto-
  detect files which require this, but you may need to explicitly specify.</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_backup</term>
<listitem>
<simpara>Backup a configuration channel.</simpara>
<screen>usage: configchannel_backup CHANNEL [OUTDIR]

OUTDIR defaults to $HOME/spacecmd-backup/configchannel/YYYY-MM-DD/CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_clone</term>
<listitem>
<simpara>Clone configuration channel(s).</simpara>
<screen>usage examples:
                 configchannel_clone foo_label -c bar_label
                 configchannel_clone foo_label1 foo_label2 -c prefix
                 configchannel_clone foo_label -x "s/foo/bar"
                 configchannel_clone foo_label1 foo_label2 -x "s/foo/bar"

options:
  -c CLONE_LABEL : name/label of the resulting cc (note does not update
                   description, see -x option), treated as a prefix if
                   multiple keys are passed
  -x "s/foo/bar" : Optional regex replacement, replaces foo with bar in the
                   clone name, label and description
  Note : If no -c or -x option is specified, interactive is assumed</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_create</term>
<listitem>
<simpara>Create a configuration channel.</simpara>
<screen>usage: configchannel_create [options]

options:
  -n NAME
  -l LABEL
  -d DESCRIPTION</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_delete</term>
<listitem>
<simpara>Delete a configuration channel.</simpara>
<screen>usage: configchannel_delete CHANNEL ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_details</term>
<listitem>
<simpara>Show the details of a configuration channel.</simpara>
<screen>usage: configchannel_details CHANNEL ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_diff</term>
<listitem>
<simpara>Find differences between configuration channels.</simpara>
<screen>usage: configchannel_diff SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_export</term>
<listitem>
<simpara>Export configuration channel(s) to a json formatted file.</simpara>
<screen>usage: configchannel_export &lt;CHANNEL&gt;... [options]
options:
    -f outfile.json : specify an output filename, defaults to &lt;CHANNEL&gt;.json
                      if exporting a single channel, ccs.json for multiple
                      channels, or cc_all.json if no CHANNEL specified
                      e.g (export ALL)

Note : CHANNEL list is optional, default is to export ALL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_filedetails</term>
<listitem>
<simpara>Show the details of a file in a configuration channel.</simpara>
<screen>usage: configchannel_filedetails CHANNEL FILE [REVISION]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_forcedeploy</term>
<listitem>
<simpara>Forces a redeployment of files within a channel on all subscribed systems.</simpara>
<screen>usage: configchannel_forcedeploy CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_import</term>
<listitem>
<simpara>Import configuration channel(s) from a json file.</simpara>
<screen>usage: configchannel_import &lt;JSONFILES...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_list</term>
<listitem>
<simpara>List all configuration channels.</simpara>
<screen>usage: configchannel_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_listfiles</term>
<listitem>
<simpara>List all files in a configuration channel.</simpara>
<screen>usage: configchannel_listfiles CHANNEL ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_listsystems</term>
<listitem>
<simpara>List all systems subscribed to a configuration channel.</simpara>
<screen>usage: configchannel_listsystems CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_removefiles</term>
<listitem>
<simpara>Remove configuration files.</simpara>
<screen>usage: configchannel_removefile CHANNEL &lt;FILE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_sync</term>
<listitem>
<simpara>Sync configuration files between two configuration channels.</simpara>
<screen>usage: configchannel_sync SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_updatefile</term>
<listitem>
<simpara>Update a configuration file.</simpara>
<screen>usage: configchannel_updatefile CHANNEL FILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>configchannel_verifyfile</term>
<listitem>
<simpara>Verify a configuration file.</simpara>
<screen>usage: configchannel_verifyfile CHANNEL FILE &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; may be substituted with any of the following targets:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.cryptokey">
<title>cryptokey_</title>
<simpara>The following spacecmd commands are available for use with cryptographic keys.</simpara>
<variablelist>
<varlistentry>
<term>cryptokey_create</term>
<listitem>
<simpara>Create a cryptographic key.</simpara>
<screen>usage: cryptokey_create [options]

options:
  -t GPG or SSL
  -d DESCRIPTION
  -f KEY_FILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>cryptokey_delete</term>
<listitem>
<simpara>Delete a cryptographic key.</simpara>
<screen>usage: cryptokey_delete NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>cryptokey_details</term>
<listitem>
<simpara>Show the contents of a cryptographic key.</simpara>
<screen>usage: cryptokey_details KEY ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>cryptokey_list</term>
<listitem>
<simpara>List all cryptographic keys (SSL, GPG).</simpara>
<screen>usage: cryptokey_list</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.custominfo">
<title>custominfo_</title>
<simpara>The following spacecmd commands are available for working with custom keys.</simpara>
<variablelist>
<varlistentry>
<term>custominfo_createkey</term>
<listitem>
<simpara>Create a custom key.</simpara>
<screen>usage: custominfo_createkey [NAME] [DESCRIPTION]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>custominfo_deletekey</term>
<listitem>
<simpara>Delete a custom key.</simpara>
<screen>usage: custominfo_deletekey KEY ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>custominfo_details</term>
<listitem>
<simpara>Show the details of a custom key.</simpara>
<screen>usage: custominfo_details KEY ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>custominfo_listkeys</term>
<listitem>
<simpara>List all custom keys.</simpara>
<screen>usage: custominfo_listkeys</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>custominfo_updatekey</term>
<listitem>
<simpara>Update a custom key.</simpara>
<screen>usage: custominfo_updatekey [NAME] [DESCRIPTION]</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.distribution">
<title>distribution_</title>
<simpara>The following spacecmd commands are available for working with kickstart distributions.</simpara>
<variablelist>
<varlistentry>
<term>distribution_create</term>
<listitem>
<simpara>Create a Kickstart tree.</simpara>
<screen>usage: distribution_create [options]

options:
  -n NAME
  -p path to tree
  -b base channel to associate with
  -t install type [fedora|rhel_4/5/6|suse|generic_rpm]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>distribution_delete</term>
<listitem>
<simpara>Delete a Kickstart tree.</simpara>
<screen>usage: distribution_delete LABEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>distribution_details</term>
<listitem>
<simpara>Show the details of a Kickstart tree.</simpara>
<screen>usage: distribution_details LABEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>distribution_list</term>
<listitem>
<simpara>List the available autoinstall trees.</simpara>
<screen>usage: distribution_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>distribution_rename</term>
<listitem>
<simpara>Rename a Kickstart tree.</simpara>
<screen>usage: distribution_rename OLDNAME NEWNAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>distribution_update</term>
<listitem>
<simpara>Update the path of a Kickstart tree.</simpara>
<screen>usage: distribution_update NAME [options]

options:
  -p path to tree
  -b base channel to associate with
  -t install type [fedora|rhel_4/5/6|suse|generic_rpm]</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.errata">
<title>errata_</title>
<simpara>The following spacecmd commands are available for use with errata data.</simpara>
<variablelist>
<varlistentry>
<term>errata_apply</term>
<listitem>
<simpara>Apply an patch to all affected systems.</simpara>
<screen>usage: errata_apply ERRATA|search:XXX ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_delete</term>
<listitem>
<simpara>Delete an patch.</simpara>
<screen>usage: errata_delete ERRATA|search:XXX ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_details</term>
<listitem>
<simpara>Show the details of an patch.</simpara>
<screen>usage: errata_details ERRATA|search:XXX ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_findbycve</term>
<listitem>
<simpara>List errata addressing a CVE.</simpara>
<screen>usage: errata_findbycve CVE-YYYY-NNNN ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_list</term>
<listitem>
<simpara>List all patches.</simpara>
<screen>usage: errata_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_listaffectedsystems</term>
<listitem>
<simpara>List of systems affected by an patch.</simpara>
<screen>usage: errata_listaffectedsystems ERRATA|search:XXX ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_listcves</term>
<listitem>
<simpara>List of CVEs addressed by an patch.</simpara>
<screen>usage: errata_listcves ERRATA|search:XXX ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_publish</term>
<listitem>
<simpara>Publish an patch to a channel.</simpara>
<screen>usage: errata_publish ERRATA|search:XXX &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_search</term>
<listitem>
<simpara>List patches that meet user provided criteria</simpara>
<screen>usage: errata_search CVE|RHSA|RHBA|RHEA|CLA ...

Example:
&gt; errata_search CVE-2009:1674
&gt; errata_search RHSA-2009:1674</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>errata_summary</term>
<listitem>
<simpara>Print a summary of all errata.</simpara>
<screen>usage: errata_summary</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.kickstart.filepreservation">
<title>filepreservation_</title>
<simpara>The following spacecmd commands are available for working with kickstart file preservation lists.</simpara>
<variablelist>
<varlistentry>
<term>filepreservation_create</term>
<listitem>
<simpara>Create a file preservation list.</simpara>
<screen>usage: filepreservation_create [NAME] [FILE ...]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>filepreservation_delete</term>
<listitem>
<simpara>Delete a file preservation list.</simpara>
<screen>filepreservation_delete NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>filepreservation_details</term>
<listitem>
<simpara>Show the details of a file preservation list.</simpara>
<screen>usage: filepreservation_details NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>filepreservation_list</term>
<listitem>
<simpara>List all file preservations.</simpara>
<screen>usage: filepreservation_list</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.get">
<title>get_</title>
<variablelist>
<varlistentry>
<term>get_apiversion</term>
<listitem>
<simpara>Display the API version of the server.</simpara>
<screen>usage: get_apiversion</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>get_certificateexpiration</term>
<listitem>
<simpara>Print the expiration date of the server&#8217;s entitlement certificate.</simpara>
<screen>usage: get_certificateexpiration</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>get_serverversion</term>
<listitem>
<simpara>Display SUSE Manager server version.</simpara>
<screen>usage: get_serverversion</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>get_session</term>
<listitem>
<simpara>Show the current session string.</simpara>
<screen>usage: get_session</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.group">
<title>group_</title>
<variablelist>
<varlistentry>
<term>group_addsystems</term>
<listitem>
<simpara>Add systems to a group.</simpara>
<screen>usage: group_addsystems GROUP &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_backup</term>
<listitem>
<simpara>Backup a system group.</simpara>
<screen>usage: group_backup NAME [OUTDIR]

OUTDIR defaults to $HOME/spacecmd-backup/group/YYYY-MM-DD/NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_create</term>
<listitem>
<simpara>Create a system group.</simpara>
<screen>usage: group_create [NAME] [DESCRIPTION]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_delete</term>
<listitem>
<simpara>Delete a system group.</simpara>
<screen>usage: group_delete NAME ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_details</term>
<listitem>
<simpara>Show the details of a system group.</simpara>
<screen>usage: group_details GROUP ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_list</term>
<listitem>
<simpara>List available system groups.</simpara>
<screen>usage: group_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_listsystems</term>
<listitem>
<simpara>List the members of a group.</simpara>
<screen>usage: group_listsystems GROUP</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_removesystems</term>
<listitem>
<simpara>Remove systems from a group.</simpara>
<screen>usage: group_removesystems GROUP &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>group_restore</term>
<listitem>
<simpara>Restore a system group.</simpara>
<screen>usage: group_backup INPUTDIR [NAME] ...</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.help">
<title>help</title>
<simpara>List all available spacecmd commands with the help function.
Check for additional help on a specific function by calling for example:<literal role="command">user_create
                    --help</literal>.</simpara>
<screen>Documented commands (type help &lt;topic&gt;):
========================================
activationkey_addchildchannels         org_trustdetails
activationkey_addconfigchannels        package_details
activationkey_addentitlements          package_listdependencies
activationkey_addgroups                package_listerrata
activationkey_addpackages              package_listinstalledsystems
activationkey_clone                    package_listorphans
activationkey_create                   package_remove
activationkey_delete                   package_removeorphans
activationkey_details                  package_search
activationkey_diff                     repo_addfilters
activationkey_disable                  repo_clearfilters
activationkey_disableconfigdeployment  repo_create
activationkey_enable                   repo_delete
activationkey_enableconfigdeployment   repo_details
activationkey_export                   repo_list
activationkey_import                   repo_listfilters
activationkey_list                     repo_removefilters
activationkey_listbasechannel          repo_rename
activationkey_listchildchannels        repo_setfilters
activationkey_listconfigchannels       repo_updatessl
activationkey_listentitlements         repo_updateurl
activationkey_listgroups               report_duplicates
activationkey_listpackages             report_errata
activationkey_listsystems              report_inactivesystems
activationkey_removechildchannels      report_ipaddresses
activationkey_removeconfigchannels     report_kernels
activationkey_removeentitlements       report_outofdatesystems
activationkey_removegroups             report_ungroupedsystems
activationkey_removepackages           scap_getxccdfscandetails
activationkey_setbasechannel           scap_getxccdfscanruleresults
activationkey_setconfigchannelorder    scap_listxccdfscans
activationkey_setcontactmethod         scap_schedulexccdfscan
activationkey_setdescription           schedule_cancel
activationkey_setuniversaldefault      schedule_details
activationkey_setusagelimit            schedule_getoutput
api                                    schedule_list
clear                                  schedule_listarchived
clear_caches                           schedule_listcompleted
configchannel_addfile                  schedule_listfailed
configchannel_backup                   schedule_listpending
configchannel_clone                    schedule_reschedule
configchannel_create                   snippet_create
configchannel_delete                   snippet_delete
configchannel_details                  snippet_details
configchannel_diff                     snippet_list
configchannel_export                   snippet_update
configchannel_filedetails              softwarechannel_adderrata
configchannel_forcedeploy              softwarechannel_adderratabydate
configchannel_import                   softwarechannel_addpackages
configchannel_list                     softwarechannel_addrepo
configchannel_listfiles                softwarechannel_clone
configchannel_listsystems              softwarechannel_clonetree
configchannel_removefiles              softwarechannel_create
configchannel_sync                     softwarechannel_delete
configchannel_updatefile               softwarechannel_details
configchannel_verifyfile               softwarechannel_diff
cryptokey_create                       softwarechannel_errata_diff
cryptokey_delete                       softwarechannel_errata_sync
cryptokey_details                      softwarechannel_getorgaccess
cryptokey_list                         softwarechannel_list
custominfo_createkey                   softwarechannel_listallpackages
custominfo_deletekey                   softwarechannel_listbasechannels
custominfo_details                     softwarechannel_listchildchannels
custominfo_listkeys                    softwarechannel_listerrata
custominfo_updatekey                   softwarechannel_listerratabydate
distribution_create                    softwarechannel_listlatestpackages
distribution_delete                    softwarechannel_listpackages
distribution_details                   softwarechannel_listrepos
distribution_list                      softwarechannel_listsyncschedule
distribution_rename                    softwarechannel_listsystems
distribution_update                    softwarechannel_mirrorpackages
errata_apply                           softwarechannel_regenerateneededcache
errata_delete                          softwarechannel_regenerateyumcache
errata_details                         softwarechannel_removeerrata
errata_findbycve                       softwarechannel_removepackages
errata_list                            softwarechannel_removerepo
errata_listaffectedsystems             softwarechannel_removesyncschedule
errata_listcves                        softwarechannel_setorgaccess
errata_publish                         softwarechannel_setsyncschedule
errata_search                          softwarechannel_sync
errata_summary                         softwarechannel_syncrepos
filepreservation_create                ssm_add
filepreservation_delete                ssm_clear
filepreservation_details               ssm_intersect
filepreservation_list                  ssm_list
get_apiversion                         ssm_remove
get_certificateexpiration              system_addchildchannels
get_serverversion                      system_addconfigchannels
get_session                            system_addconfigfile
group_addsystems                       system_addcustomvalue
group_backup                           system_addentitlements
group_create                           system_addnote
group_delete                           system_applyerrata
group_details                          system_comparepackageprofile
group_list                             system_comparepackages
group_listsystems                      system_comparewithchannel
group_removesystems                    system_createpackageprofile
group_restore                          system_delete
help                                   system_deletecrashes
history                                system_deletenotes
kickstart_addactivationkeys            system_deletepackageprofile
kickstart_addchildchannels             system_deployconfigfiles
kickstart_addcryptokeys                system_details
kickstart_addfilepreservations         system_getcrashfiles
kickstart_addoption                    system_installpackage
kickstart_addpackages                  system_list
kickstart_addscript                    system_listbasechannel
kickstart_addvariable                  system_listchildchannels
kickstart_clone                        system_listconfigchannels
kickstart_create                       system_listconfigfiles
kickstart_delete                       system_listcrashedsystems
kickstart_details                      system_listcrashesbysystem
kickstart_diff                         system_listcustomvalues
kickstart_disableconfigmanagement      system_listentitlements
kickstart_disableremotecommands        system_listerrata
kickstart_enableconfigmanagement       system_listevents
kickstart_enablelogging                system_listhardware
kickstart_enableremotecommands         system_listinstalledpackages
kickstart_export                       system_listnotes
kickstart_getcontents                  system_listpackageprofiles
kickstart_getsoftwaredetails           system_listupgrades
kickstart_getupdatetype                system_lock
kickstart_import                       system_reboot
kickstart_import_raw                   system_removechildchannels
kickstart_importjson                   system_removeconfigchannels
kickstart_list                         system_removecustomvalues
kickstart_listactivationkeys           system_removeentitlement
kickstart_listchildchannels            system_removepackage
kickstart_listcryptokeys               system_rename
kickstart_listcustomoptions            system_runscript
kickstart_listoptions                  system_schedulehardwarerefresh
kickstart_listpackages                 system_schedulepackagerefresh
kickstart_listscripts                  system_search
kickstart_listvariables                system_setbasechannel
kickstart_removeactivationkeys         system_setconfigchannelorder
kickstart_removechildchannels          system_setcontactmethod
kickstart_removecryptokeys             system_show_packageversion
kickstart_removefilepreservations      system_syncpackages
kickstart_removeoptions                system_unlock
kickstart_removepackages               system_updatecustomvalue
kickstart_removescript                 system_upgradepackage
kickstart_removevariables              toggle_confirmations
kickstart_rename                       user_adddefaultgroup
kickstart_setcustomoptions             user_addgroup
kickstart_setdistribution              user_addrole
kickstart_setlocale                    user_create
kickstart_setpartitions                user_delete
kickstart_setselinux                   user_details
kickstartsetupdatetype                user_disable
kickstart_updatevariable               user_enable
list_proxies                           user_list
login                                  user_listavailableroles
logout                                 user_removedefaultgroup
org_addtrust                           user_removegroup
org_create                             user_removerole
org_delete                             user_setemail
org_details                            user_setfirstname
org_list                               user_setlastname
org_listtrusts                         user_setpassword
org_listusers                          user_setprefix
org_removetrust                        whoami
org_rename                             whoamitalkingto


Miscellaneous help topics:
==========================
time  systems  ssm</screen>
</section>
<section xml:id="at.spacecmd.history">
<title>history</title>
<simpara>List recent commands using the <literal role="command">history</literal> command.</simpara>
<screen>spacecmd {SSM:0}&gt; history
   1  help
   2  api
   3  exit
   4  help
   5  time --help
   6  quit
   7  clear
spacecmd {SSM:0}&gt;</screen>
</section>
<section xml:id="at.spacecmd.kickstart">
<title>kickstart_</title>
<simpara>The following spacecmd functions are available for use with kickstart.</simpara>
<variablelist>
<varlistentry>
<term>kickstart_addactivationkeys</term>
<listitem>
<simpara>Add activation keys to a Kickstart profile.</simpara>
<screen>usage: kickstart_addactivationkeys PROFILE &lt;KEY ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addchildchannels</term>
<listitem>
<simpara>Add a child channels to a Kickstart profile.</simpara>
<screen>usage: kickstart_addchildchannels PROFILE &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addcryptokeys</term>
<listitem>
<simpara>Add cryptography keys to a Kickstart profile.</simpara>
<screen>usage: kickstart_addcryptokeys PROFILE &lt;KEY ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addfilepreservations</term>
<listitem>
<simpara>Add file preservations to a Kickstart profile.</simpara>
<screen>usage: kickstart_addfilepreservations PROFILE &lt;FILELIST ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addoption</term>
<listitem>
<simpara>Set an option for a Kickstart profile.</simpara>
<screen>usage: kickstart_addoption PROFILE KEY [VALUE]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addpackages</term>
<listitem>
<simpara>Add packages to a Kickstart profile.</simpara>
<screen>usage: kickstart_addpackages PROFILE &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addscript</term>
<listitem>
<simpara>Add a script to a Kickstart profile.</simpara>
<screen>usage: kickstart_addscript PROFILE [options]

options:
  -p PROFILE
  -e EXECUTION_TIME ['pre', 'post']
  -i INTERPRETER
  -f FILE
  -c execute in a chroot environment
  -t ENABLING_TEMPLATING</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_addvariable</term>
<listitem>
<simpara>Add a variable to a Kickstart profile.</simpara>
<screen>usage: kickstart_addvariable PROFILE KEY VALUE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_clone</term>
<listitem>
<simpara>Clone a Kickstart profile.</simpara>
<screen>usage: kickstart_clone [options]

options:
  -n NAME
  -c CLONE_NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_create</term>
<listitem>
<simpara>Create a Kickstart profile.</simpara>
<screen>usage: kickstart_create [options]

options:
  -n NAME
  -d DISTRIBUTION
  -p ROOT_PASSWORD
  -v VIRT_TYPE ['none', 'para_host', 'qemu', 'xenfv', 'xenpv']</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_delete</term>
<listitem>
<simpara>Delete kickstart profile(s).</simpara>
<screen>usage: kickstart_delete PROFILE
usage: kickstart_delete PROFILE1 PROFILE2
usage: kickstart_delete "PROF*"</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_details</term>
<listitem>
<simpara>Show the details of a Kickstart profile.</simpara>
<screen>usage: kickstart_details PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_diff</term>
<listitem>
<simpara>List differences between two kickstart files.</simpara>
<screen>usage: kickstart_diff SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_disableconfigmanagement</term>
<listitem>
<simpara>Disable configuration management on a Kickstart profile.</simpara>
<screen>usage: kickstart_disableconfigmanagement PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_disableremotecommands</term>
<listitem>
<simpara>Disable remote commands on a Kickstart profile.</simpara>
<screen>usage: kickstart_disableremotecommands PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_enableconfigmanagement</term>
<listitem>
<simpara>Enable configuration management on a Kickstart profile.</simpara>
<screen>usage: kickstart_enableconfigmanagement PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_enablelogging</term>
<listitem>
<simpara>Enable logging for a Kickstart profile.</simpara>
<screen>usage: kickstart_enablelogging PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_enableremotecommands</term>
<listitem>
<simpara>Enable remote commands on a Kickstart profile.</simpara>
<screen>usage: kickstart_enableremotecommands PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_export</term>
<listitem>
<simpara>Export kickstart profile(s) to json formatted file.</simpara>
<screen>usage: kickstart_export &lt;KSPROFILE&gt;... [options]
options:
    -f outfile.json : specify an output filename, defaults to &lt;KSPROFILE&gt;.json
                      if exporting a single kickstart, profiles.json for multiple
                      kickstarts, or ks_all.json if no KSPROFILE specified
                      e.g (export ALL)

Note : KSPROFILE list is optional, default is to export ALL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_getcontents</term>
<listitem>
<simpara>Show the contents of a Kickstart profile as they would be presented to a client.</simpara>
<screen>usage: kickstart_getcontents LABEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_getsoftwaredetails</term>
<listitem>
<simpara>Gets kickstart profile software details.</simpara>
<screen>usage: kickstart_getsoftwaredetails KS_LABEL
usage: kickstart_getsoftwaredetails KS_LABEL KS_LABEL2 ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_getupdatetype</term>
<listitem>
<simpara>Get the update type for a kickstart profile(s).</simpara>
<screen>usage: kickstart_getupdatetype PROFILE
usage: kickstart_getupdatetype PROFILE1 PROFILE2
usage: kickstart_getupdatetype "PROF*"</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_import</term>
<listitem>
<simpara>Import a Kickstart profile from a file.</simpara>
<screen>usage: kickstart_import [options]

options:
  -f FILE
  -n NAME
  -d DISTRIBUTION
  -v VIRT_TYPE ['none', 'para_host', 'qemu', 'xenfv', 'xenpv']</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_import_raw</term>
<listitem>
<simpara>Import a raw Kickstart or autoyast profile from a file.</simpara>
<screen>usage: kickstart_import_raw [options]

options:
  -f FILE
  -n NAME
  -d DISTRIBUTION
  -v VIRT_TYPE ['none', 'para_host', 'qemu', 'xenfv', 'xenpv']</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_importjson</term>
<listitem>
<simpara>Import kickstart profile(s) from json file.</simpara>
<screen>usage: kickstart_import &lt;JSONFILES...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_list</term>
<listitem>
<simpara>List the available Kickstart profiles.</simpara>
<screen>usage: kickstart_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listactivationkeys</term>
<listitem>
<simpara>List the activation keys associated with a Kickstart profile.</simpara>
<screen>usage: kickstart_listactivationkeys PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listchildchannels</term>
<listitem>
<simpara>List the child channels of a Kickstart profile.</simpara>
<screen>usage: kickstart_listchildchannels PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listcryptokeys</term>
<listitem>
<simpara>List the crypto keys associated with a Kickstart profile.</simpara>
<screen>usage: kickstart_listcryptokeys PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listcustomoptions</term>
<listitem>
<simpara>List the custom options of a Kickstart profile.</simpara>
<screen>usage: kickstart_listcustomoptions PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listoptions</term>
<listitem>
<simpara>List the options of a Kickstart profile.</simpara>
<screen>usage: kickstart_listoptions PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listpackages</term>
<listitem>
<simpara>List the packages for a Kickstart profile.</simpara>
<screen>usage: kickstart_listpackages PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listscripts</term>
<listitem>
<simpara>List the scripts for a Kickstart profile.</simpara>
<screen>usage: kickstart_listscripts PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_listvariables</term>
<listitem>
<simpara>List the variables of a Kickstart profile.</simpara>
<screen>usage: kickstart_listvariables PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removeactivationkeys</term>
<listitem>
<simpara>Remove activation keys from a Kickstart profile.</simpara>
<screen>usage: kickstart_removeactivationkeys PROFILE &lt;KEY ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removechildchannels</term>
<listitem>
<simpara>Remove child channels from a Kickstart profile.</simpara>
<screen>usage: kickstart_removechildchannels PROFILE &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removecryptokeys</term>
<listitem>
<simpara>Remove crypto keys from a Kickstart profile.</simpara>
<screen>usage: kickstart_removecryptokeys PROFILE &lt;KEY ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removefilepreservations</term>
<listitem>
<simpara>Remove file preservations from a Kickstart profile.</simpara>
<screen>usage: kickstart_removefilepreservations PROFILE &lt;FILE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removeoptions</term>
<listitem>
<simpara>Remove options from a Kickstart profile.</simpara>
<screen>usage: kickstart_removeoptions PROFILE &lt;OPTION ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removepackages</term>
<listitem>
<simpara>Remove packages from a Kickstart profile.</simpara>
<screen>usage: kickstart_removepackages PROFILE &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removescript</term>
<listitem>
<simpara>Add a script to a Kickstart profile.</simpara>
<screen>usage: kickstart_removescript PROFILE [ID]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_removevariables</term>
<listitem>
<simpara>Remove variables from a Kickstart profile.</simpara>
<screen>usage: kickstart_removevariables PROFILE &lt;KEY ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_rename</term>
<listitem>
<simpara>Rename a Kickstart profile</simpara>
<screen>usage: kickstart_rename OLDNAME NEWNAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_setcustomoptions</term>
<listitem>
<simpara>Set custom options for a Kickstart profile.</simpara>
<screen>usage: kickstart_setcustomoptions PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_setdistribution</term>
<listitem>
<simpara>Set the distribution for a Kickstart profile.</simpara>
<screen>usage: kickstart_setdistribution PROFILE DISTRIBUTION</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_setlocale</term>
<listitem>
<simpara>Set the locale for a Kickstart profile.</simpara>
<screen>usage: kickstart_setlocale PROFILE LOCALE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_setpartitions</term>
<listitem>
<simpara>Set the partitioning scheme for a Kickstart profile.</simpara>
<screen>usage: kickstart_setpartitions PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_setselinux</term>
<listitem>
<simpara>Set the SELinux mode for a Kickstart profile.</simpara>
<screen>usage: kickstart_setselinux PROFILE MODE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstartsetupdatetype</term>
<listitem>
<simpara>Set the update type for a kickstart profile(s).</simpara>
<screen>usage: kickstartsetupdatetype [options] KS_LABEL

options:
    -u UPDATE_TYPE ['red_hat', 'all', 'none']</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>kickstart_updatevariable</term>
<listitem>
<simpara>Update a variable in a Kickstart profile.</simpara>
<screen>usage: kickstart_updatevariable PROFILE KEY VALUE</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.list.proxies">
<title>list_proxies</title>
<simpara>The following spacecmd function is available for listing proxies.</simpara>
<variablelist>
<varlistentry>
<term>list_proxies</term>
<listitem>
<simpara>List the proxies within the user&#8217;s organization.</simpara>
<screen>usage: list_proxies</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.login">
<title>login</title>
<simpara>Connect as a specific user to the SUSE manager server.</simpara>
<screen># spacecmd -- login &lt;USERNAME&gt;</screen>
</section>
<section xml:id="at.spacecmd.logout">
<title>logout</title>
<simpara>Logout from server as the current user.</simpara>
<screen># spacecmd -- logout</screen>
</section>
<section xml:id="at.spacecmd.org">
<title>org_</title>
<simpara>The following spacecmd functions are available for use with organizations.</simpara>
<variablelist>
<varlistentry>
<term>org_addtrust</term>
<listitem>
<simpara>Add a trust between two organizations</simpara>
<screen>usage: org_addtrust YOUR_ORG ORG_TO_TRUST</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_create</term>
<listitem>
<simpara>Create an organization.</simpara>
<screen>usage: org_create [options]

options:
  -n ORG_NAME
  -u USERNAME
  -P PREFIX (Dr., Mr., Miss, Mrs., Ms.)
  -f FIRST_NAME
  -l LAST_NAME
  -e EMAIL
  -p PASSWORD
  --pam enable PAM authentication</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_delete</term>
<listitem>
<simpara>Delete an organization.</simpara>
<screen>usage: org_delete NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_details</term>
<listitem>
<simpara>Show the details of an organization.</simpara>
<screen>usage: org_details NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_list</term>
<listitem>
<simpara>List all organizations.</simpara>
<screen>usage: org_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_listtrusts</term>
<listitem>
<simpara>List an organization&#8217;s trusts.</simpara>
<screen>org_listtrusts NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_listusers</term>
<listitem>
<simpara>List an organization&#8217;s users.</simpara>
<screen>org_listusers NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_removetrust</term>
<listitem>
<simpara>Remove a trust between two organizations.</simpara>
<screen>usage: org_removetrust YOUR_ORG TRUSTED_ORG</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_rename</term>
<listitem>
<simpara>Rename an organization.</simpara>
<screen>usage: org_rename OLDNAME NEWNAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>org_trustdetails</term>
<listitem>
<simpara>Show the details of an organizational trust.</simpara>
<screen>usage: org_trustdetails TRUSTED_ORG</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.package">
<title>package_</title>
<simpara>The following spacecmd functions are available for working with packages.</simpara>
<variablelist>
<varlistentry>
<term>package_details</term>
<listitem>
<simpara>Show the details of a software package.</simpara>
<screen>usage: package_details PACKAGE ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_listdependencies</term>
<listitem>
<simpara>List the dependencies for a package.</simpara>
<screen>usage: package_listdependencies PACKAGE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_listerrata</term>
<listitem>
<simpara>List the errata that provide this package.</simpara>
<screen>usage: package_listerrata PACKAGE ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_listinstalledsystems</term>
<listitem>
<simpara>List the systems with a package installed.</simpara>
<screen>usage: package_listinstalledsystems PACKAGE ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_listorphans</term>
<listitem>
<simpara>List packages that are not in a channel.</simpara>
<screen>usage: package_listorphans</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_remove</term>
<listitem>
<simpara>Remove a package from SUSE Manager/Satellite</simpara>
<screen>usage: package_remove PACKAGE ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_removeorphans</term>
<listitem>
<simpara>Remove packages that are not in a channel.</simpara>
<screen>usage: package_removeorphans</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>package_search</term>
<listitem>
<simpara>Find packages that meet the given criteria.</simpara>
<screen>usage: package_search NAME|QUERY

Example: package_search kernel

Advanced Search:
Available Fields: name, epoch, version, release, arch, description, summary
Example: name:kernel AND version:2.6.18 AND -description:devel</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.repo">
<title>repo_</title>
<simpara>The following spacecmd functions are available for working with repositories.</simpara>
<variablelist>
<varlistentry>
<term>repo_addfilters</term>
<listitem>
<simpara>Add filters for a user repository.</simpara>
<screen>usage: repo_addfilters repo &lt;filter ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_clearfilters</term>
<listitem>
<simpara>Clears the filters for a user repository.</simpara>
<screen>usage: repo_clearfilters repo</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_create</term>
<listitem>
<simpara>Create a user repository.</simpara>
<screen>usage: repo_create &lt;options&gt;

options:
  -n, --name   name of repository
  -u, --url    url of repository

  --ca         SSL CA certificate (not required)
  --cert       SSL Client certificate (not required)
  --key        SSL Client key (not required)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_delete</term>
<listitem>
<simpara>Delete a user repository.</simpara>
<screen>usage: repo_delete &lt;repo ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_details</term>
<listitem>
<simpara>Show the details of a user repository.</simpara>
<screen>usage: repo_details &lt;repo ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_list</term>
<listitem>
<simpara>List all available user repository.</simpara>
<screen>usage: repo_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_listfilters</term>
<listitem>
<simpara>Show the filters for a user repository.</simpara>
<screen>usage: repo_listfilters repo</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_removefilters</term>
<listitem>
<simpara>Remove filters from a user repository.</simpara>
<screen>usage: repo_removefilters repo &lt;filter ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_rename</term>
<listitem>
<simpara>Rename a user repository.</simpara>
<screen>usage: repo_rename OLDNAME NEWNAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_setfilters</term>
<listitem>
<simpara>Set the filters for a user repo.</simpara>
<screen>usage: repo_setfilters repo &lt;filter ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_updatessl</term>
<listitem>
<simpara>Change the SSL certificates of a user repository.</simpara>
<screen>usage: repo_updatessl &lt;options&gt;
options:
  --ca         SSL CA certificate (not required)
  --cert       SSL Client certificate (not required)
  --key        SSL Client key (not required)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>repo_updateurl</term>
<listitem>
<simpara>Change the URL of a user repository.</simpara>
<screen>usage: repo_updateurl &lt;repo&gt; &lt;url&gt;</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.report">
<title>report_</title>
<simpara>The following spacecmd functions are available for working with reports.</simpara>
<variablelist>
<varlistentry>
<term>report_duplicates</term>
<listitem>
<simpara>List duplicate system profiles.</simpara>
<screen>usage: report_duplicates</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_errata</term>
<listitem>
<simpara>List all errata and how many systems they affect.</simpara>
<screen>usage: report_errata [ERRATA|search:XXX ...]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_inactivesystems</term>
<listitem>
<simpara>List all inactive systems.</simpara>
<screen>usage: report_inactivesystems [DAYS]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_ipaddresses</term>
<listitem>
<simpara>List the hostname and IP of each system.</simpara>
<screen>usage: report_network [&lt;SYSTEMS&gt;]

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_kernels</term>
<listitem>
<simpara>List the running kernel of each system.</simpara>
<screen>usage: report_kernels [&lt;SYSTEMS&gt;]

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_outofdatesystems</term>
<listitem>
<simpara>List all out-of-date systems.</simpara>
<screen>usage: report_outofdatesystems</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>report_ungroupedsystems</term>
<listitem>
<simpara>List all ungrouped systems.</simpara>
<screen>usage: report_ungroupedsystems</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.scap">
<title>scap_</title>
<simpara>The following spacecmd functions are available for working with OpenSCAP.</simpara>
<variablelist>
<varlistentry>
<term>scap_getxccdfscandetails</term>
<listitem>
<simpara>Get details of given OpenSCAP XCCDF scan.</simpara>
<screen>usage: scap_getxccdfscandetails &lt;XID&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>scap_getxccdfscanruleresults</term>
<listitem>
<simpara>Return a full list of RuleResults for given OpenSCAP XCCDF scan.</simpara>
<screen>usage: scap_getxccdfscanruleresults &lt;XID&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>scap_listxccdfscans</term>
<listitem>
<simpara>Return a list of finished OpenSCAP scans for given systems.</simpara>
<screen>usage: scap_listxccdfscans &lt;SYSTEMS&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>scap_schedulexccdfscan</term>
<listitem>
<simpara>Schedule Scap XCCDF scan.</simpara>
<screen>usage: scap_schedulexccdfscan PATH_TO_XCCDF_FILE XCCDF_OPTIONS SYSTEMS

Example:
&gt; scap_schedulexccdfscan '/usr/share/openscap/scap-security-xccdf.xml' 'profile Web-Default' \
system-scap.example.com</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.schedule">
<title>schedule_</title>
<simpara>The following spacecmd functions are available for working with scheduling.</simpara>
<variablelist>
<varlistentry>
<term>schedule_cancel</term>
<listitem>
<simpara>Cancel a scheduled action.</simpara>
<screen>usage: schedule_cancel ID|* ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_details</term>
<listitem>
<simpara>Show the details of a scheduled action.</simpara>
<screen>usage: schedule_details ID</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_getoutput</term>
<listitem>
<simpara>Show the output from an action.</simpara>
<screen>usage: schedule_getoutput ID</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_list</term>
<listitem>
<simpara>List all actions.</simpara>
<screen>usage: schedule_list [BEGINDATE] [ENDDATE]

Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_listarchived</term>
<listitem>
<simpara>List archived actions.</simpara>
<screen>usage: schedule_listarchived [BEGINDATE] [ENDDATE]

Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_listcompleted</term>
<listitem>
<simpara>List completed actions.</simpara>
<screen>Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_listfailed</term>
<listitem>
<simpara>List failed actions.</simpara>
<screen>usage: schedule_listfailed [BEGINDATE] [ENDDATE]

Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_listpending</term>
<listitem>
<simpara>List pending actions.</simpara>
<screen>usage: schedule_listpending [BEGINDATE] [ENDDATE]

Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>schedule_reschedule</term>
<listitem>
<simpara>Reschedule failed actions.</simpara>
<screen>usage: schedule_reschedule ID|* ...</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.snippet">
<title>snippet_</title>
<simpara>The following spacecmd functions are available for working with Kickstart snippets.</simpara>
<variablelist>
<varlistentry>
<term>snippet_create</term>
<listitem>
<simpara>Create a Kickstart snippet</simpara>
<screen>usage: snippet_create [options]

options:
  -n NAME
  -f FILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>snippet_delete</term>
<listitem>
<simpara>Delete a Kickstart snippet.</simpara>
<screen>usage: snippet_removefile NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>snippet_details</term>
<listitem>
<simpara>Show the contents of a snippet.</simpara>
<screen>usage: snippet_details SNIPPET ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>snippet_list</term>
<listitem>
<simpara>List the available Kickstart snippets.</simpara>
<screen>usage: snippet_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>snippet_update</term>
<listitem>
<simpara>Update a Kickstart snippet.</simpara>
<screen>usage: snippet_update NAME</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.softwarechannel">
<title>softwarechannel_</title>
<simpara>The following spacecmd functions are available for working with software channels.</simpara>
<variablelist>
<varlistentry>
<term>softwarechannel_adderrata</term>
<listitem>
<simpara>Add patches from one channel into another channel.</simpara>
<screen>usage: softwarechannel_adderrata SOURCE DEST &lt;ERRATA|search:XXX ...&gt;
Options:
    -q/--quick : Don't display list of packages (slightly faster)
    -s/--skip :  Skip errata which appear to exist already in DEST</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_adderratabydate</term>
<listitem>
<simpara>Add errata from one channel into another channel based on a date range.</simpara>
<screen>usage: softwarechannel_adderratabydate [options] SOURCE DEST BEGINDATE ENDDATE
Date format : YYYYMMDD
Options:
        -p/--publish : Publish errata to the channel (don't clone)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_addpackages</term>
<listitem>
<simpara>Add packages to a software channel.</simpara>
<screen>usage: softwarechannel_addpackages CHANNEL &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_addrepo</term>
<listitem>
<simpara>Add a repo to a software channel.</simpara>
<screen>usage: softwarechannel_addrepo CHANNEL REPO</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_clone</term>
<listitem>
<simpara>Clone a software channel.</simpara>
<screen>usage: softwarechannel_clone [options]

options:
  -s SOURCE_CHANNEL
  -n NAME
  -l LABEL
  -p PARENT_CHANNEL
  --gpg-copy/-g (copy SOURCE_CHANNEL GPG details)
  --gpg-url GPG_URL
  --gpg-id GPG_ID
  --gpg-fingerprint GPG_FINGERPRINT
  -o do not clone any patches
  --regex/-x "s/foo/bar" : Optional regex replacement,
        replaces foo with bar in the clone name and label</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_clonetree</term>
<listitem>
<simpara>Clone a software channel and its child channels.</simpara>
<screen>usage: softwarechannel_clonetree [options]A
             e.g    softwarechannel_clonetree foobasechannel -p "my_"
                    softwarechannel_clonetree foobasechannel -x "s/foo/bar"
                    softwarechannel_clonetree foobasechannel -x "s/^/my_"

options:
  -s/--source-channel SOURCE_CHANNEL
  -p/--prefix PREFIX (is prepended to the label and name of all channels)
  --gpg-copy/-g (copy GPG details for correspondoing source channel))
  --gpg-url GPG_URL (applied to all channels)
  --gpg-id GPG_ID (applied to all channels)
  --gpg-fingerprint GPG_FINGERPRINT (applied to all channels)
  -o do not clone any errata
  --regex/-x "s/foo/bar" : Optional regex replacement,
        replaces foo with bar in the clone name, label and description</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_create</term>
<listitem>
<simpara>Create a software channel.</simpara>
<screen>usage: softwarechannel_create [options]

options:
  -n NAME
  -l LABEL
  -p PARENT_CHANNEL
  -a ARCHITECTURE ['ia32', 'ia64', 'x86_64', 'ppc',
                  'i386-sun-solaris', 'sparc-sun-solaris']
  -c CHECKSUM ['sha1', 'sha256', 'sha384', 'sha512']
  -u GPG_URL
  -i GPG_ID
  -f GPG_FINGERPRINT</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_delete</term>
<listitem>
<simpara>Delete a software channel.</simpara>
<screen>usage: softwarechannel_delete &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_details</term>
<listitem>
<simpara>Show the details of a software channel.</simpara>
<screen>usage: softwarechannel_details &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_diff</term>
<listitem>
<simpara>Check the difference between software channels.</simpara>
<screen>usage: softwarechannel_diff SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_errata_diff</term>
<listitem>
<simpara>Check the difference between software channel files.</simpara>
<screen>usage: softwarechannel_errata_diff SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_errata_sync</term>
<listitem>
<simpara>Sync errata of two software channels.</simpara>
<screen>usage: softwarechannel_errata_sync SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_getorgaccess</term>
<listitem>
<simpara>Get the org-access for the software channel.</simpara>
<screen>usage : softwarechannel_getorgaccess : get org access for all channels
usage : softwarechannel_getorgaccess &lt;channel_label(s)&gt; : get org access for specific channel(s)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_list</term>
<listitem>
<simpara>List all available software channels.</simpara>
<screen>usage: softwarechannel_list [options]'
options:
  -v verbose (display label and summary)
  -t tree view (pretty-print child-channels)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listallpackages</term>
<listitem>
<simpara>List all packages in a channel.</simpara>
<screen>usage: softwarechannel_listallpackages CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listbasechannels</term>
<listitem>
<simpara>List all base software channels.</simpara>
<screen>usage: softwarechannel_listbasechannels [options]
options:
  -v verbose (display label and summary)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listchildchannels</term>
<listitem>
<simpara>List child software channels.</simpara>
<screen>usage:
softwarechannel_listchildchannels [options]
softwarechannel_listchildchannels : List all child channels
softwarechannel_listchildchannels CHANNEL : List children for a specific base channel
options:
 -v verbose (display label and summary)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listerrata</term>
<listitem>
<simpara>List the errata associated with a software channel.</simpara>
<screen>usage: softwarechannel_listerrata &lt;CHANNEL ...&gt; [from=yyyymmdd [to=yyyymmdd]]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listerratabydate</term>
<listitem>
<simpara>List errata from channelbased on a date range.</simpara>
<screen>usage: softwarechannel_listerratabydate CHANNEL BEGINDATE ENDDATE
Date format : YYYYMMDD</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listlatestpackages</term>
<listitem>
<simpara>List the newest version of all packages in a channel.</simpara>
<screen>usage: softwarechannel_listlatestpackages CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listpackages</term>
<listitem>
<simpara>List the most recent packages available from a software channel.</simpara>
<screen>usage: softwarechannel_listpackages CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listrepos</term>
<listitem>
<simpara>List the repos for a software channel.</simpara>
<screen>usage: softwarechannel_listrepos CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listsyncschedule</term>
<listitem>
<simpara>List sync schedules for all software channels.</simpara>
<screen>usage: softwarechannel_listsyncschedule : List all channels</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_listsystems</term>
<listitem>
<simpara>List all systems subscribed to a software channel.</simpara>
<screen>usage: softwarechannel_listsystems CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_mirrorpackages</term>
<listitem>
<simpara>Download packages of a given channel.</simpara>
<screen>usage: softwarechannel_mirrorpackages CHANNEL
Options:
    -l/--latest : Only mirror latest package version</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_regenerateneededcache</term>
<listitem>
<simpara>Regenerate the needed errata and package cache for all systems.</simpara>
<screen>usage: softwarechannel_regenerateneededcache</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_regenerateyumcache</term>
<listitem>
<simpara>Regenerate the YUM cache for a software channel.</simpara>
<screen>usage: softwarechannel_regenerateyumcache &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_removeerrata</term>
<listitem>
<simpara>Remove patches from a software channel.</simpara>
<screen>usage: softwarechannel_removeerrata CHANNEL &lt;ERRATA:search:XXX ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_removepackages</term>
<listitem>
<simpara>Remove packages from a software channel.</simpara>
<screen>usage: softwarechannel_removepackages CHANNEL &lt;PACKAGE ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_removerepo</term>
<listitem>
<simpara>Remove a repo from a software channel.</simpara>
<screen>usage: softwarechannel_removerepo CHANNEL REPO</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_removesyncschedule</term>
<listitem>
<simpara>Removes the repo sync schedule for a software channel.</simpara>
<screen>usage: softwarechannel_setsyncschedule &lt;CHANNEL&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_setorgaccess</term>
<listitem>
<simpara>Set the org-access for the software channel.</simpara>
<screen>usage : softwarechannel_setorgaccess &lt;channel_label&gt; [options]
-d,--disable : disable org access (private, no org sharing)
-e,--enable : enable org access (public access to all trusted orgs)</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_setsyncschedule</term>
<listitem>
<simpara>Sets the repo sync schedule for a software channel.</simpara>
<screen>usage: softwarechannel_setsyncschedule &lt;CHANNEL&gt; &lt;SCHEDULE&gt;

The schedule is specified in Quartz CronTrigger format without enclosing quotes.
For example, to set a schedule of every day at 1am, &lt;SCHEDULE&gt; would be 0 0 1 * * ?</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_sync</term>
<listitem>
<simpara>Sync the packages of two software channels.</simpara>
<screen>usage: softwarechannel_sync SOURCE_CHANNEL TARGET_CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>softwarechannel_syncrepos</term>
<listitem>
<simpara>Sync users repos for a software channel.</simpara>
<screen>usage: softwarechannel_syncrepos &lt;CHANNEL ...&gt;</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.ssm">
<title>ssm_</title>
<simpara>The following spacecmd functions are available for use with System Set Manager.</simpara>
<variablelist>
<varlistentry>
<term>ssm_add</term>
<listitem>
<simpara>Add systems to the SSM.</simpara>
<screen>usage: ssm_add &lt;SYSTEMS&gt;

see 'help ssm' for more details

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>ssm_clear</term>
<listitem>
<simpara>Remove all systems from the SSM.</simpara>
<screen>usage: ssm_clear</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>ssm_intersect</term>
<listitem>
<simpara>Replace the current SSM with the intersection of the current list of systems and the list of systems passed as arguments.</simpara>
<screen>usage: ssm_intersect &lt;SYSTEMS&gt;

see 'help ssm' for more details

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>ssm_list</term>
<listitem>
<simpara>List the systems currently in the SSM.</simpara>
<screen>usage: ssm_list

see 'help ssm' for more details</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>ssm_remove</term>
<listitem>
<simpara>Remove systems from the SSM.</simpara>
<screen>usage: ssm_remove &lt;SYSTEMS&gt;

see 'help ssm' for more details

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.system">
<title>system_</title>
<simpara>The following spacecmd functions are available for use with systems.</simpara>
<variablelist>
<varlistentry>
<term>system_addchildchannels</term>
<listitem>
<simpara>Add child channels to a system.</simpara>
<screen>usage: system_addchildchannels &lt;SYSTEMS&gt; &lt;CHANNEL ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_addconfigchannels</term>
<listitem>
<simpara>Add config channels to a system.</simpara>
<screen>usage: system_addconfigchannels &lt;SYSTEMS&gt; &lt;CHANNEL ...&gt; [options]

options:
  -t add channels to the top of the list
  -b add channels to the bottom of the list

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_addconfigfile</term>
<listitem>
<simpara>Create a configuration file.</simpara>
<screen>Note this is only for system sandbox or locally-managed files
Centrally managed files should be created via configchannel_addfile
usage: system_addconfigfile [SYSTEM] [options]

options:
  -S/--sandbox : list only system-sandbox files
  -L/--local   : list only locally managed files
  -p PATH
  -r REVISION
  -o OWNER [default: root]
  -g GROUP [default: root]
  -m MODE [defualt: 0644]
  -x SELINUX_CONTEXT
  -d path is a directory
  -s path is a symlink
  -b path is a binary (or other file which needs base64 encoding)
  -t SYMLINK_TARGET
  -f local path to file contents

  Note re binary/base64: Some text files, notably those containing trailing
  newlines, those containing ASCII escape characters (or other charaters not
  allowed in XML) need to be sent as binary (-b).  Some effort is made to auto-
  detect files which require this, but you may need to explicitly specify.</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_addcustomvalue</term>
<listitem>
<simpara>Set a custom value for a system.</simpara>
<screen>usage: system_addcustomvalue KEY VALUE &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_addentitlements</term>
<listitem>
<simpara>Add entitlements to a system.</simpara>
<screen>usage: system_addentitlements &lt;SYSTEMS&gt; ENTITLEMENT

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_addnote</term>
<listitem>
<simpara>Set a note for a system.</simpara>
<screen>usage: system_addnote &lt;SYSTEM&gt; [options]

options:
  -s SUBJECT
  -b BODY

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_applyerrata</term>
<listitem>
<simpara>Apply errata to a system.</simpara>
<screen>usage: system_applyerrata &lt;SYSTEMS&gt; [ERRATA|search:XXX ...]

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_comparepackageprofile</term>
<listitem>
<simpara>Compare a system against a package profile.</simpara>
<screen>usage: system_comparepackageprofile &lt;SYSTEMS&gt; PROFILE

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_comparepackages</term>
<listitem>
<simpara>Compare the packages between two systems.</simpara>
<screen>usage: system_comparepackages SOME_SYSTEM ANOTHER_SYSTEM</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_comparewithchannel</term>
<listitem>
<simpara>Compare the installed packages on a system with those in the channels it is registered to, or optionally some other channel.</simpara>
<screen>usage: system_comparewithchannel &lt;SYSTEMS&gt; [options]
options:
         -c/--channel : Specific channel to compare against,
                        default is those subscribed to, including
                        child channels

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_createpackageprofile</term>
<listitem>
<simpara>Create a package profile.</simpara>
<screen>usage: system_createpackageprofile SYSTEM [options]

options:
  -n NAME
  -d DESCRIPTION</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_delete</term>
<listitem>
<simpara>Delete a system profile.</simpara>
<screen>usage: system_delete &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_deletecrashes</term>
<listitem>
<simpara>Delete crashes reported by spacewalk-abrt.</simpara>
<screen>usage: Delete all crashes for all systems    : system_deletecrashes [--verbose]
usage: Delete all crashes for a single system: system_deletecrashes -i sys_id [--verbose]
usage: Delete a single crash record          : system_deletecrashes -c crash_id [--verbose]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_deletenotes</term>
<listitem>
<simpara>Delete notes from a system.</simpara>
<screen>usage: system_deletenotes &lt;SYSTEM&gt; &lt;ID|*&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_deletepackageprofile</term>
<listitem>
<simpara>Delete a package profile.</simpara>
<screen>usage: system_deletepackageprofile PROFILE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_deployconfigfiles</term>
<listitem>
<simpara>Deploy all configuration files for a system.</simpara>
<screen>usage: system_deployconfigfiles &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_details</term>
<listitem>
<simpara>Show the details of a system profile.</simpara>
<screen>usage: system_details &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_getcrashfiles</term>
<listitem>
<simpara>Download all files for a crash record.</simpara>
<screen>usage: system_getcrashfiles -c crash_id [--verbose]
usage: system_getcrashfiles -c crash_id [--dest_folder=/tmp/crash_files] [--verbose]</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_installpackage</term>
<listitem>
<simpara>Install a package on a system.</simpara>
<screen>usage: system_installpackage &lt;SYSTEMS&gt; &lt;PACKAGE ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_list</term>
<listitem>
<simpara>List all system profiles.</simpara>
<screen>usage: system_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listbasechannel</term>
<listitem>
<simpara>List the base channel for a system.</simpara>
<screen>usage: system_listbasechannel &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listchildchannels</term>
<listitem>
<simpara>List the child channels for a system.</simpara>
<screen>usage: system_listchildchannels &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listconfigchannels</term>
<listitem>
<simpara>List the config channels of a system.</simpara>
<screen>usage: system_listconfigchannels &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listconfigfiles</term>
<listitem>
<simpara>List the managed config files of a system.</simpara>
<screen>usage: system_listconfigfiles &lt;SYSTEMS&gt;'
options:
  -s/--sandbox : list only system-sandbox files
  -l/--local   : list only locally managed files
  -c/--central : list only centrally managed files
  -q/--quiet   : quiet mode (omits the header)

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listcrashedsystems</term>
<listitem>
<simpara>List all systems that have experienced a crash and reported by spacewalk-abrt.</simpara>
<screen>usage: system_listcrashedsystems</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listcrashesbysystem</term>
<listitem>
<simpara>List all reported crashes for a system.</simpara>
<screen>usage: system_listcrashesbysystem -i sys_id</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listcustomvalues</term>
<listitem>
<simpara>List the custom values for a system.</simpara>
<screen>usage: system_listcustomvalues &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listentitlements</term>
<listitem>
<simpara>List the entitlements for a system.</simpara>
<screen>usage: system_listentitlements &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listerrata</term>
<listitem>
<simpara>List available errata for a system.</simpara>
<screen>usage: system_listerrata &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listevents</term>
<listitem>
<simpara>List the event history for a system.</simpara>
<screen>usage: system_listevents &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listhardware</term>
<listitem>
<simpara>List the hardware details of a system.</simpara>
<screen>usage: system_listhardware &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listinstalledpackages</term>
<listitem>
<simpara>List the installed packages on a system.</simpara>
<screen>usage: system_listinstalledpackages &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listnotes</term>
<listitem>
<simpara>List the available notes for a system.</simpara>
<screen>usage: system_listnotes &lt;SYSTEM&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listpackageprofiles</term>
<listitem>
<simpara>List all package profiles.</simpara>
<screen>usage: system_listpackageprofiles</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_listupgrades</term>
<listitem>
<simpara>List the available upgrades for a system.</simpara>
<screen>usage: system_listupgrades &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_lock</term>
<listitem>
<simpara>Lock a system.</simpara>
<screen>usage: system_lock &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_reboot</term>
<listitem>
<simpara>Reboot a system.</simpara>
<screen>usage: system_reboot &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_removechildchannels</term>
<listitem>
<simpara>Remove child channels from a system.</simpara>
<screen>usage: system_removechildchannels &lt;SYSTEMS&gt; &lt;CHANNEL ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_removeconfigchannels</term>
<listitem>
<simpara>Remove config channels from a system.</simpara>
<screen>usage: system_removeconfigchannels &lt;SYSTEMS&gt; &lt;CHANNEL ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_removecustomvalues</term>
<listitem>
<simpara>Remove a custom value for a system.</simpara>
<screen>usage: system_removecustomvalues &lt;SYSTEMS&gt; &lt;KEY ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_removeentitlement</term>
<listitem>
<simpara>Remove an entitlement from a system.</simpara>
<screen>usage: system_removeentitlement &lt;SYSTEMS&gt; ENTITLEMENT

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_removepackage</term>
<listitem>
<simpara>Remove a package from a system.</simpara>
<screen>usage: system_removepackage &lt;SYSTEMS&gt; &lt;PACKAGE ...&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_rename</term>
<listitem>
<simpara>Rename a system profile.</simpara>
<screen>usage: system_rename OLDNAME NEWNAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_runscript</term>
<listitem>
<simpara>Schedule a script to run on the list of systems provided.</simpara>
<screen>usage: system_runscript &lt;SYSTEMS&gt; [options]

options:
  -u USER
  -g GROUP
  -t TIMEOUT
  -s START_TIME
  -l LABEL
  -f FILE

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL


Dates can be any of the following:
Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_schedulehardwarerefresh</term>
<listitem>
<simpara>Schedule a hardware refresh for a system.</simpara>
<screen>usage: system_schedulehardwarerefresh &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_schedulepackagerefresh</term>
<listitem>
<simpara>Schedule a software package refresh for a system.</simpara>
<screen>usage: system_schedulepackagerefresh &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_search</term>
<listitem>
<simpara>List systems that match the given criteria.</simpara>
<screen>usage: system_search QUERY

Available Fields:
id
name
ip
hostname
device
vendor
driver
uuid

Examples:
&gt; system_search device:vmware
&gt; system_search ip:192.168.82</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_setbasechannel</term>
<listitem>
<simpara>Set a system&#8217;s base software channel.</simpara>
<screen>usage: system_setbasechannel &lt;SYSTEMS&gt; CHANNEL

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_setconfigchannelorder</term>
<listitem>
<simpara>Set the ranked order of configuration channels.</simpara>
<screen>usage: system_setconfigchannelorder &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_setcontactmethod</term>
<listitem>
<simpara>Set the contact method for given system(s).</simpara>
<screen>Available contact methods: ['default', 'ssh-push', 'ssh-push-tunnel']
usage: system_setcontactmethod &lt;SYSTEMS&gt; &lt;CONTACT_METHOD&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_show_packageversion</term>
<listitem>
<simpara>Shows version of installed package on given system(s).</simpara>
<screen>usage: system_show_packageversion &lt;SYSTEM&gt; &lt;PACKAGE&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_syncpackages</term>
<listitem>
<simpara>Sync packages between two systems.</simpara>
<screen>usage: system_syncpackages SOURCE TARGET</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_unlock</term>
<listitem>
<simpara>Unlock a system.</simpara>
<screen>usage: system_unlock &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_updatecustomvalue</term>
<listitem>
<simpara>Update a custom value for a system.</simpara>
<screen>usage: system_updatecustomvalue KEY VALUE &lt;SYSTEMS&gt;

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>system_upgradepackage</term>
<listitem>
<simpara>Upgrade a package on a system.</simpara>
<screen>usage: system_upgradepackage &lt;SYSTEMS&gt; &lt;PACKAGE ...&gt;|*

&lt;SYSTEMS&gt; can be any of the following:
name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.toggle">
<title>toggle_</title>
<variablelist>
<varlistentry>
<term>toggle_confirmations</term>
<listitem>
<simpara>Toggle confirmation messages on/off.</simpara>
<screen>usage: toggle_confirmations</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.user">
<title>user_</title>
<variablelist>
<varlistentry>
<term>user_adddefaultgroup</term>
<listitem>
<simpara>Add a default group to an user account.</simpara>
<screen>usage: user_adddefaultgroup USER &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_addgroup</term>
<listitem>
<simpara>Add a group to an user account.</simpara>
<screen>usage: user_addgroup USER &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_addrole</term>
<listitem>
<simpara>Add a role to an user account.</simpara>
<screen>usage: user_addrole USER ROLE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_create</term>
<listitem>
<simpara>Create an user.</simpara>
<screen>usage: user_create [options]

options:
  -u USERNAME
  -f FIRST_NAME
  -l LAST_NAME
  -e EMAIL
  -p PASSWORD
  --pam enable PAM authentication</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_delete</term>
<listitem>
<simpara>Delete an user.</simpara>
<screen>usage: user_delete NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_details</term>
<listitem>
<simpara>Show the details of an user.</simpara>
<screen>usage: user_details USER ...</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_disable</term>
<listitem>
<simpara>Disable an user account.</simpara>
<screen>usage: user_disable NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_enable</term>
<listitem>
<simpara>Enable an user account.</simpara>
<screen>usage: user_enable NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_list</term>
<listitem>
<simpara>List all users.</simpara>
<screen>usage: user_list</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_listavailableroles</term>
<listitem>
<simpara>List all available roles for users.</simpara>
<screen>usage: user_listavailableroles</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_removedefaultgroup</term>
<listitem>
<simpara>Remove a default group from an user account.</simpara>
<screen>usage: user_removedefaultgroup USER &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_removegroup</term>
<listitem>
<simpara>Remove a group to an user account.</simpara>
<screen>usage: user_removegroup USER &lt;GROUP ...&gt;</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_removerole</term>
<listitem>
<simpara>Remove a role from an user account.</simpara>
<screen>usage: user_removerole USER ROLE</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_setemail</term>
<listitem>
<simpara>Set an user accounts email field.</simpara>
<screen>usage: user_setemail USER EMAIL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_setfirstname</term>
<listitem>
<simpara>Set an user accounts first name field.</simpara>
<screen>usage: user_setfirstname USER FIRST_NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_setlastname</term>
<listitem>
<simpara>Set an user accounts last name field.</simpara>
<screen>usage: user_setlastname USER LAST_NAME</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_setpassword</term>
<listitem>
<simpara>Set an user accounts name prefix field.</simpara>
<screen>usage: user_setpassword USER PASSWORD</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>user_setprefix</term>
<listitem>
<simpara>Set an user accounts name prefix field.</simpara>
<screen>usage: user_setprefix USER PREFIX</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.whoami">
<title>whoami</title>
<simpara>The following command is available for returning the currently logged spacecmd username.</simpara>
<variablelist>
<varlistentry>
<term>whoami</term>
<listitem>
<simpara>Print the currently logged spacecmd user.</simpara>
<screen>spacecmd {SSM:0}&gt; whoami
admin</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.whoamitalkingto">
<title>whoamitalkingto</title>
<simpara>The following spacecmd function is available for returning the server hostname.</simpara>
<variablelist>
<varlistentry>
<term>whoamitalkingto</term>
<listitem>
<simpara>Return the server hostname that spacecmd is connected with.</simpara>
<screen>spacecmd {SSM:0}&gt; whoamitalkingto
MGR_SERVER_HOSTNAME</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="at.spacecmd.misc.help.topics">
<title>Miscellaneous Help Topics</title>
<simpara>The following help topics are printed with all functions requiring the relevant information.</simpara>
<variablelist>
<varlistentry>
<term>time</term>
<listitem>
<simpara>Dates can be any of the following:</simpara>
<screen>Explicit Dates:
Dates can be expressed as explicit date strings in the YYYYMMDD[HHMM]
format.  The year, month and day are required, while the hours and
minutes are not; the hours and minutes will default to 0000 if no
values are provided.

Deltas:
Dates can be expressed as delta values.  For example, '2h' would
mean 2 hours in the future.  You can also use negative values to
express times in the past (e.g., -7d would be one week ago).

Units:
s -&gt; seconds
m -&gt; minutes
h -&gt; hours
d -&gt; days</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>systems</term>
<listitem>
<simpara>&lt;SYSTEMS&gt; can be any of the following:</simpara>
<screen>name
ssm (see 'help ssm')
search:QUERY (see 'help system_search')
group:GROUP
channel:CHANNEL</screen>
</listitem>
</varlistentry>
<varlistentry>
<term>ssm</term>
<listitem>
<simpara>The System Set Manager (SSM) is a group of systems that you</simpara>
<simpara>can perform tasks on as a group.</simpara>
<screen>Adding Systems:
&gt; ssm_add group:rhel5-x86_64
&gt; ssm_add channel:rhel-x86_64-server-5
&gt; ssm_add search:device:vmware
&gt; ssm_add host.example.com

Intersections:
&gt; ssm_add group:rhel5-x86_64
&gt; ssm_intersect group:web-servers

Using the SSM:
&gt; system_installpackage ssm zsh
&gt; system_runscript ssm</screen>
</listitem>
</varlistentry>
</variablelist>
</section>
</section>
</chapter>
<appendix xml:id="advanced.topics.app.ports">
<title>Ports</title>
<section xml:id="advanced.topics.app.ports.server">
<title>SUSE Manager Server</title>
<simpara>Some ports are only relevant if you actually run the related service on the SUSE Manager server.</simpara>
<variablelist>
<title>Ports to Open on SUSE ManagerServer</title>
<varlistentry>
<term>67</term>
<listitem>
<simpara>Inbound / TCP/UDP / DHCP</simpara>
<simpara>Required when SUSE Manager is configured as a DHCP server for systems requesting IP addresses.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>69</term>
<listitem>
<simpara>Inbound / TCP/UDP / TFTP</simpara>
<simpara>Used when SUSE Manager is configured as a PXE server and allows installation and re-installation of PXE-boot enabled systems.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>80</term>
<listitem>
<simpara>Inbound / TCP / HTTP</simpara>
<simpara>Client and proxy server requests travel via HTTP or HTTPS.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>80</term>
<listitem>
<simpara>Outbound / TCP / HTTP</simpara>
<simpara>Used to contact SUSE Customer Center/Novell Customer Center.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>443</term>
<listitem>
<simpara>Inbound / TCP / HTTPS</simpara>
<simpara>All Web UI, client, and proxy server requests travel via HTTP or HTTPS.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>443</term>
<listitem>
<simpara>Outbound / TCP / HTTPS</simpara>
<simpara>SUSE Manager uses this port to reach SUSE Customer Center (unless running in a disconnected mode with RMT or SMT-as described in <xref linkend="disconnect-setup"/>).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>5222</term>
<listitem>
<simpara>Inbound / TCP / osad</simpara>
<simpara>When you wish to push actions to clients this port is required by the <literal role="systemitem">osad</literal> daemon running on your client systems.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>5269</term>
<listitem>
<simpara>Inbound/Outbound / TCP / jabberd</simpara>
<simpara>Needed if you push actions to or via a SUSE Manager Proxy.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>4505</term>
<listitem>
<simpara>Inbound / TCP / salt</simpara>
<simpara>Required by the Salt-master to accept communication requests via TCP from minions.
The connection is initiated by the minion and remains open to allow the master to send commands.
This port uses a publish/subscribe topology; the minion subscribes to notifications from the master.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>4506</term>
<listitem>
<simpara>Inbound / TCP / salt</simpara>
<simpara>Required by the Salt-master to accept communication requests via TCP from minions.
The connection is initiated by the minion and is open only when needed.
Usually, minions will open this port when they have to report results to the master, such as when a command received on port 4505 has finished.
This port uses a request/response topology; the minion sends requests to the master.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>25151</term>
<listitem>
<simpara>TCP</simpara>
<simpara>For cobbler.</simpara>
</listitem>
</varlistentry>
</variablelist>
<variablelist>
<title>Internally Used Ports on SUSE Manager Server</title>
<varlistentry>
<term>2828</term>
<listitem>
<simpara>Internal /</simpara>
<simpara>Satellite-search API, used by the RHN application in Tomcat and Taskomatic.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>2829</term>
<listitem>
<simpara>Internal /</simpara>
<simpara>Taskomatic API, used by the RHN application in Tomcat.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>6868</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Auditlog-keeper to database.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>6888</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Auditlog-keeper API, used by the RHN application in Tomcat.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>8005</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Tomcat shutdown port.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>8009</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Tomcat to Apache HTTPD (AJP).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>8080</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Tomcat to Apache HTTPD (HTTP).</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>9080</term>
<listitem>
<simpara>Internal</simpara>
<simpara>Salt-API, used by the RHN application in Tomcat and Taskomatic.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>32000</term>
<listitem>
<simpara>Internal / TCP</simpara>
<simpara>Port for a TCP connection to the Java Virtual Machine (JVM) that runs Taskomatic and the search (satellite-search).</simpara>
</listitem>
</varlistentry>
</variablelist>
<note>
<title>Ephemeral Ports</title>
<simpara>Anything from port 32768 on (more exactly, what you can see with <literal role="command">cat /proc/sys/net/ipv4/ip_local_port_range</literal>) is an ephemeral port, typically used as the receiving end of a TCP connection.
So if process A opens a TCP connection to process B (for example, port 22), then A chooses an arbitrary source TCP port to match with destination port 22.</simpara>
</note>
<simpara>This image is a graphical representation of the ports used in SUSE Manager:</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="ports_diagram.png"/>
</imageobject>
<textobject><phrase>ports diagram</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Port 80 (http) is not used to serve the Web UI, and is closed in most installations.
Port 80 is used temporarily for some bootstrap repositories and automated installations.</simpara>
</section>
<section xml:id="advanced.topics.app.ports.proxy">
<title>SUSE Manager Proxy Server</title>
<variablelist>
<title>Ports to Open on SUSE ManagerProxy Server</title>
<varlistentry>
<term>22</term>
<listitem>
<simpara>Inbound /</simpara>
<simpara>Required when using ssh-push or ssh-push-tunnel contact methods.
Check-in on clients connected to a SUSE Manager Proxy will be initiated on the SUSE Manager Server and <quote>hop through</quote> through to clients.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>80</term>
<listitem>
<simpara>Outbound /</simpara>
<simpara>Used to reach SUSE Manager.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>5222</term>
<listitem>
<simpara>Inbound / TCP</simpara>
<simpara>For push actions and connections issued by <literal role="systemitem">osad</literal> running on the client systems.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>5269</term>
<listitem>
<simpara>Inbound/Outbound / TCP</simpara>
<simpara>For push actions with the server.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
<section xml:id="advanced.topics.app.ports.client">
<title>SUSE Manager Client</title>
<variablelist>
<title>Ports to Open on SUSE Manager Client</title>
<varlistentry>
<term>22</term>
<listitem>
<simpara>Inbound / SSH</simpara>
<simpara>Required when using ssh-push or ssh-push-tunnel contact methods.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>80</term>
<listitem>
<simpara>Outbound</simpara>
<simpara>To reach the SUSE Manager server or SUSE Manager Proxy server.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>5222</term>
<listitem>
<simpara>Outbound / TCP</simpara>
<simpara>For push actions with the server or proxy server.</simpara>
</listitem>
</varlistentry>
</variablelist>
</section>
</appendix>
<appendix xml:id="advanced.topics.app.ay.example-simple">
<title>Minimalist AutoYaST Profile for Automated Installations and Useful Enhancements</title>
<simpara>The AutoYaST profile in this section installs a SUSE Linux Enterprise Server system with all default installation options including a default network configuration using DHCP.
After the installation is finished, a bootstrap script located on the SUSE Manager server is executed in order to register the freshly installed system with SUSE Manager.
You need to adjust the IP address of the SUSE Manager server, the name of the bootstrap script, and the root password according to your environment:</simpara>
<screen>&lt;user&gt;
 ...
 &lt;username&gt;root&lt;/username&gt;
 &lt;user_password&gt;`linux`&lt;/user_password&gt;
&lt;/user&gt;

&lt;location&gt;http://`192.168.1.1`/pub/bootstrap/`my_bootstrap.sh`&lt;/location&gt;</screen>
<simpara>The complete AutoYaST file:</simpara>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns"
         xmlns:config="http://www.suse.com/1.0/configns"&gt;
 &lt;general&gt;
  &lt;mode&gt;
   &lt;confirm config:type="boolean"&gt;false&lt;/confirm&gt;
  &lt;/mode&gt;
 &lt;/general&gt;
 &lt;networking&gt;
  &lt;keep_install_network config:type="boolean"&gt;true&lt;/keep_install_network&gt;
 &lt;/networking&gt;
 &lt;software&gt;
  &lt;install_recommended config:type="boolean"&gt;true&lt;/install_recommended&gt;
   &lt;patterns config:type="list"&gt;
    &lt;pattern&gt;base&lt;/pattern&gt;
   &lt;/patterns&gt;
 &lt;/software&gt;
 &lt;users config:type="list"&gt;
  &lt;user&gt;
   &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
   &lt;fullname&gt;root&lt;/fullname&gt;
   &lt;gid&gt;0&lt;/gid&gt;
   &lt;home&gt;/root&lt;/home&gt;
   &lt;password_settings&gt;
    &lt;expire&gt;&lt;/expire&gt;
    &lt;flag&gt;&lt;/flag&gt;
    &lt;inact&gt;&lt;/inact&gt;
    &lt;max&gt;&lt;/max&gt;
    &lt;min&gt;&lt;/min&gt;
    &lt;warn&gt;&lt;/warn&gt;
   &lt;/password_settings&gt;
   &lt;shell&gt;/bin/bash&lt;/shell&gt;
   &lt;uid&gt;0&lt;/uid&gt;
   &lt;username&gt;root&lt;/username&gt;
   &lt;user_password&gt;linux&lt;/user_password&gt;
  &lt;/user&gt;
 &lt;/users&gt;
 &lt;scripts&gt;
  &lt;init-scripts config:type="list"&gt;
   &lt;script&gt;
    &lt;interpreter&gt;shell&lt;/interpreter&gt;
    &lt;location&gt;http://192.168.1.1/pub/bootstrap/my_bootstrap.sh&lt;/location&gt;
   &lt;/script&gt;
  &lt;/init-scripts&gt;
 &lt;/scripts&gt;
&lt;/profile&gt;</screen>
<simpara>Use this enhancement fragment to add child channels:</simpara>
<screen>&lt;add-on&gt;
 &lt;add_on_products config:type="list"&gt;
  &lt;listentry&gt;
   &lt;ask_on_error config:type="boolean"&gt;true&lt;/ask_on_error&gt;
   &lt;media_url&gt;http://$c_server/ks/dist/child/`channel-label`/`distribution-label`&lt;/media_url&gt;
   &lt;name&gt;$c_name&lt;/name&gt;
   &lt;product&gt;$c_product&lt;/product&gt;
   &lt;product_dir&gt;/&lt;/product_dir&gt;
  &lt;/listentry&gt;
...
 &lt;/add_on_products&gt;
&lt;/add-on&gt;</screen>
<simpara>Replace <literal role="replaceable">channel-label</literal> and <literal role="replaceable">distribution-label</literal> with the correct labels (such as <literal>sles11-sp1-updates-x86_64</literal> and <literal>sles11-sp2-x86_64</literal>). Ensure that the distribution label corresponds to the Autoinstallable Distribution. Set the variables (such as <literal>$c_server</literal>) according to your environment.
For information about variables, see
<xref linkend="s4-sm-system-kick-dist-variables"/>.</simpara>
<important>
<title>Add the Updates Channel</title>
<simpara>It is required that you add the updates tools channel to the &lt;add-on&gt; AutoYaST snippet section.
This ensures your systems are provided with an up-to-date version of the <literal>libzypp</literal> package.
If you do not include the updates tools channel, you will encounter <literal>400</literal> errors.
In this example, the (DISTRIBUTION_NAME) is replaced with the name of the autoinstallation distribution, as created previously, from <menuchoice><guimenu>Systems</guimenu> <guisubmenu>Autoinstallation</guisubmenu> <guimenuitem>Distributions</guimenuitem></menuchoice></simpara>
<screen>&lt;listentry&gt;
     &lt;ask_on_error config:type="boolean"&gt;true&lt;/ask_on_error&gt;
     &lt;media_url&gt;http://$redhat_management_server/ks/dist/child/sles12-sp2-updates-x86_64/(DISTRIBUTION_NAME)&lt;/media_url&gt;
     &lt;name&gt;sles12 sp2 updates&lt;/name&gt;
     &lt;product&gt;SLES12&lt;/product&gt;
     &lt;product_dir&gt;/&lt;/product_dir&gt;
  &lt;/listentry&gt;</screen>
</important>
</appendix>
<appendix xml:id="_gnu_licenses_2">
<title>GNU Licenses</title>
<simpara>This appendix contains the GNU Free Documentation License version 1.2.</simpara>
</appendix>
<chapter xml:id="_gnu_free_documentation_license_2">
<title>GNU Free Documentation License</title>
<simpara>Copyright &#169; 2000, 2001, 2002 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.</simpara>
<bridgehead xml:id="_0_preamble_2" renderas="sect2">0. PREAMBLE</bridgehead>
<simpara>The purpose of this License is to make a manual, textbook, or other functional and useful document "free" in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others.</simpara>
<simpara>This License is a kind of "copyleft", which means that derivative works of the document must themselves be free in the same sense.
It complements the GNU General Public License, which is a copyleft license designed for free software.</simpara>
<simpara>We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does.
But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book.
We recommend this License principally for works whose purpose is instruction or reference.</simpara>
<bridgehead xml:id="_1_applicability_and_definitions_2" renderas="sect2">1. APPLICABILITY AND DEFINITIONS</bridgehead>
<simpara>This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License.
Such a notice grants a world-wide, royalty-free license, unlimited in duration, to use that work under the conditions stated herein.
The "Document", below, refers to any such manual or work.
Any member of the public is a licensee, and is addressed as "you". You accept the license if you copy, modify or distribute the work in a way requiring permission under copyright law.</simpara>
<simpara>A "Modified Version" of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language.</simpara>
<simpara>A "Secondary Section" is a named appendix or a front-matter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document&#8217;s overall subject (or to related matters) and contains nothing that could fall directly within that overall subject.
(Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them.</simpara>
<simpara>The "Invariant Sections" are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License.
If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant.
The Document may contain zero Invariant Sections.
If the Document does not identify any Invariant Sections then there are none.</simpara>
<simpara>The "Cover Texts" are certain short passages of text that are listed, as Front-Cover Texts or Back-Cover Texts, in the notice that says that the Document is released under this License.
A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at most 25 words.</simpara>
<simpara>A "Transparent" copy of the Document means a machine-readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters.
A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount of text.
A copy that is not "Transparent" is called "Opaque".</simpara>
<simpara>Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, LaTeX input format, SGML or XML using a publicly available DTD, and standard-conforming simple HTML, PostScript or PDF designed for human modification.
Examples of transparent image formats include PNG, XCF and JPG.
Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine-generated HTML, PostScript or PDF produced by some word processors for output purposes only.</simpara>
<simpara>The "Title Page" means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page.
For works in formats which do not have any title page as such, "Title Page" means the text near the most prominent appearance of the work&#8217;s title, preceding the beginning of the body of the text.</simpara>
<simpara>A section "Entitled XYZ" means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language.
(Here XYZ stands for a specific section name mentioned below, such as "Acknowledgements", "Dedications", "Endorsements", or "History".) To "Preserve the Title" of such a section when you modify the Document means that it remains a section "Entitled XYZ" according to this definition.</simpara>
<simpara>The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document.
These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License.</simpara>
<bridgehead xml:id="_2_verbatim_copying_2" renderas="sect2">2. VERBATIM COPYING</bridgehead>
<simpara>You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License.
You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute.
However, you may accept compensation in exchange for copies.
If you distribute a large enough number of copies you must also follow the conditions in section 3.</simpara>
<simpara>You may also lend copies, under the same conditions stated above, and you may publicly display copies.</simpara>
<bridgehead xml:id="_3_copying_in_quantity_2" renderas="sect2">3. COPYING IN QUANTITY</bridgehead>
<simpara>If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document&#8217;s license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on the back cover.
Both covers must also clearly and legibly identify you as the publisher of these copies.
The front cover must present the full title with all words of the title equally prominent and visible.
You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects.</simpara>
<simpara>If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages.</simpara>
<simpara>If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine-readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computer-network location from which the general network-using public has access to download using public-standard network protocols a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public.</simpara>
<simpara>It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document.</simpara>
<bridgehead xml:id="_4_modifications_2" renderas="sect2">4. MODIFICATIONS</bridgehead>
<simpara>You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy of it.
In addition, you must do these things in the Modified Version:</simpara>
<orderedlist numeration="upperalpha">
<listitem>
<simpara>Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission.</simpara>
</listitem>
<listitem>
<simpara>List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement.</simpara>
</listitem>
<listitem>
<simpara>State on the Title page the name of the publisher of the Modified Version, as the publisher.</simpara>
</listitem>
<listitem>
<simpara>Preserve all the copyright notices of the Document.</simpara>
</listitem>
<listitem>
<simpara>Add an appropriate copyright notice for your modifications adjacent to the other copyright notices.</simpara>
</listitem>
<listitem>
<simpara>Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below.</simpara>
</listitem>
<listitem>
<simpara>Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document&#8217;s license notice.</simpara>
</listitem>
<listitem>
<simpara>Include an unaltered copy of this License.</simpara>
</listitem>
<listitem>
<simpara>Preserve the section Entitled "History", Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled "History" in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence.</simpara>
</listitem>
<listitem>
<simpara>Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on. These may be placed in the "History" section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission.</simpara>
</listitem>
<listitem>
<simpara>For any section Entitled "Acknowledgements" or "Dedications", Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein.</simpara>
</listitem>
<listitem>
<simpara>Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles.</simpara>
</listitem>
<listitem>
<simpara>Delete any section Entitled "Endorsements". Such a section may not be included in the Modified Version.</simpara>
</listitem>
<listitem>
<simpara>Do not retitle any existing section to be Entitled "Endorsements" or to conflict in title with any Invariant Section.</simpara>
</listitem>
<listitem>
<simpara>Preserve any Warranty Disclaimers.</simpara>
</listitem>
</orderedlist>
<simpara>If the Modified Version includes new front-matter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant.
To do this, add their titles to the list of Invariant Sections in the Modified Version&#8217;s license notice.
These titles must be distinct from any other section titles.</simpara>
<simpara>You may add a section Entitled "Endorsements", provided it contains nothing but endorsements of your Modified Version by various parties&#8212;&#8203;for example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard.</simpara>
<simpara>You may add a passage of up to five words as a Front-Cover Text, and a passage of up to 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified Version.
Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or through arrangements made by) any one entity.
If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one.</simpara>
<simpara>The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version.</simpara>
<bridgehead xml:id="_5_combining_documents_2" renderas="sect2">5. COMBINING DOCUMENTS</bridgehead>
<simpara>You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers.</simpara>
<simpara>The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy.
If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work.</simpara>
<simpara>In the combination, you must combine any sections Entitled "History" in the various original documents, forming one section Entitled "History"; likewise combine any sections Entitled "Acknowledgements", and any sections Entitled "Dedications". You must delete all sections Entitled "Endorsements".</simpara>
<bridgehead xml:id="_6_collections_of_documents_2" renderas="sect2">6. COLLECTIONS OF DOCUMENTS</bridgehead>
<simpara>You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects.</simpara>
<simpara>You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document.</simpara>
<bridgehead xml:id="_7_aggregation_with_independent_works_2" renderas="sect2">7. AGGREGATION WITH INDEPENDENT WORKS</bridgehead>
<simpara>A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an "aggregate" if the copyright resulting from the compilation is not used to limit the legal rights of the compilation&#8217;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document.</simpara>
<simpara>If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document&#8217;s Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole aggregate.</simpara>
<bridgehead xml:id="_8_translation_2" renderas="sect2">8. TRANSLATION</bridgehead>
<simpara>Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections.
You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers.
In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail.</simpara>
<simpara>If a section in the Document is Entitled "Acknowledgements", "Dedications", or "History", the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title.</simpara>
<bridgehead xml:id="_9_termination_2" renderas="sect2">9. TERMINATION</bridgehead>
<simpara>You may not copy, modify, sublicense, or distribute the Document except as expressly provided for under this License.
Any other attempt to copy, modify, sublicense or distribute the Document is void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.</simpara>
<bridgehead xml:id="_10_future_revisions_of_this_license_2" renderas="sect2">10. FUTURE REVISIONS OF THIS LICENSE</bridgehead>
<simpara>The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time.
Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
See <link xl:href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</link>.</simpara>
<simpara>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this License "or any later version" applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation.
If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation.</simpara>
<bridgehead xml:id="_addendum_how_to_use_this_license_for_your_documents_2" renderas="sect2">ADDENDUM: How to use this License for your documents</bridgehead>
<screen>Copyright (c) YEAR YOUR NAME.
   Permission is granted to copy, distribute and/or modify this document
   under the terms of the GNU Free Documentation License, Version 1.2
   or any later version published by the Free Software Foundation;
   with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
   A copy of the license is included in the section entitled{ldquo}GNU
   Free Documentation License{rdquo}.</screen>
<simpara>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the &#8220;
with&#8230;&#8203;Texts.&#8221;
line with this:</simpara>
<screen>with the Invariant Sections being LIST THEIR TITLES, with the
   Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.</screen>
<simpara>If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation.</simpara>
<simpara>If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software.</simpara>
</chapter>
</part>
</book>